(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}})();function makeMap(n,e){const r=Object.create(null),o=n.split(",");for(let s=0;s<o.length;s++)r[o[s]]=!0;return e?s=>!!r[s.toLowerCase()]:s=>!!r[s]}function normalizeStyle(n){if(isArray$1(n)){const e={};for(let r=0;r<n.length;r++){const o=n[r],s=isString(o)?parseStringStyle(o):normalizeStyle(o);if(s)for(const l in s)e[l]=s[l]}return e}else{if(isString(n))return n;if(isObject$1(n))return n}}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*.*?\*\//gs;function parseStringStyle(n){const e={};return n.replace(styleCommentRE,"").split(listDelimiterRE).forEach(r=>{if(r){const o=r.split(propertyDelimiterRE);o.length>1&&(e[o[0].trim()]=o[1].trim())}}),e}function normalizeClass(n){let e="";if(isString(n))e=n;else if(isArray$1(n))for(let r=0;r<n.length;r++){const o=normalizeClass(n[r]);o&&(e+=o+" ")}else if(isObject$1(n))for(const r in n)n[r]&&(e+=r+" ");return e.trim()}function normalizeProps(n){if(!n)return null;let{class:e,style:r}=n;return e&&!isString(e)&&(n.class=normalizeClass(e)),r&&(n.style=normalizeStyle(r)),n}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(n){return!!n||n===""}function looseCompareArrays(n,e){if(n.length!==e.length)return!1;let r=!0;for(let o=0;r&&o<n.length;o++)r=looseEqual(n[o],e[o]);return r}function looseEqual(n,e){if(n===e)return!0;let r=isDate(n),o=isDate(e);if(r||o)return r&&o?n.getTime()===e.getTime():!1;if(r=isSymbol(n),o=isSymbol(e),r||o)return n===e;if(r=isArray$1(n),o=isArray$1(e),r||o)return r&&o?looseCompareArrays(n,e):!1;if(r=isObject$1(n),o=isObject$1(e),r||o){if(!r||!o)return!1;const s=Object.keys(n).length,l=Object.keys(e).length;if(s!==l)return!1;for(const a in n){const c=n.hasOwnProperty(a),u=e.hasOwnProperty(a);if(c&&!u||!c&&u||!looseEqual(n[a],e[a]))return!1}}return String(n)===String(e)}function looseIndexOf(n,e){return n.findIndex(r=>looseEqual(r,e))}const toDisplayString=n=>isString(n)?n:n==null?"":isArray$1(n)||isObject$1(n)&&(n.toString===objectToString||!isFunction(n.toString))?JSON.stringify(n,replacer,2):String(n),replacer=(n,e)=>e&&e.__v_isRef?replacer(n,e.value):isMap(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[o,s])=>(r[`${o} =>`]=s,r),{})}:isSet(e)?{[`Set(${e.size})`]:[...e.values()]}:isObject$1(e)&&!isArray$1(e)&&!isPlainObject(e)?String(e):e,EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,onRE=/^on[^a-z]/,isOn=n=>onRE.test(n),isModelListener=n=>n.startsWith("onUpdate:"),extend$1=Object.assign,remove$1=(n,e)=>{const r=n.indexOf(e);r>-1&&n.splice(r,1)},hasOwnProperty$1=Object.prototype.hasOwnProperty,hasOwn=(n,e)=>hasOwnProperty$1.call(n,e),isArray$1=Array.isArray,isMap=n=>toTypeString(n)==="[object Map]",isSet=n=>toTypeString(n)==="[object Set]",isDate=n=>toTypeString(n)==="[object Date]",isFunction=n=>typeof n=="function",isString=n=>typeof n=="string",isSymbol=n=>typeof n=="symbol",isObject$1=n=>n!==null&&typeof n=="object",isPromise=n=>isObject$1(n)&&isFunction(n.then)&&isFunction(n.catch),objectToString=Object.prototype.toString,toTypeString=n=>objectToString.call(n),toRawType=n=>toTypeString(n).slice(8,-1),isPlainObject=n=>toTypeString(n)==="[object Object]",isIntegerKey=n=>isString(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=n=>{const e=Object.create(null);return r=>e[r]||(e[r]=n(r))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(n=>n.replace(camelizeRE,(e,r)=>r?r.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(n=>n.replace(hyphenateRE,"-$1").toLowerCase()),capitalize=cacheStringFunction(n=>n.charAt(0).toUpperCase()+n.slice(1)),toHandlerKey=cacheStringFunction(n=>n?`on${capitalize(n)}`:""),hasChanged=(n,e)=>!Object.is(n,e),invokeArrayFns=(n,e)=>{for(let r=0;r<n.length;r++)n[r](e)},def=(n,e,r)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value:r})},looseToNumber=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let activeEffectScope;class EffectScope{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=activeEffectScope,!e&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const r=activeEffectScope;try{return activeEffectScope=this,e()}finally{activeEffectScope=r}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(e){if(this._active){let r,o;for(r=0,o=this.effects.length;r<o;r++)this.effects[r].stop();for(r=0,o=this.cleanups.length;r<o;r++)this.cleanups[r]();if(this.scopes)for(r=0,o=this.scopes.length;r<o;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function effectScope(n){return new EffectScope(n)}function recordEffectScope(n,e=activeEffectScope){e&&e.active&&e.effects.push(n)}function getCurrentScope(){return activeEffectScope}function onScopeDispose(n){activeEffectScope&&activeEffectScope.cleanups.push(n)}const createDep=n=>{const e=new Set(n);return e.w=0,e.n=0,e},wasTracked=n=>(n.w&trackOpBit)>0,newTracked=n=>(n.n&trackOpBit)>0,initDepMarkers=({deps:n})=>{if(n.length)for(let e=0;e<n.length;e++)n[e].w|=trackOpBit},finalizeDepMarkers=n=>{const{deps:e}=n;if(e.length){let r=0;for(let o=0;o<e.length;o++){const s=e[o];wasTracked(s)&&!newTracked(s)?s.delete(n):e[r++]=s,s.w&=~trackOpBit,s.n&=~trackOpBit}e.length=r}},targetMap=new WeakMap;let effectTrackDepth=0,trackOpBit=1;const maxMarkerBits=30;let activeEffect;const ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol("");class ReactiveEffect{constructor(e,r=null,o){this.fn=e,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,recordEffectScope(this,o)}run(){if(!this.active)return this.fn();let e=activeEffect,r=shouldTrack;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=activeEffect,activeEffect=this,shouldTrack=!0,trackOpBit=1<<++effectTrackDepth,effectTrackDepth<=maxMarkerBits?initDepMarkers(this):cleanupEffect(this),this.fn()}finally{effectTrackDepth<=maxMarkerBits&&finalizeDepMarkers(this),trackOpBit=1<<--effectTrackDepth,activeEffect=this.parent,shouldTrack=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){activeEffect===this?this.deferStop=!0:this.active&&(cleanupEffect(this),this.onStop&&this.onStop(),this.active=!1)}}function cleanupEffect(n){const{deps:e}=n;if(e.length){for(let r=0;r<e.length;r++)e[r].delete(n);e.length=0}}let shouldTrack=!0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const n=trackStack.pop();shouldTrack=n===void 0?!0:n}function track(n,e,r){if(shouldTrack&&activeEffect){let o=targetMap.get(n);o||targetMap.set(n,o=new Map);let s=o.get(r);s||o.set(r,s=createDep()),trackEffects(s)}}function trackEffects(n,e){let r=!1;effectTrackDepth<=maxMarkerBits?newTracked(n)||(n.n|=trackOpBit,r=!wasTracked(n)):r=!n.has(activeEffect),r&&(n.add(activeEffect),activeEffect.deps.push(n))}function trigger(n,e,r,o,s,l){const a=targetMap.get(n);if(!a)return;let c=[];if(e==="clear")c=[...a.values()];else if(r==="length"&&isArray$1(n)){const u=Number(o);a.forEach((f,d)=>{(d==="length"||d>=u)&&c.push(f)})}else switch(r!==void 0&&c.push(a.get(r)),e){case"add":isArray$1(n)?isIntegerKey(r)&&c.push(a.get("length")):(c.push(a.get(ITERATE_KEY)),isMap(n)&&c.push(a.get(MAP_KEY_ITERATE_KEY)));break;case"delete":isArray$1(n)||(c.push(a.get(ITERATE_KEY)),isMap(n)&&c.push(a.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap(n)&&c.push(a.get(ITERATE_KEY));break}if(c.length===1)c[0]&&triggerEffects(c[0]);else{const u=[];for(const f of c)f&&u.push(...f);triggerEffects(createDep(u))}}function triggerEffects(n,e){const r=isArray$1(n)?n:[...n];for(const o of r)o.computed&&triggerEffect(o);for(const o of r)o.computed||triggerEffect(o)}function triggerEffect(n,e){(n!==activeEffect||n.allowRecurse)&&(n.scheduler?n.scheduler():n.run())}function getDepFromReactive(n,e){var r;return(r=targetMap.get(n))===null||r===void 0?void 0:r.get(e)}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(isSymbol)),get$1=createGetter(),shallowGet=createGetter(!1,!0),readonlyGet=createGetter(!0),arrayInstrumentations=createArrayInstrumentations();function createArrayInstrumentations(){const n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...r){const o=toRaw(this);for(let l=0,a=this.length;l<a;l++)track(o,"get",l+"");const s=o[e](...r);return s===-1||s===!1?o[e](...r.map(toRaw)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...r){pauseTracking();const o=toRaw(this)[e].apply(this,r);return resetTracking(),o}}),n}function hasOwnProperty(n){const e=toRaw(this);return track(e,"has",n),e.hasOwnProperty(n)}function createGetter(n=!1,e=!1){return function(o,s,l){if(s==="__v_isReactive")return!n;if(s==="__v_isReadonly")return n;if(s==="__v_isShallow")return e;if(s==="__v_raw"&&l===(n?e?shallowReadonlyMap:readonlyMap:e?shallowReactiveMap:reactiveMap).get(o))return o;const a=isArray$1(o);if(!n){if(a&&hasOwn(arrayInstrumentations,s))return Reflect.get(arrayInstrumentations,s,l);if(s==="hasOwnProperty")return hasOwnProperty}const c=Reflect.get(o,s,l);return(isSymbol(s)?builtInSymbols.has(s):isNonTrackableKeys(s))||(n||track(o,"get",s),e)?c:isRef(c)?a&&isIntegerKey(s)?c:c.value:isObject$1(c)?n?readonly(c):reactive(c):c}}const set$1=createSetter(),shallowSet=createSetter(!0);function createSetter(n=!1){return function(r,o,s,l){let a=r[o];if(isReadonly(a)&&isRef(a)&&!isRef(s))return!1;if(!n&&(!isShallow(s)&&!isReadonly(s)&&(a=toRaw(a),s=toRaw(s)),!isArray$1(r)&&isRef(a)&&!isRef(s)))return a.value=s,!0;const c=isArray$1(r)&&isIntegerKey(o)?Number(o)<r.length:hasOwn(r,o),u=Reflect.set(r,o,s,l);return r===toRaw(l)&&(c?hasChanged(s,a)&&trigger(r,"set",o,s):trigger(r,"add",o,s)),u}}function deleteProperty(n,e){const r=hasOwn(n,e);n[e];const o=Reflect.deleteProperty(n,e);return o&&r&&trigger(n,"delete",e,void 0),o}function has$1(n,e){const r=Reflect.has(n,e);return(!isSymbol(e)||!builtInSymbols.has(e))&&track(n,"has",e),r}function ownKeys(n){return track(n,"iterate",isArray$1(n)?"length":ITERATE_KEY),Reflect.ownKeys(n)}const mutableHandlers={get:get$1,set:set$1,deleteProperty,has:has$1,ownKeys},readonlyHandlers={get:readonlyGet,set(n,e){return!0},deleteProperty(n,e){return!0}},shallowReactiveHandlers=extend$1({},mutableHandlers,{get:shallowGet,set:shallowSet}),toShallow=n=>n,getProto=n=>Reflect.getPrototypeOf(n);function get$2(n,e,r=!1,o=!1){n=n.__v_raw;const s=toRaw(n),l=toRaw(e);r||(e!==l&&track(s,"get",e),track(s,"get",l));const{has:a}=getProto(s),c=o?toShallow:r?toReadonly:toReactive;if(a.call(s,e))return c(n.get(e));if(a.call(s,l))return c(n.get(l));n!==s&&n.get(e)}function has(n,e=!1){const r=this.__v_raw,o=toRaw(r),s=toRaw(n);return e||(n!==s&&track(o,"has",n),track(o,"has",s)),n===s?r.has(n):r.has(n)||r.has(s)}function size(n,e=!1){return n=n.__v_raw,!e&&track(toRaw(n),"iterate",ITERATE_KEY),Reflect.get(n,"size",n)}function add$1(n){n=toRaw(n);const e=toRaw(this);return getProto(e).has.call(e,n)||(e.add(n),trigger(e,"add",n,n)),this}function set$2(n,e){e=toRaw(e);const r=toRaw(this),{has:o,get:s}=getProto(r);let l=o.call(r,n);l||(n=toRaw(n),l=o.call(r,n));const a=s.call(r,n);return r.set(n,e),l?hasChanged(e,a)&&trigger(r,"set",n,e):trigger(r,"add",n,e),this}function deleteEntry(n){const e=toRaw(this),{has:r,get:o}=getProto(e);let s=r.call(e,n);s||(n=toRaw(n),s=r.call(e,n)),o&&o.call(e,n);const l=e.delete(n);return s&&trigger(e,"delete",n,void 0),l}function clear(){const n=toRaw(this),e=n.size!==0,r=n.clear();return e&&trigger(n,"clear",void 0,void 0),r}function createForEach(n,e){return function(o,s){const l=this,a=l.__v_raw,c=toRaw(a),u=e?toShallow:n?toReadonly:toReactive;return!n&&track(c,"iterate",ITERATE_KEY),a.forEach((f,d)=>o.call(s,u(f),u(d),l))}}function createIterableMethod(n,e,r){return function(...o){const s=this.__v_raw,l=toRaw(s),a=isMap(l),c=n==="entries"||n===Symbol.iterator&&a,u=n==="keys"&&a,f=s[n](...o),d=r?toShallow:e?toReadonly:toReactive;return!e&&track(l,"iterate",u?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:g,done:m}=f.next();return m?{value:g,done:m}:{value:c?[d(g[0]),d(g[1])]:d(g),done:m}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(n){return function(...e){return n==="delete"?!1:this}}function createInstrumentations(){const n={get(l){return get$2(this,l)},get size(){return size(this)},has,add:add$1,set:set$2,delete:deleteEntry,clear,forEach:createForEach(!1,!1)},e={get(l){return get$2(this,l,!1,!0)},get size(){return size(this)},has,add:add$1,set:set$2,delete:deleteEntry,clear,forEach:createForEach(!1,!0)},r={get(l){return get$2(this,l,!0)},get size(){return size(this,!0)},has(l){return has.call(this,l,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},o={get(l){return get$2(this,l,!0,!0)},get size(){return size(this,!0)},has(l){return has.call(this,l,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(l=>{n[l]=createIterableMethod(l,!1,!1),r[l]=createIterableMethod(l,!0,!1),e[l]=createIterableMethod(l,!1,!0),o[l]=createIterableMethod(l,!0,!0)}),[n,r,e,o]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(n,e){const r=e?n?shallowReadonlyInstrumentations:shallowInstrumentations:n?readonlyInstrumentations:mutableInstrumentations;return(o,s,l)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?o:Reflect.get(hasOwn(r,s)&&s in o?r:o,s,l)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(n){return n.__v_skip||!Object.isExtensible(n)?0:targetTypeMap(toRawType(n))}function reactive(n){return isReadonly(n)?n:createReactiveObject(n,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(n){return createReactiveObject(n,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(n){return createReactiveObject(n,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function createReactiveObject(n,e,r,o,s){if(!isObject$1(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const l=s.get(n);if(l)return l;const a=getTargetType(n);if(a===0)return n;const c=new Proxy(n,a===2?o:r);return s.set(n,c),c}function isReactive(n){return isReadonly(n)?isReactive(n.__v_raw):!!(n&&n.__v_isReactive)}function isReadonly(n){return!!(n&&n.__v_isReadonly)}function isShallow(n){return!!(n&&n.__v_isShallow)}function isProxy(n){return isReactive(n)||isReadonly(n)}function toRaw(n){const e=n&&n.__v_raw;return e?toRaw(e):n}function markRaw(n){return def(n,"__v_skip",!0),n}const toReactive=n=>isObject$1(n)?reactive(n):n,toReadonly=n=>isObject$1(n)?readonly(n):n;function trackRefValue(n){shouldTrack&&activeEffect&&(n=toRaw(n),trackEffects(n.dep||(n.dep=createDep())))}function triggerRefValue(n,e){n=toRaw(n);const r=n.dep;r&&triggerEffects(r)}function isRef(n){return!!(n&&n.__v_isRef===!0)}function ref(n){return createRef(n,!1)}function shallowRef(n){return createRef(n,!0)}function createRef(n,e){return isRef(n)?n:new RefImpl(n,e)}class RefImpl{constructor(e,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?e:toRaw(e),this._value=r?e:toReactive(e)}get value(){return trackRefValue(this),this._value}set value(e){const r=this.__v_isShallow||isShallow(e)||isReadonly(e);e=r?e:toRaw(e),hasChanged(e,this._rawValue)&&(this._rawValue=e,this._value=r?e:toReactive(e),triggerRefValue(this))}}function unref(n){return isRef(n)?n.value:n}const shallowUnwrapHandlers={get:(n,e,r)=>unref(Reflect.get(n,e,r)),set:(n,e,r,o)=>{const s=n[e];return isRef(s)&&!isRef(r)?(s.value=r,!0):Reflect.set(n,e,r,o)}};function proxyRefs(n){return isReactive(n)?n:new Proxy(n,shallowUnwrapHandlers)}class CustomRefImpl{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:r,set:o}=e(()=>trackRefValue(this),()=>triggerRefValue(this));this._get=r,this._set=o}get value(){return this._get()}set value(e){this._set(e)}}function customRef(n){return new CustomRefImpl(n)}function toRefs(n){const e=isArray$1(n)?new Array(n.length):{};for(const r in n)e[r]=toRef(n,r);return e}class ObjectRefImpl{constructor(e,r,o){this._object=e,this._key=r,this._defaultValue=o,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return getDepFromReactive(toRaw(this._object),this._key)}}function toRef(n,e,r){const o=n[e];return isRef(o)?o:new ObjectRefImpl(n,e,r)}var _a$1$1;class ComputedRefImpl{constructor(e,r,o,s){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[_a$1$1]=!1,this._dirty=!0,this.effect=new ReactiveEffect(e,()=>{this._dirty||(this._dirty=!0,triggerRefValue(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=o}get value(){const e=toRaw(this);return trackRefValue(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}_a$1$1="__v_isReadonly";function computed$1(n,e,r=!1){let o,s;const l=isFunction(n);return l?(o=n,s=NOOP):(o=n.get,s=n.set),new ComputedRefImpl(o,s,l||!s,r)}function warn(n,...e){}function callWithErrorHandling(n,e,r,o){let s;try{s=o?n(...o):n()}catch(l){handleError(l,e,r)}return s}function callWithAsyncErrorHandling(n,e,r,o){if(isFunction(n)){const l=callWithErrorHandling(n,e,r,o);return l&&isPromise(l)&&l.catch(a=>{handleError(a,e,r)}),l}const s=[];for(let l=0;l<n.length;l++)s.push(callWithAsyncErrorHandling(n[l],e,r,o));return s}function handleError(n,e,r,o=!0){const s=e?e.vnode:null;if(e){let l=e.parent;const a=e.proxy,c=r;for(;l;){const f=l.ec;if(f){for(let d=0;d<f.length;d++)if(f[d](n,a,c)===!1)return}l=l.parent}const u=e.appContext.config.errorHandler;if(u){callWithErrorHandling(u,null,10,[n,a,c]);return}}logError(n,r,s,o)}function logError(n,e,r,o=!0){console.error(n)}let isFlushing=!1,isFlushPending=!1;const queue=[];let flushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(n){const e=currentFlushPromise||resolvedPromise;return n?e.then(this?n.bind(this):n):e}function findInsertionIndex(n){let e=flushIndex+1,r=queue.length;for(;e<r;){const o=e+r>>>1;getId(queue[o])<n?e=o+1:r=o}return e}function queueJob(n){(!queue.length||!queue.includes(n,isFlushing&&n.allowRecurse?flushIndex+1:flushIndex))&&(n.id==null?queue.push(n):queue.splice(findInsertionIndex(n.id),0,n),queueFlush())}function queueFlush(){!isFlushing&&!isFlushPending&&(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function invalidateJob(n){const e=queue.indexOf(n);e>flushIndex&&queue.splice(e,1)}function queuePostFlushCb(n){isArray$1(n)?pendingPostFlushCbs.push(...n):(!activePostFlushCbs||!activePostFlushCbs.includes(n,n.allowRecurse?postFlushIndex+1:postFlushIndex))&&pendingPostFlushCbs.push(n),queueFlush()}function flushPreFlushCbs(n,e=isFlushing?flushIndex+1:0){for(;e<queue.length;e++){const r=queue[e];r&&r.pre&&(queue.splice(e,1),e--,r())}}function flushPostFlushCbs(n){if(pendingPostFlushCbs.length){const e=[...new Set(pendingPostFlushCbs)];if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...e);return}for(activePostFlushCbs=e,activePostFlushCbs.sort((r,o)=>getId(r)-getId(o)),postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++)activePostFlushCbs[postFlushIndex]();activePostFlushCbs=null,postFlushIndex=0}}const getId=n=>n.id==null?1/0:n.id,comparator=(n,e)=>{const r=getId(n)-getId(e);if(r===0){if(n.pre&&!e.pre)return-1;if(e.pre&&!n.pre)return 1}return r};function flushJobs(n){isFlushPending=!1,isFlushing=!0,queue.sort(comparator);const e=NOOP;try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const r=queue[flushIndex];r&&r.active!==!1&&callWithErrorHandling(r,null,14)}}finally{flushIndex=0,queue.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}function emit(n,e,...r){if(n.isUnmounted)return;const o=n.vnode.props||EMPTY_OBJ;let s=r;const l=e.startsWith("update:"),a=l&&e.slice(7);if(a&&a in o){const d=`${a==="modelValue"?"model":a}Modifiers`,{number:g,trim:m}=o[d]||EMPTY_OBJ;m&&(s=r.map(v=>isString(v)?v.trim():v)),g&&(s=r.map(looseToNumber))}let c,u=o[c=toHandlerKey(e)]||o[c=toHandlerKey(camelize(e))];!u&&l&&(u=o[c=toHandlerKey(hyphenate(e))]),u&&callWithAsyncErrorHandling(u,n,6,s);const f=o[c+"Once"];if(f){if(!n.emitted)n.emitted={};else if(n.emitted[c])return;n.emitted[c]=!0,callWithAsyncErrorHandling(f,n,6,s)}}function normalizeEmitsOptions(n,e,r=!1){const o=e.emitsCache,s=o.get(n);if(s!==void 0)return s;const l=n.emits;let a={},c=!1;if(!isFunction(n)){const u=f=>{const d=normalizeEmitsOptions(f,e,!0);d&&(c=!0,extend$1(a,d))};!r&&e.mixins.length&&e.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}return!l&&!c?(isObject$1(n)&&o.set(n,null),null):(isArray$1(l)?l.forEach(u=>a[u]=null):extend$1(a,l),isObject$1(n)&&o.set(n,a),a)}function isEmitListener(n,e){return!n||!isOn(e)?!1:(e=e.slice(2).replace(/Once$/,""),hasOwn(n,e[0].toLowerCase()+e.slice(1))||hasOwn(n,hyphenate(e))||hasOwn(n,e))}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(n){const e=currentRenderingInstance;return currentRenderingInstance=n,currentScopeId=n&&n.type.__scopeId||null,e}function pushScopeId(n){currentScopeId=n}function popScopeId(){currentScopeId=null}function withCtx(n,e=currentRenderingInstance,r){if(!e||n._n)return n;const o=(...s)=>{o._d&&setBlockTracking(-1);const l=setCurrentRenderingInstance(e);let a;try{a=n(...s)}finally{setCurrentRenderingInstance(l),o._d&&setBlockTracking(1)}return a};return o._n=!0,o._c=!0,o._d=!0,o}function markAttrsAccessed(){}function renderComponentRoot(n){const{type:e,vnode:r,proxy:o,withProxy:s,props:l,propsOptions:[a],slots:c,attrs:u,emit:f,render:d,renderCache:g,data:m,setupState:v,ctx:b,inheritAttrs:k}=n;let A,R;const $=setCurrentRenderingInstance(n);try{if(r.shapeFlag&4){const _=s||o;A=normalizeVNode(d.call(_,_,g,l,v,m,b)),R=u}else{const _=e;A=normalizeVNode(_.length>1?_(l,{attrs:u,slots:c,emit:f}):_(l,null)),R=e.props?u:getFunctionalFallthrough(u)}}catch(_){blockStack.length=0,handleError(_,n,1),A=createVNode(Comment)}let J=A;if(R&&k!==!1){const _=Object.keys(R),{shapeFlag:L}=J;_.length&&L&7&&(a&&_.some(isModelListener)&&(R=filterModelListeners(R,a)),J=cloneVNode(J,R))}return r.dirs&&(J=cloneVNode(J),J.dirs=J.dirs?J.dirs.concat(r.dirs):r.dirs),r.transition&&(J.transition=r.transition),A=J,setCurrentRenderingInstance($),A}const getFunctionalFallthrough=n=>{let e;for(const r in n)(r==="class"||r==="style"||isOn(r))&&((e||(e={}))[r]=n[r]);return e},filterModelListeners=(n,e)=>{const r={};for(const o in n)(!isModelListener(o)||!(o.slice(9)in e))&&(r[o]=n[o]);return r};function shouldUpdateComponent(n,e,r){const{props:o,children:s,component:l}=n,{props:a,children:c,patchFlag:u}=e,f=l.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&u>=0){if(u&1024)return!0;if(u&16)return o?hasPropsChanged(o,a,f):!!a;if(u&8){const d=e.dynamicProps;for(let g=0;g<d.length;g++){const m=d[g];if(a[m]!==o[m]&&!isEmitListener(f,m))return!0}}}else return(s||c)&&(!c||!c.$stable)?!0:o===a?!1:o?a?hasPropsChanged(o,a,f):!0:!!a;return!1}function hasPropsChanged(n,e,r){const o=Object.keys(e);if(o.length!==Object.keys(n).length)return!0;for(let s=0;s<o.length;s++){const l=o[s];if(e[l]!==n[l]&&!isEmitListener(r,l))return!0}return!1}function updateHOCHostEl({vnode:n,parent:e},r){for(;e&&e.subTree===n;)(n=e.vnode).el=r,e=e.parent}const isSuspense=n=>n.__isSuspense;function queueEffectWithSuspense(n,e){e&&e.pendingBranch?isArray$1(n)?e.effects.push(...n):e.effects.push(n):queuePostFlushCb(n)}function provide(n,e){if(currentInstance){let r=currentInstance.provides;const o=currentInstance.parent&&currentInstance.parent.provides;o===r&&(r=currentInstance.provides=Object.create(o)),r[n]=e}}function inject(n,e,r=!1){const o=currentInstance||currentRenderingInstance;if(o){const s=o.parent==null?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides;if(s&&n in s)return s[n];if(arguments.length>1)return r&&isFunction(e)?e.call(o.proxy):e}}function watchEffect(n,e){return doWatch(n,null,e)}const INITIAL_WATCHER_VALUE={};function watch(n,e,r){return doWatch(n,e,r)}function doWatch(n,e,{immediate:r,deep:o,flush:s,onTrack:l,onTrigger:a}=EMPTY_OBJ){const c=getCurrentScope()===(currentInstance==null?void 0:currentInstance.scope)?currentInstance:null;let u,f=!1,d=!1;if(isRef(n)?(u=()=>n.value,f=isShallow(n)):isReactive(n)?(u=()=>n,o=!0):isArray$1(n)?(d=!0,f=n.some(J=>isReactive(J)||isShallow(J)),u=()=>n.map(J=>{if(isRef(J))return J.value;if(isReactive(J))return traverse(J);if(isFunction(J))return callWithErrorHandling(J,c,2)})):isFunction(n)?e?u=()=>callWithErrorHandling(n,c,2):u=()=>{if(!(c&&c.isUnmounted))return g&&g(),callWithAsyncErrorHandling(n,c,3,[m])}:u=NOOP,e&&o){const J=u;u=()=>traverse(J())}let g,m=J=>{g=R.onStop=()=>{callWithErrorHandling(J,c,4)}},v;if(isInSSRComponentSetup)if(m=NOOP,e?r&&callWithAsyncErrorHandling(e,c,3,[u(),d?[]:void 0,m]):u(),s==="sync"){const J=useSSRContext();v=J.__watcherHandles||(J.__watcherHandles=[])}else return NOOP;let b=d?new Array(n.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const k=()=>{if(R.active)if(e){const J=R.run();(o||f||(d?J.some((_,L)=>hasChanged(_,b[L])):hasChanged(J,b)))&&(g&&g(),callWithAsyncErrorHandling(e,c,3,[J,b===INITIAL_WATCHER_VALUE?void 0:d&&b[0]===INITIAL_WATCHER_VALUE?[]:b,m]),b=J)}else R.run()};k.allowRecurse=!!e;let A;s==="sync"?A=k:s==="post"?A=()=>queuePostRenderEffect(k,c&&c.suspense):(k.pre=!0,c&&(k.id=c.uid),A=()=>queueJob(k));const R=new ReactiveEffect(u,A);e?r?k():b=R.run():s==="post"?queuePostRenderEffect(R.run.bind(R),c&&c.suspense):R.run();const $=()=>{R.stop(),c&&c.scope&&remove$1(c.scope.effects,R)};return v&&v.push($),$}function instanceWatch(n,e,r){const o=this.proxy,s=isString(n)?n.includes(".")?createPathGetter(o,n):()=>o[n]:n.bind(o,o);let l;isFunction(e)?l=e:(l=e.handler,r=e);const a=currentInstance;setCurrentInstance(this);const c=doWatch(s,l.bind(o),r);return a?setCurrentInstance(a):unsetCurrentInstance(),c}function createPathGetter(n,e){const r=e.split(".");return()=>{let o=n;for(let s=0;s<r.length&&o;s++)o=o[r[s]];return o}}function traverse(n,e){if(!isObject$1(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),isRef(n))traverse(n.value,e);else if(isArray$1(n))for(let r=0;r<n.length;r++)traverse(n[r],e);else if(isSet(n)||isMap(n))n.forEach(r=>{traverse(r,e)});else if(isPlainObject(n))for(const r in n)traverse(n[r],e);return n}function defineComponent(n){return isFunction(n)?{setup:n,name:n.name}:n}const isAsyncWrapper=n=>!!n.type.__asyncLoader,isKeepAlive=n=>n.type.__isKeepAlive;function onActivated(n,e){registerKeepAliveHook(n,"a",e)}function onDeactivated(n,e){registerKeepAliveHook(n,"da",e)}function registerKeepAliveHook(n,e,r=currentInstance){const o=n.__wdc||(n.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(injectHook(e,o,r),r){let s=r.parent;for(;s&&s.parent;)isKeepAlive(s.parent.vnode)&&injectToKeepAliveRoot(o,e,r,s),s=s.parent}}function injectToKeepAliveRoot(n,e,r,o){const s=injectHook(e,n,o,!0);onUnmounted(()=>{remove$1(o[e],s)},r)}function injectHook(n,e,r=currentInstance,o=!1){if(r){const s=r[n]||(r[n]=[]),l=e.__weh||(e.__weh=(...a)=>{if(r.isUnmounted)return;pauseTracking(),setCurrentInstance(r);const c=callWithAsyncErrorHandling(e,r,n,a);return unsetCurrentInstance(),resetTracking(),c});return o?s.unshift(l):s.push(l),l}}const createHook=n=>(e,r=currentInstance)=>(!isInSSRComponentSetup||n==="sp")&&injectHook(n,(...o)=>e(...o),r),onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(n,e=currentInstance){injectHook("ec",n,e)}function withDirectives(n,e){const r=currentRenderingInstance;if(r===null)return n;const o=getExposeProxy(r)||r.proxy,s=n.dirs||(n.dirs=[]);for(let l=0;l<e.length;l++){let[a,c,u,f=EMPTY_OBJ]=e[l];a&&(isFunction(a)&&(a={mounted:a,updated:a}),a.deep&&traverse(c),s.push({dir:a,instance:o,value:c,oldValue:void 0,arg:u,modifiers:f}))}return n}function invokeDirectiveHook(n,e,r,o){const s=n.dirs,l=e&&e.dirs;for(let a=0;a<s.length;a++){const c=s[a];l&&(c.oldValue=l[a].value);let u=c.dir[o];u&&(pauseTracking(),callWithAsyncErrorHandling(u,r,8,[n.el,c,n,e]),resetTracking())}}const COMPONENTS="components";function resolveComponent(n,e){return resolveAsset(COMPONENTS,n,!0,e)||n}const NULL_DYNAMIC_COMPONENT=Symbol();function resolveDynamicComponent(n){return isString(n)?resolveAsset(COMPONENTS,n,!1)||n:n||NULL_DYNAMIC_COMPONENT}function resolveAsset(n,e,r=!0,o=!1){const s=currentRenderingInstance||currentInstance;if(s){const l=s.type;if(n===COMPONENTS){const c=getComponentName(l,!1);if(c&&(c===e||c===camelize(e)||c===capitalize(camelize(e))))return l}const a=resolve(s[n]||l[n],e)||resolve(s.appContext[n],e);return!a&&o?l:a}}function resolve(n,e){return n&&(n[e]||n[camelize(e)]||n[capitalize(camelize(e))])}function renderList(n,e,r,o){let s;const l=r&&r[o];if(isArray$1(n)||isString(n)){s=new Array(n.length);for(let a=0,c=n.length;a<c;a++)s[a]=e(n[a],a,void 0,l&&l[a])}else if(typeof n=="number"){s=new Array(n);for(let a=0;a<n;a++)s[a]=e(a+1,a,void 0,l&&l[a])}else if(isObject$1(n))if(n[Symbol.iterator])s=Array.from(n,(a,c)=>e(a,c,void 0,l&&l[c]));else{const a=Object.keys(n);s=new Array(a.length);for(let c=0,u=a.length;c<u;c++){const f=a[c];s[c]=e(n[f],f,c,l&&l[c])}}else s=[];return r&&(r[o]=s),s}function renderSlot(n,e,r={},o,s){if(currentRenderingInstance.isCE||currentRenderingInstance.parent&&isAsyncWrapper(currentRenderingInstance.parent)&&currentRenderingInstance.parent.isCE)return e!=="default"&&(r.name=e),createVNode("slot",r,o&&o());let l=n[e];l&&l._c&&(l._d=!1),openBlock();const a=l&&ensureValidVNode(l(r)),c=createBlock(Fragment,{key:r.key||a&&a.key||`_${e}`},a||(o?o():[]),a&&n._===1?64:-2);return!s&&c.scopeId&&(c.slotScopeIds=[c.scopeId+"-s"]),l&&l._c&&(l._d=!0),c}function ensureValidVNode(n){return n.some(e=>isVNode(e)?!(e.type===Comment||e.type===Fragment&&!ensureValidVNode(e.children)):!0)?n:null}const getPublicInstance=n=>n?isStatefulComponent(n)?getExposeProxy(n)||n.proxy:getPublicInstance(n.parent):null,publicPropertiesMap=extend$1(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>getPublicInstance(n.parent),$root:n=>getPublicInstance(n.root),$emit:n=>n.emit,$options:n=>resolveMergedOptions(n),$forceUpdate:n=>n.f||(n.f=()=>queueJob(n.update)),$nextTick:n=>n.n||(n.n=nextTick.bind(n.proxy)),$watch:n=>instanceWatch.bind(n)}),hasSetupBinding=(n,e)=>n!==EMPTY_OBJ&&!n.__isScriptSetup&&hasOwn(n,e),PublicInstanceProxyHandlers={get({_:n},e){const{ctx:r,setupState:o,data:s,props:l,accessCache:a,type:c,appContext:u}=n;let f;if(e[0]!=="$"){const v=a[e];if(v!==void 0)switch(v){case 1:return o[e];case 2:return s[e];case 4:return r[e];case 3:return l[e]}else{if(hasSetupBinding(o,e))return a[e]=1,o[e];if(s!==EMPTY_OBJ&&hasOwn(s,e))return a[e]=2,s[e];if((f=n.propsOptions[0])&&hasOwn(f,e))return a[e]=3,l[e];if(r!==EMPTY_OBJ&&hasOwn(r,e))return a[e]=4,r[e];shouldCacheAccess&&(a[e]=0)}}const d=publicPropertiesMap[e];let g,m;if(d)return e==="$attrs"&&track(n,"get",e),d(n);if((g=c.__cssModules)&&(g=g[e]))return g;if(r!==EMPTY_OBJ&&hasOwn(r,e))return a[e]=4,r[e];if(m=u.config.globalProperties,hasOwn(m,e))return m[e]},set({_:n},e,r){const{data:o,setupState:s,ctx:l}=n;return hasSetupBinding(s,e)?(s[e]=r,!0):o!==EMPTY_OBJ&&hasOwn(o,e)?(o[e]=r,!0):hasOwn(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(l[e]=r,!0)},has({_:{data:n,setupState:e,accessCache:r,ctx:o,appContext:s,propsOptions:l}},a){let c;return!!r[a]||n!==EMPTY_OBJ&&hasOwn(n,a)||hasSetupBinding(e,a)||(c=l[0])&&hasOwn(c,a)||hasOwn(o,a)||hasOwn(publicPropertiesMap,a)||hasOwn(s.config.globalProperties,a)},defineProperty(n,e,r){return r.get!=null?n._.accessCache[e]=0:hasOwn(r,"value")&&this.set(n,e,r.value,null),Reflect.defineProperty(n,e,r)}};let shouldCacheAccess=!0;function applyOptions(n){const e=resolveMergedOptions(n),r=n.proxy,o=n.ctx;shouldCacheAccess=!1,e.beforeCreate&&callHook(e.beforeCreate,n,"bc");const{data:s,computed:l,methods:a,watch:c,provide:u,inject:f,created:d,beforeMount:g,mounted:m,beforeUpdate:v,updated:b,activated:k,deactivated:A,beforeDestroy:R,beforeUnmount:$,destroyed:J,unmounted:_,render:L,renderTracked:Y,renderTriggered:I,errorCaptured:Le,serverPrefetch:oe,expose:G,inheritAttrs:Z,components:Ee,directives:We,filters:K}=e;if(f&&resolveInjections(f,o,null,n.appContext.config.unwrapInjectedRef),a)for(const le in a){const Ae=a[le];isFunction(Ae)&&(o[le]=Ae.bind(r))}if(s){const le=s.call(r,r);isObject$1(le)&&(n.data=reactive(le))}if(shouldCacheAccess=!0,l)for(const le in l){const Ae=l[le],Ve=isFunction(Ae)?Ae.bind(r,r):isFunction(Ae.get)?Ae.get.bind(r,r):NOOP,fe=!isFunction(Ae)&&isFunction(Ae.set)?Ae.set.bind(r):NOOP,Ze=computed({get:Ve,set:fe});Object.defineProperty(o,le,{enumerable:!0,configurable:!0,get:()=>Ze.value,set:_e=>Ze.value=_e})}if(c)for(const le in c)createWatcher(c[le],o,r,le);if(u){const le=isFunction(u)?u.call(r):u;Reflect.ownKeys(le).forEach(Ae=>{provide(Ae,le[Ae])})}d&&callHook(d,n,"c");function ne(le,Ae){isArray$1(Ae)?Ae.forEach(Ve=>le(Ve.bind(r))):Ae&&le(Ae.bind(r))}if(ne(onBeforeMount,g),ne(onMounted,m),ne(onBeforeUpdate,v),ne(onUpdated,b),ne(onActivated,k),ne(onDeactivated,A),ne(onErrorCaptured,Le),ne(onRenderTracked,Y),ne(onRenderTriggered,I),ne(onBeforeUnmount,$),ne(onUnmounted,_),ne(onServerPrefetch,oe),isArray$1(G))if(G.length){const le=n.exposed||(n.exposed={});G.forEach(Ae=>{Object.defineProperty(le,Ae,{get:()=>r[Ae],set:Ve=>r[Ae]=Ve})})}else n.exposed||(n.exposed={});L&&n.render===NOOP&&(n.render=L),Z!=null&&(n.inheritAttrs=Z),Ee&&(n.components=Ee),We&&(n.directives=We)}function resolveInjections(n,e,r=NOOP,o=!1){isArray$1(n)&&(n=normalizeInject(n));for(const s in n){const l=n[s];let a;isObject$1(l)?"default"in l?a=inject(l.from||s,l.default,!0):a=inject(l.from||s):a=inject(l),isRef(a)&&o?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>a.value,set:c=>a.value=c}):e[s]=a}}function callHook(n,e,r){callWithAsyncErrorHandling(isArray$1(n)?n.map(o=>o.bind(e.proxy)):n.bind(e.proxy),e,r)}function createWatcher(n,e,r,o){const s=o.includes(".")?createPathGetter(r,o):()=>r[o];if(isString(n)){const l=e[n];isFunction(l)&&watch(s,l)}else if(isFunction(n))watch(s,n.bind(r));else if(isObject$1(n))if(isArray$1(n))n.forEach(l=>createWatcher(l,e,r,o));else{const l=isFunction(n.handler)?n.handler.bind(r):e[n.handler];isFunction(l)&&watch(s,l,n)}}function resolveMergedOptions(n){const e=n.type,{mixins:r,extends:o}=e,{mixins:s,optionsCache:l,config:{optionMergeStrategies:a}}=n.appContext,c=l.get(e);let u;return c?u=c:!s.length&&!r&&!o?u=e:(u={},s.length&&s.forEach(f=>mergeOptions$1(u,f,a,!0)),mergeOptions$1(u,e,a)),isObject$1(e)&&l.set(e,u),u}function mergeOptions$1(n,e,r,o=!1){const{mixins:s,extends:l}=e;l&&mergeOptions$1(n,l,r,!0),s&&s.forEach(a=>mergeOptions$1(n,a,r,!0));for(const a in e)if(!(o&&a==="expose")){const c=internalOptionMergeStrats[a]||r&&r[a];n[a]=c?c(n[a],e[a]):e[a]}return n}const internalOptionMergeStrats={data:mergeDataFn,props:mergeObjectOptions,emits:mergeObjectOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(n,e){return e?n?function(){return extend$1(isFunction(n)?n.call(this,this):n,isFunction(e)?e.call(this,this):e)}:e:n}function mergeInject(n,e){return mergeObjectOptions(normalizeInject(n),normalizeInject(e))}function normalizeInject(n){if(isArray$1(n)){const e={};for(let r=0;r<n.length;r++)e[n[r]]=n[r];return e}return n}function mergeAsArray(n,e){return n?[...new Set([].concat(n,e))]:e}function mergeObjectOptions(n,e){return n?extend$1(extend$1(Object.create(null),n),e):e}function mergeWatchOptions(n,e){if(!n)return e;if(!e)return n;const r=extend$1(Object.create(null),n);for(const o in e)r[o]=mergeAsArray(n[o],e[o]);return r}function initProps(n,e,r,o=!1){const s={},l={};def(l,InternalObjectKey,1),n.propsDefaults=Object.create(null),setFullProps(n,e,s,l);for(const a in n.propsOptions[0])a in s||(s[a]=void 0);r?n.props=o?s:shallowReactive(s):n.type.props?n.props=s:n.props=l,n.attrs=l}function updateProps(n,e,r,o){const{props:s,attrs:l,vnode:{patchFlag:a}}=n,c=toRaw(s),[u]=n.propsOptions;let f=!1;if((o||a>0)&&!(a&16)){if(a&8){const d=n.vnode.dynamicProps;for(let g=0;g<d.length;g++){let m=d[g];if(isEmitListener(n.emitsOptions,m))continue;const v=e[m];if(u)if(hasOwn(l,m))v!==l[m]&&(l[m]=v,f=!0);else{const b=camelize(m);s[b]=resolvePropValue(u,c,b,v,n,!1)}else v!==l[m]&&(l[m]=v,f=!0)}}}else{setFullProps(n,e,s,l)&&(f=!0);let d;for(const g in c)(!e||!hasOwn(e,g)&&((d=hyphenate(g))===g||!hasOwn(e,d)))&&(u?r&&(r[g]!==void 0||r[d]!==void 0)&&(s[g]=resolvePropValue(u,c,g,void 0,n,!0)):delete s[g]);if(l!==c)for(const g in l)(!e||!hasOwn(e,g))&&(delete l[g],f=!0)}f&&trigger(n,"set","$attrs")}function setFullProps(n,e,r,o){const[s,l]=n.propsOptions;let a=!1,c;if(e)for(let u in e){if(isReservedProp(u))continue;const f=e[u];let d;s&&hasOwn(s,d=camelize(u))?!l||!l.includes(d)?r[d]=f:(c||(c={}))[d]=f:isEmitListener(n.emitsOptions,u)||(!(u in o)||f!==o[u])&&(o[u]=f,a=!0)}if(l){const u=toRaw(r),f=c||EMPTY_OBJ;for(let d=0;d<l.length;d++){const g=l[d];r[g]=resolvePropValue(s,u,g,f[g],n,!hasOwn(f,g))}}return a}function resolvePropValue(n,e,r,o,s,l){const a=n[r];if(a!=null){const c=hasOwn(a,"default");if(c&&o===void 0){const u=a.default;if(a.type!==Function&&isFunction(u)){const{propsDefaults:f}=s;r in f?o=f[r]:(setCurrentInstance(s),o=f[r]=u.call(null,e),unsetCurrentInstance())}else o=u}a[0]&&(l&&!c?o=!1:a[1]&&(o===""||o===hyphenate(r))&&(o=!0))}return o}function normalizePropsOptions(n,e,r=!1){const o=e.propsCache,s=o.get(n);if(s)return s;const l=n.props,a={},c=[];let u=!1;if(!isFunction(n)){const d=g=>{u=!0;const[m,v]=normalizePropsOptions(g,e,!0);extend$1(a,m),v&&c.push(...v)};!r&&e.mixins.length&&e.mixins.forEach(d),n.extends&&d(n.extends),n.mixins&&n.mixins.forEach(d)}if(!l&&!u)return isObject$1(n)&&o.set(n,EMPTY_ARR),EMPTY_ARR;if(isArray$1(l))for(let d=0;d<l.length;d++){const g=camelize(l[d]);validatePropName(g)&&(a[g]=EMPTY_OBJ)}else if(l)for(const d in l){const g=camelize(d);if(validatePropName(g)){const m=l[d],v=a[g]=isArray$1(m)||isFunction(m)?{type:m}:Object.assign({},m);if(v){const b=getTypeIndex(Boolean,v.type),k=getTypeIndex(String,v.type);v[0]=b>-1,v[1]=k<0||b<k,(b>-1||hasOwn(v,"default"))&&c.push(g)}}}const f=[a,c];return isObject$1(n)&&o.set(n,f),f}function validatePropName(n){return n[0]!=="$"}function getType(n){const e=n&&n.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:n===null?"null":""}function isSameType(n,e){return getType(n)===getType(e)}function getTypeIndex(n,e){return isArray$1(e)?e.findIndex(r=>isSameType(r,n)):isFunction(e)&&isSameType(e,n)?0:-1}const isInternalKey=n=>n[0]==="_"||n==="$stable",normalizeSlotValue=n=>isArray$1(n)?n.map(normalizeVNode):[normalizeVNode(n)],normalizeSlot$1=(n,e,r)=>{if(e._n)return e;const o=withCtx((...s)=>normalizeSlotValue(e(...s)),r);return o._c=!1,o},normalizeObjectSlots=(n,e,r)=>{const o=n._ctx;for(const s in n){if(isInternalKey(s))continue;const l=n[s];if(isFunction(l))e[s]=normalizeSlot$1(s,l,o);else if(l!=null){const a=normalizeSlotValue(l);e[s]=()=>a}}},normalizeVNodeSlots=(n,e)=>{const r=normalizeSlotValue(e);n.slots.default=()=>r},initSlots=(n,e)=>{if(n.vnode.shapeFlag&32){const r=e._;r?(n.slots=toRaw(e),def(e,"_",r)):normalizeObjectSlots(e,n.slots={})}else n.slots={},e&&normalizeVNodeSlots(n,e);def(n.slots,InternalObjectKey,1)},updateSlots=(n,e,r)=>{const{vnode:o,slots:s}=n;let l=!0,a=EMPTY_OBJ;if(o.shapeFlag&32){const c=e._;c?r&&c===1?l=!1:(extend$1(s,e),!r&&c===1&&delete s._):(l=!e.$stable,normalizeObjectSlots(e,s)),a=e}else e&&(normalizeVNodeSlots(n,e),a={default:1});if(l)for(const c in s)!isInternalKey(c)&&!(c in a)&&delete s[c]};function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(n,e){return function(o,s=null){isFunction(o)||(o=Object.assign({},o)),s!=null&&!isObject$1(s)&&(s=null);const l=createAppContext(),a=new Set;let c=!1;const u=l.app={_uid:uid$1++,_component:o,_props:s,_container:null,_context:l,_instance:null,version,get config(){return l.config},set config(f){},use(f,...d){return a.has(f)||(f&&isFunction(f.install)?(a.add(f),f.install(u,...d)):isFunction(f)&&(a.add(f),f(u,...d))),u},mixin(f){return l.mixins.includes(f)||l.mixins.push(f),u},component(f,d){return d?(l.components[f]=d,u):l.components[f]},directive(f,d){return d?(l.directives[f]=d,u):l.directives[f]},mount(f,d,g){if(!c){const m=createVNode(o,s);return m.appContext=l,d&&e?e(m,f):n(m,f,g),c=!0,u._container=f,f.__vue_app__=u,getExposeProxy(m.component)||m.component.proxy}},unmount(){c&&(n(null,u._container),delete u._container.__vue_app__)},provide(f,d){return l.provides[f]=d,u}};return u}}function setRef(n,e,r,o,s=!1){if(isArray$1(n)){n.forEach((m,v)=>setRef(m,e&&(isArray$1(e)?e[v]:e),r,o,s));return}if(isAsyncWrapper(o)&&!s)return;const l=o.shapeFlag&4?getExposeProxy(o.component)||o.component.proxy:o.el,a=s?null:l,{i:c,r:u}=n,f=e&&e.r,d=c.refs===EMPTY_OBJ?c.refs={}:c.refs,g=c.setupState;if(f!=null&&f!==u&&(isString(f)?(d[f]=null,hasOwn(g,f)&&(g[f]=null)):isRef(f)&&(f.value=null)),isFunction(u))callWithErrorHandling(u,c,12,[a,d]);else{const m=isString(u),v=isRef(u);if(m||v){const b=()=>{if(n.f){const k=m?hasOwn(g,u)?g[u]:d[u]:u.value;s?isArray$1(k)&&remove$1(k,l):isArray$1(k)?k.includes(l)||k.push(l):m?(d[u]=[l],hasOwn(g,u)&&(g[u]=d[u])):(u.value=[l],n.k&&(d[n.k]=u.value))}else m?(d[u]=a,hasOwn(g,u)&&(g[u]=a)):v&&(u.value=a,n.k&&(d[n.k]=a))};a?(b.id=-1,queuePostRenderEffect(b,r)):b()}}}const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(n){return baseCreateRenderer(n)}function baseCreateRenderer(n,e){const r=getGlobalThis();r.__VUE__=!0;const{insert:o,remove:s,patchProp:l,createElement:a,createText:c,createComment:u,setText:f,setElementText:d,parentNode:g,nextSibling:m,setScopeId:v=NOOP,insertStaticContent:b}=n,k=(E,M,q,te=null,ue=null,Ge=null,lt=!1,qe=null,nt=!!M.dynamicChildren)=>{if(E===M)return;E&&!isSameVNodeType(E,M)&&(te=N(E),_e(E,ue,Ge,!0),E=null),M.patchFlag===-2&&(nt=!1,M.dynamicChildren=null);const{type:He,ref:tn,shapeFlag:Bt}=M;switch(He){case Text$1:A(E,M,q,te);break;case Comment:R(E,M,q,te);break;case Static:E==null&&$(M,q,te,lt);break;case Fragment:Ee(E,M,q,te,ue,Ge,lt,qe,nt);break;default:Bt&1?L(E,M,q,te,ue,Ge,lt,qe,nt):Bt&6?We(E,M,q,te,ue,Ge,lt,qe,nt):(Bt&64||Bt&128)&&He.process(E,M,q,te,ue,Ge,lt,qe,nt,ae)}tn!=null&&ue&&setRef(tn,E&&E.ref,Ge,M||E,!M)},A=(E,M,q,te)=>{if(E==null)o(M.el=c(M.children),q,te);else{const ue=M.el=E.el;M.children!==E.children&&f(ue,M.children)}},R=(E,M,q,te)=>{E==null?o(M.el=u(M.children||""),q,te):M.el=E.el},$=(E,M,q,te)=>{[E.el,E.anchor]=b(E.children,M,q,te,E.el,E.anchor)},J=({el:E,anchor:M},q,te)=>{let ue;for(;E&&E!==M;)ue=m(E),o(E,q,te),E=ue;o(M,q,te)},_=({el:E,anchor:M})=>{let q;for(;E&&E!==M;)q=m(E),s(E),E=q;s(M)},L=(E,M,q,te,ue,Ge,lt,qe,nt)=>{lt=lt||M.type==="svg",E==null?Y(M,q,te,ue,Ge,lt,qe,nt):oe(E,M,ue,Ge,lt,qe,nt)},Y=(E,M,q,te,ue,Ge,lt,qe)=>{let nt,He;const{type:tn,props:Bt,shapeFlag:An,transition:Bn,dirs:Dn}=E;if(nt=E.el=a(E.type,Ge,Bt&&Bt.is,Bt),An&8?d(nt,E.children):An&16&&Le(E.children,nt,null,te,ue,Ge&&tn!=="foreignObject",lt,qe),Dn&&invokeDirectiveHook(E,null,te,"created"),I(nt,E,E.scopeId,lt,te),Bt){for(const zn in Bt)zn!=="value"&&!isReservedProp(zn)&&l(nt,zn,null,Bt[zn],Ge,E.children,te,ue,ee);"value"in Bt&&l(nt,"value",null,Bt.value),(He=Bt.onVnodeBeforeMount)&&invokeVNodeHook(He,te,E)}Dn&&invokeDirectiveHook(E,null,te,"beforeMount");const ci=(!ue||ue&&!ue.pendingBranch)&&Bn&&!Bn.persisted;ci&&Bn.beforeEnter(nt),o(nt,M,q),((He=Bt&&Bt.onVnodeMounted)||ci||Dn)&&queuePostRenderEffect(()=>{He&&invokeVNodeHook(He,te,E),ci&&Bn.enter(nt),Dn&&invokeDirectiveHook(E,null,te,"mounted")},ue)},I=(E,M,q,te,ue)=>{if(q&&v(E,q),te)for(let Ge=0;Ge<te.length;Ge++)v(E,te[Ge]);if(ue){let Ge=ue.subTree;if(M===Ge){const lt=ue.vnode;I(E,lt,lt.scopeId,lt.slotScopeIds,ue.parent)}}},Le=(E,M,q,te,ue,Ge,lt,qe,nt=0)=>{for(let He=nt;He<E.length;He++){const tn=E[He]=qe?cloneIfMounted(E[He]):normalizeVNode(E[He]);k(null,tn,M,q,te,ue,Ge,lt,qe)}},oe=(E,M,q,te,ue,Ge,lt)=>{const qe=M.el=E.el;let{patchFlag:nt,dynamicChildren:He,dirs:tn}=M;nt|=E.patchFlag&16;const Bt=E.props||EMPTY_OBJ,An=M.props||EMPTY_OBJ;let Bn;q&&toggleRecurse(q,!1),(Bn=An.onVnodeBeforeUpdate)&&invokeVNodeHook(Bn,q,M,E),tn&&invokeDirectiveHook(M,E,q,"beforeUpdate"),q&&toggleRecurse(q,!0);const Dn=ue&&M.type!=="foreignObject";if(He?G(E.dynamicChildren,He,qe,q,te,Dn,Ge):lt||Ae(E,M,qe,null,q,te,Dn,Ge,!1),nt>0){if(nt&16)Z(qe,M,Bt,An,q,te,ue);else if(nt&2&&Bt.class!==An.class&&l(qe,"class",null,An.class,ue),nt&4&&l(qe,"style",Bt.style,An.style,ue),nt&8){const ci=M.dynamicProps;for(let zn=0;zn<ci.length;zn++){const hi=ci[zn],di=Bt[hi],xi=An[hi];(xi!==di||hi==="value")&&l(qe,hi,di,xi,ue,E.children,q,te,ee)}}nt&1&&E.children!==M.children&&d(qe,M.children)}else!lt&&He==null&&Z(qe,M,Bt,An,q,te,ue);((Bn=An.onVnodeUpdated)||tn)&&queuePostRenderEffect(()=>{Bn&&invokeVNodeHook(Bn,q,M,E),tn&&invokeDirectiveHook(M,E,q,"updated")},te)},G=(E,M,q,te,ue,Ge,lt)=>{for(let qe=0;qe<M.length;qe++){const nt=E[qe],He=M[qe],tn=nt.el&&(nt.type===Fragment||!isSameVNodeType(nt,He)||nt.shapeFlag&70)?g(nt.el):q;k(nt,He,tn,null,te,ue,Ge,lt,!0)}},Z=(E,M,q,te,ue,Ge,lt)=>{if(q!==te){if(q!==EMPTY_OBJ)for(const qe in q)!isReservedProp(qe)&&!(qe in te)&&l(E,qe,q[qe],null,lt,M.children,ue,Ge,ee);for(const qe in te){if(isReservedProp(qe))continue;const nt=te[qe],He=q[qe];nt!==He&&qe!=="value"&&l(E,qe,He,nt,lt,M.children,ue,Ge,ee)}"value"in te&&l(E,"value",q.value,te.value)}},Ee=(E,M,q,te,ue,Ge,lt,qe,nt)=>{const He=M.el=E?E.el:c(""),tn=M.anchor=E?E.anchor:c("");let{patchFlag:Bt,dynamicChildren:An,slotScopeIds:Bn}=M;Bn&&(qe=qe?qe.concat(Bn):Bn),E==null?(o(He,q,te),o(tn,q,te),Le(M.children,q,tn,ue,Ge,lt,qe,nt)):Bt>0&&Bt&64&&An&&E.dynamicChildren?(G(E.dynamicChildren,An,q,ue,Ge,lt,qe),(M.key!=null||ue&&M===ue.subTree)&&traverseStaticChildren(E,M,!0)):Ae(E,M,q,tn,ue,Ge,lt,qe,nt)},We=(E,M,q,te,ue,Ge,lt,qe,nt)=>{M.slotScopeIds=qe,E==null?M.shapeFlag&512?ue.ctx.activate(M,q,te,lt,nt):K(M,q,te,ue,Ge,lt,nt):ge(E,M,nt)},K=(E,M,q,te,ue,Ge,lt)=>{const qe=E.component=createComponentInstance(E,te,ue);if(isKeepAlive(E)&&(qe.ctx.renderer=ae),setupComponent(qe),qe.asyncDep){if(ue&&ue.registerDep(qe,ne),!E.el){const nt=qe.subTree=createVNode(Comment);R(null,nt,M,q)}return}ne(qe,E,M,q,ue,Ge,lt)},ge=(E,M,q)=>{const te=M.component=E.component;if(shouldUpdateComponent(E,M,q))if(te.asyncDep&&!te.asyncResolved){le(te,M,q);return}else te.next=M,invalidateJob(te.update),te.update();else M.el=E.el,te.vnode=M},ne=(E,M,q,te,ue,Ge,lt)=>{const qe=()=>{if(E.isMounted){let{next:tn,bu:Bt,u:An,parent:Bn,vnode:Dn}=E,ci=tn,zn;toggleRecurse(E,!1),tn?(tn.el=Dn.el,le(E,tn,lt)):tn=Dn,Bt&&invokeArrayFns(Bt),(zn=tn.props&&tn.props.onVnodeBeforeUpdate)&&invokeVNodeHook(zn,Bn,tn,Dn),toggleRecurse(E,!0);const hi=renderComponentRoot(E),di=E.subTree;E.subTree=hi,k(di,hi,g(di.el),N(di),E,ue,Ge),tn.el=hi.el,ci===null&&updateHOCHostEl(E,hi.el),An&&queuePostRenderEffect(An,ue),(zn=tn.props&&tn.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(zn,Bn,tn,Dn),ue)}else{let tn;const{el:Bt,props:An}=M,{bm:Bn,m:Dn,parent:ci}=E,zn=isAsyncWrapper(M);if(toggleRecurse(E,!1),Bn&&invokeArrayFns(Bn),!zn&&(tn=An&&An.onVnodeBeforeMount)&&invokeVNodeHook(tn,ci,M),toggleRecurse(E,!0),Bt&&ye){const hi=()=>{E.subTree=renderComponentRoot(E),ye(Bt,E.subTree,E,ue,null)};zn?M.type.__asyncLoader().then(()=>!E.isUnmounted&&hi()):hi()}else{const hi=E.subTree=renderComponentRoot(E);k(null,hi,q,te,E,ue,Ge),M.el=hi.el}if(Dn&&queuePostRenderEffect(Dn,ue),!zn&&(tn=An&&An.onVnodeMounted)){const hi=M;queuePostRenderEffect(()=>invokeVNodeHook(tn,ci,hi),ue)}(M.shapeFlag&256||ci&&isAsyncWrapper(ci.vnode)&&ci.vnode.shapeFlag&256)&&E.a&&queuePostRenderEffect(E.a,ue),E.isMounted=!0,M=q=te=null}},nt=E.effect=new ReactiveEffect(qe,()=>queueJob(He),E.scope),He=E.update=()=>nt.run();He.id=E.uid,toggleRecurse(E,!0),He()},le=(E,M,q)=>{M.component=E;const te=E.vnode.props;E.vnode=M,E.next=null,updateProps(E,M.props,te,q),updateSlots(E,M.children,q),pauseTracking(),flushPreFlushCbs(),resetTracking()},Ae=(E,M,q,te,ue,Ge,lt,qe,nt=!1)=>{const He=E&&E.children,tn=E?E.shapeFlag:0,Bt=M.children,{patchFlag:An,shapeFlag:Bn}=M;if(An>0){if(An&128){fe(He,Bt,q,te,ue,Ge,lt,qe,nt);return}else if(An&256){Ve(He,Bt,q,te,ue,Ge,lt,qe,nt);return}}Bn&8?(tn&16&&ee(He,ue,Ge),Bt!==He&&d(q,Bt)):tn&16?Bn&16?fe(He,Bt,q,te,ue,Ge,lt,qe,nt):ee(He,ue,Ge,!0):(tn&8&&d(q,""),Bn&16&&Le(Bt,q,te,ue,Ge,lt,qe,nt))},Ve=(E,M,q,te,ue,Ge,lt,qe,nt)=>{E=E||EMPTY_ARR,M=M||EMPTY_ARR;const He=E.length,tn=M.length,Bt=Math.min(He,tn);let An;for(An=0;An<Bt;An++){const Bn=M[An]=nt?cloneIfMounted(M[An]):normalizeVNode(M[An]);k(E[An],Bn,q,null,ue,Ge,lt,qe,nt)}He>tn?ee(E,ue,Ge,!0,!1,Bt):Le(M,q,te,ue,Ge,lt,qe,nt,Bt)},fe=(E,M,q,te,ue,Ge,lt,qe,nt)=>{let He=0;const tn=M.length;let Bt=E.length-1,An=tn-1;for(;He<=Bt&&He<=An;){const Bn=E[He],Dn=M[He]=nt?cloneIfMounted(M[He]):normalizeVNode(M[He]);if(isSameVNodeType(Bn,Dn))k(Bn,Dn,q,null,ue,Ge,lt,qe,nt);else break;He++}for(;He<=Bt&&He<=An;){const Bn=E[Bt],Dn=M[An]=nt?cloneIfMounted(M[An]):normalizeVNode(M[An]);if(isSameVNodeType(Bn,Dn))k(Bn,Dn,q,null,ue,Ge,lt,qe,nt);else break;Bt--,An--}if(He>Bt){if(He<=An){const Bn=An+1,Dn=Bn<tn?M[Bn].el:te;for(;He<=An;)k(null,M[He]=nt?cloneIfMounted(M[He]):normalizeVNode(M[He]),q,Dn,ue,Ge,lt,qe,nt),He++}}else if(He>An)for(;He<=Bt;)_e(E[He],ue,Ge,!0),He++;else{const Bn=He,Dn=He,ci=new Map;for(He=Dn;He<=An;He++){const fi=M[He]=nt?cloneIfMounted(M[He]):normalizeVNode(M[He]);fi.key!=null&&ci.set(fi.key,He)}let zn,hi=0;const di=An-Dn+1;let xi=!1,yr=0;const pr=new Array(di);for(He=0;He<di;He++)pr[He]=0;for(He=Bn;He<=Bt;He++){const fi=E[He];if(hi>=di){_e(fi,ue,Ge,!0);continue}let gi;if(fi.key!=null)gi=ci.get(fi.key);else for(zn=Dn;zn<=An;zn++)if(pr[zn-Dn]===0&&isSameVNodeType(fi,M[zn])){gi=zn;break}gi===void 0?_e(fi,ue,Ge,!0):(pr[gi-Dn]=He+1,gi>=yr?yr=gi:xi=!0,k(fi,M[gi],q,null,ue,Ge,lt,qe,nt),hi++)}const br=xi?getSequence(pr):EMPTY_ARR;for(zn=br.length-1,He=di-1;He>=0;He--){const fi=Dn+He,gi=M[fi],wr=fi+1<tn?M[fi+1].el:te;pr[He]===0?k(null,gi,q,wr,ue,Ge,lt,qe,nt):xi&&(zn<0||He!==br[zn]?Ze(gi,q,wr,2):zn--)}}},Ze=(E,M,q,te,ue=null)=>{const{el:Ge,type:lt,transition:qe,children:nt,shapeFlag:He}=E;if(He&6){Ze(E.component.subTree,M,q,te);return}if(He&128){E.suspense.move(M,q,te);return}if(He&64){lt.move(E,M,q,ae);return}if(lt===Fragment){o(Ge,M,q);for(let Bt=0;Bt<nt.length;Bt++)Ze(nt[Bt],M,q,te);o(E.anchor,M,q);return}if(lt===Static){J(E,M,q);return}if(te!==2&&He&1&&qe)if(te===0)qe.beforeEnter(Ge),o(Ge,M,q),queuePostRenderEffect(()=>qe.enter(Ge),ue);else{const{leave:Bt,delayLeave:An,afterLeave:Bn}=qe,Dn=()=>o(Ge,M,q),ci=()=>{Bt(Ge,()=>{Dn(),Bn&&Bn()})};An?An(Ge,Dn,ci):ci()}else o(Ge,M,q)},_e=(E,M,q,te=!1,ue=!1)=>{const{type:Ge,props:lt,ref:qe,children:nt,dynamicChildren:He,shapeFlag:tn,patchFlag:Bt,dirs:An}=E;if(qe!=null&&setRef(qe,null,q,E,!0),tn&256){M.ctx.deactivate(E);return}const Bn=tn&1&&An,Dn=!isAsyncWrapper(E);let ci;if(Dn&&(ci=lt&&lt.onVnodeBeforeUnmount)&&invokeVNodeHook(ci,M,E),tn&6)re(E.component,q,te);else{if(tn&128){E.suspense.unmount(q,te);return}Bn&&invokeDirectiveHook(E,null,M,"beforeUnmount"),tn&64?E.type.remove(E,M,q,ue,ae,te):He&&(Ge!==Fragment||Bt>0&&Bt&64)?ee(He,M,q,!1,!0):(Ge===Fragment&&Bt&384||!ue&&tn&16)&&ee(nt,M,q),te&&ut(E)}(Dn&&(ci=lt&&lt.onVnodeUnmounted)||Bn)&&queuePostRenderEffect(()=>{ci&&invokeVNodeHook(ci,M,E),Bn&&invokeDirectiveHook(E,null,M,"unmounted")},q)},ut=E=>{const{type:M,el:q,anchor:te,transition:ue}=E;if(M===Fragment){st(q,te);return}if(M===Static){_(E);return}const Ge=()=>{s(q),ue&&!ue.persisted&&ue.afterLeave&&ue.afterLeave()};if(E.shapeFlag&1&&ue&&!ue.persisted){const{leave:lt,delayLeave:qe}=ue,nt=()=>lt(q,Ge);qe?qe(E.el,Ge,nt):nt()}else Ge()},st=(E,M)=>{let q;for(;E!==M;)q=m(E),s(E),E=q;s(M)},re=(E,M,q)=>{const{bum:te,scope:ue,update:Ge,subTree:lt,um:qe}=E;te&&invokeArrayFns(te),ue.stop(),Ge&&(Ge.active=!1,_e(lt,E,M,q)),qe&&queuePostRenderEffect(qe,M),queuePostRenderEffect(()=>{E.isUnmounted=!0},M),M&&M.pendingBranch&&!M.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===M.pendingId&&(M.deps--,M.deps===0&&M.resolve())},ee=(E,M,q,te=!1,ue=!1,Ge=0)=>{for(let lt=Ge;lt<E.length;lt++)_e(E[lt],M,q,te,ue)},N=E=>E.shapeFlag&6?N(E.component.subTree):E.shapeFlag&128?E.suspense.next():m(E.anchor||E.el),H=(E,M,q)=>{E==null?M._vnode&&_e(M._vnode,null,null,!0):k(M._vnode||null,E,M,null,null,null,q),flushPreFlushCbs(),flushPostFlushCbs(),M._vnode=E},ae={p:k,um:_e,m:Ze,r:ut,mt:K,mc:Le,pc:Ae,pbc:G,n:N,o:n};let Ce,ye;return e&&([Ce,ye]=e(ae)),{render:H,hydrate:Ce,createApp:createAppAPI(H,Ce)}}function toggleRecurse({effect:n,update:e},r){n.allowRecurse=e.allowRecurse=r}function traverseStaticChildren(n,e,r=!1){const o=n.children,s=e.children;if(isArray$1(o)&&isArray$1(s))for(let l=0;l<o.length;l++){const a=o[l];let c=s[l];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=s[l]=cloneIfMounted(s[l]),c.el=a.el),r||traverseStaticChildren(a,c)),c.type===Text$1&&(c.el=a.el)}}function getSequence(n){const e=n.slice(),r=[0];let o,s,l,a,c;const u=n.length;for(o=0;o<u;o++){const f=n[o];if(f!==0){if(s=r[r.length-1],n[s]<f){e[o]=s,r.push(o);continue}for(l=0,a=r.length-1;l<a;)c=l+a>>1,n[r[c]]<f?l=c+1:a=c;f<n[r[l]]&&(l>0&&(e[o]=r[l-1]),r[l]=o)}}for(l=r.length,a=r[l-1];l-- >0;)r[l]=a,a=e[a];return r}const isTeleport=n=>n.__isTeleport,Fragment=Symbol(void 0),Text$1=Symbol(void 0),Comment=Symbol(void 0),Static=Symbol(void 0),blockStack=[];let currentBlock=null;function openBlock(n=!1){blockStack.push(currentBlock=n?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(n){isBlockTreeEnabled+=n}function setupBlock(n){return n.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(n),n}function createElementBlock(n,e,r,o,s,l){return setupBlock(createBaseVNode(n,e,r,o,s,l,!0))}function createBlock(n,e,r,o,s){return setupBlock(createVNode(n,e,r,o,s,!0))}function isVNode(n){return n?n.__v_isVNode===!0:!1}function isSameVNodeType(n,e){return n.type===e.type&&n.key===e.key}const InternalObjectKey="__vInternal",normalizeKey=({key:n})=>n??null,normalizeRef=({ref:n,ref_key:e,ref_for:r})=>n!=null?isString(n)||isRef(n)||isFunction(n)?{i:currentRenderingInstance,r:n,k:e,f:!!r}:n:null;function createBaseVNode(n,e=null,r=null,o=0,s=null,l=n===Fragment?0:1,a=!1,c=!1){const u={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&normalizeKey(e),ref:e&&normalizeRef(e),scopeId:currentScopeId,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:l,patchFlag:o,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return c?(normalizeChildren(u,r),l&128&&n.normalize(u)):r&&(u.shapeFlag|=isString(r)?8:16),isBlockTreeEnabled>0&&!a&&currentBlock&&(u.patchFlag>0||l&6)&&u.patchFlag!==32&&currentBlock.push(u),u}const createVNode=_createVNode;function _createVNode(n,e=null,r=null,o=0,s=null,l=!1){if((!n||n===NULL_DYNAMIC_COMPONENT)&&(n=Comment),isVNode(n)){const c=cloneVNode(n,e,!0);return r&&normalizeChildren(c,r),isBlockTreeEnabled>0&&!l&&currentBlock&&(c.shapeFlag&6?currentBlock[currentBlock.indexOf(n)]=c:currentBlock.push(c)),c.patchFlag|=-2,c}if(isClassComponent(n)&&(n=n.__vccOpts),e){e=guardReactiveProps(e);let{class:c,style:u}=e;c&&!isString(c)&&(e.class=normalizeClass(c)),isObject$1(u)&&(isProxy(u)&&!isArray$1(u)&&(u=extend$1({},u)),e.style=normalizeStyle(u))}const a=isString(n)?1:isSuspense(n)?128:isTeleport(n)?64:isObject$1(n)?4:isFunction(n)?2:0;return createBaseVNode(n,e,r,o,s,a,l,!0)}function guardReactiveProps(n){return n?isProxy(n)||InternalObjectKey in n?extend$1({},n):n:null}function cloneVNode(n,e,r=!1){const{props:o,ref:s,patchFlag:l,children:a}=n,c=e?mergeProps(o||{},e):o;return{__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&normalizeKey(c),ref:e&&e.ref?r&&s?isArray$1(s)?s.concat(normalizeRef(e)):[s,normalizeRef(e)]:normalizeRef(e):s,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Fragment?l===-1?16:l|16:l,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:n.transition,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&cloneVNode(n.ssContent),ssFallback:n.ssFallback&&cloneVNode(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce}}function createTextVNode(n=" ",e=0){return createVNode(Text$1,null,n,e)}function createCommentVNode(n="",e=!1){return e?(openBlock(),createBlock(Comment,null,n)):createVNode(Comment,null,n)}function normalizeVNode(n){return n==null||typeof n=="boolean"?createVNode(Comment):isArray$1(n)?createVNode(Fragment,null,n.slice()):typeof n=="object"?cloneIfMounted(n):createVNode(Text$1,null,String(n))}function cloneIfMounted(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:cloneVNode(n)}function normalizeChildren(n,e){let r=0;const{shapeFlag:o}=n;if(e==null)e=null;else if(isArray$1(e))r=16;else if(typeof e=="object")if(o&65){const s=e.default;s&&(s._c&&(s._d=!1),normalizeChildren(n,s()),s._c&&(s._d=!0));return}else{r=32;const s=e._;!s&&!(InternalObjectKey in e)?e._ctx=currentRenderingInstance:s===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else isFunction(e)?(e={default:e,_ctx:currentRenderingInstance},r=32):(e=String(e),o&64?(r=16,e=[createTextVNode(e)]):r=8);n.children=e,n.shapeFlag|=r}function mergeProps(...n){const e={};for(let r=0;r<n.length;r++){const o=n[r];for(const s in o)if(s==="class")e.class!==o.class&&(e.class=normalizeClass([e.class,o.class]));else if(s==="style")e.style=normalizeStyle([e.style,o.style]);else if(isOn(s)){const l=e[s],a=o[s];a&&l!==a&&!(isArray$1(l)&&l.includes(a))&&(e[s]=l?[].concat(l,a):a)}else s!==""&&(e[s]=o[s])}return e}function invokeVNodeHook(n,e,r,o=null){callWithAsyncErrorHandling(n,e,7,[r,o])}const emptyAppContext=createAppContext();let uid=0;function createComponentInstance(n,e,r){const o=n.type,s=(e?e.appContext:n.appContext)||emptyAppContext,l={uid:uid++,vnode:n,type:o,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(o,s),emitsOptions:normalizeEmitsOptions(o,s),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:o.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return l.ctx={_:l},l.root=e?e.root:l,l.emit=emit.bind(null,l),n.ce&&n.ce(l),l}let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance,setCurrentInstance=n=>{currentInstance=n,n.scope.on()},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),currentInstance=null};function isStatefulComponent(n){return n.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(n,e=!1){isInSSRComponentSetup=e;const{props:r,children:o}=n.vnode,s=isStatefulComponent(n);initProps(n,r,s,e),initSlots(n,o);const l=s?setupStatefulComponent(n,e):void 0;return isInSSRComponentSetup=!1,l}function setupStatefulComponent(n,e){const r=n.type;n.accessCache=Object.create(null),n.proxy=markRaw(new Proxy(n.ctx,PublicInstanceProxyHandlers));const{setup:o}=r;if(o){const s=n.setupContext=o.length>1?createSetupContext(n):null;setCurrentInstance(n),pauseTracking();const l=callWithErrorHandling(o,n,0,[n.props,s]);if(resetTracking(),unsetCurrentInstance(),isPromise(l)){if(l.then(unsetCurrentInstance,unsetCurrentInstance),e)return l.then(a=>{handleSetupResult(n,a,e)}).catch(a=>{handleError(a,n,0)});n.asyncDep=l}else handleSetupResult(n,l,e)}else finishComponentSetup(n,e)}function handleSetupResult(n,e,r){isFunction(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:isObject$1(e)&&(n.setupState=proxyRefs(e)),finishComponentSetup(n,r)}let compile;function finishComponentSetup(n,e,r){const o=n.type;if(!n.render){if(!e&&compile&&!o.render){const s=o.template||resolveMergedOptions(n).template;if(s){const{isCustomElement:l,compilerOptions:a}=n.appContext.config,{delimiters:c,compilerOptions:u}=o,f=extend$1(extend$1({isCustomElement:l,delimiters:c},a),u);o.render=compile(s,f)}}n.render=o.render||NOOP}setCurrentInstance(n),pauseTracking(),applyOptions(n),resetTracking(),unsetCurrentInstance()}function createAttrsProxy(n){return new Proxy(n.attrs,{get(e,r){return track(n,"get","$attrs"),e[r]}})}function createSetupContext(n){const e=o=>{n.exposed=o||{}};let r;return{get attrs(){return r||(r=createAttrsProxy(n))},slots:n.slots,emit:n.emit,expose:e}}function getExposeProxy(n){if(n.exposed)return n.exposeProxy||(n.exposeProxy=new Proxy(proxyRefs(markRaw(n.exposed)),{get(e,r){if(r in e)return e[r];if(r in publicPropertiesMap)return publicPropertiesMap[r](n)},has(e,r){return r in e||r in publicPropertiesMap}}))}function getComponentName(n,e=!0){return isFunction(n)?n.displayName||n.name:n.name||e&&n.__name}function isClassComponent(n){return isFunction(n)&&"__vccOpts"in n}const computed=(n,e)=>computed$1(n,e,isInSSRComponentSetup);function useSlots(){return getContext().slots}function getContext(){const n=getCurrentInstance();return n.setupContext||(n.setupContext=createSetupContext(n))}function h$1(n,e,r){const o=arguments.length;return o===2?isObject$1(e)&&!isArray$1(e)?isVNode(e)?createVNode(n,null,[e]):createVNode(n,e):createVNode(n,null,e):(o>3?r=Array.prototype.slice.call(arguments,2):o===3&&isVNode(r)&&(r=[r]),createVNode(n,e,r))}const ssrContextKey=Symbol(""),useSSRContext=()=>inject(ssrContextKey),version="3.2.47",svgNS="http://www.w3.org/2000/svg",doc$1=typeof document<"u"?document:null,templateContainer=doc$1&&doc$1.createElement("template"),nodeOps={insert:(n,e,r)=>{e.insertBefore(n,r||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,r,o)=>{const s=e?doc$1.createElementNS(svgNS,n):doc$1.createElement(n,r?{is:r}:void 0);return n==="select"&&o&&o.multiple!=null&&s.setAttribute("multiple",o.multiple),s},createText:n=>doc$1.createTextNode(n),createComment:n=>doc$1.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>doc$1.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,r,o,s,l){const a=r?r.previousSibling:e.lastChild;if(s&&(s===l||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),r),!(s===l||!(s=s.nextSibling)););else{templateContainer.innerHTML=o?`<svg>${n}</svg>`:n;const c=templateContainer.content;if(o){const u=c.firstChild;for(;u.firstChild;)c.appendChild(u.firstChild);c.removeChild(u)}e.insertBefore(c,r)}return[a?a.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}};function patchClass(n,e,r){const o=n._vtc;o&&(e=(e?[e,...o]:[...o]).join(" ")),e==null?n.removeAttribute("class"):r?n.setAttribute("class",e):n.className=e}function patchStyle(n,e,r){const o=n.style,s=isString(r);if(r&&!s){if(e&&!isString(e))for(const l in e)r[l]==null&&setStyle(o,l,"");for(const l in r)setStyle(o,l,r[l])}else{const l=o.display;s?e!==r&&(o.cssText=r):e&&n.removeAttribute("style"),"_vod"in n&&(o.display=l)}}const importantRE=/\s*!important$/;function setStyle(n,e,r){if(isArray$1(r))r.forEach(o=>setStyle(n,e,o));else if(r==null&&(r=""),e.startsWith("--"))n.setProperty(e,r);else{const o=autoPrefix(n,e);importantRE.test(r)?n.setProperty(hyphenate(o),r.replace(importantRE,""),"important"):n[o]=r}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(n,e){const r=prefixCache[e];if(r)return r;let o=camelize(e);if(o!=="filter"&&o in n)return prefixCache[e]=o;o=capitalize(o);for(let s=0;s<prefixes.length;s++){const l=prefixes[s]+o;if(l in n)return prefixCache[e]=l}return e}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(n,e,r,o,s){if(o&&e.startsWith("xlink:"))r==null?n.removeAttributeNS(xlinkNS,e.slice(6,e.length)):n.setAttributeNS(xlinkNS,e,r);else{const l=isSpecialBooleanAttr(e);r==null||l&&!includeBooleanAttr(r)?n.removeAttribute(e):n.setAttribute(e,l?"":r)}}function patchDOMProp(n,e,r,o,s,l,a){if(e==="innerHTML"||e==="textContent"){o&&a(o,s,l),n[e]=r??"";return}if(e==="value"&&n.tagName!=="PROGRESS"&&!n.tagName.includes("-")){n._value=r;const u=r??"";(n.value!==u||n.tagName==="OPTION")&&(n.value=u),r==null&&n.removeAttribute(e);return}let c=!1;if(r===""||r==null){const u=typeof n[e];u==="boolean"?r=includeBooleanAttr(r):r==null&&u==="string"?(r="",c=!0):u==="number"&&(r=0,c=!0)}try{n[e]=r}catch{}c&&n.removeAttribute(e)}function addEventListener(n,e,r,o){n.addEventListener(e,r,o)}function removeEventListener(n,e,r,o){n.removeEventListener(e,r,o)}function patchEvent(n,e,r,o,s=null){const l=n._vei||(n._vei={}),a=l[e];if(o&&a)a.value=o;else{const[c,u]=parseName(e);if(o){const f=l[e]=createInvoker(o,s);addEventListener(n,c,f,u)}else a&&(removeEventListener(n,c,a,u),l[e]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(n){let e;if(optionsModifierRE.test(n)){e={};let o;for(;o=n.match(optionsModifierRE);)n=n.slice(0,n.length-o[0].length),e[o[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):hyphenate(n.slice(2)),e]}let cachedNow=0;const p=Promise.resolve(),getNow=()=>cachedNow||(p.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(n,e){const r=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=r.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(o,r.value),e,5,[o])};return r.value=n,r.attached=getNow(),r}function patchStopImmediatePropagation(n,e){if(isArray$1(e)){const r=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{r.call(n),n._stopped=!0},e.map(o=>s=>!s._stopped&&o&&o(s))}else return e}const nativeOnRE=/^on[a-z]/,patchProp=(n,e,r,o,s=!1,l,a,c,u)=>{e==="class"?patchClass(n,o,s):e==="style"?patchStyle(n,r,o):isOn(e)?isModelListener(e)||patchEvent(n,e,r,o,a):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):shouldSetAsProp(n,e,o,s))?patchDOMProp(n,e,o,l,a,c,u):(e==="true-value"?n._trueValue=o:e==="false-value"&&(n._falseValue=o),patchAttr(n,e,o,s))};function shouldSetAsProp(n,e,r,o){return o?!!(e==="innerHTML"||e==="textContent"||e in n&&nativeOnRE.test(e)&&isFunction(r)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA"||nativeOnRE.test(e)&&isString(r)?!1:e in n}const getModelAssigner=n=>{const e=n.props["onUpdate:modelValue"]||!1;return isArray$1(e)?r=>invokeArrayFns(e,r):e};function onCompositionStart(n){n.target.composing=!0}function onCompositionEnd(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const vModelText={created(n,{modifiers:{lazy:e,trim:r,number:o}},s){n._assign=getModelAssigner(s);const l=o||s.props&&s.props.type==="number";addEventListener(n,e?"change":"input",a=>{if(a.target.composing)return;let c=n.value;r&&(c=c.trim()),l&&(c=looseToNumber(c)),n._assign(c)}),r&&addEventListener(n,"change",()=>{n.value=n.value.trim()}),e||(addEventListener(n,"compositionstart",onCompositionStart),addEventListener(n,"compositionend",onCompositionEnd),addEventListener(n,"change",onCompositionEnd))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,modifiers:{lazy:r,trim:o,number:s}},l){if(n._assign=getModelAssigner(l),n.composing||document.activeElement===n&&n.type!=="range"&&(r||o&&n.value.trim()===e||(s||n.type==="number")&&looseToNumber(n.value)===e))return;const a=e??"";n.value!==a&&(n.value=a)}},vModelCheckbox={deep:!0,created(n,e,r){n._assign=getModelAssigner(r),addEventListener(n,"change",()=>{const o=n._modelValue,s=getValue(n),l=n.checked,a=n._assign;if(isArray$1(o)){const c=looseIndexOf(o,s),u=c!==-1;if(l&&!u)a(o.concat(s));else if(!l&&u){const f=[...o];f.splice(c,1),a(f)}}else if(isSet(o)){const c=new Set(o);l?c.add(s):c.delete(s),a(c)}else a(getCheckboxValue(n,l))})},mounted:setChecked,beforeUpdate(n,e,r){n._assign=getModelAssigner(r),setChecked(n,e,r)}};function setChecked(n,{value:e,oldValue:r},o){n._modelValue=e,isArray$1(e)?n.checked=looseIndexOf(e,o.props.value)>-1:isSet(e)?n.checked=e.has(o.props.value):e!==r&&(n.checked=looseEqual(e,getCheckboxValue(n,!0)))}const vModelSelect={deep:!0,created(n,{value:e,modifiers:{number:r}},o){const s=isSet(e);addEventListener(n,"change",()=>{const l=Array.prototype.filter.call(n.options,a=>a.selected).map(a=>r?looseToNumber(getValue(a)):getValue(a));n._assign(n.multiple?s?new Set(l):l:l[0])}),n._assign=getModelAssigner(o)},mounted(n,{value:e}){setSelected(n,e)},beforeUpdate(n,e,r){n._assign=getModelAssigner(r)},updated(n,{value:e}){setSelected(n,e)}};function setSelected(n,e){const r=n.multiple;if(!(r&&!isArray$1(e)&&!isSet(e))){for(let o=0,s=n.options.length;o<s;o++){const l=n.options[o],a=getValue(l);if(r)isArray$1(e)?l.selected=looseIndexOf(e,a)>-1:l.selected=e.has(a);else if(looseEqual(getValue(l),e)){n.selectedIndex!==o&&(n.selectedIndex=o);return}}!r&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function getValue(n){return"_value"in n?n._value:n.value}function getCheckboxValue(n,e){const r=e?"_trueValue":"_falseValue";return r in n?n[r]:e}const rendererOptions=extend$1({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const createApp=(...n)=>{const e=ensureRenderer().createApp(...n),{mount:r}=e;return e.mount=o=>{const s=normalizeContainer(o);if(!s)return;const l=e._component;!isFunction(l)&&!l.render&&!l.template&&(l.template=s.innerHTML),s.innerHTML="";const a=r(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},e};function normalizeContainer(n){return isString(n)?document.querySelector(n):n}var isVue2=!1;/*!
  * pinia v2.0.34
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const piniaSymbol=Symbol();var MutationType;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(MutationType||(MutationType={}));function createPinia(){const n=effectScope(!0),e=n.run(()=>ref({}));let r=[],o=[];const s=markRaw({install(l){s._a=l,l.provide(piniaSymbol,s),l.config.globalProperties.$pinia=s,o.forEach(a=>r.push(a)),o=[]},use(l){return!this._a&&!isVue2?o.push(l):r.push(l),this},_p:r,_a:null,_e:n,_s:new Map,state:e});return s}function isObject(n){return typeof n=="object"&&n!==null}function normalizeOptions(n,e){return n=isObject(n)?n:Object.create(null),new Proxy(n,{get(r,o,s){return o==="key"?Reflect.get(r,o,s):Reflect.get(r,o,s)||Reflect.get(e,o,s)}})}function get(n,e){return e.reduce((r,o)=>r==null?void 0:r[o],n)}function set(n,e,r){return e.slice(0,-1).reduce((o,s)=>/^(__proto__)$/.test(s)?{}:o[s]=o[s]||{},n)[e[e.length-1]]=r,n}function pick(n,e){return e.reduce((r,o)=>{const s=o.split(".");return set(r,s,get(n,s))},{})}function hydrateStore(n,{storage:e,serializer:r,key:o,debug:s}){try{const l=e==null?void 0:e.getItem(o);l&&n.$patch(r==null?void 0:r.deserialize(l))}catch(l){s&&console.error(l)}}function persistState(n,{storage:e,serializer:r,key:o,paths:s,debug:l}){try{const a=Array.isArray(s)?pick(n,s):n;e.setItem(o,r.serialize(a))}catch(a){l&&console.error(a)}}function createPersistedState(n={}){return e=>{const{auto:r=!1}=n,{options:{persist:o=r},store:s}=e;if(!o)return;const l=(Array.isArray(o)?o.map(a=>normalizeOptions(a,n)):[normalizeOptions(o,n)]).map(({storage:a=localStorage,beforeRestore:c=null,afterRestore:u=null,serializer:f={serialize:JSON.stringify,deserialize:JSON.parse},key:d=s.$id,paths:g=null,debug:m=!1})=>{var v;return{storage:a,beforeRestore:c,afterRestore:u,serializer:f,key:((v=n.key)!=null?v:b=>b)(d),paths:g,debug:m}});s.$persist=()=>{l.forEach(a=>{persistState(s.$state,a)})},s.$hydrate=({runHooks:a=!0}={})=>{l.forEach(c=>{const{beforeRestore:u,afterRestore:f}=c;a&&(u==null||u(e)),hydrateStore(s,c),a&&(f==null||f(e))})},l.forEach(a=>{const{beforeRestore:c,afterRestore:u}=a;c==null||c(e),hydrateStore(s,a),u==null||u(e),s.$subscribe((f,d)=>{persistState(d,a)},{detached:!0})})}}var src_default=createPersistedState();class Text{constructor(){}lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,r,o){let s=[];return this.decompose(0,e,s,2),o.length&&o.decompose(0,o.length,s,3),this.decompose(r,this.length,s,1),TextNode.from(s,this.length-(r-e)+o.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,r=this.length){let o=[];return this.decompose(e,r,o,0),TextNode.from(o,r-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let r=this.scanIdentical(e,1),o=this.length-this.scanIdentical(e,-1),s=new RawTextCursor(this),l=new RawTextCursor(e);for(let a=r,c=r;;){if(s.next(a),l.next(a),a=0,s.lineBreak!=l.lineBreak||s.done!=l.done||s.value!=l.value)return!1;if(c+=s.value.length,s.done||c>=o)return!0}}iter(e=1){return new RawTextCursor(this,e)}iterRange(e,r=this.length){return new PartialTextCursor(this,e,r)}iterLines(e,r){let o;if(e==null)o=this.iter();else{r==null&&(r=this.lines+1);let s=this.line(e).from;o=this.iterRange(s,Math.max(s,r==this.lines+1?this.length:r<=1?0:this.line(r-1).to))}return new LineCursor(o)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Text.empty:e.length<=32?new TextLeaf(e):TextNode.from(TextLeaf.split(e,[]))}}class TextLeaf extends Text{constructor(e,r=textLength(e)){super(),this.text=e,this.length=r}get lines(){return this.text.length}get children(){return null}lineInner(e,r,o,s){for(let l=0;;l++){let a=this.text[l],c=s+a.length;if((r?o:c)>=e)return new Line(s,c,o,a);s=c+1,o++}}decompose(e,r,o,s){let l=e<=0&&r>=this.length?this:new TextLeaf(sliceText(this.text,e,r),Math.min(r,this.length)-Math.max(0,e));if(s&1){let a=o.pop(),c=appendText(l.text,a.text.slice(),0,l.length);if(c.length<=32)o.push(new TextLeaf(c,a.length+l.length));else{let u=c.length>>1;o.push(new TextLeaf(c.slice(0,u)),new TextLeaf(c.slice(u)))}}else o.push(l)}replace(e,r,o){if(!(o instanceof TextLeaf))return super.replace(e,r,o);let s=appendText(this.text,appendText(o.text,sliceText(this.text,0,e)),r),l=this.length+o.length-(r-e);return s.length<=32?new TextLeaf(s,l):TextNode.from(TextLeaf.split(s,[]),l)}sliceString(e,r=this.length,o=`
`){let s="";for(let l=0,a=0;l<=r&&a<this.text.length;a++){let c=this.text[a],u=l+c.length;l>e&&a&&(s+=o),e<u&&r>l&&(s+=c.slice(Math.max(0,e-l),r-l)),l=u+1}return s}flatten(e){for(let r of this.text)e.push(r)}scanIdentical(){return 0}static split(e,r){let o=[],s=-1;for(let l of e)o.push(l),s+=l.length+1,o.length==32&&(r.push(new TextLeaf(o,s)),o=[],s=-1);return s>-1&&r.push(new TextLeaf(o,s)),r}}class TextNode extends Text{constructor(e,r){super(),this.children=e,this.length=r,this.lines=0;for(let o of e)this.lines+=o.lines}lineInner(e,r,o,s){for(let l=0;;l++){let a=this.children[l],c=s+a.length,u=o+a.lines-1;if((r?u:c)>=e)return a.lineInner(e,r,o,s);s=c+1,o=u+1}}decompose(e,r,o,s){for(let l=0,a=0;a<=r&&l<this.children.length;l++){let c=this.children[l],u=a+c.length;if(e<=u&&r>=a){let f=s&((a<=e?1:0)|(u>=r?2:0));a>=e&&u<=r&&!f?o.push(c):c.decompose(e-a,r-a,o,f)}a=u+1}}replace(e,r,o){if(o.lines<this.lines)for(let s=0,l=0;s<this.children.length;s++){let a=this.children[s],c=l+a.length;if(e>=l&&r<=c){let u=a.replace(e-l,r-l,o),f=this.lines-a.lines+u.lines;if(u.lines<f>>5-1&&u.lines>f>>5+1){let d=this.children.slice();return d[s]=u,new TextNode(d,this.length-(r-e)+o.length)}return super.replace(l,c,u)}l=c+1}return super.replace(e,r,o)}sliceString(e,r=this.length,o=`
`){let s="";for(let l=0,a=0;l<this.children.length&&a<=r;l++){let c=this.children[l],u=a+c.length;a>e&&l&&(s+=o),e<u&&r>a&&(s+=c.sliceString(e-a,r-a,o)),a=u+1}return s}flatten(e){for(let r of this.children)r.flatten(e)}scanIdentical(e,r){if(!(e instanceof TextNode))return 0;let o=0,[s,l,a,c]=r>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;s+=r,l+=r){if(s==a||l==c)return o;let u=this.children[s],f=e.children[l];if(u!=f)return o+u.scanIdentical(f,r);o+=u.length+1}}static from(e,r=e.reduce((o,s)=>o+s.length+1,-1)){let o=0;for(let v of e)o+=v.lines;if(o<32){let v=[];for(let b of e)b.flatten(v);return new TextLeaf(v,r)}let s=Math.max(32,o>>5),l=s<<1,a=s>>1,c=[],u=0,f=-1,d=[];function g(v){let b;if(v.lines>l&&v instanceof TextNode)for(let k of v.children)g(k);else v.lines>a&&(u>a||!u)?(m(),c.push(v)):v instanceof TextLeaf&&u&&(b=d[d.length-1])instanceof TextLeaf&&v.lines+b.lines<=32?(u+=v.lines,f+=v.length+1,d[d.length-1]=new TextLeaf(b.text.concat(v.text),b.length+1+v.length)):(u+v.lines>s&&m(),u+=v.lines,f+=v.length+1,d.push(v))}function m(){u!=0&&(c.push(d.length==1?d[0]:TextNode.from(d,f)),f=-1,u=d.length=0)}for(let v of e)g(v);return m(),c.length==1?c[0]:new TextNode(c,r)}}Text.empty=new TextLeaf([""],0);function textLength(n){let e=-1;for(let r of n)e+=r.length+1;return e}function appendText(n,e,r=0,o=1e9){for(let s=0,l=0,a=!0;l<n.length&&s<=o;l++){let c=n[l],u=s+c.length;u>=r&&(u>o&&(c=c.slice(0,o-s)),s<r&&(c=c.slice(r-s)),a?(e[e.length-1]+=c,a=!1):e.push(c)),s=u+1}return e}function sliceText(n,e,r){return appendText(n,[""],e,r)}class RawTextCursor{constructor(e,r=1){this.dir=r,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[r>0?1:(e instanceof TextLeaf?e.text.length:e.children.length)<<1]}nextInner(e,r){for(this.done=this.lineBreak=!1;;){let o=this.nodes.length-1,s=this.nodes[o],l=this.offsets[o],a=l>>1,c=s instanceof TextLeaf?s.text.length:s.children.length;if(a==(r>0?c:0)){if(o==0)return this.done=!0,this.value="",this;r>0&&this.offsets[o-1]++,this.nodes.pop(),this.offsets.pop()}else if((l&1)==(r>0?0:1)){if(this.offsets[o]+=r,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(s instanceof TextLeaf){let u=s.text[a+(r<0?-1:0)];if(this.offsets[o]+=r,u.length>Math.max(0,e))return this.value=e==0?u:r>0?u.slice(e):u.slice(0,u.length-e),this;e-=u.length}else{let u=s.children[a+(r<0?-1:0)];e>u.length?(e-=u.length,this.offsets[o]+=r):(r<0&&this.offsets[o]--,this.nodes.push(u),this.offsets.push(r>0?1:(u instanceof TextLeaf?u.text.length:u.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class PartialTextCursor{constructor(e,r,o){this.value="",this.done=!1,this.cursor=new RawTextCursor(e,r>o?-1:1),this.pos=r>o?e.length:0,this.from=Math.min(r,o),this.to=Math.max(r,o)}nextInner(e,r){if(r<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,r<0?this.pos-this.to:this.from-this.pos);let o=r<0?this.pos-this.from:this.to-this.pos;e>o&&(e=o),o-=e;let{value:s}=this.cursor.next(e);return this.pos+=(s.length+e)*r,this.value=s.length<=o?s:r<0?s.slice(s.length-o):s.slice(0,o),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class LineCursor{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:r,lineBreak:o,value:s}=this.inner.next(e);return r?(this.done=!0,this.value=""):o?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Text.prototype[Symbol.iterator]=function(){return this.iter()},RawTextCursor.prototype[Symbol.iterator]=PartialTextCursor.prototype[Symbol.iterator]=LineCursor.prototype[Symbol.iterator]=function(){return this});class Line{constructor(e,r,o,s){this.from=e,this.to=r,this.number=o,this.text=s}get length(){return this.to-this.from}}let extend="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(n=>n?parseInt(n,36):1);for(let n=1;n<extend.length;n++)extend[n]+=extend[n-1];function isExtendingChar(n){for(let e=1;e<extend.length;e+=2)if(extend[e]>n)return extend[e-1]<=n;return!1}function isRegionalIndicator(n){return n>=127462&&n<=127487}const ZWJ=8205;function findClusterBreak(n,e,r=!0,o=!0){return(r?nextClusterBreak:prevClusterBreak)(n,e,o)}function nextClusterBreak(n,e,r){if(e==n.length)return e;e&&surrogateLow(n.charCodeAt(e))&&surrogateHigh(n.charCodeAt(e-1))&&e--;let o=codePointAt(n,e);for(e+=codePointSize(o);e<n.length;){let s=codePointAt(n,e);if(o==ZWJ||s==ZWJ||r&&isExtendingChar(s))e+=codePointSize(s),o=s;else if(isRegionalIndicator(s)){let l=0,a=e-2;for(;a>=0&&isRegionalIndicator(codePointAt(n,a));)l++,a-=2;if(l%2==0)break;e+=2}else break}return e}function prevClusterBreak(n,e,r){for(;e>0;){let o=nextClusterBreak(n,e-2,r);if(o<e)return o;e--}return 0}function surrogateLow(n){return n>=56320&&n<57344}function surrogateHigh(n){return n>=55296&&n<56320}function codePointAt(n,e){let r=n.charCodeAt(e);if(!surrogateHigh(r)||e+1==n.length)return r;let o=n.charCodeAt(e+1);return surrogateLow(o)?(r-55296<<10)+(o-56320)+65536:r}function fromCodePoint(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function codePointSize(n){return n<65536?1:2}const DefaultSplit=/\r\n?|\n/;var MapMode=function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n}(MapMode||(MapMode={}));class ChangeDesc{constructor(e){this.sections=e}get length(){let e=0;for(let r=0;r<this.sections.length;r+=2)e+=this.sections[r];return e}get newLength(){let e=0;for(let r=0;r<this.sections.length;r+=2){let o=this.sections[r+1];e+=o<0?this.sections[r]:o}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let r=0,o=0,s=0;r<this.sections.length;){let l=this.sections[r++],a=this.sections[r++];a<0?(e(o,s,l),s+=l):s+=a,o+=l}}iterChangedRanges(e,r=!1){iterChanges(this,e,r)}get invertedDesc(){let e=[];for(let r=0;r<this.sections.length;){let o=this.sections[r++],s=this.sections[r++];s<0?e.push(o,s):e.push(s,o)}return new ChangeDesc(e)}composeDesc(e){return this.empty?e:e.empty?this:composeSets(this,e)}mapDesc(e,r=!1){return e.empty?this:mapSet(this,e,r)}mapPos(e,r=-1,o=MapMode.Simple){let s=0,l=0;for(let a=0;a<this.sections.length;){let c=this.sections[a++],u=this.sections[a++],f=s+c;if(u<0){if(f>e)return l+(e-s);l+=c}else{if(o!=MapMode.Simple&&f>=e&&(o==MapMode.TrackDel&&s<e&&f>e||o==MapMode.TrackBefore&&s<e||o==MapMode.TrackAfter&&f>e))return null;if(f>e||f==e&&r<0&&!c)return e==s||r<0?l:l+u;l+=u}s=f}if(e>s)throw new RangeError(`Position ${e} is out of range for changeset of length ${s}`);return l}touchesRange(e,r=e){for(let o=0,s=0;o<this.sections.length&&s<=r;){let l=this.sections[o++],a=this.sections[o++],c=s+l;if(a>=0&&s<=r&&c>=e)return s<e&&c>r?"cover":!0;s=c}return!1}toString(){let e="";for(let r=0;r<this.sections.length;){let o=this.sections[r++],s=this.sections[r++];e+=(e?" ":"")+o+(s>=0?":"+s:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(r=>typeof r!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ChangeDesc(e)}static create(e){return new ChangeDesc(e)}}class ChangeSet extends ChangeDesc{constructor(e,r){super(e),this.inserted=r}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return iterChanges(this,(r,o,s,l,a)=>e=e.replace(s,s+(o-r),a),!1),e}mapDesc(e,r=!1){return mapSet(this,e,r,!0)}invert(e){let r=this.sections.slice(),o=[];for(let s=0,l=0;s<r.length;s+=2){let a=r[s],c=r[s+1];if(c>=0){r[s]=c,r[s+1]=a;let u=s>>1;for(;o.length<u;)o.push(Text.empty);o.push(a?e.slice(l,l+a):Text.empty)}l+=a}return new ChangeSet(r,o)}compose(e){return this.empty?e:e.empty?this:composeSets(this,e,!0)}map(e,r=!1){return e.empty?this:mapSet(this,e,r,!0)}iterChanges(e,r=!1){iterChanges(this,e,r)}get desc(){return ChangeDesc.create(this.sections)}filter(e){let r=[],o=[],s=[],l=new SectionIter(this);e:for(let a=0,c=0;;){let u=a==e.length?1e9:e[a++];for(;c<u||c==u&&l.len==0;){if(l.done)break e;let d=Math.min(l.len,u-c);addSection(s,d,-1);let g=l.ins==-1?-1:l.off==0?l.ins:0;addSection(r,d,g),g>0&&addInsert(o,r,l.text),l.forward(d),c+=d}let f=e[a++];for(;c<f;){if(l.done)break e;let d=Math.min(l.len,f-c);addSection(r,d,-1),addSection(s,d,l.ins==-1?-1:l.off==0?l.ins:0),l.forward(d),c+=d}}return{changes:new ChangeSet(r,o),filtered:ChangeDesc.create(s)}}toJSON(){let e=[];for(let r=0;r<this.sections.length;r+=2){let o=this.sections[r],s=this.sections[r+1];s<0?e.push(o):s==0?e.push([o]):e.push([o].concat(this.inserted[r>>1].toJSON()))}return e}static of(e,r,o){let s=[],l=[],a=0,c=null;function u(d=!1){if(!d&&!s.length)return;a<r&&addSection(s,r-a,-1);let g=new ChangeSet(s,l);c=c?c.compose(g.map(c)):g,s=[],l=[],a=0}function f(d){if(Array.isArray(d))for(let g of d)f(g);else if(d instanceof ChangeSet){if(d.length!=r)throw new RangeError(`Mismatched change set length (got ${d.length}, expected ${r})`);u(),c=c?c.compose(d.map(c)):d}else{let{from:g,to:m=g,insert:v}=d;if(g>m||g<0||m>r)throw new RangeError(`Invalid change range ${g} to ${m} (in doc of length ${r})`);let b=v?typeof v=="string"?Text.of(v.split(o||DefaultSplit)):v:Text.empty,k=b.length;if(g==m&&k==0)return;g<a&&u(),g>a&&addSection(s,g-a,-1),addSection(s,m-g,k),addInsert(l,s,b),a=m}}return f(e),u(!c),c}static empty(e){return new ChangeSet(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let r=[],o=[];for(let s=0;s<e.length;s++){let l=e[s];if(typeof l=="number")r.push(l,-1);else{if(!Array.isArray(l)||typeof l[0]!="number"||l.some((a,c)=>c&&typeof a!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(l.length==1)r.push(l[0],0);else{for(;o.length<s;)o.push(Text.empty);o[s]=Text.of(l.slice(1)),r.push(l[0],o[s].length)}}}return new ChangeSet(r,o)}static createSet(e,r){return new ChangeSet(e,r)}}function addSection(n,e,r,o=!1){if(e==0&&r<=0)return;let s=n.length-2;s>=0&&r<=0&&r==n[s+1]?n[s]+=e:e==0&&n[s]==0?n[s+1]+=r:o?(n[s]+=e,n[s+1]+=r):n.push(e,r)}function addInsert(n,e,r){if(r.length==0)return;let o=e.length-2>>1;if(o<n.length)n[n.length-1]=n[n.length-1].append(r);else{for(;n.length<o;)n.push(Text.empty);n.push(r)}}function iterChanges(n,e,r){let o=n.inserted;for(let s=0,l=0,a=0;a<n.sections.length;){let c=n.sections[a++],u=n.sections[a++];if(u<0)s+=c,l+=c;else{let f=s,d=l,g=Text.empty;for(;f+=c,d+=u,u&&o&&(g=g.append(o[a-2>>1])),!(r||a==n.sections.length||n.sections[a+1]<0);)c=n.sections[a++],u=n.sections[a++];e(s,f,l,d,g),s=f,l=d}}}function mapSet(n,e,r,o=!1){let s=[],l=o?[]:null,a=new SectionIter(n),c=new SectionIter(e);for(let u=-1;;)if(a.ins==-1&&c.ins==-1){let f=Math.min(a.len,c.len);addSection(s,f,-1),a.forward(f),c.forward(f)}else if(c.ins>=0&&(a.ins<0||u==a.i||a.off==0&&(c.len<a.len||c.len==a.len&&!r))){let f=c.len;for(addSection(s,c.ins,-1);f;){let d=Math.min(a.len,f);a.ins>=0&&u<a.i&&a.len<=d&&(addSection(s,0,a.ins),l&&addInsert(l,s,a.text),u=a.i),a.forward(d),f-=d}c.next()}else if(a.ins>=0){let f=0,d=a.len;for(;d;)if(c.ins==-1){let g=Math.min(d,c.len);f+=g,d-=g,c.forward(g)}else if(c.ins==0&&c.len<d)d-=c.len,c.next();else break;addSection(s,f,u<a.i?a.ins:0),l&&u<a.i&&addInsert(l,s,a.text),u=a.i,a.forward(a.len-d)}else{if(a.done&&c.done)return l?ChangeSet.createSet(s,l):ChangeDesc.create(s);throw new Error("Mismatched change set lengths")}}function composeSets(n,e,r=!1){let o=[],s=r?[]:null,l=new SectionIter(n),a=new SectionIter(e);for(let c=!1;;){if(l.done&&a.done)return s?ChangeSet.createSet(o,s):ChangeDesc.create(o);if(l.ins==0)addSection(o,l.len,0,c),l.next();else if(a.len==0&&!a.done)addSection(o,0,a.ins,c),s&&addInsert(s,o,a.text),a.next();else{if(l.done||a.done)throw new Error("Mismatched change set lengths");{let u=Math.min(l.len2,a.len),f=o.length;if(l.ins==-1){let d=a.ins==-1?-1:a.off?0:a.ins;addSection(o,u,d,c),s&&d&&addInsert(s,o,a.text)}else a.ins==-1?(addSection(o,l.off?0:l.len,u,c),s&&addInsert(s,o,l.textBit(u))):(addSection(o,l.off?0:l.len,a.off?0:a.ins,c),s&&!a.off&&addInsert(s,o,a.text));c=(l.ins>u||a.ins>=0&&a.len>u)&&(c||o.length>f),l.forward2(u),a.forward(u)}}}}class SectionIter{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,r=this.i-2>>1;return r>=e.length?Text.empty:e[r]}textBit(e){let{inserted:r}=this.set,o=this.i-2>>1;return o>=r.length&&!e?Text.empty:r[o].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class SelectionRange{constructor(e,r,o){this.from=e,this.to=r,this.flags=o}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let e=this.flags&3;return e==3?null:e}get goalColumn(){let e=this.flags>>5;return e==33554431?void 0:e}map(e,r=-1){let o,s;return this.empty?o=s=e.mapPos(this.from,r):(o=e.mapPos(this.from,1),s=e.mapPos(this.to,-1)),o==this.from&&s==this.to?this:new SelectionRange(o,s,this.flags)}extend(e,r=e){if(e<=this.anchor&&r>=this.anchor)return EditorSelection.range(e,r);let o=Math.abs(e-this.anchor)>Math.abs(r-this.anchor)?e:r;return EditorSelection.range(this.anchor,o)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return EditorSelection.range(e.anchor,e.head)}static create(e,r,o){return new SelectionRange(e,r,o)}}class EditorSelection{constructor(e,r){this.ranges=e,this.mainIndex=r}map(e,r=-1){return e.empty?this:EditorSelection.create(this.ranges.map(o=>o.map(e,r)),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let r=0;r<this.ranges.length;r++)if(!this.ranges[r].eq(e.ranges[r]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new EditorSelection([this.main],0)}addRange(e,r=!0){return EditorSelection.create([e].concat(this.ranges),r?0:this.mainIndex+1)}replaceRange(e,r=this.mainIndex){let o=this.ranges.slice();return o[r]=e,EditorSelection.create(o,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new EditorSelection(e.ranges.map(r=>SelectionRange.fromJSON(r)),e.main)}static single(e,r=e){return new EditorSelection([EditorSelection.range(e,r)],0)}static create(e,r=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let o=0,s=0;s<e.length;s++){let l=e[s];if(l.empty?l.from<=o:l.from<o)return EditorSelection.normalized(e.slice(),r);o=l.to}return new EditorSelection(e,r)}static cursor(e,r=0,o,s){return SelectionRange.create(e,e,(r==0?0:r<0?4:8)|(o==null?3:Math.min(2,o))|(s??33554431)<<5)}static range(e,r,o,s){let l=(o??33554431)<<5|(s==null?3:Math.min(2,s));return r<e?SelectionRange.create(r,e,24|l):SelectionRange.create(e,r,(r>e?4:0)|l)}static normalized(e,r=0){let o=e[r];e.sort((s,l)=>s.from-l.from),r=e.indexOf(o);for(let s=1;s<e.length;s++){let l=e[s],a=e[s-1];if(l.empty?l.from<=a.to:l.from<a.to){let c=a.from,u=Math.max(l.to,a.to);s<=r&&r--,e.splice(--s,2,l.anchor>l.head?EditorSelection.range(u,c):EditorSelection.range(c,u))}}return new EditorSelection(e,r)}}function checkSelection(n,e){for(let r of n.ranges)if(r.to>e)throw new RangeError("Selection points outside of document")}let nextID=0;class Facet{constructor(e,r,o,s,l){this.combine=e,this.compareInput=r,this.compare=o,this.isStatic=s,this.id=nextID++,this.default=e([]),this.extensions=typeof l=="function"?l(this):l}static define(e={}){return new Facet(e.combine||(r=>r),e.compareInput||((r,o)=>r===o),e.compare||(e.combine?(r,o)=>r===o:sameArray$1),!!e.static,e.enables)}of(e){return new FacetProvider([],this,0,e)}compute(e,r){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(e,this,1,r)}computeN(e,r){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(e,this,2,r)}from(e,r){return r||(r=o=>o),this.compute([e],o=>r(o.field(e)))}}function sameArray$1(n,e){return n==e||n.length==e.length&&n.every((r,o)=>r===e[o])}class FacetProvider{constructor(e,r,o,s){this.dependencies=e,this.facet=r,this.type=o,this.value=s,this.id=nextID++}dynamicSlot(e){var r;let o=this.value,s=this.facet.compareInput,l=this.id,a=e[l]>>1,c=this.type==2,u=!1,f=!1,d=[];for(let g of this.dependencies)g=="doc"?u=!0:g=="selection"?f=!0:((r=e[g.id])!==null&&r!==void 0?r:1)&1||d.push(e[g.id]);return{create(g){return g.values[a]=o(g),1},update(g,m){if(u&&m.docChanged||f&&(m.docChanged||m.selection)||ensureAll(g,d)){let v=o(g);if(c?!compareArray(v,g.values[a],s):!s(v,g.values[a]))return g.values[a]=v,1}return 0},reconfigure:(g,m)=>{let v,b=m.config.address[l];if(b!=null){let k=getAddr(m,b);if(this.dependencies.every(A=>A instanceof Facet?m.facet(A)===g.facet(A):A instanceof StateField?m.field(A,!1)==g.field(A,!1):!0)||(c?compareArray(v=o(g),k,s):s(v=o(g),k)))return g.values[a]=k,0}else v=o(g);return g.values[a]=v,1}}}}function compareArray(n,e,r){if(n.length!=e.length)return!1;for(let o=0;o<n.length;o++)if(!r(n[o],e[o]))return!1;return!0}function ensureAll(n,e){let r=!1;for(let o of e)ensureAddr(n,o)&1&&(r=!0);return r}function dynamicFacetSlot(n,e,r){let o=r.map(u=>n[u.id]),s=r.map(u=>u.type),l=o.filter(u=>!(u&1)),a=n[e.id]>>1;function c(u){let f=[];for(let d=0;d<o.length;d++){let g=getAddr(u,o[d]);if(s[d]==2)for(let m of g)f.push(m);else f.push(g)}return e.combine(f)}return{create(u){for(let f of o)ensureAddr(u,f);return u.values[a]=c(u),1},update(u,f){if(!ensureAll(u,l))return 0;let d=c(u);return e.compare(d,u.values[a])?0:(u.values[a]=d,1)},reconfigure(u,f){let d=ensureAll(u,o),g=f.config.facets[e.id],m=f.facet(e);if(g&&!d&&sameArray$1(r,g))return u.values[a]=m,0;let v=c(u);return e.compare(v,m)?(u.values[a]=m,0):(u.values[a]=v,1)}}}const initField=Facet.define({static:!0});class StateField{constructor(e,r,o,s,l){this.id=e,this.createF=r,this.updateF=o,this.compareF=s,this.spec=l,this.provides=void 0}static define(e){let r=new StateField(nextID++,e.create,e.update,e.compare||((o,s)=>o===s),e);return e.provide&&(r.provides=e.provide(r)),r}create(e){let r=e.facet(initField).find(o=>o.field==this);return((r==null?void 0:r.create)||this.createF)(e)}slot(e){let r=e[this.id]>>1;return{create:o=>(o.values[r]=this.create(o),1),update:(o,s)=>{let l=o.values[r],a=this.updateF(l,s);return this.compareF(l,a)?0:(o.values[r]=a,1)},reconfigure:(o,s)=>s.config.address[this.id]!=null?(o.values[r]=s.field(this),0):(o.values[r]=this.create(o),1)}}init(e){return[this,initField.of({field:this,create:e})]}get extension(){return this}}const Prec_={lowest:4,low:3,default:2,high:1,highest:0};function prec(n){return e=>new PrecExtension(e,n)}const Prec={highest:prec(Prec_.highest),high:prec(Prec_.high),default:prec(Prec_.default),low:prec(Prec_.low),lowest:prec(Prec_.lowest)};class PrecExtension{constructor(e,r){this.inner=e,this.prec=r}}class Compartment{of(e){return new CompartmentInstance(this,e)}reconfigure(e){return Compartment.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class CompartmentInstance{constructor(e,r){this.compartment=e,this.inner=r}}class Configuration{constructor(e,r,o,s,l,a){for(this.base=e,this.compartments=r,this.dynamicSlots=o,this.address=s,this.staticValues=l,this.facets=a,this.statusTemplate=[];this.statusTemplate.length<o.length;)this.statusTemplate.push(0)}staticFacet(e){let r=this.address[e.id];return r==null?e.default:this.staticValues[r>>1]}static resolve(e,r,o){let s=[],l=Object.create(null),a=new Map;for(let m of flatten(e,r,a))m instanceof StateField?s.push(m):(l[m.facet.id]||(l[m.facet.id]=[])).push(m);let c=Object.create(null),u=[],f=[];for(let m of s)c[m.id]=f.length<<1,f.push(v=>m.slot(v));let d=o==null?void 0:o.config.facets;for(let m in l){let v=l[m],b=v[0].facet,k=d&&d[m]||[];if(v.every(A=>A.type==0))if(c[b.id]=u.length<<1|1,sameArray$1(k,v))u.push(o.facet(b));else{let A=b.combine(v.map(R=>R.value));u.push(o&&b.compare(A,o.facet(b))?o.facet(b):A)}else{for(let A of v)A.type==0?(c[A.id]=u.length<<1|1,u.push(A.value)):(c[A.id]=f.length<<1,f.push(R=>A.dynamicSlot(R)));c[b.id]=f.length<<1,f.push(A=>dynamicFacetSlot(A,b,v))}}let g=f.map(m=>m(c));return new Configuration(e,a,g,c,u,l)}}function flatten(n,e,r){let o=[[],[],[],[],[]],s=new Map;function l(a,c){let u=s.get(a);if(u!=null){if(u<=c)return;let f=o[u].indexOf(a);f>-1&&o[u].splice(f,1),a instanceof CompartmentInstance&&r.delete(a.compartment)}if(s.set(a,c),Array.isArray(a))for(let f of a)l(f,c);else if(a instanceof CompartmentInstance){if(r.has(a.compartment))throw new RangeError("Duplicate use of compartment in extensions");let f=e.get(a.compartment)||a.inner;r.set(a.compartment,f),l(f,c)}else if(a instanceof PrecExtension)l(a.inner,a.prec);else if(a instanceof StateField)o[c].push(a),a.provides&&l(a.provides,c);else if(a instanceof FacetProvider)o[c].push(a),a.facet.extensions&&l(a.facet.extensions,Prec_.default);else{let f=a.extension;if(!f)throw new Error(`Unrecognized extension value in extension set (${a}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);l(f,c)}}return l(n,Prec_.default),o.reduce((a,c)=>a.concat(c))}function ensureAddr(n,e){if(e&1)return 2;let r=e>>1,o=n.status[r];if(o==4)throw new Error("Cyclic dependency between fields and/or facets");if(o&2)return o;n.status[r]=4;let s=n.computeSlot(n,n.config.dynamicSlots[r]);return n.status[r]=2|s}function getAddr(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const languageData=Facet.define(),allowMultipleSelections=Facet.define({combine:n=>n.some(e=>e),static:!0}),lineSeparator=Facet.define({combine:n=>n.length?n[0]:void 0,static:!0}),changeFilter=Facet.define(),transactionFilter=Facet.define(),transactionExtender=Facet.define(),readOnly=Facet.define({combine:n=>n.length?n[0]:!1});class Annotation{constructor(e,r){this.type=e,this.value=r}static define(){return new AnnotationType}}class AnnotationType{of(e){return new Annotation(this,e)}}class StateEffectType{constructor(e){this.map=e}of(e){return new StateEffect(this,e)}}class StateEffect{constructor(e,r){this.type=e,this.value=r}map(e){let r=this.type.map(this.value,e);return r===void 0?void 0:r==this.value?this:new StateEffect(this.type,r)}is(e){return this.type==e}static define(e={}){return new StateEffectType(e.map||(r=>r))}static mapEffects(e,r){if(!e.length)return e;let o=[];for(let s of e){let l=s.map(r);l&&o.push(l)}return o}}StateEffect.reconfigure=StateEffect.define();StateEffect.appendConfig=StateEffect.define();class Transaction{constructor(e,r,o,s,l,a){this.startState=e,this.changes=r,this.selection=o,this.effects=s,this.annotations=l,this.scrollIntoView=a,this._doc=null,this._state=null,o&&checkSelection(o,r.newLength),l.some(c=>c.type==Transaction.time)||(this.annotations=l.concat(Transaction.time.of(Date.now())))}static create(e,r,o,s,l,a){return new Transaction(e,r,o,s,l,a)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let r of this.annotations)if(r.type==e)return r.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let r=this.annotation(Transaction.userEvent);return!!(r&&(r==e||r.length>e.length&&r.slice(0,e.length)==e&&r[e.length]=="."))}}Transaction.time=Annotation.define();Transaction.userEvent=Annotation.define();Transaction.addToHistory=Annotation.define();Transaction.remote=Annotation.define();function joinRanges(n,e){let r=[];for(let o=0,s=0;;){let l,a;if(o<n.length&&(s==e.length||e[s]>=n[o]))l=n[o++],a=n[o++];else if(s<e.length)l=e[s++],a=e[s++];else return r;!r.length||r[r.length-1]<l?r.push(l,a):r[r.length-1]<a&&(r[r.length-1]=a)}}function mergeTransaction(n,e,r){var o;let s,l,a;return r?(s=e.changes,l=ChangeSet.empty(e.changes.length),a=n.changes.compose(e.changes)):(s=e.changes.map(n.changes),l=n.changes.mapDesc(e.changes,!0),a=n.changes.compose(s)),{changes:a,selection:e.selection?e.selection.map(l):(o=n.selection)===null||o===void 0?void 0:o.map(s),effects:StateEffect.mapEffects(n.effects,s).concat(StateEffect.mapEffects(e.effects,l)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function resolveTransactionInner(n,e,r){let o=e.selection,s=asArray$1(e.annotations);return e.userEvent&&(s=s.concat(Transaction.userEvent.of(e.userEvent))),{changes:e.changes instanceof ChangeSet?e.changes:ChangeSet.of(e.changes||[],r,n.facet(lineSeparator)),selection:o&&(o instanceof EditorSelection?o:EditorSelection.single(o.anchor,o.head)),effects:asArray$1(e.effects),annotations:s,scrollIntoView:!!e.scrollIntoView}}function resolveTransaction(n,e,r){let o=resolveTransactionInner(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(r=!1);for(let l=1;l<e.length;l++){e[l].filter===!1&&(r=!1);let a=!!e[l].sequential;o=mergeTransaction(o,resolveTransactionInner(n,e[l],a?o.changes.newLength:n.doc.length),a)}let s=Transaction.create(n,o.changes,o.selection,o.effects,o.annotations,o.scrollIntoView);return extendTransaction(r?filterTransaction(s):s)}function filterTransaction(n){let e=n.startState,r=!0;for(let s of e.facet(changeFilter)){let l=s(n);if(l===!1){r=!1;break}Array.isArray(l)&&(r=r===!0?l:joinRanges(r,l))}if(r!==!0){let s,l;if(r===!1)l=n.changes.invertedDesc,s=ChangeSet.empty(e.doc.length);else{let a=n.changes.filter(r);s=a.changes,l=a.filtered.mapDesc(a.changes).invertedDesc}n=Transaction.create(e,s,n.selection&&n.selection.map(l),StateEffect.mapEffects(n.effects,l),n.annotations,n.scrollIntoView)}let o=e.facet(transactionFilter);for(let s=o.length-1;s>=0;s--){let l=o[s](n);l instanceof Transaction?n=l:Array.isArray(l)&&l.length==1&&l[0]instanceof Transaction?n=l[0]:n=resolveTransaction(e,asArray$1(l),!1)}return n}function extendTransaction(n){let e=n.startState,r=e.facet(transactionExtender),o=n;for(let s=r.length-1;s>=0;s--){let l=r[s](n);l&&Object.keys(l).length&&(o=mergeTransaction(o,resolveTransactionInner(e,l,n.changes.newLength),!0))}return o==n?n:Transaction.create(e,n.changes,n.selection,o.effects,o.annotations,o.scrollIntoView)}const none$2=[];function asArray$1(n){return n==null?none$2:Array.isArray(n)?n:[n]}var CharCategory=function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n}(CharCategory||(CharCategory={}));const nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let wordChar;try{wordChar=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function hasWordChar(n){if(wordChar)return wordChar.test(n);for(let e=0;e<n.length;e++){let r=n[e];if(/\w/.test(r)||r>""&&(r.toUpperCase()!=r.toLowerCase()||nonASCIISingleCaseWordChar.test(r)))return!0}return!1}function makeCategorizer(n){return e=>{if(!/\S/.test(e))return CharCategory.Space;if(hasWordChar(e))return CharCategory.Word;for(let r=0;r<n.length;r++)if(e.indexOf(n[r])>-1)return CharCategory.Word;return CharCategory.Other}}class EditorState{constructor(e,r,o,s,l,a){this.config=e,this.doc=r,this.selection=o,this.values=s,this.status=e.statusTemplate.slice(),this.computeSlot=l,a&&(a._state=this);for(let c=0;c<this.config.dynamicSlots.length;c++)ensureAddr(this,c<<1);this.computeSlot=null}field(e,r=!0){let o=this.config.address[e.id];if(o==null){if(r)throw new RangeError("Field is not present in this state");return}return ensureAddr(this,o),getAddr(this,o)}update(...e){return resolveTransaction(this,e,!0)}applyTransaction(e){let r=this.config,{base:o,compartments:s}=r;for(let a of e.effects)a.is(Compartment.reconfigure)?(r&&(s=new Map,r.compartments.forEach((c,u)=>s.set(u,c)),r=null),s.set(a.value.compartment,a.value.extension)):a.is(StateEffect.reconfigure)?(r=null,o=a.value):a.is(StateEffect.appendConfig)&&(r=null,o=asArray$1(o).concat(a.value));let l;r?l=e.startState.values.slice():(r=Configuration.resolve(o,s,this),l=new EditorState(r,this.doc,this.selection,r.dynamicSlots.map(()=>null),(c,u)=>u.reconfigure(c,this),null).values),new EditorState(r,e.newDoc,e.newSelection,l,(a,c)=>c.update(a,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:e},range:EditorSelection.cursor(r.from+e.length)}))}changeByRange(e){let r=this.selection,o=e(r.ranges[0]),s=this.changes(o.changes),l=[o.range],a=asArray$1(o.effects);for(let c=1;c<r.ranges.length;c++){let u=e(r.ranges[c]),f=this.changes(u.changes),d=f.map(s);for(let m=0;m<c;m++)l[m]=l[m].map(d);let g=s.mapDesc(f,!0);l.push(u.range.map(g)),s=s.compose(d),a=StateEffect.mapEffects(a,d).concat(StateEffect.mapEffects(asArray$1(u.effects),g))}return{changes:s,selection:EditorSelection.create(l,r.mainIndex),effects:a}}changes(e=[]){return e instanceof ChangeSet?e:ChangeSet.of(e,this.doc.length,this.facet(EditorState.lineSeparator))}toText(e){return Text.of(e.split(this.facet(EditorState.lineSeparator)||DefaultSplit))}sliceDoc(e=0,r=this.doc.length){return this.doc.sliceString(e,r,this.lineBreak)}facet(e){let r=this.config.address[e.id];return r==null?e.default:(ensureAddr(this,r),getAddr(this,r))}toJSON(e){let r={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let o in e){let s=e[o];s instanceof StateField&&this.config.address[s.id]!=null&&(r[o]=s.spec.toJSON(this.field(e[o]),this))}return r}static fromJSON(e,r={},o){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(o){for(let l in o)if(Object.prototype.hasOwnProperty.call(e,l)){let a=o[l],c=e[l];s.push(a.init(u=>a.spec.fromJSON(c,u)))}}return EditorState.create({doc:e.doc,selection:EditorSelection.fromJSON(e.selection),extensions:r.extensions?s.concat([r.extensions]):s})}static create(e={}){let r=Configuration.resolve(e.extensions||[],new Map),o=e.doc instanceof Text?e.doc:Text.of((e.doc||"").split(r.staticFacet(EditorState.lineSeparator)||DefaultSplit)),s=e.selection?e.selection instanceof EditorSelection?e.selection:EditorSelection.single(e.selection.anchor,e.selection.head):EditorSelection.single(0);return checkSelection(s,o.length),r.staticFacet(allowMultipleSelections)||(s=s.asSingle()),new EditorState(r,o,s,r.dynamicSlots.map(()=>null),(l,a)=>a.create(l),null)}get tabSize(){return this.facet(EditorState.tabSize)}get lineBreak(){return this.facet(EditorState.lineSeparator)||`
`}get readOnly(){return this.facet(readOnly)}phrase(e,...r){for(let o of this.facet(EditorState.phrases))if(Object.prototype.hasOwnProperty.call(o,e)){e=o[e];break}return r.length&&(e=e.replace(/\$(\$|\d*)/g,(o,s)=>{if(s=="$")return"$";let l=+(s||1);return!l||l>r.length?o:r[l-1]})),e}languageDataAt(e,r,o=-1){let s=[];for(let l of this.facet(languageData))for(let a of l(this,r,o))Object.prototype.hasOwnProperty.call(a,e)&&s.push(a[e]);return s}charCategorizer(e){return makeCategorizer(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:r,from:o,length:s}=this.doc.lineAt(e),l=this.charCategorizer(e),a=e-o,c=e-o;for(;a>0;){let u=findClusterBreak(r,a,!1);if(l(r.slice(u,a))!=CharCategory.Word)break;a=u}for(;c<s;){let u=findClusterBreak(r,c);if(l(r.slice(c,u))!=CharCategory.Word)break;c=u}return a==c?null:EditorSelection.range(a+o,c+o)}}EditorState.allowMultipleSelections=allowMultipleSelections;EditorState.tabSize=Facet.define({combine:n=>n.length?n[0]:4});EditorState.lineSeparator=lineSeparator;EditorState.readOnly=readOnly;EditorState.phrases=Facet.define({compare(n,e){let r=Object.keys(n),o=Object.keys(e);return r.length==o.length&&r.every(s=>n[s]==e[s])}});EditorState.languageData=languageData;EditorState.changeFilter=changeFilter;EditorState.transactionFilter=transactionFilter;EditorState.transactionExtender=transactionExtender;Compartment.reconfigure=StateEffect.define();function combineConfig(n,e,r={}){let o={};for(let s of n)for(let l of Object.keys(s)){let a=s[l],c=o[l];if(c===void 0)o[l]=a;else if(!(c===a||a===void 0))if(Object.hasOwnProperty.call(r,l))o[l]=r[l](c,a);else throw new Error("Config merge conflict for field "+l)}for(let s in e)o[s]===void 0&&(o[s]=e[s]);return o}class RangeValue{eq(e){return this==e}range(e,r=e){return Range$1.create(e,r,this)}}RangeValue.prototype.startSide=RangeValue.prototype.endSide=0;RangeValue.prototype.point=!1;RangeValue.prototype.mapMode=MapMode.TrackDel;let Range$1=class Sr{constructor(e,r,o){this.from=e,this.to=r,this.value=o}static create(e,r,o){return new Sr(e,r,o)}};function cmpRange(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class Chunk{constructor(e,r,o,s){this.from=e,this.to=r,this.value=o,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(e,r,o,s=0){let l=o?this.to:this.from;for(let a=s,c=l.length;;){if(a==c)return a;let u=a+c>>1,f=l[u]-e||(o?this.value[u].endSide:this.value[u].startSide)-r;if(u==a)return f>=0?a:c;f>=0?c=u:a=u+1}}between(e,r,o,s){for(let l=this.findIndex(r,-1e9,!0),a=this.findIndex(o,1e9,!1,l);l<a;l++)if(s(this.from[l]+e,this.to[l]+e,this.value[l])===!1)return!1}map(e,r){let o=[],s=[],l=[],a=-1,c=-1;for(let u=0;u<this.value.length;u++){let f=this.value[u],d=this.from[u]+e,g=this.to[u]+e,m,v;if(d==g){let b=r.mapPos(d,f.startSide,f.mapMode);if(b==null||(m=v=b,f.startSide!=f.endSide&&(v=r.mapPos(d,f.endSide),v<m)))continue}else if(m=r.mapPos(d,f.startSide),v=r.mapPos(g,f.endSide),m>v||m==v&&f.startSide>0&&f.endSide<=0)continue;(v-m||f.endSide-f.startSide)<0||(a<0&&(a=m),f.point&&(c=Math.max(c,v-m)),o.push(f),s.push(m-a),l.push(v-a))}return{mapped:o.length?new Chunk(s,l,o,c):null,pos:a}}}class RangeSet{constructor(e,r,o,s){this.chunkPos=e,this.chunk=r,this.nextLayer=o,this.maxPoint=s}static create(e,r,o,s){return new RangeSet(e,r,o,s)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let r of this.chunk)e+=r.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:r=[],sort:o=!1,filterFrom:s=0,filterTo:l=this.length}=e,a=e.filter;if(r.length==0&&!a)return this;if(o&&(r=r.slice().sort(cmpRange)),this.isEmpty)return r.length?RangeSet.of(r):this;let c=new LayerCursor(this,null,-1).goto(0),u=0,f=[],d=new RangeSetBuilder;for(;c.value||u<r.length;)if(u<r.length&&(c.from-r[u].from||c.startSide-r[u].value.startSide)>=0){let g=r[u++];d.addInner(g.from,g.to,g.value)||f.push(g)}else c.rangeIndex==1&&c.chunkIndex<this.chunk.length&&(u==r.length||this.chunkEnd(c.chunkIndex)<r[u].from)&&(!a||s>this.chunkEnd(c.chunkIndex)||l<this.chunkPos[c.chunkIndex])&&d.addChunk(this.chunkPos[c.chunkIndex],this.chunk[c.chunkIndex])?c.nextChunk():((!a||s>c.to||l<c.from||a(c.from,c.to,c.value))&&(d.addInner(c.from,c.to,c.value)||f.push(Range$1.create(c.from,c.to,c.value))),c.next());return d.finishInner(this.nextLayer.isEmpty&&!f.length?RangeSet.empty:this.nextLayer.update({add:f,filter:a,filterFrom:s,filterTo:l}))}map(e){if(e.empty||this.isEmpty)return this;let r=[],o=[],s=-1;for(let a=0;a<this.chunk.length;a++){let c=this.chunkPos[a],u=this.chunk[a],f=e.touchesRange(c,c+u.length);if(f===!1)s=Math.max(s,u.maxPoint),r.push(u),o.push(e.mapPos(c));else if(f===!0){let{mapped:d,pos:g}=u.map(c,e);d&&(s=Math.max(s,d.maxPoint),r.push(d),o.push(g))}}let l=this.nextLayer.map(e);return r.length==0?l:new RangeSet(o,r,l||RangeSet.empty,s)}between(e,r,o){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let l=this.chunkPos[s],a=this.chunk[s];if(r>=l&&e<=l+a.length&&a.between(l,e-l,r-l,o)===!1)return}this.nextLayer.between(e,r,o)}}iter(e=0){return HeapCursor.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,r=0){return HeapCursor.from(e).goto(r)}static compare(e,r,o,s,l=-1){let a=e.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=l),c=r.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=l),u=findSharedChunks(a,c,o),f=new SpanCursor(a,u,l),d=new SpanCursor(c,u,l);o.iterGaps((g,m,v)=>compare(f,g,d,m,v,s)),o.empty&&o.length==0&&compare(f,0,d,0,0,s)}static eq(e,r,o=0,s){s==null&&(s=1e9-1);let l=e.filter(d=>!d.isEmpty&&r.indexOf(d)<0),a=r.filter(d=>!d.isEmpty&&e.indexOf(d)<0);if(l.length!=a.length)return!1;if(!l.length)return!0;let c=findSharedChunks(l,a),u=new SpanCursor(l,c,0).goto(o),f=new SpanCursor(a,c,0).goto(o);for(;;){if(u.to!=f.to||!sameValues(u.active,f.active)||u.point&&(!f.point||!u.point.eq(f.point)))return!1;if(u.to>s)return!0;u.next(),f.next()}}static spans(e,r,o,s,l=-1){let a=new SpanCursor(e,null,l).goto(r),c=r,u=a.openStart;for(;;){let f=Math.min(a.to,o);if(a.point){let d=a.activeForPoint(a.to),g=a.pointFrom<r?d.length+1:Math.min(d.length,u);s.point(c,f,a.point,d,g,a.pointRank),u=Math.min(a.openEnd(f),d.length)}else f>c&&(s.span(c,f,a.active,u),u=a.openEnd(f));if(a.to>o)return u+(a.point&&a.to>o?1:0);c=a.to,a.next()}}static of(e,r=!1){let o=new RangeSetBuilder;for(let s of e instanceof Range$1?[e]:r?lazySort(e):e)o.add(s.from,s.to,s.value);return o.finish()}}RangeSet.empty=new RangeSet([],[],null,-1);function lazySort(n){if(n.length>1)for(let e=n[0],r=1;r<n.length;r++){let o=n[r];if(cmpRange(e,o)>0)return n.slice().sort(cmpRange);e=o}return n}RangeSet.empty.nextLayer=RangeSet.empty;class RangeSetBuilder{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(e){this.chunks.push(new Chunk(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}add(e,r,o){this.addInner(e,r,o)||(this.nextLayer||(this.nextLayer=new RangeSetBuilder)).add(e,r,o)}addInner(e,r,o){let s=e-this.lastTo||o.startSide-this.last.endSide;if(s<=0&&(e-this.lastFrom||o.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(r-this.chunkStart),this.last=o,this.lastFrom=e,this.lastTo=r,this.value.push(o),o.point&&(this.maxPoint=Math.max(this.maxPoint,r-e)),!0)}addChunk(e,r){if((e-this.lastTo||r.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,r.maxPoint),this.chunks.push(r),this.chunkPos.push(e);let o=r.value.length-1;return this.last=r.value[o],this.lastFrom=r.from[o]+e,this.lastTo=r.to[o]+e,!0}finish(){return this.finishInner(RangeSet.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let r=RangeSet.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,r}}function findSharedChunks(n,e,r){let o=new Map;for(let l of n)for(let a=0;a<l.chunk.length;a++)l.chunk[a].maxPoint<=0&&o.set(l.chunk[a],l.chunkPos[a]);let s=new Set;for(let l of e)for(let a=0;a<l.chunk.length;a++){let c=o.get(l.chunk[a]);c!=null&&(r?r.mapPos(c):c)==l.chunkPos[a]&&!(r!=null&&r.touchesRange(c,c+l.chunk[a].length))&&s.add(l.chunk[a])}return s}class LayerCursor{constructor(e,r,o,s=0){this.layer=e,this.skip=r,this.minPoint=o,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,r=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,r,!1),this}gotoInner(e,r,o){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<e||s.maxPoint<this.minPoint))break;this.chunkIndex++,o=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],r,!0);(!o||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(e,r){(this.to-e||this.endSide-r)<0&&this.gotoInner(e,r,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],r=this.layer.chunk[this.chunkIndex],o=e+r.from[this.rangeIndex];if(this.from=o,this.to=e+r.to[this.rangeIndex],this.value=r.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class HeapCursor{constructor(e){this.heap=e}static from(e,r=null,o=-1){let s=[];for(let l=0;l<e.length;l++)for(let a=e[l];!a.isEmpty;a=a.nextLayer)a.maxPoint>=o&&s.push(new LayerCursor(a,r,o,l));return s.length==1?s[0]:new HeapCursor(s)}get startSide(){return this.value?this.value.startSide:0}goto(e,r=-1e9){for(let o of this.heap)o.goto(e,r);for(let o=this.heap.length>>1;o>=0;o--)heapBubble(this.heap,o);return this.next(),this}forward(e,r){for(let o of this.heap)o.forward(e,r);for(let o=this.heap.length>>1;o>=0;o--)heapBubble(this.heap,o);(this.to-e||this.value.endSide-r)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),heapBubble(this.heap,0)}}}function heapBubble(n,e){for(let r=n[e];;){let o=(e<<1)+1;if(o>=n.length)break;let s=n[o];if(o+1<n.length&&s.compare(n[o+1])>=0&&(s=n[o+1],o++),r.compare(s)<0)break;n[o]=r,n[e]=s,e=o}}class SpanCursor{constructor(e,r,o){this.minPoint=o,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=HeapCursor.from(e,r,o)}goto(e,r=-1e9){return this.cursor.goto(e,r),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=r,this.openStart=-1,this.next(),this}forward(e,r){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-r)<0;)this.removeActive(this.minActive);this.cursor.forward(e,r)}removeActive(e){remove(this.active,e),remove(this.activeTo,e),remove(this.activeRank,e),this.minActive=findMinIndex(this.active,this.activeTo)}addActive(e){let r=0,{value:o,to:s,rank:l}=this.cursor;for(;r<this.activeRank.length&&this.activeRank[r]<=l;)r++;insert(this.active,r,o),insert(this.activeTo,r,s),insert(this.activeRank,r,l),e&&insert(e,r,this.cursor.from),this.minActive=findMinIndex(this.active,this.activeTo)}next(){let e=this.to,r=this.point;this.point=null;let o=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),o&&remove(o,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let l=this.cursor.value;if(!l.point)this.addActive(o),this.cursor.next();else if(r&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=l,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=l.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(o){this.openStart=0;for(let s=o.length-1;s>=0&&o[s]<e;s--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let r=[];for(let o=this.active.length-1;o>=0&&!(this.activeRank[o]<this.pointRank);o--)(this.activeTo[o]>e||this.activeTo[o]==e&&this.active[o].endSide>=this.point.endSide)&&r.push(this.active[o]);return r.reverse()}openEnd(e){let r=0;for(let o=this.activeTo.length-1;o>=0&&this.activeTo[o]>e;o--)r++;return r}}function compare(n,e,r,o,s,l){n.goto(e),r.goto(o);let a=o+s,c=o,u=o-e;for(;;){let f=n.to+u-r.to||n.endSide-r.endSide,d=f<0?n.to+u:r.to,g=Math.min(d,a);if(n.point||r.point?n.point&&r.point&&(n.point==r.point||n.point.eq(r.point))&&sameValues(n.activeForPoint(n.to+u),r.activeForPoint(r.to))||l.comparePoint(c,g,n.point,r.point):g>c&&!sameValues(n.active,r.active)&&l.compareRange(c,g,n.active,r.active),d>a)break;c=d,f<=0&&n.next(),f>=0&&r.next()}}function sameValues(n,e){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(n[r]!=e[r]&&!n[r].eq(e[r]))return!1;return!0}function remove(n,e){for(let r=e,o=n.length-1;r<o;r++)n[r]=n[r+1];n.pop()}function insert(n,e,r){for(let o=n.length-1;o>=e;o--)n[o+1]=n[o];n[e]=r}function findMinIndex(n,e){let r=-1,o=1e9;for(let s=0;s<e.length;s++)(e[s]-o||n[s].endSide-n[r].endSide)<0&&(r=s,o=e[s]);return r}function countColumn(n,e,r=n.length){let o=0;for(let s=0;s<r;)n.charCodeAt(s)==9?(o+=e-o%e,s++):(o++,s=findClusterBreak(n,s));return o}function findColumn(n,e,r,o){for(let s=0,l=0;;){if(l>=e)return s;if(s==n.length)break;l+=n.charCodeAt(s)==9?r-l%r:1,s=findClusterBreak(n,s)}return o===!0?-1:n.length}const C$1="",COUNT=typeof Symbol>"u"?"__"+C$1:Symbol.for(C$1),SET=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),top=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class StyleModule{constructor(e,r){this.rules=[];let{finish:o}=r||{};function s(a){return/^@/.test(a)?[a]:a.split(/,\s*/)}function l(a,c,u,f){let d=[],g=/^@(\w+)\b/.exec(a[0]),m=g&&g[1]=="keyframes";if(g&&c==null)return u.push(a[0]+";");for(let v in c){let b=c[v];if(/&/.test(v))l(v.split(/,\s*/).map(k=>a.map(A=>k.replace(/&/,A))).reduce((k,A)=>k.concat(A)),b,u);else if(b&&typeof b=="object"){if(!g)throw new RangeError("The value of a property ("+v+") should be a primitive value.");l(s(v),b,d,m)}else b!=null&&d.push(v.replace(/_.*/,"").replace(/[A-Z]/g,k=>"-"+k.toLowerCase())+": "+b+";")}(d.length||m)&&u.push((o&&!g&&!f?a.map(o):a).join(", ")+" {"+d.join(" ")+"}")}for(let a in e)l(s(a),e[a],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=top[COUNT]||1;return top[COUNT]=e+1,C$1+e.toString(36)}static mount(e,r){(e[SET]||new StyleSet(e)).mount(Array.isArray(r)?r:[r])}}let adoptedSet=new Map;class StyleSet{constructor(e){let r=e.ownerDocument||e,o=r.defaultView;if(!e.head&&e.adoptedStyleSheets&&o.CSSStyleSheet){let s=adoptedSet.get(r);if(s)return e.adoptedStyleSheets=[s.sheet,...e.adoptedStyleSheets],e[SET]=s;this.sheet=new o.CSSStyleSheet,e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets],adoptedSet.set(r,this)}else{this.styleTag=r.createElement("style");let s=e.head||e;s.insertBefore(this.styleTag,s.firstChild)}this.modules=[],e[SET]=this}mount(e){let r=this.sheet,o=0,s=0;for(let l=0;l<e.length;l++){let a=e[l],c=this.modules.indexOf(a);if(c<s&&c>-1&&(this.modules.splice(c,1),s--,c=-1),c==-1){if(this.modules.splice(s++,0,a),r)for(let u=0;u<a.rules.length;u++)r.insertRule(a.rules[u],o++)}else{for(;s<c;)o+=this.modules[s++].rules.length;o+=a.rules.length,s++}}if(!r){let l="";for(let a=0;a<this.modules.length;a++)l+=this.modules[a].getRules()+`
`;this.styleTag.textContent=l}}}var base={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shift={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},chrome$1=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent),mac=typeof navigator<"u"&&/Mac/.test(navigator.platform),ie$1=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),brokenModifierNames=mac||chrome$1&&+chrome$1[1]<57;for(var i=0;i<10;i++)base[48+i]=base[96+i]=String(i);for(var i=1;i<=24;i++)base[i+111]="F"+i;for(var i=65;i<=90;i++)base[i]=String.fromCharCode(i+32),shift[i]=String.fromCharCode(i);for(var code in base)shift.hasOwnProperty(code)||(shift[code]=base[code]);function keyName(n){var e=brokenModifierNames&&(n.ctrlKey||n.altKey||n.metaKey)||ie$1&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",r=!e&&n.key||(n.shiftKey?shift:base)[n.keyCode]||n.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}function getSelection(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function contains(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function deepActiveElement(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function hasSelection(n,e){if(!e.anchorNode)return!1;try{return contains(n,e.anchorNode)}catch{return!1}}function clientRectsFor(n){return n.nodeType==3?textRange(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function isEquivalentPosition(n,e,r,o){return r?scanFor(n,e,r,o,-1)||scanFor(n,e,r,o,1):!1}function domIndex(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function scanFor(n,e,r,o,s){for(;;){if(n==r&&e==o)return!0;if(e==(s<0?0:maxOffset(n))){if(n.nodeName=="DIV")return!1;let l=n.parentNode;if(!l||l.nodeType!=1)return!1;e=domIndex(n)+(s<0?0:1),n=l}else if(n.nodeType==1){if(n=n.childNodes[e+(s<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=s<0?maxOffset(n):0}else return!1}}function maxOffset(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}const Rect0={left:0,right:0,top:0,bottom:0};function flattenRect(n,e){let r=e?n.left:n.right;return{left:r,right:r,top:n.top,bottom:n.bottom}}function windowRect(n){return{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function scrollRectIntoView(n,e,r,o,s,l,a,c){let u=n.ownerDocument,f=u.defaultView||window;for(let d=n;d;)if(d.nodeType==1){let g,m=d==u.body;if(m)g=windowRect(f);else{if(d.scrollHeight<=d.clientHeight&&d.scrollWidth<=d.clientWidth){d=d.assignedSlot||d.parentNode;continue}let k=d.getBoundingClientRect();g={left:k.left,right:k.left+d.clientWidth,top:k.top,bottom:k.top+d.clientHeight}}let v=0,b=0;if(s=="nearest")e.top<g.top?(b=-(g.top-e.top+a),r>0&&e.bottom>g.bottom+b&&(b=e.bottom-g.bottom+b+a)):e.bottom>g.bottom&&(b=e.bottom-g.bottom+a,r<0&&e.top-b<g.top&&(b=-(g.top+b-e.top+a)));else{let k=e.bottom-e.top,A=g.bottom-g.top;b=(s=="center"&&k<=A?e.top+k/2-A/2:s=="start"||s=="center"&&r<0?e.top-a:e.bottom-A+a)-g.top}if(o=="nearest"?e.left<g.left?(v=-(g.left-e.left+l),r>0&&e.right>g.right+v&&(v=e.right-g.right+v+l)):e.right>g.right&&(v=e.right-g.right+l,r<0&&e.left<g.left+v&&(v=-(g.left+v-e.left+l))):v=(o=="center"?e.left+(e.right-e.left)/2-(g.right-g.left)/2:o=="start"==c?e.left-l:e.right-(g.right-g.left)+l)-g.left,v||b)if(m)f.scrollBy(v,b);else{let k=0,A=0;if(b){let R=d.scrollTop;d.scrollTop+=b,A=d.scrollTop-R}if(v){let R=d.scrollLeft;d.scrollLeft+=v,k=d.scrollLeft-R}e={left:e.left-k,top:e.top-A,right:e.right-k,bottom:e.bottom-A},k&&Math.abs(k-v)<1&&(o="nearest"),A&&Math.abs(A-b)<1&&(s="nearest")}if(m)break;d=d.assignedSlot||d.parentNode}else if(d.nodeType==11)d=d.host;else break}function scrollableParent(n){let e=n.ownerDocument;for(let r=n.parentNode;r&&r!=e.body;)if(r.nodeType==1){if(r.scrollHeight>r.clientHeight||r.scrollWidth>r.clientWidth)return r;r=r.assignedSlot||r.parentNode}else if(r.nodeType==11)r=r.host;else break;return null}class DOMSelectionState{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){this.set(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)}set(e,r,o,s){this.anchorNode=e,this.anchorOffset=r,this.focusNode=o,this.focusOffset=s}}let preventScrollSupported=null;function focusPreventScroll(n){if(n.setActive)return n.setActive();if(preventScrollSupported)return n.focus(preventScrollSupported);let e=[];for(let r=n;r&&(e.push(r,r.scrollTop,r.scrollLeft),r!=r.ownerDocument);r=r.parentNode);if(n.focus(preventScrollSupported==null?{get preventScroll(){return preventScrollSupported={preventScroll:!0},!0}}:void 0),!preventScrollSupported){preventScrollSupported=!1;for(let r=0;r<e.length;){let o=e[r++],s=e[r++],l=e[r++];o.scrollTop!=s&&(o.scrollTop=s),o.scrollLeft!=l&&(o.scrollLeft=l)}}}let scratchRange;function textRange(n,e,r=e){let o=scratchRange||(scratchRange=document.createRange());return o.setEnd(n,r),o.setStart(n,e),o}function dispatchKey(n,e,r){let o={key:e,code:e,keyCode:r,which:r,cancelable:!0},s=new KeyboardEvent("keydown",o);s.synthetic=!0,n.dispatchEvent(s);let l=new KeyboardEvent("keyup",o);return l.synthetic=!0,n.dispatchEvent(l),s.defaultPrevented||l.defaultPrevented}function getRoot(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function clearAttributes(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function atElementStart(n,e){let r=e.focusNode,o=e.focusOffset;if(!r||e.anchorNode!=r||e.anchorOffset!=o)return!1;for(;;)if(o){if(r.nodeType!=1)return!1;let s=r.childNodes[o-1];s.contentEditable=="false"?o--:(r=s,o=maxOffset(r))}else{if(r==n)return!0;o=domIndex(r),r=r.parentNode}}class DOMPos{constructor(e,r,o=!0){this.node=e,this.offset=r,this.precise=o}static before(e,r){return new DOMPos(e.parentNode,domIndex(e),r)}static after(e,r){return new DOMPos(e.parentNode,domIndex(e)+1,r)}}const noChildren=[];class ContentView{constructor(){this.parent=null,this.dom=null,this.dirty=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let r=this.posAtStart;for(let o of this.children){if(o==e)return r;r+=o.length+o.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}coordsAt(e,r){return null}sync(e,r){if(this.dirty&2){let o=this.dom,s=null,l;for(let a of this.children){if(a.dirty){if(!a.dom&&(l=s?s.nextSibling:o.firstChild)){let c=ContentView.get(l);(!c||!c.parent&&c.canReuseDOM(a))&&a.reuseDOM(l)}a.sync(e,r),a.dirty=0}if(l=s?s.nextSibling:o.firstChild,r&&!r.written&&r.node==o&&l!=a.dom&&(r.written=!0),a.dom.parentNode==o)for(;l&&l!=a.dom;)l=rm$1(l);else o.insertBefore(a.dom,l);s=a.dom}for(l=s?s.nextSibling:o.firstChild,l&&r&&r.node==o&&(r.written=!0);l;)l=rm$1(l)}else if(this.dirty&1)for(let o of this.children)o.dirty&&(o.sync(e,r),o.dirty=0)}reuseDOM(e){}localPosFromDOM(e,r){let o;if(e==this.dom)o=this.dom.childNodes[r];else{let s=maxOffset(e)==0?0:r==0?-1:1;for(;;){let l=e.parentNode;if(l==this.dom)break;s==0&&l.firstChild!=l.lastChild&&(e==l.firstChild?s=-1:s=1),e=l}s<0?o=e:o=e.nextSibling}if(o==this.dom.firstChild)return 0;for(;o&&!ContentView.get(o);)o=o.nextSibling;if(!o)return this.length;for(let s=0,l=0;;s++){let a=this.children[s];if(a.dom==o)return l;l+=a.length+a.breakAfter}}domBoundsAround(e,r,o=0){let s=-1,l=-1,a=-1,c=-1;for(let u=0,f=o,d=o;u<this.children.length;u++){let g=this.children[u],m=f+g.length;if(f<e&&m>r)return g.domBoundsAround(e,r,f);if(m>=e&&s==-1&&(s=u,l=f),f>r&&g.dom.parentNode==this.dom){a=u,c=d;break}d=m,f=m+g.breakAfter}return{from:l,to:c<0?o+this.length:c,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:a<this.children.length&&a>=0?this.children[a].dom:null}}markDirty(e=!1){this.dirty|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let r=this.parent;r;r=r.parent){if(e&&(r.dirty|=2),r.dirty&1)return;r.dirty|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let r=e.parent;if(!r)return e;e=r}}replaceChildren(e,r,o=noChildren){this.markDirty();for(let s=e;s<r;s++){let l=this.children[s];l.parent==this&&l.destroy()}this.children.splice(e,r-e,...o);for(let s=0;s<o.length;s++)o[s].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new ChildCursor(this.children,e,this.children.length)}childPos(e,r=1){return this.childCursor().findPos(e,r)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,r,o,s,l,a){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor}getSide(){return 0}destroy(){this.parent=null}}ContentView.prototype.breakAfter=0;function rm$1(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class ChildCursor{constructor(e,r,o){this.children=e,this.pos=r,this.i=o,this.off=0}findPos(e,r=1){for(;;){if(e>this.pos||e==this.pos&&(r>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let o=this.children[--this.i];this.pos-=o.length+o.breakAfter}}}function replaceRange(n,e,r,o,s,l,a,c,u){let{children:f}=n,d=f.length?f[e]:null,g=l.length?l[l.length-1]:null,m=g?g.breakAfter:a;if(!(e==o&&d&&!a&&!m&&l.length<2&&d.merge(r,s,l.length?g:null,r==0,c,u))){if(o<f.length){let v=f[o];v&&s<v.length?(e==o&&(v=v.split(s),s=0),!m&&g&&v.merge(0,s,g,!0,0,u)?l[l.length-1]=v:(s&&v.merge(0,s,null,!1,0,u),l.push(v))):v!=null&&v.breakAfter&&(g?g.breakAfter=1:a=1),o++}for(d&&(d.breakAfter=a,r>0&&(!a&&l.length&&d.merge(r,d.length,l[0],!1,c,0)?d.breakAfter=l.shift().breakAfter:(r<d.length||d.children.length&&d.children[d.children.length-1].length==0)&&d.merge(r,d.length,null,!1,c,0),e++));e<o&&l.length;)if(f[o-1].become(l[l.length-1]))o--,l.pop(),u=l.length?0:c;else if(f[e].become(l[0]))e++,l.shift(),c=l.length?0:u;else break;!l.length&&e&&o<f.length&&!f[e-1].breakAfter&&f[o].merge(0,0,f[e-1],!1,c,u)&&e--,(e<o||l.length)&&n.replaceChildren(e,o,l)}}function mergeChildrenInto(n,e,r,o,s,l){let a=n.childCursor(),{i:c,off:u}=a.findPos(r,1),{i:f,off:d}=a.findPos(e,-1),g=e-r;for(let m of o)g+=m.length;n.length+=g,replaceRange(n,f,d,c,u,o,0,s,l)}let nav=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},doc=typeof document<"u"?document:{documentElement:{style:{}}};const ie_edge=/Edge\/(\d+)/.exec(nav.userAgent),ie_upto10=/MSIE \d/.test(nav.userAgent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nav.userAgent),ie=!!(ie_upto10||ie_11up||ie_edge),gecko=!ie&&/gecko\/(\d+)/i.test(nav.userAgent),chrome=!ie&&/Chrome\/(\d+)/.exec(nav.userAgent),webkit="webkitFontSmoothing"in doc.documentElement.style,safari=!ie&&/Apple Computer/.test(nav.vendor),ios=safari&&(/Mobile\/\w+/.test(nav.userAgent)||nav.maxTouchPoints>2);var browser={mac:ios||/Mac/.test(nav.platform),windows:/Win/.test(nav.platform),linux:/Linux|X11/.test(nav.platform),ie,ie_version:ie_upto10?doc.documentMode||6:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko,gecko_version:gecko?+(/Firefox\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,chrome:!!chrome,chrome_version:chrome?+chrome[1]:0,ios,android:/Android\b/.test(nav.userAgent),webkit,safari,webkit_version:webkit?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:doc.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const MaxJoinLen=256;class TextView extends ContentView{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,r){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(r&&r.node==this.dom&&(r.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,r,o){return o&&(!(o instanceof TextView)||this.length-(r-e)+o.length>MaxJoinLen)?!1:(this.text=this.text.slice(0,e)+(o?o.text:"")+this.text.slice(r),this.markDirty(),!0)}split(e){let r=new TextView(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),r}localPosFromDOM(e,r){return e==this.dom?r:r?this.text.length:0}domAtPos(e){return new DOMPos(this.dom,e)}domBoundsAround(e,r,o){return{from:o,to:o+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,r){return textCoords(this.dom,e,r)}}class MarkView extends ContentView{constructor(e,r=[],o=0){super(),this.mark=e,this.children=r,this.length=o;for(let s of r)s.setParent(this)}setAttrs(e){if(clearAttributes(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let r in this.mark.attrs)e.setAttribute(r,this.mark.attrs[r]);return e}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6)}sync(e,r){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,r)}merge(e,r,o,s,l,a){return o&&(!(o instanceof MarkView&&o.mark.eq(this.mark))||e&&l<=0||r<this.length&&a<=0)?!1:(mergeChildrenInto(this,e,r,o?o.children:[],l-1,a-1),this.markDirty(),!0)}split(e){let r=[],o=0,s=-1,l=0;for(let c of this.children){let u=o+c.length;u>e&&r.push(o<e?c.split(e-o):c),s<0&&o>=e&&(s=l),o=u,l++}let a=this.length-e;return this.length=e,s>-1&&(this.children.length=s,this.markDirty()),new MarkView(this.mark,r,a)}domAtPos(e){return inlineDOMAtPos(this,e)}coordsAt(e,r){return coordsInChildren(this,e,r)}}function textCoords(n,e,r){let o=n.nodeValue.length;e>o&&(e=o);let s=e,l=e,a=0;e==0&&r<0||e==o&&r>=0?browser.chrome||browser.gecko||(e?(s--,a=1):l<o&&(l++,a=-1)):r<0?s--:l<o&&l++;let c=textRange(n,s,l).getClientRects();if(!c.length)return Rect0;let u=c[(a?a<0:r>=0)?0:c.length-1];return browser.safari&&!a&&u.width==0&&(u=Array.prototype.find.call(c,f=>f.width)||u),a?flattenRect(u,a<0):u||null}class WidgetView extends ContentView{constructor(e,r,o){super(),this.widget=e,this.length=r,this.side=o,this.prevWidget=null}static create(e,r,o){return new(e.customView||WidgetView)(e,r,o)}split(e){let r=WidgetView.create(this.widget,this.length-e,this.side);return this.length-=e,r}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,r,o,s,l,a){return o&&(!(o instanceof WidgetView)||!this.widget.compare(o.widget)||e>0&&l<=0||r<this.length&&a<=0)?!1:(this.length=e+(o?o.length:0)+(this.length-r),!0)}become(e){return e.length==this.length&&e instanceof WidgetView&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Text.empty;let e=this;for(;e.parent;)e=e.parent;let{view:r}=e,o=r&&r.state.doc,s=this.posAtStart;return o?o.slice(s,s+this.length):Text.empty}domAtPos(e){return(this.length?e==0:this.side>0)?DOMPos.before(this.dom):DOMPos.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,r){let o=this.dom.getClientRects(),s=null;if(!o.length)return Rect0;for(let l=e>0?o.length-1:0;s=o[l],!(e>0?l==0:l==o.length-1||s.top<s.bottom);l+=e>0?-1:1);return this.length?s:flattenRect(s,this.side>0)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class CompositionView extends WidgetView{domAtPos(e){let{topView:r,text:o}=this.widget;return r?scanCompositionTree(e,0,r,o,(s,l)=>s.domAtPos(l),s=>new DOMPos(o,Math.min(s,o.nodeValue.length))):new DOMPos(o,Math.min(e,o.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(e,r){let{topView:o,text:s}=this.widget;return o?posFromDOMInCompositionTree(e,r,o,s):Math.min(r,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(e,r){let{topView:o,text:s}=this.widget;return o?scanCompositionTree(e,r,o,s,(l,a,c)=>l.coordsAt(a,c),(l,a)=>textCoords(s,l,a)):textCoords(s,e,r)}destroy(){var e;super.destroy(),(e=this.widget.topView)===null||e===void 0||e.destroy()}get isEditable(){return!0}canReuseDOM(){return!0}}function scanCompositionTree(n,e,r,o,s,l){if(r instanceof MarkView){for(let a=r.dom.firstChild;a;a=a.nextSibling){let c=ContentView.get(a);if(!c)return l(n,e);let u=contains(a,o),f=c.length+(u?o.nodeValue.length:0);if(n<f||n==f&&c.getSide()<=0)return u?scanCompositionTree(n,e,c,o,s,l):s(c,n,e);n-=f}return s(r,r.length,-1)}else return r.dom==o?l(n,e):s(r,n,e)}function posFromDOMInCompositionTree(n,e,r,o){if(r instanceof MarkView){let s=0;for(let l of r.children){let a=contains(l.dom,o);if(contains(l.dom,n))return s+(a?posFromDOMInCompositionTree(n,e,l,o):l.localPosFromDOM(n,e));s+=a?o.nodeValue.length:l.length}}else if(r.dom==o)return Math.min(e,o.nodeValue.length);return r.localPosFromDOM(n,e)}class WidgetBufferView extends ContentView{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof WidgetBufferView&&e.side==this.side}split(){return new WidgetBufferView(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?DOMPos.before(this.dom):DOMPos.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){let r=this.dom.getBoundingClientRect(),o=inlineSiblingRect(this,this.side>0?-1:1);return o&&o.top<r.bottom&&o.bottom>r.top?{left:r.left,right:r.right,top:o.top,bottom:o.bottom}:r}get overrideDOMText(){return Text.empty}get isHidden(){return!0}}TextView.prototype.children=WidgetView.prototype.children=WidgetBufferView.prototype.children=noChildren;function inlineSiblingRect(n,e){let r=n.parent,o=r?r.children.indexOf(n):-1;for(;r&&o>=0;)if(e<0?o>0:o<r.children.length){let s=r.children[o+e];if(s instanceof TextView){let l=s.coordsAt(e<0?s.length:0,e);if(l)return l}o+=e}else if(r instanceof MarkView&&r.parent)o=r.parent.children.indexOf(r)+(e<0?0:1),r=r.parent;else{let s=r.dom.lastChild;if(s&&s.nodeName=="BR")return s.getClientRects()[0];break}}function inlineDOMAtPos(n,e){let r=n.dom,{children:o}=n,s=0;for(let l=0;s<o.length;s++){let a=o[s],c=l+a.length;if(!(c==l&&a.getSide()<=0)){if(e>l&&e<c&&a.dom.parentNode==r)return a.domAtPos(e-l);if(e<=l)break;l=c}}for(let l=s;l>0;l--){let a=o[l-1];if(a.dom.parentNode==r)return a.domAtPos(a.length)}for(let l=s;l<o.length;l++){let a=o[l];if(a.dom.parentNode==r)return a.domAtPos(0)}return new DOMPos(r,0)}function joinInlineInto(n,e,r){let o,{children:s}=n;r>0&&e instanceof MarkView&&s.length&&(o=s[s.length-1])instanceof MarkView&&o.mark.eq(e.mark)?joinInlineInto(o,e.children[0],r-1):(s.push(e),e.setParent(n)),n.length+=e.length}function coordsInChildren(n,e,r){let o=null,s=-1,l=null,a=-1;function c(f,d){for(let g=0,m=0;g<f.children.length&&m<=d;g++){let v=f.children[g],b=m+v.length;b>=d&&(v.children.length?c(v,d-m):(!l||l instanceof WidgetBufferView&&r>0)&&(b>d||m==b&&v.getSide()>0)?(l=v,a=d-m):(m<d||m==b&&v.getSide()<0)&&(o=v,s=d-m)),m=b}}c(n,e);let u=(r<0?o:l)||o||l;return u?u.coordsAt(Math.max(0,u==o?s:a),r):fallbackRect(n)}function fallbackRect(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let r=clientRectsFor(e);return r[r.length-1]||null}function combineAttrs(n,e){for(let r in n)r=="class"&&e.class?e.class+=" "+n.class:r=="style"&&e.style?e.style+=";"+n.style:e[r]=n[r];return e}function attrsEq(n,e){if(n==e)return!0;if(!n||!e)return!1;let r=Object.keys(n),o=Object.keys(e);if(r.length!=o.length)return!1;for(let s of r)if(o.indexOf(s)==-1||n[s]!==e[s])return!1;return!0}function updateAttrs(n,e,r){let o=null;if(e)for(let s in e)r&&s in r||n.removeAttribute(o=s);if(r)for(let s in r)e&&e[s]==r[s]||n.setAttribute(o=s,r[s]);return!!o}class WidgetType{eq(e){return!1}updateDOM(e,r){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}ignoreEvent(e){return!0}get customView(){return null}get isHidden(){return!1}destroy(e){}}var BlockType=function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n}(BlockType||(BlockType={}));class Decoration extends RangeValue{constructor(e,r,o,s){super(),this.startSide=e,this.endSide=r,this.widget=o,this.spec=s}get heightRelevant(){return!1}static mark(e){return new MarkDecoration(e)}static widget(e){let r=e.side||0,o=!!e.block;return r+=o?r>0?3e8:-4e8:r>0?1e8:-1e8,new PointDecoration(e,r,r,o,e.widget||null,!1)}static replace(e){let r=!!e.block,o,s;if(e.isBlockGap)o=-5e8,s=4e8;else{let{start:l,end:a}=getInclusive(e,r);o=(l?r?-3e8:-1:5e8)-1,s=(a?r?2e8:1:-6e8)+1}return new PointDecoration(e,o,s,r,e.widget||null,!0)}static line(e){return new LineDecoration(e)}static set(e,r=!1){return RangeSet.of(e,r)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Decoration.none=RangeSet.empty;class MarkDecoration extends Decoration{constructor(e){let{start:r,end:o}=getInclusive(e);super(r?-1:5e8,o?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){return this==e||e instanceof MarkDecoration&&this.tagName==e.tagName&&this.class==e.class&&attrsEq(this.attrs,e.attrs)}range(e,r=e){if(e>=r)throw new RangeError("Mark decorations may not be empty");return super.range(e,r)}}MarkDecoration.prototype.point=!1;class LineDecoration extends Decoration{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof LineDecoration&&this.spec.class==e.spec.class&&attrsEq(this.spec.attributes,e.spec.attributes)}range(e,r=e){if(r!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,r)}}LineDecoration.prototype.mapMode=MapMode.TrackBefore;LineDecoration.prototype.point=!0;class PointDecoration extends Decoration{constructor(e,r,o,s,l,a){super(r,o,l,e),this.block=s,this.isReplace=a,this.mapMode=s?r<=0?MapMode.TrackBefore:MapMode.TrackAfter:MapMode.TrackDel}get type(){return this.startSide<this.endSide?BlockType.WidgetRange:this.startSide<=0?BlockType.WidgetBefore:BlockType.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof PointDecoration&&widgetsEq(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,r=e){if(this.isReplace&&(e>r||e==r&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&r!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,r)}}PointDecoration.prototype.point=!0;function getInclusive(n,e=!1){let{inclusiveStart:r,inclusiveEnd:o}=n;return r==null&&(r=n.inclusive),o==null&&(o=n.inclusive),{start:r??e,end:o??e}}function widgetsEq(n,e){return n==e||!!(n&&e&&n.compare(e))}function addRange(n,e,r,o=0){let s=r.length-1;s>=0&&r[s]+o>=n?r[s]=Math.max(r[s],e):r.push(n,e)}class LineView extends ContentView{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,r,o,s,l,a){if(o){if(!(o instanceof LineView))return!1;this.dom||o.transferDOM(this)}return s&&this.setDeco(o?o.attrs:null),mergeChildrenInto(this,e,r,o?o.children:[],l,a),!0}split(e){let r=new LineView;if(r.breakAfter=this.breakAfter,this.length==0)return r;let{i:o,off:s}=this.childPos(e);s&&(r.append(this.children[o].split(s),0),this.children[o].merge(s,this.children[o].length,null,!1,0,0),o++);for(let l=o;l<this.children.length;l++)r.append(this.children[l],0);for(;o>0&&this.children[o-1].length==0;)this.children[--o].destroy();return this.children.length=o,this.markDirty(),this.length=e,r}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){attrsEq(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,r){joinInlineInto(this,e,r)}addLineDeco(e){let r=e.spec.attributes,o=e.spec.class;r&&(this.attrs=combineAttrs(r,this.attrs||{})),o&&(this.attrs=combineAttrs({class:o},this.attrs||{}))}domAtPos(e){return inlineDOMAtPos(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.dirty|=6)}sync(e,r){var o;this.dom?this.dirty&4&&(clearAttributes(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(updateAttrs(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,r);let s=this.dom.lastChild;for(;s&&ContentView.get(s)instanceof MarkView;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((o=ContentView.get(s))===null||o===void 0?void 0:o.isEditable)==!1&&(!browser.ios||!this.children.some(l=>l instanceof TextView))){let l=document.createElement("BR");l.cmIgnore=!0,this.dom.appendChild(l)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,r;for(let o of this.children){if(!(o instanceof TextView)||/[^ -~]/.test(o.text))return null;let s=clientRectsFor(o.dom);if(s.length!=1)return null;e+=s[0].width,r=s[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:r}:null}coordsAt(e,r){let o=coordsInChildren(this,e,r);if(!this.children.length&&o&&this.parent){let{heightOracle:s}=this.parent.view.viewState,l=o.bottom-o.top;if(Math.abs(l-s.lineHeight)<2&&s.textHeight<l){let a=(l-s.textHeight)/2;return{top:o.top+a,bottom:o.bottom-a,left:o.left,right:o.left}}}return o}become(e){return!1}get type(){return BlockType.Text}static find(e,r){for(let o=0,s=0;o<e.children.length;o++){let l=e.children[o],a=s+l.length;if(a>=r){if(l instanceof LineView)return l;if(a>r)break}s=a+l.breakAfter}return null}}class BlockWidgetView extends ContentView{constructor(e,r,o){super(),this.widget=e,this.length=r,this.type=o,this.breakAfter=0,this.prevWidget=null}merge(e,r,o,s,l,a){return o&&(!(o instanceof BlockWidgetView)||!this.widget.compare(o.widget)||e>0&&l<=0||r<this.length&&a<=0)?!1:(this.length=e+(o?o.length:0)+(this.length-r),!0)}domAtPos(e){return e==0?DOMPos.before(this.dom):DOMPos.after(this.dom,e==this.length)}split(e){let r=this.length-e;this.length=e;let o=new BlockWidgetView(this.widget,r,this.type);return o.breakAfter=this.breakAfter,o}get children(){return noChildren}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Text.empty}domBoundsAround(){return null}become(e){return e instanceof BlockWidgetView&&e.type==this.type&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class ContentBuilder{constructor(e,r,o,s){this.doc=e,this.pos=r,this.end=o,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=r}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof BlockWidgetView&&e.type==BlockType.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new LineView),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(wrapMarks(new WidgetBufferView(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine()}buildText(e,r,o){for(;e>0;){if(this.textOff==this.text.length){let{value:l,lineBreak:a,done:c}=this.cursor.next(this.skip);if(this.skip=0,c)throw new Error("Ran out of text content when drawing inline views");if(a){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=l,this.textOff=0}let s=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(r.slice(r.length-o)),this.getLine().append(wrapMarks(new TextView(this.text.slice(this.textOff,this.textOff+s)),r),o),this.atCursorPos=!0,this.textOff+=s,e-=s,o=0}}span(e,r,o,s){this.buildText(r-e,o,s),this.pos=r,this.openStart<0&&(this.openStart=s)}point(e,r,o,s,l,a){if(this.disallowBlockEffectsFor[a]&&o instanceof PointDecoration){if(o.block)throw new RangeError("Block decorations may not be specified via plugins");if(r>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let c=r-e;if(o instanceof PointDecoration)if(o.block){let{type:u}=o;u==BlockType.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new BlockWidgetView(o.widget||new NullWidget("div"),c,u))}else{let u=WidgetView.create(o.widget||new NullWidget("span"),c,c?0:o.startSide),f=this.atCursorPos&&!u.isEditable&&l<=s.length&&(e<r||o.startSide>0),d=!u.isEditable&&(e<r||l>s.length||o.startSide<=0),g=this.getLine();this.pendingBuffer==2&&!f&&!u.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),f&&(g.append(wrapMarks(new WidgetBufferView(1),s),l),l=s.length+Math.max(0,l-s.length)),g.append(wrapMarks(u,s),l),this.atCursorPos=d,this.pendingBuffer=d?e<r||l>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(o);c&&(this.textOff+c<=this.text.length?this.textOff+=c:(this.skip+=c-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=r),this.openStart<0&&(this.openStart=l)}static build(e,r,o,s,l){let a=new ContentBuilder(e,r,o,l);return a.openEnd=RangeSet.spans(s,r,o,a),a.openStart<0&&(a.openStart=a.openEnd),a.finish(a.openEnd),a}}function wrapMarks(n,e){for(let r of e)n=new MarkView(r,[n],n.length);return n}class NullWidget extends WidgetType{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}const clickAddsSelectionRange=Facet.define(),dragMovesSelection$1=Facet.define(),mouseSelectionStyle=Facet.define(),exceptionSink=Facet.define(),updateListener=Facet.define(),inputHandler$1=Facet.define(),focusChangeEffect=Facet.define(),perLineTextDirection=Facet.define({combine:n=>n.some(e=>e)}),nativeSelectionHidden=Facet.define({combine:n=>n.some(e=>e)});class ScrollTarget{constructor(e,r="nearest",o="nearest",s=5,l=5){this.range=e,this.y=r,this.x=o,this.yMargin=s,this.xMargin=l}map(e){return e.empty?this:new ScrollTarget(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const scrollIntoView$1=StateEffect.define({map:(n,e)=>n.map(e)});function logException(n,e,r){let o=n.facet(exceptionSink);o.length?o[0](e):window.onerror?window.onerror(String(e),r,void 0,void 0,e):r?console.error(r+":",e):console.error(e)}const editable=Facet.define({combine:n=>n.length?n[0]:!0});let nextPluginID=0;const viewPlugin=Facet.define();class ViewPlugin{constructor(e,r,o,s){this.id=e,this.create=r,this.domEventHandlers=o,this.extension=s(this)}static define(e,r){const{eventHandlers:o,provide:s,decorations:l}=r||{};return new ViewPlugin(nextPluginID++,e,o,a=>{let c=[viewPlugin.of(a)];return l&&c.push(decorations.of(u=>{let f=u.plugin(a);return f?l(f):Decoration.none})),s&&c.push(s(a)),c})}static fromClass(e,r){return ViewPlugin.define(o=>new e(o),r)}}class PluginInstance{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let r=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(r)}catch(o){if(logException(r.state,o,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(r){logException(e.state,r,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var r;if(!((r=this.value)===null||r===void 0)&&r.destroy)try{this.value.destroy()}catch(o){logException(e.state,o,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const editorAttributes=Facet.define(),contentAttributes=Facet.define(),decorations=Facet.define(),atomicRanges=Facet.define(),scrollMargins=Facet.define(),styleModule=Facet.define();class ChangedRange{constructor(e,r,o,s){this.fromA=e,this.toA=r,this.fromB=o,this.toB=s}join(e){return new ChangedRange(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let r=e.length,o=this;for(;r>0;r--){let s=e[r-1];if(!(s.fromA>o.toA)){if(s.toA<o.fromA)break;o=o.join(s),e.splice(r-1,1)}}return e.splice(r,0,o),e}static extendWithRanges(e,r){if(r.length==0)return e;let o=[];for(let s=0,l=0,a=0,c=0;;s++){let u=s==e.length?null:e[s],f=a-c,d=u?u.fromB:1e9;for(;l<r.length&&r[l]<d;){let g=r[l],m=r[l+1],v=Math.max(c,g),b=Math.min(d,m);if(v<=b&&new ChangedRange(v+f,b+f,v,b).addToSet(o),m>d)break;l+=2}if(!u)return o;new ChangedRange(u.fromA,u.toA,u.fromB,u.toB).addToSet(o),a=u.toA,c=u.toB}}}class ViewUpdate{constructor(e,r,o){this.view=e,this.state=r,this.transactions=o,this.flags=0,this.startState=e.state,this.changes=ChangeSet.empty(this.startState.doc.length);for(let l of o)this.changes=this.changes.compose(l.changes);let s=[];this.changes.iterChangedRanges((l,a,c,u)=>s.push(new ChangedRange(l,a,c,u))),this.changedRanges=s}static create(e,r,o){return new ViewUpdate(e,r,o)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var Direction=function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n}(Direction||(Direction={}));const LTR=Direction.LTR,RTL=Direction.RTL;function dec(n){let e=[];for(let r=0;r<n.length;r++)e.push(1<<+n[r]);return e}const LowTypes=dec("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ArabicTypes=dec("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Brackets=Object.create(null),BracketStack=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),r=n.charCodeAt(1);Brackets[e]=r,Brackets[r]=-e}function charType(n){return n<=247?LowTypes[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?ArabicTypes[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8203?256:64336<=n&&n<=65023?4:n==8204?256:1}const BidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class BidiSpan{constructor(e,r,o){this.from=e,this.to=r,this.level=o}get dir(){return this.level%2?RTL:LTR}side(e,r){return this.dir==r==e?this.to:this.from}static find(e,r,o,s){let l=-1;for(let a=0;a<e.length;a++){let c=e[a];if(c.from<=r&&c.to>=r){if(c.level==o)return a;(l<0||(s!=0?s<0?c.from<r:c.to>r:e[l].level>c.level))&&(l=a)}}if(l<0)throw new RangeError("Index out of range");return l}}const types=[];function computeOrder(n,e){let r=n.length,o=e==LTR?1:2,s=e==LTR?2:1;if(!n||o==1&&!BidiRE.test(n))return trivialOrder(r);for(let a=0,c=o,u=o;a<r;a++){let f=charType(n.charCodeAt(a));f==512?f=c:f==8&&u==4&&(f=16),types[a]=f==4?2:f,f&7&&(u=f),c=f}for(let a=0,c=o,u=o;a<r;a++){let f=types[a];if(f==128)a<r-1&&c==types[a+1]&&c&24?f=types[a]=c:types[a]=256;else if(f==64){let d=a+1;for(;d<r&&types[d]==64;)d++;let g=a&&c==8||d<r&&types[d]==8?u==1?1:8:256;for(let m=a;m<d;m++)types[m]=g;a=d-1}else f==8&&u==1&&(types[a]=1);c=f,f&7&&(u=f)}for(let a=0,c=0,u=0,f,d,g;a<r;a++)if(d=Brackets[f=n.charCodeAt(a)])if(d<0){for(let m=c-3;m>=0;m-=3)if(BracketStack[m+1]==-d){let v=BracketStack[m+2],b=v&2?o:v&4?v&1?s:o:0;b&&(types[a]=types[BracketStack[m]]=b),c=m;break}}else{if(BracketStack.length==189)break;BracketStack[c++]=a,BracketStack[c++]=f,BracketStack[c++]=u}else if((g=types[a])==2||g==1){let m=g==o;u=m?0:1;for(let v=c-3;v>=0;v-=3){let b=BracketStack[v+2];if(b&2)break;if(m)BracketStack[v+2]|=2;else{if(b&4)break;BracketStack[v+2]|=4}}}for(let a=0;a<r;a++)if(types[a]==256){let c=a+1;for(;c<r&&types[c]==256;)c++;let u=(a?types[a-1]:o)==1,f=(c<r?types[c]:o)==1,d=u==f?u?1:2:o;for(let g=a;g<c;g++)types[g]=d;a=c-1}let l=[];if(o==1)for(let a=0;a<r;){let c=a,u=types[a++]!=1;for(;a<r&&u==(types[a]!=1);)a++;if(u)for(let f=a;f>c;){let d=f,g=types[--f]!=2;for(;f>c&&g==(types[f-1]!=2);)f--;l.push(new BidiSpan(f,d,g?2:1))}else l.push(new BidiSpan(c,a,0))}else for(let a=0;a<r;){let c=a,u=types[a++]==2;for(;a<r&&u==(types[a]==2);)a++;l.push(new BidiSpan(c,a,u?1:2))}return l}function trivialOrder(n){return[new BidiSpan(0,n,0)]}let movedOver="";function moveVisually(n,e,r,o,s){var l;let a=o.head-n.from,c=-1;if(a==0){if(!s||!n.length)return null;e[0].level!=r&&(a=e[0].side(!1,r),c=0)}else if(a==n.length){if(s)return null;let m=e[e.length-1];m.level!=r&&(a=m.side(!0,r),c=e.length-1)}c<0&&(c=BidiSpan.find(e,a,(l=o.bidiLevel)!==null&&l!==void 0?l:-1,o.assoc));let u=e[c];a==u.side(s,r)&&(u=e[c+=s?1:-1],a=u.side(!s,r));let f=s==(u.dir==r),d=findClusterBreak(n.text,a,f);if(movedOver=n.text.slice(Math.min(a,d),Math.max(a,d)),d!=u.side(s,r))return EditorSelection.cursor(d+n.from,f?-1:1,u.level);let g=c==(s?e.length-1:0)?null:e[c+(s?1:-1)];return!g&&u.level!=r?EditorSelection.cursor(s?n.to:n.from,s?-1:1,r):g&&g.level<u.level?EditorSelection.cursor(g.side(!s,r)+n.from,s?1:-1,g.level):EditorSelection.cursor(d+n.from,s?-1:1,u.level)}const LineBreakPlaceholder="";class DOMReader{constructor(e,r){this.points=e,this.text="",this.lineSeparator=r.facet(EditorState.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=LineBreakPlaceholder}readRange(e,r){if(!e)return this;let o=e.parentNode;for(let s=e;;){this.findPointBefore(o,s),this.readNode(s);let l=s.nextSibling;if(l==r)break;let a=ContentView.get(s),c=ContentView.get(l);(a&&c?a.breakAfter:(a?a.breakAfter:isBlockElement(s))||isBlockElement(l)&&(s.nodeName!="BR"||s.cmIgnore))&&this.lineBreak(),s=l}return this.findPointBefore(o,r),this}readTextNode(e){let r=e.nodeValue;for(let o of this.points)o.node==e&&(o.pos=this.text.length+Math.min(o.offset,r.length));for(let o=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let l=-1,a=1,c;if(this.lineSeparator?(l=r.indexOf(this.lineSeparator,o),a=this.lineSeparator.length):(c=s.exec(r))&&(l=c.index,a=c[0].length),this.append(r.slice(o,l<0?r.length:l)),l<0)break;if(this.lineBreak(),a>1)for(let u of this.points)u.node==e&&u.pos>this.text.length&&(u.pos-=a-1);o=l+a}}readNode(e){if(e.cmIgnore)return;let r=ContentView.get(e),o=r&&r.overrideDOMText;if(o!=null){this.findPointInside(e,o.length);for(let s=o.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,r){for(let o of this.points)o.node==e&&e.childNodes[o.offset]==r&&(o.pos=this.text.length)}findPointInside(e,r){for(let o of this.points)(e.nodeType==3?o.node==e:e.contains(o.node))&&(o.pos=this.text.length+Math.min(r,o.offset))}}function isBlockElement(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}class DOMPoint{constructor(e,r){this.node=e,this.offset=r,this.pos=-1}}class DocView extends ContentView{constructor(e){super(),this.view=e,this.compositionDeco=Decoration.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new LineView],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ChangedRange(0,0,0,e.state.doc.length)],0)}get length(){return this.view.state.doc.length}update(e){let r=e.changedRanges;this.minWidth>0&&r.length&&(r.every(({fromA:a,toA:c})=>c<this.minWidthFrom||a>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=Decoration.none:(e.transactions.length||this.dirty)&&(this.compositionDeco=computeCompositionDeco(this.view,e.changes)),(browser.ie||browser.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,s=this.updateDeco(),l=findChangedDeco(o,s,e.changes);return r=ChangedRange.extendWithRanges(r,l),this.dirty==0&&r.length==0?!1:(this.updateInner(r,e.startState.doc.length),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,r){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,r);let{observer:o}=this.view;o.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let l=browser.chrome||browser.ios?{node:o.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,l),this.dirty=0,l&&(l.written||o.selectionRange.focusNode!=l.node)&&(this.forceSelection=!0),this.dom.style.height=""});let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let l of this.children)l instanceof BlockWidgetView&&l.widget instanceof BlockGapWidget&&s.push(l.dom);o.updateGaps(s)}updateChildren(e,r){let o=this.childCursor(r);for(let s=e.length-1;;s--){let l=s>=0?e[s]:null;if(!l)break;let{fromA:a,toA:c,fromB:u,toB:f}=l,{content:d,breakAtStart:g,openStart:m,openEnd:v}=ContentBuilder.build(this.view.state.doc,u,f,this.decorations,this.dynamicDecorationMap),{i:b,off:k}=o.findPos(c,1),{i:A,off:R}=o.findPos(a,-1);replaceRange(this,A,R,b,k,d,g,m,v)}}updateSelection(e=!1,r=!1){if((e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange(),!(r||this.mayControlSelection()))return;let o=this.forceSelection;this.forceSelection=!1;let s=this.view.state.selection.main,l=this.domAtPos(s.anchor),a=s.empty?l:this.domAtPos(s.head);if(browser.gecko&&s.empty&&!this.compositionDeco.size&&betweenUneditable(l)){let u=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(u,l.node.childNodes[l.offset]||null)),l=a=new DOMPos(u,0),o=!0}let c=this.view.observer.selectionRange;(o||!c.focusNode||!isEquivalentPosition(l.node,l.offset,c.anchorNode,c.anchorOffset)||!isEquivalentPosition(a.node,a.offset,c.focusNode,c.focusOffset))&&(this.view.observer.ignore(()=>{browser.android&&browser.chrome&&this.dom.contains(c.focusNode)&&inUneditable(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let u=getSelection(this.view.root);if(u)if(s.empty){if(browser.gecko){let f=nextToUneditable(l.node,l.offset);if(f&&f!=3){let d=nearbyTextNode(l.node,l.offset,f==1?1:-1);d&&(l=new DOMPos(d,f==1?0:d.nodeValue.length))}}u.collapse(l.node,l.offset),s.bidiLevel!=null&&c.cursorBidiLevel!=null&&(c.cursorBidiLevel=s.bidiLevel)}else if(u.extend){u.collapse(l.node,l.offset);try{u.extend(a.node,a.offset)}catch{}}else{let f=document.createRange();s.anchor>s.head&&([l,a]=[a,l]),f.setEnd(a.node,a.offset),f.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(f)}}),this.view.observer.setSelectionRange(l,a)),this.impreciseAnchor=l.precise?null:new DOMPos(c.anchorNode,c.anchorOffset),this.impreciseHead=a.precise?null:new DOMPos(c.focusNode,c.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let{view:e}=this,r=e.state.selection.main,o=getSelection(e.root),{anchorNode:s,anchorOffset:l}=e.observer.selectionRange;if(!o||!r.empty||!r.assoc||!o.modify)return;let a=LineView.find(this,r.head);if(!a)return;let c=a.posAtStart;if(r.head==c||r.head==c+a.length)return;let u=this.coordsAt(r.head,-1),f=this.coordsAt(r.head,1);if(!u||!f||u.bottom>f.top)return;let d=this.domAtPos(r.head+r.assoc);o.collapse(d.node,d.offset),o.modify("move",r.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let g=e.observer.selectionRange;e.docView.posFromDOM(g.anchorNode,g.anchorOffset)!=r.from&&o.collapse(s,l)}mayControlSelection(){let e=this.view.root.activeElement;return e==this.dom||hasSelection(this.dom,this.view.observer.selectionRange)&&!(e&&this.dom.contains(e))}nearest(e){for(let r=e;r;){let o=ContentView.get(r);if(o&&o.rootView==this)return o;r=r.parentNode}return null}posFromDOM(e,r){let o=this.nearest(e);if(!o)throw new RangeError("Trying to find position for a DOM position outside of the document");return o.localPosFromDOM(e,r)+o.posAtStart}domAtPos(e){let{i:r,off:o}=this.childCursor().findPos(e,-1);for(;r<this.children.length-1;){let s=this.children[r];if(o<s.length||s instanceof LineView)break;r++,o=0}return this.children[r].domAtPos(o)}coordsAt(e,r){for(let o=this.length,s=this.children.length-1;;s--){let l=this.children[s],a=o-l.breakAfter-l.length;if(e>a||e==a&&l.type!=BlockType.WidgetBefore&&l.type!=BlockType.WidgetAfter&&(!s||r==2||this.children[s-1].breakAfter||this.children[s-1].type==BlockType.WidgetBefore&&r>-2))return l.coordsAt(e-a,r);o=a}}measureVisibleLineHeights(e){let r=[],{from:o,to:s}=e,l=this.view.contentDOM.clientWidth,a=l>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,c=-1,u=this.view.textDirection==Direction.LTR;for(let f=0,d=0;d<this.children.length;d++){let g=this.children[d],m=f+g.length;if(m>s)break;if(f>=o){let v=g.dom.getBoundingClientRect();if(r.push(v.height),a){let b=g.dom.lastChild,k=b?clientRectsFor(b):[];if(k.length){let A=k[k.length-1],R=u?A.right-v.left:v.right-A.left;R>c&&(c=R,this.minWidth=l,this.minWidthFrom=f,this.minWidthTo=m)}}}f=m+g.breakAfter}return r}textDirectionAt(e){let{i:r}=this.childPos(e,1);return getComputedStyle(this.children[r].dom).direction=="rtl"?Direction.RTL:Direction.LTR}measureTextSize(){for(let l of this.children)if(l instanceof LineView){let a=l.measureTextSize();if(a)return a}let e=document.createElement("div"),r,o,s;return e.className="cm-line",e.style.width="99999px",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let l=clientRectsFor(e.firstChild)[0];r=e.getBoundingClientRect().height,o=l?l.width/27:7,s=l?l.height:r,e.remove()}),{lineHeight:r,charWidth:o,textHeight:s}}childCursor(e=this.length){let r=this.children.length;return r&&(e-=this.children[--r].length),new ChildCursor(this.children,e,r)}computeBlockGapDeco(){let e=[],r=this.view.viewState;for(let o=0,s=0;;s++){let l=s==r.viewports.length?null:r.viewports[s],a=l?l.from-1:this.length;if(a>o){let c=r.lineBlockAt(a).bottom-r.lineBlockAt(o).top;e.push(Decoration.replace({widget:new BlockGapWidget(c),block:!0,inclusive:!0,isBlockGap:!0}).range(o,a))}if(!l)break;o=l.to+1}return Decoration.set(e)}updateDeco(){let e=this.view.state.facet(decorations).map((r,o)=>(this.dynamicDecorationMap[o]=typeof r=="function")?r(this.view):r);for(let r=e.length;r<e.length+3;r++)this.dynamicDecorationMap[r]=!1;return this.decorations=[...e,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:r}=e,o=this.coordsAt(r.head,r.empty?r.assoc:r.head>r.anchor?-1:1),s;if(!o)return;!r.empty&&(s=this.coordsAt(r.anchor,r.anchor>r.head?-1:1))&&(o={left:Math.min(o.left,s.left),top:Math.min(o.top,s.top),right:Math.max(o.right,s.right),bottom:Math.max(o.bottom,s.bottom)});let l=0,a=0,c=0,u=0;for(let d of this.view.state.facet(scrollMargins).map(g=>g(this.view)))if(d){let{left:g,right:m,top:v,bottom:b}=d;g!=null&&(l=Math.max(l,g)),m!=null&&(a=Math.max(a,m)),v!=null&&(c=Math.max(c,v)),b!=null&&(u=Math.max(u,b))}let f={left:o.left-l,top:o.top-c,right:o.right+a,bottom:o.bottom+u};scrollRectIntoView(this.view.scrollDOM,f,r.head<r.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==Direction.LTR)}}function betweenUneditable(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}class BlockGapWidget extends WidgetType{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function compositionSurroundingNode(n){let e=n.observer.selectionRange,r=e.focusNode&&nearbyTextNode(e.focusNode,e.focusOffset,0);if(!r)return null;let o=n.docView.nearest(r);if(!o)return null;if(o instanceof LineView){let s=r;for(;s.parentNode!=o.dom;)s=s.parentNode;let l=s.previousSibling;for(;l&&!ContentView.get(l);)l=l.previousSibling;let a=l?ContentView.get(l).posAtEnd:o.posAtStart;return{from:a,to:a,node:s,text:r}}else{for(;;){let{parent:l}=o;if(!l)return null;if(l instanceof LineView)break;o=l}let s=o.posAtStart;return{from:s,to:s+o.length,node:o.dom,text:r}}}function computeCompositionDeco(n,e){let r=compositionSurroundingNode(n);if(!r)return Decoration.none;let{from:o,to:s,node:l,text:a}=r,c=e.mapPos(o,1),u=Math.max(c,e.mapPos(s,-1)),{state:f}=n,d=l.nodeType==3?l.nodeValue:new DOMReader([],f).readRange(l.firstChild,null).text;if(u-c<d.length)if(f.doc.sliceString(c,Math.min(f.doc.length,c+d.length),LineBreakPlaceholder)==d)u=c+d.length;else if(f.doc.sliceString(Math.max(0,u-d.length),u,LineBreakPlaceholder)==d)c=u-d.length;else return Decoration.none;else if(f.doc.sliceString(c,u,LineBreakPlaceholder)!=d)return Decoration.none;let g=ContentView.get(l);return g instanceof CompositionView?g=g.widget.topView:g&&(g.parent=null),Decoration.set(Decoration.replace({widget:new CompositionWidget(l,a,g),inclusive:!0}).range(c,u))}class CompositionWidget extends WidgetType{constructor(e,r,o){super(),this.top=e,this.text=r,this.topView=o}eq(e){return this.top==e.top&&this.text==e.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return CompositionView}}function nearbyTextNode(n,e,r){if(r<=0)for(let o=n,s=e;;){if(o.nodeType==3)return o;if(o.nodeType==1&&s>0)o=o.childNodes[s-1],s=maxOffset(o);else break}if(r>=0)for(let o=n,s=e;;){if(o.nodeType==3)return o;if(o.nodeType==1&&s<o.childNodes.length&&r>=0)o=o.childNodes[s],s=0;else break}return null}function nextToUneditable(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}class DecorationComparator$1{constructor(){this.changes=[]}compareRange(e,r){addRange(e,r,this.changes)}comparePoint(e,r){addRange(e,r,this.changes)}}function findChangedDeco(n,e,r){let o=new DecorationComparator$1;return RangeSet.compare(n,e,r,o),o.changes}function inUneditable(n,e){for(let r=n;r&&r!=e;r=r.assignedSlot||r.parentNode)if(r.nodeType==1&&r.contentEditable=="false")return!0;return!1}function groupAt(n,e,r=1){let o=n.charCategorizer(e),s=n.doc.lineAt(e),l=e-s.from;if(s.length==0)return EditorSelection.cursor(e);l==0?r=1:l==s.length&&(r=-1);let a=l,c=l;r<0?a=findClusterBreak(s.text,l,!1):c=findClusterBreak(s.text,l);let u=o(s.text.slice(a,c));for(;a>0;){let f=findClusterBreak(s.text,a,!1);if(o(s.text.slice(f,a))!=u)break;a=f}for(;c<s.length;){let f=findClusterBreak(s.text,c);if(o(s.text.slice(c,f))!=u)break;c=f}return EditorSelection.range(a+s.from,c+s.from)}function getdx(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function getdy(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function yOverlap(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function upTop(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function upBot(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function domPosAtCoords(n,e,r){let o,s,l,a,c=!1,u,f,d,g;for(let b=n.firstChild;b;b=b.nextSibling){let k=clientRectsFor(b);for(let A=0;A<k.length;A++){let R=k[A];s&&yOverlap(s,R)&&(R=upTop(upBot(R,s.bottom),s.top));let $=getdx(e,R),J=getdy(r,R);if($==0&&J==0)return b.nodeType==3?domPosInText(b,e,r):domPosAtCoords(b,e,r);if(!o||a>J||a==J&&l>$){o=b,s=R,l=$,a=J;let _=J?r<R.top?-1:1:$?e<R.left?-1:1:0;c=!_||(_>0?A<k.length-1:A>0)}$==0?r>R.bottom&&(!d||d.bottom<R.bottom)?(u=b,d=R):r<R.top&&(!g||g.top>R.top)&&(f=b,g=R):d&&yOverlap(d,R)?d=upBot(d,R.bottom):g&&yOverlap(g,R)&&(g=upTop(g,R.top))}}if(d&&d.bottom>=r?(o=u,s=d):g&&g.top<=r&&(o=f,s=g),!o)return{node:n,offset:0};let m=Math.max(s.left,Math.min(s.right,e));if(o.nodeType==3)return domPosInText(o,m,r);if(c&&o.contentEditable!="false")return domPosAtCoords(o,m,r);let v=Array.prototype.indexOf.call(n.childNodes,o)+(e>=(s.left+s.right)/2?1:0);return{node:n,offset:v}}function domPosInText(n,e,r){let o=n.nodeValue.length,s=-1,l=1e9,a=0;for(let c=0;c<o;c++){let u=textRange(n,c,c+1).getClientRects();for(let f=0;f<u.length;f++){let d=u[f];if(d.top==d.bottom)continue;a||(a=e-d.left);let g=(d.top>r?d.top-r:r-d.bottom)-1;if(d.left-1<=e&&d.right+1>=e&&g<l){let m=e>=(d.left+d.right)/2,v=m;if((browser.chrome||browser.gecko)&&textRange(n,c).getBoundingClientRect().left==d.right&&(v=!m),g<=0)return{node:n,offset:c+(v?1:0)};s=c+(v?1:0),l=g}}}return{node:n,offset:s>-1?s:a>0?n.nodeValue.length:0}}function posAtCoords(n,e,r,o=-1){var s,l;let a=n.contentDOM.getBoundingClientRect(),c=a.top+n.viewState.paddingTop,u,{docHeight:f}=n.viewState,{x:d,y:g}=e,m=g-c;if(m<0)return 0;if(m>f)return n.state.doc.length;for(let _=n.defaultLineHeight/2,L=!1;u=n.elementAtHeight(m),u.type!=BlockType.Text;)for(;m=o>0?u.bottom+_:u.top-_,!(m>=0&&m<=f);){if(L)return r?null:0;L=!0,o=-o}g=c+m;let v=u.from;if(v<n.viewport.from)return n.viewport.from==0?0:r?null:posAtCoordsImprecise(n,a,u,d,g);if(v>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:r?null:posAtCoordsImprecise(n,a,u,d,g);let b=n.dom.ownerDocument,k=n.root.elementFromPoint?n.root:b,A=k.elementFromPoint(d,g);A&&!n.contentDOM.contains(A)&&(A=null),A||(d=Math.max(a.left+1,Math.min(a.right-1,d)),A=k.elementFromPoint(d,g),A&&!n.contentDOM.contains(A)&&(A=null));let R,$=-1;if(A&&((s=n.docView.nearest(A))===null||s===void 0?void 0:s.isEditable)!=!1){if(b.caretPositionFromPoint){let _=b.caretPositionFromPoint(d,g);_&&({offsetNode:R,offset:$}=_)}else if(b.caretRangeFromPoint){let _=b.caretRangeFromPoint(d,g);_&&({startContainer:R,startOffset:$}=_,(!n.contentDOM.contains(R)||browser.safari&&isSuspiciousSafariCaretResult(R,$,d)||browser.chrome&&isSuspiciousChromeCaretResult(R,$,d))&&(R=void 0))}}if(!R||!n.docView.dom.contains(R)){let _=LineView.find(n.docView,v);if(!_)return m>u.top+u.height/2?u.to:u.from;({node:R,offset:$}=domPosAtCoords(_.dom,d,g))}let J=n.docView.nearest(R);if(!J)return null;if(J.isWidget&&((l=J.dom)===null||l===void 0?void 0:l.nodeType)==1){let _=J.dom.getBoundingClientRect();return e.y<_.top||e.y<=_.bottom&&e.x<=(_.left+_.right)/2?J.posAtStart:J.posAtEnd}else return J.localPosFromDOM(R,$)+J.posAtStart}function posAtCoordsImprecise(n,e,r,o,s){let l=Math.round((o-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&r.height>n.defaultLineHeight*1.5){let c=Math.floor((s-r.top)/n.defaultLineHeight);l+=c*n.viewState.heightOracle.lineLength}let a=n.state.sliceDoc(r.from,r.to);return r.from+findColumn(a,l,n.state.tabSize)}function isSuspiciousSafariCaretResult(n,e,r){let o;if(n.nodeType!=3||e!=(o=n.nodeValue.length))return!1;for(let s=n.nextSibling;s;s=s.nextSibling)if(s.nodeType!=1||s.nodeName!="BR")return!1;return textRange(n,o-1,o).getBoundingClientRect().left>r}function isSuspiciousChromeCaretResult(n,e,r){if(e!=0)return!1;for(let s=n;;){let l=s.parentNode;if(!l||l.nodeType!=1||l.firstChild!=s)return!1;if(l.classList.contains("cm-line"))break;s=l}let o=n.nodeType==1?n.getBoundingClientRect():textRange(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect();return r-o.left>5}function moveToLineBoundary(n,e,r,o){let s=n.state.doc.lineAt(e.head),l=!o||!n.lineWrapping?null:n.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(l){let u=n.dom.getBoundingClientRect(),f=n.textDirectionAt(s.from),d=n.posAtCoords({x:r==(f==Direction.LTR)?u.right-1:u.left+1,y:(l.top+l.bottom)/2});if(d!=null)return EditorSelection.cursor(d,r?-1:1)}let a=LineView.find(n.docView,e.head),c=a?r?a.posAtEnd:a.posAtStart:r?s.to:s.from;return EditorSelection.cursor(c,r?-1:1)}function moveByChar(n,e,r,o){let s=n.state.doc.lineAt(e.head),l=n.bidiSpans(s),a=n.textDirectionAt(s.from);for(let c=e,u=null;;){let f=moveVisually(s,l,a,c,r),d=movedOver;if(!f){if(s.number==(r?n.state.doc.lines:1))return c;d=`
`,s=n.state.doc.line(s.number+(r?1:-1)),l=n.bidiSpans(s),f=EditorSelection.cursor(r?s.from:s.to)}if(u){if(!u(d))return c}else{if(!o)return f;u=o(d)}c=f}}function byGroup(n,e,r){let o=n.state.charCategorizer(e),s=o(r);return l=>{let a=o(l);return s==CharCategory.Space&&(s=a),s==a}}function moveVertically(n,e,r,o){let s=e.head,l=r?1:-1;if(s==(r?n.state.doc.length:0))return EditorSelection.cursor(s,e.assoc);let a=e.goalColumn,c,u=n.contentDOM.getBoundingClientRect(),f=n.coordsAtPos(s),d=n.documentTop;if(f)a==null&&(a=f.left-u.left),c=l<0?f.top:f.bottom;else{let v=n.viewState.lineBlockAt(s);a==null&&(a=Math.min(u.right-u.left,n.defaultCharacterWidth*(s-v.from))),c=(l<0?v.top:v.bottom)+d}let g=u.left+a,m=o??n.defaultLineHeight>>1;for(let v=0;;v+=10){let b=c+(m+v)*l,k=posAtCoords(n,{x:g,y:b},!1,l);if(b<u.top||b>u.bottom||(l<0?k<s:k>s))return EditorSelection.cursor(k,e.assoc,void 0,a)}}function skipAtoms(n,e,r){let o=n.state.facet(atomicRanges).map(s=>s(n));for(;;){let s=!1;for(let l of o)l.between(r.from-1,r.from+1,(a,c,u)=>{r.from>a&&r.from<c&&(r=e.head>r.from?EditorSelection.cursor(a,1):EditorSelection.cursor(c,-1),s=!0)});if(!s)return r}}class InputState{constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null;let r=(o,s)=>{this.ignoreDuringComposition(s)||s.type=="keydown"&&this.keydown(e,s)||(this.mustFlushObserver(s)&&e.observer.forceFlush(),this.runCustomHandlers(s.type,e,s)?s.preventDefault():o(e,s))};for(let o in handlers){let s=handlers[o];e.contentDOM.addEventListener(o,l=>{eventBelongsToEditor(e,l)&&r(s,l)},handlerOptions[o]),this.registeredEvents.push(o)}e.scrollDOM.addEventListener("mousedown",o=>{if(o.target==e.scrollDOM&&o.clientY>e.contentDOM.getBoundingClientRect().bottom&&(r(handlers.mousedown,o),!o.defaultPrevented&&o.button==2)){let s=e.contentDOM.style.minHeight;e.contentDOM.style.minHeight="100%",setTimeout(()=>e.contentDOM.style.minHeight=s,200)}}),browser.chrome&&browser.chrome_version==102&&e.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?e.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,e.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=e.hasFocus,browser.safari&&e.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}ensureHandlers(e,r){var o;let s;this.customHandlers=[];for(let l of r)if(s=(o=l.update(e).spec)===null||o===void 0?void 0:o.domEventHandlers){this.customHandlers.push({plugin:l.value,handlers:s});for(let a in s)this.registeredEvents.indexOf(a)<0&&a!="scroll"&&(this.registeredEvents.push(a),e.contentDOM.addEventListener(a,c=>{eventBelongsToEditor(e,c)&&this.runCustomHandlers(a,e,c)&&c.preventDefault()}))}}runCustomHandlers(e,r,o){for(let s of this.customHandlers){let l=s.handlers[e];if(l)try{if(l.call(s.plugin,o,r)||o.defaultPrevented)return!0}catch(a){logException(r.state,a)}}return!1}runScrollHandlers(e,r){this.lastScrollTop=e.scrollDOM.scrollTop,this.lastScrollLeft=e.scrollDOM.scrollLeft;for(let o of this.customHandlers){let s=o.handlers.scroll;if(s)try{s.call(o.plugin,r,e)}catch(l){logException(e.state,l)}}}keydown(e,r){if(this.lastKeyCode=r.keyCode,this.lastKeyTime=Date.now(),r.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(browser.android&&browser.chrome&&!r.synthetic&&(r.keyCode==13||r.keyCode==8))return e.observer.delayAndroidKey(r.key,r.keyCode),!0;let o;return browser.ios&&!r.synthetic&&!r.altKey&&!r.metaKey&&((o=PendingKeys.find(s=>s.keyCode==r.keyCode))&&!r.ctrlKey||EmacsyPendingKeys.indexOf(r.key)>-1&&r.ctrlKey&&!r.shiftKey)?(this.pendingIOSKey=o||r,setTimeout(()=>this.flushIOSKey(e),250),!0):!1}flushIOSKey(e){let r=this.pendingIOSKey;return r?(this.pendingIOSKey=void 0,dispatchKey(e.contentDOM,r.key,r.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:browser.safari&&!browser.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}mustFlushObserver(e){return e.type=="keydown"&&e.keyCode!=229}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const PendingKeys=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],EmacsyPendingKeys="dthko",modifierCodes=[16,17,18,20,91,92,224,225],dragScrollMargin=6;function dragScrollSpeed(n){return Math.max(0,n)*.7+8}class MouseSelection{constructor(e,r,o,s){this.view=e,this.style=o,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=r,this.scrollParent=scrollableParent(e.contentDOM);let l=e.contentDOM.ownerDocument;l.addEventListener("mousemove",this.move=this.move.bind(this)),l.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=r.shiftKey,this.multiple=e.state.facet(EditorState.allowMultipleSelections)&&addsSelectionRange(e,r),this.dragMove=dragMovesSelection(e,r),this.dragging=isInPrimarySelection(e,r)&&getClickType(r)==1?null:!1}start(e){this.dragging===!1&&(e.preventDefault(),this.select(e))}move(e){var r;if(e.buttons==0)return this.destroy();if(this.dragging!==!1)return;this.select(this.lastEvent=e);let o=0,s=0,l=((r=this.scrollParent)===null||r===void 0?void 0:r.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight};e.clientX<=l.left+dragScrollMargin?o=-dragScrollSpeed(l.left-e.clientX):e.clientX>=l.right-dragScrollMargin&&(o=dragScrollSpeed(e.clientX-l.right)),e.clientY<=l.top+dragScrollMargin?s=-dragScrollSpeed(l.top-e.clientY):e.clientY>=l.bottom-dragScrollMargin&&(s=dragScrollSpeed(e.clientY-l.bottom)),this.setScrollSpeed(o,s)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}setScrollSpeed(e,r){this.scrollSpeed={x:e,y:r},e||r?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}select(e){let r=this.style.get(e,this.extend,this.multiple);(this.mustSelect||!r.eq(this.view.state.selection)||r.main.assoc!=this.view.state.selection.main.assoc)&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function addsSelectionRange(n,e){let r=n.state.facet(clickAddsSelectionRange);return r.length?r[0](e):browser.mac?e.metaKey:e.ctrlKey}function dragMovesSelection(n,e){let r=n.state.facet(dragMovesSelection$1);return r.length?r[0](e):browser.mac?!e.altKey:!e.ctrlKey}function isInPrimarySelection(n,e){let{main:r}=n.state.selection;if(r.empty)return!1;let o=getSelection(n.root);if(!o||o.rangeCount==0)return!0;let s=o.getRangeAt(0).getClientRects();for(let l=0;l<s.length;l++){let a=s[l];if(a.left<=e.clientX&&a.right>=e.clientX&&a.top<=e.clientY&&a.bottom>=e.clientY)return!0}return!1}function eventBelongsToEditor(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r=e.target,o;r!=n.contentDOM;r=r.parentNode)if(!r||r.nodeType==11||(o=ContentView.get(r))&&o.ignoreEvent(e))return!1;return!0}const handlers=Object.create(null),handlerOptions=Object.create(null),brokenClipboardAPI=browser.ie&&browser.ie_version<15||browser.ios&&browser.webkit_version<604;function capturePaste(n){let e=n.dom.parentNode;if(!e)return;let r=e.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{n.focus(),r.remove(),doPaste(n,r.value)},50)}function doPaste(n,e){let{state:r}=n,o,s=1,l=r.toText(e),a=l.lines==r.selection.ranges.length;if(lastLinewiseCopy!=null&&r.selection.ranges.every(u=>u.empty)&&lastLinewiseCopy==l.toString()){let u=-1;o=r.changeByRange(f=>{let d=r.doc.lineAt(f.from);if(d.from==u)return{range:f};u=d.from;let g=r.toText((a?l.line(s++).text:e)+r.lineBreak);return{changes:{from:d.from,insert:g},range:EditorSelection.cursor(f.from+g.length)}})}else a?o=r.changeByRange(u=>{let f=l.line(s++);return{changes:{from:u.from,to:u.to,insert:f.text},range:EditorSelection.cursor(u.from+f.length)}}):o=r.replaceSelection(l);n.dispatch(o,{userEvent:"input.paste",scrollIntoView:!0})}handlers.keydown=(n,e)=>{n.inputState.setSelectionOrigin("select"),e.keyCode==27?n.inputState.lastEscPress=Date.now():modifierCodes.indexOf(e.keyCode)<0&&(n.inputState.lastEscPress=0)};handlers.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};handlers.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};handlerOptions.touchstart=handlerOptions.touchmove={passive:!0};handlers.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return;let r=null;for(let o of n.state.facet(mouseSelectionStyle))if(r=o(n,e),r)break;if(!r&&e.button==0&&(r=basicMouseSelection(n,e)),r){let o=n.root.activeElement!=n.contentDOM;n.inputState.startMouseSelection(new MouseSelection(n,e,r,o)),o&&n.observer.ignore(()=>focusPreventScroll(n.contentDOM)),n.inputState.mouseSelection&&n.inputState.mouseSelection.start(e)}};function rangeForClick(n,e,r,o){if(o==1)return EditorSelection.cursor(e,r);if(o==2)return groupAt(n.state,e,r);{let s=LineView.find(n.docView,e),l=n.state.doc.lineAt(s?s.posAtEnd:e),a=s?s.posAtStart:l.from,c=s?s.posAtEnd:l.to;return c<n.state.doc.length&&c==l.to&&c++,EditorSelection.range(a,c)}}let insideY=(n,e)=>n>=e.top&&n<=e.bottom,inside=(n,e,r)=>insideY(e,r)&&n>=r.left&&n<=r.right;function findPositionSide(n,e,r,o){let s=LineView.find(n.docView,e);if(!s)return 1;let l=e-s.posAtStart;if(l==0)return 1;if(l==s.length)return-1;let a=s.coordsAt(l,-1);if(a&&inside(r,o,a))return-1;let c=s.coordsAt(l,1);return c&&inside(r,o,c)?1:a&&insideY(o,a)?-1:1}function queryPos(n,e){let r=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:r,bias:findPositionSide(n,r,e.clientX,e.clientY)}}const BadMouseDetail=browser.ie&&browser.ie_version<=11;let lastMouseDown=null,lastMouseDownCount=0,lastMouseDownTime=0;function getClickType(n){if(!BadMouseDetail)return n.detail;let e=lastMouseDown,r=lastMouseDownTime;return lastMouseDown=n,lastMouseDownTime=Date.now(),lastMouseDownCount=!e||r>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(lastMouseDownCount+1)%3:1}function basicMouseSelection(n,e){let r=queryPos(n,e),o=getClickType(e),s=n.state.selection;return{update(l){l.docChanged&&(r.pos=l.changes.mapPos(r.pos),s=s.map(l.changes))},get(l,a,c){let u=queryPos(n,l),f,d=rangeForClick(n,u.pos,u.bias,o);if(r.pos!=u.pos&&!a){let g=rangeForClick(n,r.pos,r.bias,o),m=Math.min(g.from,d.from),v=Math.max(g.to,d.to);d=m<d.from?EditorSelection.range(m,v):EditorSelection.range(v,m)}return a?s.replaceRange(s.main.extend(d.from,d.to)):c&&o==1&&s.ranges.length>1&&(f=removeRangeAround(s,u.pos))?f:c?s.addRange(d):EditorSelection.create([d])}}}function removeRangeAround(n,e){for(let r=0;r<n.ranges.length;r++){let{from:o,to:s}=n.ranges[r];if(o<=e&&s>=e)return EditorSelection.create(n.ranges.slice(0,r).concat(n.ranges.slice(r+1)),n.mainIndex==r?0:n.mainIndex-(n.mainIndex>r?1:0))}return null}handlers.dragstart=(n,e)=>{let{selection:{main:r}}=n.state,{mouseSelection:o}=n.inputState;o&&(o.dragging=r),e.dataTransfer&&(e.dataTransfer.setData("Text",n.state.sliceDoc(r.from,r.to)),e.dataTransfer.effectAllowed="copyMove")};function dropText(n,e,r,o){if(!r)return;let s=n.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:l}=n.inputState,a=o&&l&&l.dragging&&l.dragMove?{from:l.dragging.from,to:l.dragging.to}:null,c={from:s,insert:r},u=n.state.changes(a?[a,c]:c);n.focus(),n.dispatch({changes:u,selection:{anchor:u.mapPos(s,-1),head:u.mapPos(s,1)},userEvent:a?"move.drop":"input.drop"})}handlers.drop=(n,e)=>{if(!e.dataTransfer)return;if(n.state.readOnly)return e.preventDefault();let r=e.dataTransfer.files;if(r&&r.length){e.preventDefault();let o=Array(r.length),s=0,l=()=>{++s==r.length&&dropText(n,e,o.filter(a=>a!=null).join(n.state.lineBreak),!1)};for(let a=0;a<r.length;a++){let c=new FileReader;c.onerror=l,c.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(c.result)||(o[a]=c.result),l()},c.readAsText(r[a])}}else dropText(n,e,e.dataTransfer.getData("Text"),!0)};handlers.paste=(n,e)=>{if(n.state.readOnly)return e.preventDefault();n.observer.flush();let r=brokenClipboardAPI?null:e.clipboardData;r?(doPaste(n,r.getData("text/plain")||r.getData("text/uri-text")),e.preventDefault()):capturePaste(n)};function captureCopy(n,e){let r=n.dom.parentNode;if(!r)return;let o=r.appendChild(document.createElement("textarea"));o.style.cssText="position: fixed; left: -10000px; top: 10px",o.value=e,o.focus(),o.selectionEnd=e.length,o.selectionStart=0,setTimeout(()=>{o.remove(),n.focus()},50)}function copiedRange(n){let e=[],r=[],o=!1;for(let s of n.selection.ranges)s.empty||(e.push(n.sliceDoc(s.from,s.to)),r.push(s));if(!e.length){let s=-1;for(let{from:l}of n.selection.ranges){let a=n.doc.lineAt(l);a.number>s&&(e.push(a.text),r.push({from:a.from,to:Math.min(n.doc.length,a.to+1)})),s=a.number}o=!0}return{text:e.join(n.lineBreak),ranges:r,linewise:o}}let lastLinewiseCopy=null;handlers.copy=handlers.cut=(n,e)=>{let{text:r,ranges:o,linewise:s}=copiedRange(n.state);if(!r&&!s)return;lastLinewiseCopy=s?r:null;let l=brokenClipboardAPI?null:e.clipboardData;l?(e.preventDefault(),l.clearData(),l.setData("text/plain",r)):captureCopy(n,r),e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:o,scrollIntoView:!0,userEvent:"delete.cut"})};const isFocusChange=Annotation.define();function focusChangeTransaction(n,e){let r=[];for(let o of n.facet(focusChangeEffect)){let s=o(n,e);s&&r.push(s)}return r?n.update({effects:r,annotations:isFocusChange.of(!0)}):null}function updateForFocusChange(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let r=focusChangeTransaction(n.state,e);r?n.dispatch(r):n.update([])}},10)}handlers.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),updateForFocusChange(n)};handlers.blur=n=>{n.observer.clearSelectionRange(),updateForFocusChange(n)};handlers.compositionstart=handlers.compositionupdate=n=>{n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0)};handlers.compositionend=n=>{n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,browser.chrome&&browser.android&&n.observer.flushSoon(),setTimeout(()=>{n.inputState.composing<0&&n.docView.compositionDeco.size&&n.update([])},50)};handlers.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};handlers.beforeinput=(n,e)=>{var r;let o;if(browser.chrome&&browser.android&&(o=PendingKeys.find(s=>s.inputType==e.inputType))&&(n.observer.delayAndroidKey(o.key,o.keyCode),o.key=="Backspace"||o.key=="Delete")){let s=((r=window.visualViewport)===null||r===void 0?void 0:r.height)||0;setTimeout(()=>{var l;(((l=window.visualViewport)===null||l===void 0?void 0:l.height)||0)>s+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}};const wrappingWhiteSpace=["pre-wrap","normal","pre-line","break-spaces"];class HeightOracle{constructor(e){this.lineWrapping=e,this.doc=Text.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,r){let o=this.doc.lineAt(r).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(o+=Math.max(0,Math.ceil((r-e-o*this.lineLength*.5)/this.lineLength))),this.lineHeight*o}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return wrappingWhiteSpace.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let r=!1;for(let o=0;o<e.length;o++){let s=e[o];s<0?o++:this.heightSamples[Math.floor(s*10)]||(r=!0,this.heightSamples[Math.floor(s*10)]=!0)}return r}refresh(e,r,o,s,l,a){let c=wrappingWhiteSpace.indexOf(e)>-1,u=Math.round(r)!=Math.round(this.lineHeight)||this.lineWrapping!=c;if(this.lineWrapping=c,this.lineHeight=r,this.charWidth=o,this.textHeight=s,this.lineLength=l,u){this.heightSamples={};for(let f=0;f<a.length;f++){let d=a[f];d<0?f++:this.heightSamples[Math.floor(d*10)]=!0}}return u}}class MeasuredHeights{constructor(e,r){this.from=e,this.heights=r,this.index=0}get more(){return this.index<this.heights.length}}class BlockInfo{constructor(e,r,o,s,l){this.from=e,this.length=r,this.top=o,this.height=s,this.type=l}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(e){let r=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(e.type)?e.type:[e]);return new BlockInfo(this.from,this.length+e.length,this.top,this.height+e.height,r)}}var QueryType$1=function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n}(QueryType$1||(QueryType$1={}));const Epsilon=.001;class HeightMap{constructor(e,r,o=2){this.length=e,this.height=r,this.flags=o}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,r){this.height!=r&&(Math.abs(this.height-r)>Epsilon&&(e.heightChanged=!0),this.height=r)}replace(e,r,o){return HeightMap.of(o)}decomposeLeft(e,r){r.push(this)}decomposeRight(e,r){r.push(this)}applyChanges(e,r,o,s){let l=this,a=o.doc;for(let c=s.length-1;c>=0;c--){let{fromA:u,toA:f,fromB:d,toB:g}=s[c],m=l.lineAt(u,QueryType$1.ByPosNoHeight,o.setDoc(r),0,0),v=m.to>=f?m:l.lineAt(f,QueryType$1.ByPosNoHeight,o,0,0);for(g+=v.to-f,f=v.to;c>0&&m.from<=s[c-1].toA;)u=s[c-1].fromA,d=s[c-1].fromB,c--,u<m.from&&(m=l.lineAt(u,QueryType$1.ByPosNoHeight,o,0,0));d+=m.from-u,u=m.from;let b=NodeBuilder.build(o.setDoc(a),e,d,g);l=l.replace(u,f,b)}return l.updateHeight(o,0)}static empty(){return new HeightMapText(0,0)}static of(e){if(e.length==1)return e[0];let r=0,o=e.length,s=0,l=0;for(;;)if(r==o)if(s>l*2){let c=e[r-1];c.break?e.splice(--r,1,c.left,null,c.right):e.splice(--r,1,c.left,c.right),o+=1+c.break,s-=c.size}else if(l>s*2){let c=e[o];c.break?e.splice(o,1,c.left,null,c.right):e.splice(o,1,c.left,c.right),o+=2+c.break,l-=c.size}else break;else if(s<l){let c=e[r++];c&&(s+=c.size)}else{let c=e[--o];c&&(l+=c.size)}let a=0;return e[r-1]==null?(a=1,r--):e[r]==null&&(a=1,o++),new HeightMapBranch(HeightMap.of(e.slice(0,r)),a,HeightMap.of(e.slice(o)))}}HeightMap.prototype.size=1;class HeightMapBlock extends HeightMap{constructor(e,r,o){super(e,r),this.type=o}blockAt(e,r,o,s){return new BlockInfo(s,this.length,o,this.height,this.type)}lineAt(e,r,o,s,l){return this.blockAt(0,o,s,l)}forEachLine(e,r,o,s,l,a){e<=l+this.length&&r>=l&&a(this.blockAt(0,o,s,l))}updateHeight(e,r=0,o=!1,s){return s&&s.from<=r&&s.more&&this.setHeight(e,s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class HeightMapText extends HeightMapBlock{constructor(e,r){super(e,r,BlockType.Text),this.collapsed=0,this.widgetHeight=0}replace(e,r,o){let s=o[0];return o.length==1&&(s instanceof HeightMapText||s instanceof HeightMapGap&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof HeightMapGap?s=new HeightMapText(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):HeightMap.of(o)}updateHeight(e,r=0,o=!1,s){return s&&s.from<=r&&s.more?this.setHeight(e,s.heights[s.index++]):(o||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class HeightMapGap extends HeightMap{constructor(e){super(e,0)}heightMetrics(e,r){let o=e.doc.lineAt(r).number,s=e.doc.lineAt(r+this.length).number,l=s-o+1,a,c=0;if(e.lineWrapping){let u=Math.min(this.height,e.lineHeight*l);a=u/l,c=(this.height-u)/(this.length-l-1)}else a=this.height/l;return{firstLine:o,lastLine:s,perLine:a,perChar:c}}blockAt(e,r,o,s){let{firstLine:l,lastLine:a,perLine:c,perChar:u}=this.heightMetrics(r,s);if(r.lineWrapping){let f=s+Math.round(Math.max(0,Math.min(1,(e-o)/this.height))*this.length),d=r.doc.lineAt(f),g=c+d.length*u,m=Math.max(o,e-g/2);return new BlockInfo(d.from,d.length,m,g,BlockType.Text)}else{let f=Math.max(0,Math.min(a-l,Math.floor((e-o)/c))),{from:d,length:g}=r.doc.line(l+f);return new BlockInfo(d,g,o+c*f,c,BlockType.Text)}}lineAt(e,r,o,s,l){if(r==QueryType$1.ByHeight)return this.blockAt(e,o,s,l);if(r==QueryType$1.ByPosNoHeight){let{from:v,to:b}=o.doc.lineAt(e);return new BlockInfo(v,b-v,0,0,BlockType.Text)}let{firstLine:a,perLine:c,perChar:u}=this.heightMetrics(o,l),f=o.doc.lineAt(e),d=c+f.length*u,g=f.number-a,m=s+c*g+u*(f.from-l-g);return new BlockInfo(f.from,f.length,Math.max(s,Math.min(m,s+this.height-d)),d,BlockType.Text)}forEachLine(e,r,o,s,l,a){e=Math.max(e,l),r=Math.min(r,l+this.length);let{firstLine:c,perLine:u,perChar:f}=this.heightMetrics(o,l);for(let d=e,g=s;d<=r;){let m=o.doc.lineAt(d);if(d==e){let b=m.number-c;g+=u*b+f*(e-l-b)}let v=u+f*m.length;a(new BlockInfo(m.from,m.length,g,v,BlockType.Text)),g+=v,d=m.to+1}}replace(e,r,o){let s=this.length-r;if(s>0){let l=o[o.length-1];l instanceof HeightMapGap?o[o.length-1]=new HeightMapGap(l.length+s):o.push(null,new HeightMapGap(s-1))}if(e>0){let l=o[0];l instanceof HeightMapGap?o[0]=new HeightMapGap(e+l.length):o.unshift(new HeightMapGap(e-1),null)}return HeightMap.of(o)}decomposeLeft(e,r){r.push(new HeightMapGap(e-1),null)}decomposeRight(e,r){r.push(null,new HeightMapGap(this.length-e-1))}updateHeight(e,r=0,o=!1,s){let l=r+this.length;if(s&&s.from<=r+this.length&&s.more){let a=[],c=Math.max(r,s.from),u=-1;for(s.from>r&&a.push(new HeightMapGap(s.from-r-1).updateHeight(e,r));c<=l&&s.more;){let d=e.doc.lineAt(c).length;a.length&&a.push(null);let g=s.heights[s.index++];u==-1?u=g:Math.abs(g-u)>=Epsilon&&(u=-2);let m=new HeightMapText(d,g);m.outdated=!1,a.push(m),c+=d+1}c<=l&&a.push(null,new HeightMapGap(l-c).updateHeight(e,c));let f=HeightMap.of(a);return(u<0||Math.abs(f.height-this.height)>=Epsilon||Math.abs(u-this.heightMetrics(e,r).perLine)>=Epsilon)&&(e.heightChanged=!0),f}else(o||this.outdated)&&(this.setHeight(e,e.heightForGap(r,r+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class HeightMapBranch extends HeightMap{constructor(e,r,o){super(e.length+r+o.length,e.height+o.height,r|(e.outdated||o.outdated?2:0)),this.left=e,this.right=o,this.size=e.size+o.size}get break(){return this.flags&1}blockAt(e,r,o,s){let l=o+this.left.height;return e<l?this.left.blockAt(e,r,o,s):this.right.blockAt(e,r,l,s+this.left.length+this.break)}lineAt(e,r,o,s,l){let a=s+this.left.height,c=l+this.left.length+this.break,u=r==QueryType$1.ByHeight?e<a:e<c,f=u?this.left.lineAt(e,r,o,s,l):this.right.lineAt(e,r,o,a,c);if(this.break||(u?f.to<c:f.from>c))return f;let d=r==QueryType$1.ByPosNoHeight?QueryType$1.ByPosNoHeight:QueryType$1.ByPos;return u?f.join(this.right.lineAt(c,d,o,a,c)):this.left.lineAt(c,d,o,s,l).join(f)}forEachLine(e,r,o,s,l,a){let c=s+this.left.height,u=l+this.left.length+this.break;if(this.break)e<u&&this.left.forEachLine(e,r,o,s,l,a),r>=u&&this.right.forEachLine(e,r,o,c,u,a);else{let f=this.lineAt(u,QueryType$1.ByPos,o,s,l);e<f.from&&this.left.forEachLine(e,f.from-1,o,s,l,a),f.to>=e&&f.from<=r&&a(f),r>f.to&&this.right.forEachLine(f.to+1,r,o,c,u,a)}}replace(e,r,o){let s=this.left.length+this.break;if(r<s)return this.balanced(this.left.replace(e,r,o),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,r-s,o));let l=[];e>0&&this.decomposeLeft(e,l);let a=l.length;for(let c of o)l.push(c);if(e>0&&mergeGaps(l,a-1),r<this.length){let c=l.length;this.decomposeRight(r,l),mergeGaps(l,c)}return HeightMap.of(l)}decomposeLeft(e,r){let o=this.left.length;if(e<=o)return this.left.decomposeLeft(e,r);r.push(this.left),this.break&&(o++,e>=o&&r.push(null)),e>o&&this.right.decomposeLeft(e-o,r)}decomposeRight(e,r){let o=this.left.length,s=o+this.break;if(e>=s)return this.right.decomposeRight(e-s,r);e<o&&this.left.decomposeRight(e,r),this.break&&e<s&&r.push(null),r.push(this.right)}balanced(e,r){return e.size>2*r.size||r.size>2*e.size?HeightMap.of(this.break?[e,null,r]:[e,r]):(this.left=e,this.right=r,this.height=e.height+r.height,this.outdated=e.outdated||r.outdated,this.size=e.size+r.size,this.length=e.length+this.break+r.length,this)}updateHeight(e,r=0,o=!1,s){let{left:l,right:a}=this,c=r+l.length+this.break,u=null;return s&&s.from<=r+l.length&&s.more?u=l=l.updateHeight(e,r,o,s):l.updateHeight(e,r,o),s&&s.from<=c+a.length&&s.more?u=a=a.updateHeight(e,c,o,s):a.updateHeight(e,c,o),u?this.balanced(l,a):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function mergeGaps(n,e){let r,o;n[e]==null&&(r=n[e-1])instanceof HeightMapGap&&(o=n[e+1])instanceof HeightMapGap&&n.splice(e-1,3,new HeightMapGap(r.length+1+o.length))}const relevantWidgetHeight=5;class NodeBuilder{constructor(e,r){this.pos=e,this.oracle=r,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,r){if(this.lineStart>-1){let o=Math.min(r,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof HeightMapText?s.length+=o-this.pos:(o>this.pos||!this.isCovered)&&this.nodes.push(new HeightMapText(o-this.pos,-1)),this.writtenTo=o,r>o&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=r}point(e,r,o){if(e<r||o.heightRelevant){let s=o.widget?o.widget.estimatedHeight:0;s<0&&(s=this.oracle.lineHeight);let l=r-e;o.block?this.addBlock(new HeightMapBlock(l,s,o.type)):(l||s>=relevantWidgetHeight)&&this.addLineDeco(s,l)}else r>e&&this.span(e,r);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:r}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=r,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new HeightMapText(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,r){let o=new HeightMapGap(r-e);return this.oracle.doc.lineAt(e).to==r&&(o.flags|=4),o}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof HeightMapText)return e;let r=new HeightMapText(0,-1);return this.nodes.push(r),r}addBlock(e){this.enterLine(),e.type==BlockType.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,e.type!=BlockType.WidgetBefore&&(this.covering=e)}addLineDeco(e,r){let o=this.ensureLine();o.length+=r,o.collapsed+=r,o.widgetHeight=Math.max(o.widgetHeight,e),this.writtenTo=this.pos=this.pos+r}finish(e){let r=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(r instanceof HeightMapText)&&!this.isCovered?this.nodes.push(new HeightMapText(0,-1)):(this.writtenTo<this.pos||r==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let o=e;for(let s of this.nodes)s instanceof HeightMapText&&s.updateHeight(this.oracle,o),o+=s?s.length:1;return this.nodes}static build(e,r,o,s){let l=new NodeBuilder(o,e);return RangeSet.spans(r,o,s,l,0),l.finish(o)}}function heightRelevantDecoChanges(n,e,r){let o=new DecorationComparator;return RangeSet.compare(n,e,r,o,0),o.changes}class DecorationComparator{constructor(){this.changes=[]}compareRange(){}comparePoint(e,r,o,s){(e<r||o&&o.heightRelevant||s&&s.heightRelevant)&&addRange(e,r,this.changes,5)}}function visiblePixelRange(n,e){let r=n.getBoundingClientRect(),o=n.ownerDocument,s=o.defaultView||window,l=Math.max(0,r.left),a=Math.min(s.innerWidth,r.right),c=Math.max(0,r.top),u=Math.min(s.innerHeight,r.bottom);for(let f=n.parentNode;f&&f!=o.body;)if(f.nodeType==1){let d=f,g=window.getComputedStyle(d);if((d.scrollHeight>d.clientHeight||d.scrollWidth>d.clientWidth)&&g.overflow!="visible"){let m=d.getBoundingClientRect();l=Math.max(l,m.left),a=Math.min(a,m.right),c=Math.max(c,m.top),u=f==n.parentNode?m.bottom:Math.min(u,m.bottom)}f=g.position=="absolute"||g.position=="fixed"?d.offsetParent:d.parentNode}else if(f.nodeType==11)f=f.host;else break;return{left:l-r.left,right:Math.max(l,a)-r.left,top:c-(r.top+e),bottom:Math.max(c,u)-(r.top+e)}}function fullPixelRange(n,e){let r=n.getBoundingClientRect();return{left:0,right:r.right-r.left,top:e,bottom:r.bottom-(r.top+e)}}class LineGap{constructor(e,r,o){this.from=e,this.to=r,this.size=o}static same(e,r){if(e.length!=r.length)return!1;for(let o=0;o<e.length;o++){let s=e[o],l=r[o];if(s.from!=l.from||s.to!=l.to||s.size!=l.size)return!1}return!0}draw(e){return Decoration.replace({widget:new LineGapWidget(this.size,e)}).range(this.from,this.to)}}class LineGapWidget extends WidgetType{constructor(e,r){super(),this.size=e,this.vertical=r}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class ViewState{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scaler=IdScaler,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Direction.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let r=e.facet(contentAttributes).some(o=>typeof o!="function"&&o.class=="cm-lineWrapping");this.heightOracle=new HeightOracle(r),this.stateDeco=e.facet(decorations).filter(o=>typeof o!="function"),this.heightMap=HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle.setDoc(e.doc),[new ChangedRange(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Decoration.set(this.lineGaps.map(o=>o.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:r}=this.state.selection;for(let o=0;o<=1;o++){let s=o?r.head:r.anchor;if(!e.some(({from:l,to:a})=>s>=l&&s<=a)){let{from:l,to:a}=this.lineBlockAt(s);e.push(new Viewport(l,a))}}this.viewports=e.sort((o,s)=>o.from-s.from),this.scaler=this.heightMap.height<=7e6?IdScaler:new BigScaler(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:scaleBlock(e,this.scaler))})}update(e,r=null){this.state=e.state;let o=this.stateDeco;this.stateDeco=this.state.facet(decorations).filter(f=>typeof f!="function");let s=e.changedRanges,l=ChangedRange.extendWithRanges(s,heightRelevantDecoChanges(o,this.stateDeco,e?e.changes:ChangeSet.empty(this.state.doc.length))),a=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),l),this.heightMap.height!=a&&(e.flags|=2);let c=l.length?this.mapViewport(this.viewport,e.changes):this.viewport;(r&&(r.range.head<c.from||r.range.head>c.to)||!this.viewportIsAppropriate(c))&&(c=this.getViewport(0,r));let u=!e.changes.empty||e.flags&2||c.from!=this.viewport.from||c.to!=this.viewport.to;this.viewport=c,this.updateForViewport(),u&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),r&&(this.scrollTarget=r),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(nativeSelectionHidden)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let r=e.contentDOM,o=window.getComputedStyle(r),s=this.heightOracle,l=o.whiteSpace;this.defaultTextDirection=o.direction=="rtl"?Direction.RTL:Direction.LTR;let a=this.heightOracle.mustRefreshForWrapping(l),c=r.getBoundingClientRect(),u=a||this.mustMeasureContent||this.contentDOMHeight!=c.height;this.contentDOMHeight=c.height,this.mustMeasureContent=!1;let f=0,d=0,g=parseInt(o.paddingTop)||0,m=parseInt(o.paddingBottom)||0;(this.paddingTop!=g||this.paddingBottom!=m)&&(this.paddingTop=g,this.paddingBottom=m,f|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(u=!0),this.editorWidth=e.scrollDOM.clientWidth,f|=8);let v=(this.printing?fullPixelRange:visiblePixelRange)(r,this.paddingTop),b=v.top-this.pixelViewport.top,k=v.bottom-this.pixelViewport.bottom;this.pixelViewport=v;let A=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(A!=this.inView&&(this.inView=A,A&&(u=!0)),!this.inView&&!this.scrollTarget)return 0;let R=c.width;if((this.contentDOMWidth!=R||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=c.width,this.editorHeight=e.scrollDOM.clientHeight,f|=8),u){let J=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(J)&&(a=!0),a||s.lineWrapping&&Math.abs(R-this.contentDOMWidth)>s.charWidth){let{lineHeight:_,charWidth:L,textHeight:Y}=e.docView.measureTextSize();a=_>0&&s.refresh(l,_,L,Y,R/L,J),a&&(e.docView.minWidth=0,f|=8)}b>0&&k>0?d=Math.max(b,k):b<0&&k<0&&(d=Math.min(b,k)),s.heightChanged=!1;for(let _ of this.viewports){let L=_.from==this.viewport.from?J:e.docView.measureVisibleLineHeights(_);this.heightMap=(a?HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle,[new ChangedRange(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,a,new MeasuredHeights(_.from,L))}s.heightChanged&&(f|=2)}let $=!this.viewportIsAppropriate(this.viewport,d)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return $&&(this.viewport=this.getViewport(d,this.scrollTarget)),this.updateForViewport(),(f&2||$)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(a?[]:this.lineGaps,e)),f|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),f}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,r){let o=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,l=this.heightOracle,{visibleTop:a,visibleBottom:c}=this,u=new Viewport(s.lineAt(a-o*1e3,QueryType$1.ByHeight,l,0,0).from,s.lineAt(c+(1-o)*1e3,QueryType$1.ByHeight,l,0,0).to);if(r){let{head:f}=r.range;if(f<u.from||f>u.to){let d=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),g=s.lineAt(f,QueryType$1.ByPos,l,0,0),m;r.y=="center"?m=(g.top+g.bottom)/2-d/2:r.y=="start"||r.y=="nearest"&&f<u.from?m=g.top:m=g.bottom-d,u=new Viewport(s.lineAt(m-1e3/2,QueryType$1.ByHeight,l,0,0).from,s.lineAt(m+d+1e3/2,QueryType$1.ByHeight,l,0,0).to)}}return u}mapViewport(e,r){let o=r.mapPos(e.from,-1),s=r.mapPos(e.to,1);return new Viewport(this.heightMap.lineAt(o,QueryType$1.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,QueryType$1.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:r},o=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,QueryType$1.ByPos,this.heightOracle,0,0),{bottom:l}=this.heightMap.lineAt(r,QueryType$1.ByPos,this.heightOracle,0,0),{visibleTop:a,visibleBottom:c}=this;return(e==0||s<=a-Math.max(10,Math.min(-o,250)))&&(r==this.state.doc.length||l>=c+Math.max(10,Math.min(o,250)))&&s>a-2*1e3&&l<c+2*1e3}mapLineGaps(e,r){if(!e.length||r.empty)return e;let o=[];for(let s of e)r.touchesRange(s.from,s.to)||o.push(new LineGap(r.mapPos(s.from),r.mapPos(s.to),s.size));return o}ensureLineGaps(e,r){let o=this.heightOracle.lineWrapping,s=o?1e4:2e3,l=s>>1,a=s<<1;if(this.defaultTextDirection!=Direction.LTR&&!o)return[];let c=[],u=(f,d,g,m)=>{if(d-f<l)return;let v=this.state.selection.main,b=[v.from];v.empty||b.push(v.to);for(let A of b)if(A>f&&A<d){u(f,A-10,g,m),u(A+10,d,g,m);return}let k=find(e,A=>A.from>=g.from&&A.to<=g.to&&Math.abs(A.from-f)<l&&Math.abs(A.to-d)<l&&!b.some(R=>A.from<R&&A.to>R));if(!k){if(d<g.to&&r&&o&&r.visibleRanges.some(A=>A.from<=d&&A.to>=d)){let A=r.moveToLineBoundary(EditorSelection.cursor(d),!1,!0).head;A>f&&(d=A)}k=new LineGap(f,d,this.gapSize(g,f,d,m))}c.push(k)};for(let f of this.viewportLines){if(f.length<a)continue;let d=lineStructure(f.from,f.to,this.stateDeco);if(d.total<a)continue;let g=this.scrollTarget?this.scrollTarget.range.head:null,m,v;if(o){let b=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,k,A;if(g!=null){let R=findFraction(d,g),$=((this.visibleBottom-this.visibleTop)/2+b)/f.height;k=R-$,A=R+$}else k=(this.visibleTop-f.top-b)/f.height,A=(this.visibleBottom-f.top+b)/f.height;m=findPosition(d,k),v=findPosition(d,A)}else{let b=d.total*this.heightOracle.charWidth,k=s*this.heightOracle.charWidth,A,R;if(g!=null){let $=findFraction(d,g),J=((this.pixelViewport.right-this.pixelViewport.left)/2+k)/b;A=$-J,R=$+J}else A=(this.pixelViewport.left-k)/b,R=(this.pixelViewport.right+k)/b;m=findPosition(d,A),v=findPosition(d,R)}m>f.from&&u(f.from,m,f,d),v<f.to&&u(v,f.to,f,d)}return c}gapSize(e,r,o,s){let l=findFraction(s,o)-findFraction(s,r);return this.heightOracle.lineWrapping?e.height*l:s.total*this.heightOracle.charWidth*l}updateLineGaps(e){LineGap.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Decoration.set(e.map(r=>r.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let r=[];RangeSet.spans(e,this.viewport.from,this.viewport.to,{span(s,l){r.push({from:s,to:l})},point(){}},20);let o=r.length!=this.visibleRanges.length||this.visibleRanges.some((s,l)=>s.from!=r[l].from||s.to!=r[l].to);return this.visibleRanges=r,o?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(r=>r.from<=e&&r.to>=e)||scaleBlock(this.heightMap.lineAt(e,QueryType$1.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return scaleBlock(this.heightMap.lineAt(this.scaler.fromDOM(e),QueryType$1.ByHeight,this.heightOracle,0,0),this.scaler)}elementAtHeight(e){return scaleBlock(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Viewport{constructor(e,r){this.from=e,this.to=r}}function lineStructure(n,e,r){let o=[],s=n,l=0;return RangeSet.spans(r,n,e,{span(){},point(a,c){a>s&&(o.push({from:s,to:a}),l+=a-s),s=c}},20),s<e&&(o.push({from:s,to:e}),l+=e-s),{total:l,ranges:o}}function findPosition({total:n,ranges:e},r){if(r<=0)return e[0].from;if(r>=1)return e[e.length-1].to;let o=Math.floor(n*r);for(let s=0;;s++){let{from:l,to:a}=e[s],c=a-l;if(o<=c)return l+o;o-=c}}function findFraction(n,e){let r=0;for(let{from:o,to:s}of n.ranges){if(e<=s){r+=e-o;break}r+=s-o}return r/n.total}function find(n,e){for(let r of n)if(e(r))return r}const IdScaler={toDOM(n){return n},fromDOM(n){return n},scale:1};class BigScaler{constructor(e,r,o){let s=0,l=0,a=0;this.viewports=o.map(({from:c,to:u})=>{let f=r.lineAt(c,QueryType$1.ByPos,e,0,0).top,d=r.lineAt(u,QueryType$1.ByPos,e,0,0).bottom;return s+=d-f,{from:c,to:u,top:f,bottom:d,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(r.height-s);for(let c of this.viewports)c.domTop=a+(c.top-l)*this.scale,a=c.domBottom=c.domTop+(c.bottom-c.top),l=c.bottom}toDOM(e){for(let r=0,o=0,s=0;;r++){let l=r<this.viewports.length?this.viewports[r]:null;if(!l||e<l.top)return s+(e-o)*this.scale;if(e<=l.bottom)return l.domTop+(e-l.top);o=l.bottom,s=l.domBottom}}fromDOM(e){for(let r=0,o=0,s=0;;r++){let l=r<this.viewports.length?this.viewports[r]:null;if(!l||e<l.domTop)return o+(e-s)/this.scale;if(e<=l.domBottom)return l.top+(e-l.domTop);o=l.bottom,s=l.domBottom}}}function scaleBlock(n,e){if(e.scale==1)return n;let r=e.toDOM(n.top),o=e.toDOM(n.bottom);return new BlockInfo(n.from,n.length,r,o-r,Array.isArray(n.type)?n.type.map(s=>scaleBlock(s,e)):n.type)}const theme=Facet.define({combine:n=>n.join(" ")}),darkTheme=Facet.define({combine:n=>n.indexOf(!0)>-1}),baseThemeID=StyleModule.newName(),baseLightID=StyleModule.newName(),baseDarkID=StyleModule.newName(),lightDarkIDs={"&light":"."+baseLightID,"&dark":"."+baseDarkID};function buildTheme(n,e,r){return new StyleModule(e,{finish(o){return/&/.test(o)?o.replace(/&\w*/,s=>{if(s=="&")return n;if(!r||!r[s])throw new RangeError(`Unsupported selector: ${s}`);return r[s]}):n+" "+o}})}const baseTheme$1$3=buildTheme("."+baseThemeID,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},lightDarkIDs);class DOMChange{constructor(e,r,o,s){this.typeOver=s,this.bounds=null,this.text="";let{impreciseHead:l,impreciseAnchor:a}=e.docView;if(e.state.readOnly&&r>-1)this.newSel=null;else if(r>-1&&(this.bounds=e.docView.domBoundsAround(r,o,0))){let c=l||a?[]:selectionPoints(e),u=new DOMReader(c,e.state);u.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=u.text,this.newSel=selectionFromPoints(c,this.bounds.from)}else{let c=e.observer.selectionRange,u=l&&l.node==c.focusNode&&l.offset==c.focusOffset||!contains(e.contentDOM,c.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(c.focusNode,c.focusOffset),f=a&&a.node==c.anchorNode&&a.offset==c.anchorOffset||!contains(e.contentDOM,c.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(c.anchorNode,c.anchorOffset);this.newSel=EditorSelection.single(f,u)}}}function applyDOMChange(n,e){let r,{newSel:o}=e,s=n.state.selection.main;if(e.bounds){let{from:l,to:a}=e.bounds,c=s.from,u=null;(n.inputState.lastKeyCode===8&&n.inputState.lastKeyTime>Date.now()-100||browser.android&&e.text.length<a-l)&&(c=s.to,u="end");let f=findDiff(n.state.doc.sliceString(l,a,LineBreakPlaceholder),e.text,c-l,u);f&&(browser.chrome&&n.inputState.lastKeyCode==13&&f.toB==f.from+2&&e.text.slice(f.from,f.toB)==LineBreakPlaceholder+LineBreakPlaceholder&&f.toB--,r={from:l+f.from,to:l+f.toA,insert:Text.of(e.text.slice(f.from,f.toB).split(LineBreakPlaceholder))})}else o&&(!n.hasFocus&&n.state.facet(editable)||o.main.eq(s))&&(o=null);if(!r&&!o)return!1;if(!r&&e.typeOver&&!s.empty&&o&&o.main.empty?r={from:s.from,to:s.to,insert:n.state.doc.slice(s.from,s.to)}:r&&r.from>=s.from&&r.to<=s.to&&(r.from!=s.from||r.to!=s.to)&&s.to-s.from-(r.to-r.from)<=4?r={from:s.from,to:s.to,insert:n.state.doc.slice(s.from,r.from).append(r.insert).append(n.state.doc.slice(r.to,s.to))}:(browser.mac||browser.android)&&r&&r.from==r.to&&r.from==s.head-1&&/^\. ?$/.test(r.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(o&&r.insert.length==2&&(o=EditorSelection.single(o.main.anchor-1,o.main.head-1)),r={from:s.from,to:s.to,insert:Text.of([" "])}):browser.chrome&&r&&r.from==r.to&&r.from==s.head&&r.insert.toString()==`
 `&&n.lineWrapping&&(o&&(o=EditorSelection.single(o.main.anchor-1,o.main.head-1)),r={from:s.from,to:s.to,insert:Text.of([" "])}),r){let l=n.state;if(browser.ios&&n.inputState.flushIOSKey(n)||browser.android&&(r.from==s.from&&r.to==s.to&&r.insert.length==1&&r.insert.lines==2&&dispatchKey(n.contentDOM,"Enter",13)||r.from==s.from-1&&r.to==s.to&&r.insert.length==0&&dispatchKey(n.contentDOM,"Backspace",8)||r.from==s.from&&r.to==s.to+1&&r.insert.length==0&&dispatchKey(n.contentDOM,"Delete",46)))return!0;let a=r.insert.toString();if(n.state.facet(inputHandler$1).some(f=>f(n,r.from,r.to,a)))return!0;n.inputState.composing>=0&&n.inputState.composing++;let c;if(r.from>=s.from&&r.to<=s.to&&r.to-r.from>=(s.to-s.from)/3&&(!o||o.main.empty&&o.main.from==r.from+r.insert.length)&&n.inputState.composing<0){let f=s.from<r.from?l.sliceDoc(s.from,r.from):"",d=s.to>r.to?l.sliceDoc(r.to,s.to):"";c=l.replaceSelection(n.state.toText(f+r.insert.sliceString(0,void 0,n.state.lineBreak)+d))}else{let f=l.changes(r),d=o&&o.main.to<=f.newLength?o.main:void 0;if(l.selection.ranges.length>1&&n.inputState.composing>=0&&r.to<=s.to&&r.to>=s.to-10){let g=n.state.sliceDoc(r.from,r.to),m=compositionSurroundingNode(n)||n.state.doc.lineAt(s.head),v=s.to-r.to,b=s.to-s.from;c=l.changeByRange(k=>{if(k.from==s.from&&k.to==s.to)return{changes:f,range:d||k.map(f)};let A=k.to-v,R=A-g.length;if(k.to-k.from!=b||n.state.sliceDoc(R,A)!=g||m&&k.to>=m.from&&k.from<=m.to)return{range:k};let $=l.changes({from:R,to:A,insert:r.insert}),J=k.to-s.to;return{changes:$,range:d?EditorSelection.range(Math.max(0,d.anchor+J),Math.max(0,d.head+J)):k.map($)}})}else c={changes:f,selection:d&&l.selection.replaceRange(d)}}let u="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,u+=".compose",n.inputState.compositionFirstChange&&(u+=".start",n.inputState.compositionFirstChange=!1)),n.dispatch(c,{scrollIntoView:!0,userEvent:u}),!0}else if(o&&!o.main.eq(s)){let l=!1,a="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(l=!0),a=n.inputState.lastSelectionOrigin),n.dispatch({selection:o,scrollIntoView:l,userEvent:a}),!0}else return!1}function findDiff(n,e,r,o){let s=Math.min(n.length,e.length),l=0;for(;l<s&&n.charCodeAt(l)==e.charCodeAt(l);)l++;if(l==s&&n.length==e.length)return null;let a=n.length,c=e.length;for(;a>0&&c>0&&n.charCodeAt(a-1)==e.charCodeAt(c-1);)a--,c--;if(o=="end"){let u=Math.max(0,l-Math.min(a,c));r-=a+u-l}if(a<l&&n.length<e.length){let u=r<=l&&r>=a?l-r:0;l-=u,c=l+(c-a),a=l}else if(c<l){let u=r<=l&&r>=c?l-r:0;l-=u,a=l+(a-c),c=l}return{from:l,toA:a,toB:c}}function selectionPoints(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:r,anchorOffset:o,focusNode:s,focusOffset:l}=n.observer.selectionRange;return r&&(e.push(new DOMPoint(r,o)),(s!=r||l!=o)&&e.push(new DOMPoint(s,l))),e}function selectionFromPoints(n,e){if(n.length==0)return null;let r=n[0].pos,o=n.length==2?n[1].pos:r;return r>-1&&o>-1?EditorSelection.single(r+e,o+e):null}const observeOptions={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},useCharData=browser.ie&&browser.ie_version<=11;class DOMObserver{constructor(e){this.view=e,this.active=!1,this.selectionRange=new DOMSelectionState,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(r=>{for(let o of r)this.queue.push(o);(browser.ie&&browser.ie_version<=11||browser.ios&&e.composing)&&r.some(o=>o.type=="childList"&&o.removedNodes.length||o.type=="characterData"&&o.oldValue.length>o.target.nodeValue.length)?this.flushSoon():this.flush()}),useCharData&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var r;((r=this.view.docView)===null||r===void 0?void 0:r.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM),this.resizeContent=new ResizeObserver(()=>this.view.requestMeasure()),this.resizeContent.observe(e.contentDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(r=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),r.length>0&&r[r.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(r=>{r.length>0&&r[r.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runScrollHandlers(this.view,e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((r,o)=>r!=e[o]))){this.gapIntersection.disconnect();for(let r of e)this.gapIntersection.observe(r);this.gaps=e}}onSelectionChange(e){let r=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:o}=this,s=this.selectionRange;if(o.state.facet(editable)?o.root.activeElement!=this.dom:!hasSelection(o.dom,s))return;let l=s.anchorNode&&o.docView.nearest(s.anchorNode);if(l&&l.ignoreEvent(e)){r||(this.selectionChanged=!1);return}(browser.ie&&browser.ie_version<=11||browser.android&&browser.chrome)&&!o.state.selection.main.empty&&s.focusNode&&isEquivalentPosition(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,r=browser.safari&&e.root.nodeType==11&&deepActiveElement(this.dom.ownerDocument)==this.dom&&safariSelectionRangeHack(this.view)||getSelection(e.root);if(!r||this.selectionRange.eq(r))return!1;let o=hasSelection(this.dom,r);return o&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&atElementStart(this.dom,r)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(r),o&&(this.selectionChanged=!0),!0)}setSelectionRange(e,r){this.selectionRange.set(e.node,e.offset,r.node,r.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,r=null;for(let o=this.dom;o;)if(o.nodeType==1)!r&&e<this.scrollTargets.length&&this.scrollTargets[e]==o?e++:r||(r=this.scrollTargets.slice(0,e)),r&&r.push(o),o=o.assignedSlot||o.parentNode;else if(o.nodeType==11)o=o.host;else break;if(e<this.scrollTargets.length&&!r&&(r=this.scrollTargets.slice(0,e)),r){for(let o of this.scrollTargets)o.removeEventListener("scroll",this.onScroll);for(let o of this.scrollTargets=r)o.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,observeOptions),useCharData&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),useCharData&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,r){var o;if(!this.delayedAndroidKey){let s=()=>{let l=this.delayedAndroidKey;l&&(this.clearDelayedAndroidKey(),!this.flush()&&l.force&&dispatchKey(this.dom,l.key,l.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:r,force:this.lastChange<Date.now()-50||!!(!((o=this.delayedAndroidKey)===null||o===void 0)&&o.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let r=-1,o=-1,s=!1;for(let l of e){let a=this.readMutation(l);a&&(a.typeOver&&(s=!0),r==-1?{from:r,to:o}=a:(r=Math.min(a.from,r),o=Math.max(a.to,o)))}return{from:r,to:o,typeOver:s}}readChange(){let{from:e,to:r,typeOver:o}=this.processRecords(),s=this.selectionChanged&&hasSelection(this.dom,this.selectionRange);return e<0&&!s?null:(e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new DOMChange(this.view,e,r,o))}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let r=this.readChange();if(!r)return!1;let o=this.view.state,s=applyDOMChange(this.view,r);return this.view.state==o&&this.view.update([]),s}readMutation(e){let r=this.view.docView.nearest(e.target);if(!r||r.ignoreMutation(e))return null;if(r.markDirty(e.type=="attributes"),e.type=="attributes"&&(r.dirty|=4),e.type=="childList"){let o=findChild(r,e.previousSibling||e.target.previousSibling,-1),s=findChild(r,e.nextSibling||e.target.nextSibling,1);return{from:o?r.posAfter(o):r.posAtStart,to:s?r.posBefore(s):r.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,r,o,s;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(r=this.gapIntersection)===null||r===void 0||r.disconnect(),(o=this.resizeScroll)===null||o===void 0||o.disconnect(),(s=this.resizeContent)===null||s===void 0||s.disconnect();for(let l of this.scrollTargets)l.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function findChild(n,e,r){for(;e;){let o=ContentView.get(e);if(o&&o.parent==n)return o;let s=e.parentNode;e=s!=n.dom?s:r>0?e.nextSibling:e.previousSibling}return null}function safariSelectionRangeHack(n){let e=null;function r(u){u.preventDefault(),u.stopImmediatePropagation(),e=u.getTargetRanges()[0]}if(n.contentDOM.addEventListener("beforeinput",r,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",r,!0),!e)return null;let o=e.startContainer,s=e.startOffset,l=e.endContainer,a=e.endOffset,c=n.docView.domAtPos(n.state.selection.main.anchor);return isEquivalentPosition(c.node,c.offset,l,a)&&([o,s,l,a]=[l,a,o,s]),{anchorNode:o,anchorOffset:s,focusNode:l,focusOffset:a}}class EditorView{constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(r=>this.update([r])),this.dispatch=this.dispatch.bind(this),this._root=e.root||getRoot(e.parent)||document,this.viewState=new ViewState(e.state||EditorState.create(e)),this.plugins=this.state.facet(viewPlugin).map(r=>new PluginInstance(r));for(let r of this.plugins)r.update(this);this.observer=new DOMObserver(this),this.inputState=new InputState(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new DocView(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}dispatch(...e){this._dispatch(e.length==1&&e[0]instanceof Transaction?e[0]:this.state.update(...e))}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let r=!1,o=!1,s,l=this.state;for(let m of e){if(m.startState!=l)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");l=m.state}if(this.destroyed){this.viewState.state=l;return}let a=this.hasFocus,c=0,u=null;e.some(m=>m.annotation(isFocusChange))?(this.inputState.notifiedFocused=a,c=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,u=focusChangeTransaction(l,a),u||(c=1));let f=this.observer.delayedAndroidKey,d=null;if(f?(this.observer.clearDelayedAndroidKey(),d=this.observer.readChange(),(d&&!this.state.doc.eq(l.doc)||!this.state.selection.eq(l.selection))&&(d=null)):this.observer.clear(),l.facet(EditorState.phrases)!=this.state.facet(EditorState.phrases))return this.setState(l);s=ViewUpdate.create(this,l,e),s.flags|=c;let g=this.viewState.scrollTarget;try{this.updateState=2;for(let m of e){if(g&&(g=g.map(m.changes)),m.scrollIntoView){let{main:v}=m.state.selection;g=new ScrollTarget(v.empty?v:EditorSelection.cursor(v.head,v.head>v.anchor?-1:1))}for(let v of m.effects)v.is(scrollIntoView$1)&&(g=v.value)}this.viewState.update(s,g),this.bidiCache=CachedOrder.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),r=this.docView.update(s),this.state.facet(styleModule)!=this.styleModules&&this.mountStyles(),o=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(r,e.some(m=>m.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(theme)!=s.state.facet(theme)&&(this.viewState.mustMeasureContent=!0),(r||o||g||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!s.empty)for(let m of this.state.facet(updateListener))m(s);(u||d)&&Promise.resolve().then(()=>{u&&this.state==u.startState&&this.dispatch(u),d&&!applyDOMChange(this,d)&&f.force&&dispatchKey(this.contentDOM,f.key,f.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let r=this.hasFocus;try{for(let o of this.plugins)o.destroy(this);this.viewState=new ViewState(e),this.plugins=e.facet(viewPlugin).map(o=>new PluginInstance(o)),this.pluginMap.clear();for(let o of this.plugins)o.update(this);this.docView=new DocView(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}r&&this.focus(),this.requestMeasure()}updatePlugins(e){let r=e.startState.facet(viewPlugin),o=e.state.facet(viewPlugin);if(r!=o){let s=[];for(let l of o){let a=r.indexOf(l);if(a<0)s.push(new PluginInstance(l));else{let c=this.plugins[a];c.mustUpdate=e,s.push(c)}}for(let l of this.plugins)l.mustUpdate!=e&&l.destroy(this);this.plugins=s,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.forceFlush();let r=null,{scrollHeight:o,scrollTop:s,clientHeight:l}=this.scrollDOM,a=s>o-l-4?o:s;try{for(let c=0;;c++){this.updateState=1;let u=this.viewport,f=this.viewState.lineBlockAtHeight(a),d=this.viewState.measure(this);if(!d&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(c>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let g=[];d&4||([this.measureRequests,g]=[g,this.measureRequests]);let m=g.map(A=>{try{return A.read(this)}catch(R){return logException(this.state,R),BadMeasure}}),v=ViewUpdate.create(this,this.state,[]),b=!1,k=!1;v.flags|=d,r?r.flags|=d:r=v,this.updateState=2,v.empty||(this.updatePlugins(v),this.inputState.update(v),this.updateAttrs(),b=this.docView.update(v));for(let A=0;A<g.length;A++)if(m[A]!=BadMeasure)try{let R=g[A];R.write&&R.write(m[A],this)}catch(R){logException(this.state,R)}if(this.viewState.editorHeight)if(this.viewState.scrollTarget)this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,k=!0;else{let A=this.viewState.lineBlockAt(f.from).top-f.top;(A>1||A<-1)&&(this.scrollDOM.scrollTop+=A,k=!0)}if(b&&this.docView.updateSelection(!0),this.viewport.from==u.from&&this.viewport.to==u.to&&!k&&this.measureRequests.length==0)break}}finally{this.updateState=0,this.measureScheduled=-1}if(r&&!r.empty)for(let c of this.state.facet(updateListener))c(r)}get themeClasses(){return baseThemeID+" "+(this.state.facet(darkTheme)?baseDarkID:baseLightID)+" "+this.state.facet(theme)}updateAttrs(){let e=attrsFromFacet(this,editorAttributes,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),r={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(editable)?"true":"false",class:"cm-content",style:`${browser.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(r["aria-readonly"]="true"),attrsFromFacet(this,contentAttributes,r);let o=this.observer.ignore(()=>{let s=updateAttrs(this.contentDOM,this.contentAttrs,r),l=updateAttrs(this.dom,this.editorAttrs,e);return s||l});return this.editorAttrs=e,this.contentAttrs=r,o}showAnnouncements(e){let r=!0;for(let o of e)for(let s of o.effects)if(s.is(EditorView.announce)){r&&(this.announceDOM.textContent=""),r=!1;let l=this.announceDOM.appendChild(document.createElement("div"));l.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(styleModule),StyleModule.mount(this.root,this.styleModules.concat(baseTheme$1$3).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let r=0;r<this.measureRequests.length;r++)if(this.measureRequests[r].key===e.key){this.measureRequests[r]=e;return}}this.measureRequests.push(e)}}plugin(e){let r=this.pluginMap.get(e);return(r===void 0||r&&r.spec!=e)&&this.pluginMap.set(e,r=this.plugins.find(o=>o.spec==e)||null),r&&r.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,r,o){return skipAtoms(this,e,moveByChar(this,e,r,o))}moveByGroup(e,r){return skipAtoms(this,e,moveByChar(this,e,r,o=>byGroup(this,e.head,o)))}moveToLineBoundary(e,r,o=!0){return moveToLineBoundary(this,e,r,o)}moveVertically(e,r,o){return skipAtoms(this,e,moveVertically(this,e,r,o))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,r=0){return this.docView.posFromDOM(e,r)}posAtCoords(e,r=!0){return this.readMeasured(),posAtCoords(this,e,r)}coordsAtPos(e,r=1){this.readMeasured();let o=this.docView.coordsAt(e,r);if(!o||o.left==o.right)return o;let s=this.state.doc.lineAt(e),l=this.bidiSpans(s),a=l[BidiSpan.find(l,e-s.from,-1,r)];return flattenRect(o,a.dir==Direction.LTR==r>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(perLineTextDirection)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>MaxBidiLine)return trivialOrder(e.length);let r=this.textDirectionAt(e.from);for(let s of this.bidiCache)if(s.from==e.from&&s.dir==r)return s.order;let o=computeOrder(e.text,r);return this.bidiCache.push(new CachedOrder(e.from,e.to,r,o)),o}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||browser.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{focusPreventScroll(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,r={}){return scrollIntoView$1.of(new ScrollTarget(typeof e=="number"?EditorSelection.cursor(e):e,r.y,r.x,r.yMargin,r.xMargin))}static domEventHandlers(e){return ViewPlugin.define(()=>({}),{eventHandlers:e})}static theme(e,r){let o=StyleModule.newName(),s=[theme.of(o),styleModule.of(buildTheme(`.${o}`,e))];return r&&r.dark&&s.push(darkTheme.of(!0)),s}static baseTheme(e){return Prec.lowest(styleModule.of(buildTheme("."+baseThemeID,e,lightDarkIDs)))}static findFromDOM(e){var r;let o=e.querySelector(".cm-content"),s=o&&ContentView.get(o)||ContentView.get(e);return((r=s==null?void 0:s.rootView)===null||r===void 0?void 0:r.view)||null}}EditorView.styleModule=styleModule;EditorView.inputHandler=inputHandler$1;EditorView.focusChangeEffect=focusChangeEffect;EditorView.perLineTextDirection=perLineTextDirection;EditorView.exceptionSink=exceptionSink;EditorView.updateListener=updateListener;EditorView.editable=editable;EditorView.mouseSelectionStyle=mouseSelectionStyle;EditorView.dragMovesSelection=dragMovesSelection$1;EditorView.clickAddsSelectionRange=clickAddsSelectionRange;EditorView.decorations=decorations;EditorView.atomicRanges=atomicRanges;EditorView.scrollMargins=scrollMargins;EditorView.darkTheme=darkTheme;EditorView.contentAttributes=contentAttributes;EditorView.editorAttributes=editorAttributes;EditorView.lineWrapping=EditorView.contentAttributes.of({class:"cm-lineWrapping"});EditorView.announce=StateEffect.define();const MaxBidiLine=4096,BadMeasure={};class CachedOrder{constructor(e,r,o,s){this.from=e,this.to=r,this.dir=o,this.order=s}static update(e,r){if(r.empty)return e;let o=[],s=e.length?e[e.length-1].dir:Direction.LTR;for(let l=Math.max(0,e.length-10);l<e.length;l++){let a=e[l];a.dir==s&&!r.touchesRange(a.from,a.to)&&o.push(new CachedOrder(r.mapPos(a.from,1),r.mapPos(a.to,-1),a.dir,a.order))}return o}}function attrsFromFacet(n,e,r){for(let o=n.state.facet(e),s=o.length-1;s>=0;s--){let l=o[s],a=typeof l=="function"?l(n):l;a&&combineAttrs(a,r)}return r}const currentPlatform=browser.mac?"mac":browser.windows?"win":browser.linux?"linux":"key";function normalizeKeyName(n,e){const r=n.split(/-(?!$)/);let o=r[r.length-1];o=="Space"&&(o=" ");let s,l,a,c;for(let u=0;u<r.length-1;++u){const f=r[u];if(/^(cmd|meta|m)$/i.test(f))c=!0;else if(/^a(lt)?$/i.test(f))s=!0;else if(/^(c|ctrl|control)$/i.test(f))l=!0;else if(/^s(hift)?$/i.test(f))a=!0;else if(/^mod$/i.test(f))e=="mac"?c=!0:l=!0;else throw new Error("Unrecognized modifier name: "+f)}return s&&(o="Alt-"+o),l&&(o="Ctrl-"+o),c&&(o="Meta-"+o),a&&(o="Shift-"+o),o}function modifiers(n,e,r){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),r!==!1&&e.shiftKey&&(n="Shift-"+n),n}const handleKeyEvents=Prec.default(EditorView.domEventHandlers({keydown(n,e){return runHandlers(getKeymap(e.state),n,e,"editor")}})),keymap=Facet.define({enables:handleKeyEvents}),Keymaps=new WeakMap;function getKeymap(n){let e=n.facet(keymap),r=Keymaps.get(e);return r||Keymaps.set(e,r=buildKeymap(e.reduce((o,s)=>o.concat(s),[]))),r}function runScopeHandlers(n,e,r){return runHandlers(getKeymap(n.state),e,n,r)}let storedPrefix=null;const PrefixTimeout=4e3;function buildKeymap(n,e=currentPlatform){let r=Object.create(null),o=Object.create(null),s=(a,c)=>{let u=o[a];if(u==null)o[a]=c;else if(u!=c)throw new Error("Key binding "+a+" is used both as a regular binding and as a multi-stroke prefix")},l=(a,c,u,f)=>{var d,g;let m=r[a]||(r[a]=Object.create(null)),v=c.split(/ (?!$)/).map(A=>normalizeKeyName(A,e));for(let A=1;A<v.length;A++){let R=v.slice(0,A).join(" ");s(R,!0),m[R]||(m[R]={preventDefault:!0,run:[$=>{let J=storedPrefix={view:$,prefix:R,scope:a};return setTimeout(()=>{storedPrefix==J&&(storedPrefix=null)},PrefixTimeout),!0}]})}let b=v.join(" ");s(b,!1);let k=m[b]||(m[b]={preventDefault:!1,run:((g=(d=m._any)===null||d===void 0?void 0:d.run)===null||g===void 0?void 0:g.slice())||[]});u&&k.run.push(u),f&&(k.preventDefault=!0)};for(let a of n){let c=a.scope?a.scope.split(" "):["editor"];if(a.any)for(let f of c){let d=r[f]||(r[f]=Object.create(null));d._any||(d._any={preventDefault:!1,run:[]});for(let g in d)d[g].run.push(a.any)}let u=a[e]||a.key;if(u)for(let f of c)l(f,u,a.run,a.preventDefault),a.shift&&l(f,"Shift-"+u,a.shift,a.preventDefault)}return r}function runHandlers(n,e,r,o){let s=keyName(e),l=codePointAt(s,0),a=codePointSize(l)==s.length&&s!=" ",c="",u=!1;storedPrefix&&storedPrefix.view==r&&storedPrefix.scope==o&&(c=storedPrefix.prefix+" ",(u=modifierCodes.indexOf(e.keyCode)<0)&&(storedPrefix=null));let f=new Set,d=b=>{if(b){for(let k of b.run)if(!f.has(k)&&(f.add(k),k(r,e)))return!0;b.preventDefault&&(u=!0)}return!1},g=n[o],m,v;if(g){if(d(g[c+modifiers(s,e,!a)]))return!0;if(a&&(e.altKey||e.metaKey||e.ctrlKey)&&!(browser.windows&&e.ctrlKey&&e.altKey)&&(m=base[e.keyCode])&&m!=s){if(d(g[c+modifiers(m,e,!0)]))return!0;if(e.shiftKey&&(v=shift[e.keyCode])!=s&&v!=m&&d(g[c+modifiers(v,e,!1)]))return!0}else if(a&&e.shiftKey&&d(g[c+modifiers(s,e,!0)]))return!0;if(d(g._any))return!0}return u}class RectangleMarker{constructor(e,r,o,s,l){this.className=e,this.left=r,this.top=o,this.width=s,this.height=l}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,r){return r.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,r,o){if(o.empty){let s=e.coordsAtPos(o.head,o.assoc||1);if(!s)return[];let l=getBase(e);return[new RectangleMarker(r,s.left-l.left,s.top-l.top,null,s.bottom-s.top)]}else return rectanglesForRange(e,r,o)}}function getBase(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Direction.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft,top:e.top-n.scrollDOM.scrollTop}}function wrappedLine(n,e,r){let o=EditorSelection.cursor(e);return{from:Math.max(r.from,n.moveToLineBoundary(o,!1,!0).from),to:Math.min(r.to,n.moveToLineBoundary(o,!0,!0).from),type:BlockType.Text}}function blockAt(n,e){let r=n.lineBlockAt(e);if(Array.isArray(r.type)){for(let o of r.type)if(o.to>e||o.to==e&&(o.to==r.to||o.type==BlockType.Text))return o}return r}function rectanglesForRange(n,e,r){if(r.to<=n.viewport.from||r.from>=n.viewport.to)return[];let o=Math.max(r.from,n.viewport.from),s=Math.min(r.to,n.viewport.to),l=n.textDirection==Direction.LTR,a=n.contentDOM,c=a.getBoundingClientRect(),u=getBase(n),f=a.querySelector(".cm-line"),d=f&&window.getComputedStyle(f),g=c.left+(d?parseInt(d.paddingLeft)+Math.min(0,parseInt(d.textIndent)):0),m=c.right-(d?parseInt(d.paddingRight):0),v=blockAt(n,o),b=blockAt(n,s),k=v.type==BlockType.Text?v:null,A=b.type==BlockType.Text?b:null;if(n.lineWrapping&&(k&&(k=wrappedLine(n,o,k)),A&&(A=wrappedLine(n,s,A))),k&&A&&k.from==A.from)return $(J(r.from,r.to,k));{let L=k?J(r.from,null,k):_(v,!1),Y=A?J(null,r.to,A):_(b,!0),I=[];return(k||v).to<(A||b).from-1?I.push(R(g,L.bottom,m,Y.top)):L.bottom<Y.top&&n.elementAtHeight((L.bottom+Y.top)/2).type==BlockType.Text&&(L.bottom=Y.top=(L.bottom+Y.top)/2),$(L).concat(I).concat($(Y))}function R(L,Y,I,Le){return new RectangleMarker(e,L-u.left,Y-u.top-.01,I-L,Le-Y+.01)}function $({top:L,bottom:Y,horizontal:I}){let Le=[];for(let oe=0;oe<I.length;oe+=2)Le.push(R(I[oe],L,I[oe+1],Y));return Le}function J(L,Y,I){let Le=1e9,oe=-1e9,G=[];function Z(K,ge,ne,le,Ae){let Ve=n.coordsAtPos(K,K==I.to?-2:2),fe=n.coordsAtPos(ne,ne==I.from?2:-2);Le=Math.min(Ve.top,fe.top,Le),oe=Math.max(Ve.bottom,fe.bottom,oe),Ae==Direction.LTR?G.push(l&&ge?g:Ve.left,l&&le?m:fe.right):G.push(!l&&le?g:fe.left,!l&&ge?m:Ve.right)}let Ee=L??I.from,We=Y??I.to;for(let K of n.visibleRanges)if(K.to>Ee&&K.from<We)for(let ge=Math.max(K.from,Ee),ne=Math.min(K.to,We);;){let le=n.state.doc.lineAt(ge);for(let Ae of n.bidiSpans(le)){let Ve=Ae.from+le.from,fe=Ae.to+le.from;if(Ve>=ne)break;fe>ge&&Z(Math.max(Ve,ge),L==null&&Ve<=Ee,Math.min(fe,ne),Y==null&&fe>=We,Ae.dir)}if(ge=le.to+1,ge>=ne)break}return G.length==0&&Z(Ee,L==null,We,Y==null,n.textDirection),{top:Le,bottom:oe,horizontal:G}}function _(L,Y){let I=c.top+(Y?L.top:L.bottom);return{top:I,bottom:I,horizontal:[]}}}function sameMarker(n,e){return n.constructor==e.constructor&&n.eq(e)}class LayerView{constructor(e,r){this.view=e,this.layer=r,this.drawn=[],this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),r.above&&this.dom.classList.add("cm-layer-above"),r.class&&this.dom.classList.add(r.class),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),r.mount&&r.mount(this.dom,e)}update(e){e.startState.facet(layerOrder)!=e.state.facet(layerOrder)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&e.view.requestMeasure(this.measureReq)}setOrder(e){let r=0,o=e.facet(layerOrder);for(;r<o.length&&o[r]!=this.layer;)r++;this.dom.style.zIndex=String((this.layer.above?150:-1)-r)}measure(){return this.layer.markers(this.view)}draw(e){if(e.length!=this.drawn.length||e.some((r,o)=>!sameMarker(r,this.drawn[o]))){let r=this.dom.firstChild,o=0;for(let s of e)s.update&&r&&s.constructor&&this.drawn[o].constructor&&s.update(r,this.drawn[o])?(r=r.nextSibling,o++):this.dom.insertBefore(s.draw(),r);for(;r;){let s=r.nextSibling;r.remove(),r=s}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const layerOrder=Facet.define();function layer(n){return[ViewPlugin.define(e=>new LayerView(e,n)),layerOrder.of(n)]}const CanHidePrimary=!browser.ios,selectionConfig=Facet.define({combine(n){return combineConfig(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,r)=>Math.min(e,r),drawRangeCursor:(e,r)=>e||r})}});function drawSelection(n={}){return[selectionConfig.of(n),cursorLayer,selectionLayer,hideNativeSelection,nativeSelectionHidden.of(!0)]}function configChanged(n){return n.startState.facet(selectionConfig)!=n.state.facet(selectionConfig)}const cursorLayer=layer({above:!0,markers(n){let{state:e}=n,r=e.facet(selectionConfig),o=[];for(let s of e.selection.ranges){let l=s==e.selection.main;if(s.empty?!l||CanHidePrimary:r.drawRangeCursor){let a=l?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",c=s.empty?s:EditorSelection.cursor(s.head,s.head>s.anchor?-1:1);for(let u of RectangleMarker.forRange(n,a,c))o.push(u)}}return o},update(n,e){n.transactions.some(o=>o.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let r=configChanged(n);return r&&setBlinkRate(n.state,e),n.docChanged||n.selectionSet||r},mount(n,e){setBlinkRate(e.state,n)},class:"cm-cursorLayer"});function setBlinkRate(n,e){e.style.animationDuration=n.facet(selectionConfig).cursorBlinkRate+"ms"}const selectionLayer=layer({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:RectangleMarker.forRange(n,"cm-selectionBackground",e)).reduce((e,r)=>e.concat(r))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||configChanged(n)},class:"cm-selectionLayer"}),themeSpec={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};CanHidePrimary&&(themeSpec[".cm-line"].caretColor="transparent !important");const hideNativeSelection=Prec.highest(EditorView.theme(themeSpec)),setDropCursorPos=StateEffect.define({map(n,e){return n==null?null:e.mapPos(n)}}),dropCursorPos=StateField.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((r,o)=>o.is(setDropCursorPos)?o.value:r,n)}}),drawDropCursor=ViewPlugin.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let r=n.state.field(dropCursorPos);r==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(dropCursorPos)!=r||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let n=this.view.state.field(dropCursorPos),e=n!=null&&this.view.coordsAtPos(n);if(!e)return null;let r=this.view.scrollDOM.getBoundingClientRect();return{left:e.left-r.left+this.view.scrollDOM.scrollLeft,top:e.top-r.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}}drawCursor(n){this.cursor&&(n?(this.cursor.style.left=n.left+"px",this.cursor.style.top=n.top+"px",this.cursor.style.height=n.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(dropCursorPos)!=n&&this.view.dispatch({effects:setDropCursorPos.of(n)})}},{eventHandlers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function dropCursor(){return[dropCursorPos,drawDropCursor]}function iterMatches(n,e,r,o,s){e.lastIndex=0;for(let l=n.iterRange(r,o),a=r,c;!l.next().done;a+=l.value.length)if(!l.lineBreak)for(;c=e.exec(l.value);)s(a+c.index,c)}function matchRanges(n,e){let r=n.visibleRanges;if(r.length==1&&r[0].from==n.viewport.from&&r[0].to==n.viewport.to)return r;let o=[];for(let{from:s,to:l}of r)s=Math.max(n.state.doc.lineAt(s).from,s-e),l=Math.min(n.state.doc.lineAt(l).to,l+e),o.length&&o[o.length-1].to>=s?o[o.length-1].to=l:o.push({from:s,to:l});return o}class MatchDecorator{constructor(e){const{regexp:r,decoration:o,decorate:s,boundary:l,maxLength:a=1e3}=e;if(!r.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=r,s)this.addMatch=(c,u,f,d)=>s(d,f,f+c[0].length,c,u);else if(typeof o=="function")this.addMatch=(c,u,f,d)=>{let g=o(c,u,f);g&&d(f,f+c[0].length,g)};else if(o)this.addMatch=(c,u,f,d)=>d(f,f+c[0].length,o);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=l,this.maxLength=a}createDeco(e){let r=new RangeSetBuilder,o=r.add.bind(r);for(let{from:s,to:l}of matchRanges(e,this.maxLength))iterMatches(e.state.doc,this.regexp,s,l,(a,c)=>this.addMatch(c,e,a,o));return r.finish()}updateDeco(e,r){let o=1e9,s=-1;return e.docChanged&&e.changes.iterChanges((l,a,c,u)=>{u>e.view.viewport.from&&c<e.view.viewport.to&&(o=Math.min(c,o),s=Math.max(u,s))}),e.viewportChanged||s-o>1e3?this.createDeco(e.view):s>-1?this.updateRange(e.view,r.map(e.changes),o,s):r}updateRange(e,r,o,s){for(let l of e.visibleRanges){let a=Math.max(l.from,o),c=Math.min(l.to,s);if(c>a){let u=e.state.doc.lineAt(a),f=u.to<c?e.state.doc.lineAt(c):u,d=Math.max(l.from,u.from),g=Math.min(l.to,f.to);if(this.boundary){for(;a>u.from;a--)if(this.boundary.test(u.text[a-1-u.from])){d=a;break}for(;c<f.to;c++)if(this.boundary.test(f.text[c-f.from])){g=c;break}}let m=[],v,b=(k,A,R)=>m.push(R.range(k,A));if(u==f)for(this.regexp.lastIndex=d-u.from;(v=this.regexp.exec(u.text))&&v.index<g-u.from;)this.addMatch(v,e,v.index+u.from,b);else iterMatches(e.state.doc,this.regexp,d,g,(k,A)=>this.addMatch(A,e,k,b));r=r.update({filterFrom:d,filterTo:g,filter:(k,A)=>k<d||A>g,add:m})}}return r}}const UnicodeRegexpSupport=/x/.unicode!=null?"gu":"g",Specials=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,UnicodeRegexpSupport),Names={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let _supportsTabSize=null;function supportsTabSize(){var n;if(_supportsTabSize==null&&typeof document<"u"&&document.body){let e=document.body.style;_supportsTabSize=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return _supportsTabSize||!1}const specialCharConfig=Facet.define({combine(n){let e=combineConfig(n,{render:null,specialChars:Specials,addSpecialChars:null});return(e.replaceTabs=!supportsTabSize())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,UnicodeRegexpSupport)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,UnicodeRegexpSupport)),e}});function highlightSpecialChars(n={}){return[specialCharConfig.of(n),specialCharPlugin()]}let _plugin=null;function specialCharPlugin(){return _plugin||(_plugin=ViewPlugin.fromClass(class{constructor(n){this.view=n,this.decorations=Decoration.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(specialCharConfig)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new MatchDecorator({regexp:n.specialChars,decoration:(e,r,o)=>{let{doc:s}=r.state,l=codePointAt(e[0],0);if(l==9){let a=s.lineAt(o),c=r.state.tabSize,u=countColumn(a.text,c,o-a.from);return Decoration.replace({widget:new TabWidget((c-u%c)*this.view.defaultCharacterWidth)})}return this.decorationCache[l]||(this.decorationCache[l]=Decoration.replace({widget:new SpecialCharWidget(n,l)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(specialCharConfig);n.startState.facet(specialCharConfig)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const DefaultPlaceholder="";function placeholder$1(n){return n>=32?DefaultPlaceholder:n==10?"":String.fromCharCode(9216+n)}class SpecialCharWidget extends WidgetType{constructor(e,r){super(),this.options=e,this.code=r}eq(e){return e.code==this.code}toDOM(e){let r=placeholder$1(this.code),o=e.state.phrase("Control character")+" "+(Names[this.code]||"0x"+this.code.toString(16)),s=this.options.render&&this.options.render(this.code,o,r);if(s)return s;let l=document.createElement("span");return l.textContent=r,l.title=o,l.setAttribute("aria-label",o),l.className="cm-specialChar",l}ignoreEvent(){return!1}}class TabWidget extends WidgetType{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function highlightActiveLine(){return activeLineHighlighter}const lineDeco=Decoration.line({class:"cm-activeLine"}),activeLineHighlighter=ViewPlugin.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,r=[];for(let o of n.state.selection.ranges){let s=n.lineBlockAt(o.head);s.from>e&&(r.push(lineDeco.range(s.from)),e=s.from)}return Decoration.set(r)}},{decorations:n=>n.decorations});class Placeholder extends WidgetType{constructor(e){super(),this.content=e}toDOM(){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):this.content),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}ignoreEvent(){return!1}}function placeholder(n){return ViewPlugin.fromClass(class{constructor(e){this.view=e,this.placeholder=Decoration.set([Decoration.widget({widget:new Placeholder(n),side:1}).range(0)])}get decorations(){return this.view.state.doc.length?Decoration.none:this.placeholder}},{decorations:e=>e.decorations})}const MaxOff=2e3;function rectangleFor(n,e,r){let o=Math.min(e.line,r.line),s=Math.max(e.line,r.line),l=[];if(e.off>MaxOff||r.off>MaxOff||e.col<0||r.col<0){let a=Math.min(e.off,r.off),c=Math.max(e.off,r.off);for(let u=o;u<=s;u++){let f=n.doc.line(u);f.length<=c&&l.push(EditorSelection.range(f.from+a,f.to+c))}}else{let a=Math.min(e.col,r.col),c=Math.max(e.col,r.col);for(let u=o;u<=s;u++){let f=n.doc.line(u),d=findColumn(f.text,a,n.tabSize,!0);if(d<0)l.push(EditorSelection.cursor(f.to));else{let g=findColumn(f.text,c,n.tabSize);l.push(EditorSelection.range(f.from+d,f.from+g))}}}return l}function absoluteColumn(n,e){let r=n.coordsAtPos(n.viewport.from);return r?Math.round(Math.abs((r.left-e)/n.defaultCharacterWidth)):-1}function getPos(n,e){let r=n.posAtCoords({x:e.clientX,y:e.clientY},!1),o=n.state.doc.lineAt(r),s=r-o.from,l=s>MaxOff?-1:s==o.length?absoluteColumn(n,e.clientX):countColumn(o.text,n.state.tabSize,r-o.from);return{line:o.number,col:l,off:s}}function rectangleSelectionStyle(n,e){let r=getPos(n,e),o=n.state.selection;return r?{update(s){if(s.docChanged){let l=s.changes.mapPos(s.startState.doc.line(r.line).from),a=s.state.doc.lineAt(l);r={line:a.number,col:r.col,off:Math.min(r.off,a.length)},o=o.map(s.changes)}},get(s,l,a){let c=getPos(n,s);if(!c)return o;let u=rectangleFor(n.state,r,c);return u.length?a?EditorSelection.create(u.concat(o.ranges)):EditorSelection.create(u):o}}:null}function rectangularSelection(n){let e=(n==null?void 0:n.eventFilter)||(r=>r.altKey&&r.button==0);return EditorView.mouseSelectionStyle.of((r,o)=>e(o)?rectangleSelectionStyle(r,o):null)}const keys={Alt:[18,n=>n.altKey],Control:[17,n=>n.ctrlKey],Shift:[16,n=>n.shiftKey],Meta:[91,n=>n.metaKey]},showCrosshair={style:"cursor: crosshair"};function crosshairCursor(n={}){let[e,r]=keys[n.key||"Alt"],o=ViewPlugin.fromClass(class{constructor(s){this.view=s,this.isDown=!1}set(s){this.isDown!=s&&(this.isDown=s,this.view.update([]))}},{eventHandlers:{keydown(s){this.set(s.keyCode==e||r(s))},keyup(s){(s.keyCode==e||!r(s))&&this.set(!1)},mousemove(s){this.set(r(s))}}});return[o,EditorView.contentAttributes.of(s=>{var l;return!((l=s.plugin(o))===null||l===void 0)&&l.isDown?showCrosshair:null})]}const Outside="-10000px";class TooltipViewManager{constructor(e,r,o){this.facet=r,this.createTooltipView=o,this.input=e.state.facet(r),this.tooltips=this.input.filter(s=>s),this.tooltipViews=this.tooltips.map(o)}update(e){var r;let o=e.state.facet(this.facet),s=o.filter(a=>a);if(o===this.input){for(let a of this.tooltipViews)a.update&&a.update(e);return!1}let l=[];for(let a=0;a<s.length;a++){let c=s[a],u=-1;if(c){for(let f=0;f<this.tooltips.length;f++){let d=this.tooltips[f];d&&d.create==c.create&&(u=f)}if(u<0)l[a]=this.createTooltipView(c);else{let f=l[a]=this.tooltipViews[u];f.update&&f.update(e)}}}for(let a of this.tooltipViews)l.indexOf(a)<0&&(a.dom.remove(),(r=a.destroy)===null||r===void 0||r.call(a));return this.input=o,this.tooltips=s,this.tooltipViews=l,!0}}function windowSpace(n){let{win:e}=n;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const tooltipConfig=Facet.define({combine:n=>{var e,r,o;return{position:browser.ios?"absolute":((e=n.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((r=n.find(s=>s.parent))===null||r===void 0?void 0:r.parent)||null,tooltipSpace:((o=n.find(s=>s.tooltipSpace))===null||o===void 0?void 0:o.tooltipSpace)||windowSpace}}}),knownHeight=new WeakMap,tooltipPlugin=ViewPlugin.fromClass(class{constructor(n){this.view=n,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let e=n.state.facet(tooltipConfig);this.position=e.position,this.parent=e.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new TooltipViewManager(n,showTooltip,r=>this.createTooltip(r)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(r=>{Date.now()>this.lastTransaction-50&&r.length>0&&r[r.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n);e&&this.observeIntersection();let r=e||n.geometryChanged,o=n.state.facet(tooltipConfig);if(o.position!=this.position){this.position=o.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;r=!0}if(o.parent!=this.parent){this.parent&&this.container.remove(),this.parent=o.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);r=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);r&&this.maybeMeasure()}createTooltip(n){let e=n.create(this.view);if(e.dom.classList.add("cm-tooltip"),n.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let r=document.createElement("div");r.className="cm-tooltip-arrow",e.dom.appendChild(r)}return e.dom.style.position=this.position,e.dom.style.top=Outside,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var n,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let r of this.manager.tooltipViews)r.dom.remove(),(n=r.destroy)===null||n===void 0||n.call(r);(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=this.view.dom.getBoundingClientRect();return{editor:n,parent:this.parent?this.container.getBoundingClientRect():n,pos:this.manager.tooltips.map((e,r)=>{let o=this.manager.tooltipViews[r];return o.getCoords?o.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(tooltipConfig).tooltipSpace(this.view)}}writeMeasure(n){var e;let{editor:r,space:o}=n,s=[];for(let l=0;l<this.manager.tooltips.length;l++){let a=this.manager.tooltips[l],c=this.manager.tooltipViews[l],{dom:u}=c,f=n.pos[l],d=n.size[l];if(!f||f.bottom<=Math.max(r.top,o.top)||f.top>=Math.min(r.bottom,o.bottom)||f.right<Math.max(r.left,o.left)-.1||f.left>Math.min(r.right,o.right)+.1){u.style.top=Outside;continue}let g=a.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,m=g?7:0,v=d.right-d.left,b=(e=knownHeight.get(c))!==null&&e!==void 0?e:d.bottom-d.top,k=c.offset||noOffset,A=this.view.textDirection==Direction.LTR,R=d.width>o.right-o.left?A?o.left:o.right-d.width:A?Math.min(f.left-(g?14:0)+k.x,o.right-v):Math.max(o.left,f.left-v+(g?14:0)-k.x),$=!!a.above;!a.strictSide&&($?f.top-(d.bottom-d.top)-k.y<o.top:f.bottom+(d.bottom-d.top)+k.y>o.bottom)&&$==o.bottom-f.bottom>f.top-o.top&&($=!$);let J=($?f.top-o.top:o.bottom-f.bottom)-m;if(J<b&&c.resize!==!1){if(J<this.view.defaultLineHeight){u.style.top=Outside;continue}knownHeight.set(c,b),u.style.height=(b=J)+"px"}else u.style.height&&(u.style.height="");let _=$?f.top-b-m-k.y:f.bottom+m+k.y,L=R+v;if(c.overlap!==!0)for(let Y of s)Y.left<L&&Y.right>R&&Y.top<_+b&&Y.bottom>_&&(_=$?Y.top-b-2-m:Y.bottom+m+2);this.position=="absolute"?(u.style.top=_-n.parent.top+"px",u.style.left=R-n.parent.left+"px"):(u.style.top=_+"px",u.style.left=R+"px"),g&&(g.style.left=`${f.left+(A?k.x:-k.x)-(R+14-7)}px`),c.overlap!==!0&&s.push({left:R,top:_,right:L,bottom:_+b}),u.classList.toggle("cm-tooltip-above",$),u.classList.toggle("cm-tooltip-below",!$),c.positioned&&c.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=Outside}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),baseTheme$4=EditorView.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),noOffset={x:0,y:0},showTooltip=Facet.define({enables:[tooltipPlugin,baseTheme$4]}),showHoverTooltip=Facet.define();class HoverTooltipHost{constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new TooltipViewManager(e,showHoverTooltip,r=>this.createHostedView(r))}static create(e){return new HoverTooltipHost(e)}createHostedView(e){let r=e.create(this.view);return r.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(r.dom),this.mounted&&r.mount&&r.mount(this.view),r}mount(e){for(let r of this.manager.tooltipViews)r.mount&&r.mount(e);this.mounted=!0}positioned(e){for(let r of this.manager.tooltipViews)r.positioned&&r.positioned(e)}update(e){this.manager.update(e)}}const showHoverTooltipHost=showTooltip.compute([showHoverTooltip],n=>{let e=n.facet(showHoverTooltip).filter(r=>r);return e.length===0?null:{pos:Math.min(...e.map(r=>r.pos)),end:Math.max(...e.filter(r=>r.end!=null).map(r=>r.end)),create:HoverTooltipHost.create,above:e[0].above,arrow:e.some(r=>r.arrow)}});class HoverPlugin{constructor(e,r,o,s,l){this.view=e,this.source=r,this.field=o,this.setHover=s,this.hoverTime=l,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:e}=this,r=this.view.contentDOM.contains(e.target)?this.view.posAtCoords(e):null;if(r==null)return;let o=this.view.coordsAtPos(r);if(o==null||e.y<o.top||e.y>o.bottom||e.x<o.left-this.view.defaultCharacterWidth||e.x>o.right+this.view.defaultCharacterWidth)return;let s=this.view.bidiSpans(this.view.state.doc.lineAt(r)).find(c=>c.from<=r&&c.to>=r),l=s&&s.dir==Direction.RTL?-1:1,a=this.source(this.view,r,e.x<o.left?-l:l);if(a!=null&&a.then){let c=this.pending={pos:r};a.then(u=>{this.pending==c&&(this.pending=null,u&&this.view.dispatch({effects:this.setHover.of(u)}))},u=>logException(this.view.state,u,"hover tooltip"))}else a&&this.view.dispatch({effects:this.setHover.of(a)})}mousemove(e){var r;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let o=this.active;if(o&&!isInTooltip(this.lastMove.target)||this.pending){let{pos:s}=o||this.pending,l=(r=o==null?void 0:o.end)!==null&&r!==void 0?r:s;(s==l?this.view.posAtCoords(this.lastMove)!=s:!isOverRange(this.view,s,l,e.clientX,e.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!isInTooltip(e.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function isInTooltip(n){for(let e=n;e;e=e.parentNode)if(e.nodeType==1&&e.classList.contains("cm-tooltip"))return!0;return!1}function isOverRange(n,e,r,o,s,l){let a=document.createRange(),c=n.domAtPos(e),u=n.domAtPos(r);a.setEnd(u.node,u.offset),a.setStart(c.node,c.offset);let f=a.getClientRects();a.detach();for(let d=0;d<f.length;d++){let g=f[d];if(Math.max(g.top-s,s-g.bottom,g.left-o,o-g.right)<=l)return!0}return!1}function hoverTooltip(n,e={}){let r=StateEffect.define(),o=StateField.define({create(){return null},update(s,l){if(s&&(e.hideOnChange&&(l.docChanged||l.selection)||e.hideOn&&e.hideOn(l,s)))return null;if(s&&l.docChanged){let a=l.changes.mapPos(s.pos,-1,MapMode.TrackDel);if(a==null)return null;let c=Object.assign(Object.create(null),s);c.pos=a,s.end!=null&&(c.end=l.changes.mapPos(s.end)),s=c}for(let a of l.effects)a.is(r)&&(s=a.value),a.is(closeHoverTooltipEffect)&&(s=null);return s},provide:s=>showHoverTooltip.from(s)});return[o,ViewPlugin.define(s=>new HoverPlugin(s,n,o,r,e.hoverTime||300)),showHoverTooltipHost]}function getTooltip(n,e){let r=n.plugin(tooltipPlugin);if(!r)return null;let o=r.manager.tooltips.indexOf(e);return o<0?null:r.manager.tooltipViews[o]}const closeHoverTooltipEffect=StateEffect.define(),panelConfig=Facet.define({combine(n){let e,r;for(let o of n)e=e||o.topContainer,r=r||o.bottomContainer;return{topContainer:e,bottomContainer:r}}});function getPanel(n,e){let r=n.plugin(panelPlugin),o=r?r.specs.indexOf(e):-1;return o>-1?r.panels[o]:null}const panelPlugin=ViewPlugin.fromClass(class{constructor(n){this.input=n.state.facet(showPanel),this.specs=this.input.filter(r=>r),this.panels=this.specs.map(r=>r(n));let e=n.state.facet(panelConfig);this.top=new PanelGroup(n,!0,e.topContainer),this.bottom=new PanelGroup(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(r=>r.top)),this.bottom.sync(this.panels.filter(r=>!r.top));for(let r of this.panels)r.dom.classList.add("cm-panel"),r.mount&&r.mount()}update(n){let e=n.state.facet(panelConfig);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new PanelGroup(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new PanelGroup(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let r=n.state.facet(showPanel);if(r!=this.input){let o=r.filter(u=>u),s=[],l=[],a=[],c=[];for(let u of o){let f=this.specs.indexOf(u),d;f<0?(d=u(n.view),c.push(d)):(d=this.panels[f],d.update&&d.update(n)),s.push(d),(d.top?l:a).push(d)}this.specs=o,this.panels=s,this.top.sync(l),this.bottom.sync(a);for(let u of c)u.dom.classList.add("cm-panel"),u.mount&&u.mount()}else for(let o of this.panels)o.update&&o.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>EditorView.scrollMargins.of(e=>{let r=e.plugin(n);return r&&{top:r.top.scrollMargin(),bottom:r.bottom.scrollMargin()}})});class PanelGroup{constructor(e,r,o){this.view=e,this.top=r,this.container=o,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let r of this.panels)r.destroy&&e.indexOf(r)<0&&r.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let r=this.container||this.view.dom;r.insertBefore(this.dom,this.top?r.firstChild:null)}let e=this.dom.firstChild;for(let r of this.panels)if(r.dom.parentNode==this.dom){for(;e!=r.dom;)e=rm(e);e=e.nextSibling}else this.dom.insertBefore(r.dom,e);for(;e;)e=rm(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function rm(n){let e=n.nextSibling;return n.remove(),e}const showPanel=Facet.define({enables:panelPlugin});class GutterMarker extends RangeValue{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}GutterMarker.prototype.elementClass="";GutterMarker.prototype.toDOM=void 0;GutterMarker.prototype.mapMode=MapMode.TrackBefore;GutterMarker.prototype.startSide=GutterMarker.prototype.endSide=-1;GutterMarker.prototype.point=!0;const gutterLineClass=Facet.define(),defaults$1={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>RangeSet.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},activeGutters=Facet.define();function gutter(n){return[gutters(),activeGutters.of(Object.assign(Object.assign({},defaults$1),n))]}const unfixGutters=Facet.define({combine:n=>n.some(e=>e)});function gutters(n){let e=[gutterView];return n&&n.fixed===!1&&e.push(unfixGutters.of(!0)),e}const gutterView=ViewPlugin.fromClass(class{constructor(n){this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=n.state.facet(activeGutters).map(e=>new SingleGutterView(n,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!n.state.facet(unfixGutters),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}update(n){if(this.updateGutters(n)){let e=this.prevViewport,r=n.view.viewport,o=Math.min(e.to,r.to)-Math.max(e.from,r.from);this.syncGutters(o<(r.to-r.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(unfixGutters)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&this.dom.remove();let r=RangeSet.iter(this.view.state.facet(gutterLineClass),this.view.viewport.from),o=[],s=this.gutters.map(l=>new UpdateContext(l,this.view.viewport,-this.view.documentPadding.top));for(let l of this.view.viewportLineBlocks){let a;if(Array.isArray(l.type)){for(let c of l.type)if(c.type==BlockType.Text){a=c;break}}else a=l.type==BlockType.Text?l:void 0;if(a){o.length&&(o=[]),advanceCursor(r,o,l.from);for(let c of s)c.line(this.view,a,o)}}for(let l of s)l.finish();n&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(n){let e=n.startState.facet(activeGutters),r=n.state.facet(activeGutters),o=n.docChanged||n.heightChanged||n.viewportChanged||!RangeSet.eq(n.startState.facet(gutterLineClass),n.state.facet(gutterLineClass),n.view.viewport.from,n.view.viewport.to);if(e==r)for(let s of this.gutters)s.update(n)&&(o=!0);else{o=!0;let s=[];for(let l of r){let a=e.indexOf(l);a<0?s.push(new SingleGutterView(this.view,l)):(this.gutters[a].update(n),s.push(this.gutters[a]))}for(let l of this.gutters)l.dom.remove(),s.indexOf(l)<0&&l.destroy();for(let l of s)this.dom.appendChild(l.dom);this.gutters=s}return o}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:n=>EditorView.scrollMargins.of(e=>{let r=e.plugin(n);return!r||r.gutters.length==0||!r.fixed?null:e.textDirection==Direction.LTR?{left:r.dom.offsetWidth}:{right:r.dom.offsetWidth}})});function asArray(n){return Array.isArray(n)?n:[n]}function advanceCursor(n,e,r){for(;n.value&&n.from<=r;)n.from==r&&e.push(n.value),n.next()}class UpdateContext{constructor(e,r,o){this.gutter=e,this.height=o,this.i=0,this.cursor=RangeSet.iter(e.markers,r.from)}line(e,r,o){let s=[];advanceCursor(this.cursor,s,r.from),o.length&&(s=s.concat(o));let l=this.gutter.config.lineMarker(e,r,s);l&&s.unshift(l);let a=this.gutter;if(s.length==0&&!a.config.renderEmptyElements)return;let c=r.top-this.height;if(this.i==a.elements.length){let u=new GutterElement(e,r.height,c,s);a.elements.push(u),a.dom.appendChild(u.dom)}else a.elements[this.i].update(e,r.height,c,s);this.height=r.bottom,this.i++}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let r=e.elements.pop();e.dom.removeChild(r.dom),r.destroy()}}}class SingleGutterView{constructor(e,r){this.view=e,this.config=r,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let o in r.domEventHandlers)this.dom.addEventListener(o,s=>{let l=s.target,a;if(l!=this.dom&&this.dom.contains(l)){for(;l.parentNode!=this.dom;)l=l.parentNode;let u=l.getBoundingClientRect();a=(u.top+u.bottom)/2}else a=s.clientY;let c=e.lineBlockAtHeight(a-e.documentTop);r.domEventHandlers[o](e,c,s)&&s.preventDefault()});this.markers=asArray(r.markers(e)),r.initialSpacer&&(this.spacer=new GutterElement(e,0,0,[r.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let r=this.markers;if(this.markers=asArray(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let o=e.view.viewport;return!RangeSet.eq(this.markers,r,o.from,o.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class GutterElement{constructor(e,r,o,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,r,o,s)}update(e,r,o,s){this.height!=r&&(this.dom.style.height=(this.height=r)+"px"),this.above!=o&&(this.dom.style.marginTop=(this.above=o)?o+"px":""),sameMarkers(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,r){let o="cm-gutterElement",s=this.dom.firstChild;for(let l=0,a=0;;){let c=a,u=l<r.length?r[l++]:null,f=!1;if(u){let d=u.elementClass;d&&(o+=" "+d);for(let g=a;g<this.markers.length;g++)if(this.markers[g].compare(u)){c=g,f=!0;break}}else c=this.markers.length;for(;a<c;){let d=this.markers[a++];if(d.toDOM){d.destroy(s);let g=s.nextSibling;s.remove(),s=g}}if(!u)break;u.toDOM&&(f?s=s.nextSibling:this.dom.insertBefore(u.toDOM(e),s)),f&&a++}this.dom.className=o,this.markers=r}destroy(){this.setMarkers(null,[])}}function sameMarkers(n,e){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!n[r].compare(e[r]))return!1;return!0}const lineNumberMarkers=Facet.define(),lineNumberConfig=Facet.define({combine(n){return combineConfig(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,r){let o=Object.assign({},e);for(let s in r){let l=o[s],a=r[s];o[s]=l?(c,u,f)=>l(c,u,f)||a(c,u,f):a}return o}})}});class NumberMarker extends GutterMarker{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function formatNumber(n,e){return n.state.facet(lineNumberConfig).formatNumber(e,n.state)}const lineNumberGutter=activeGutters.compute([lineNumberConfig],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(lineNumberMarkers)},lineMarker(e,r,o){return o.some(s=>s.toDOM)?null:new NumberMarker(formatNumber(e,e.state.doc.lineAt(r.from).number))},lineMarkerChange:e=>e.startState.facet(lineNumberConfig)!=e.state.facet(lineNumberConfig),initialSpacer(e){return new NumberMarker(formatNumber(e,maxLineNumber(e.state.doc.lines)))},updateSpacer(e,r){let o=formatNumber(r.view,maxLineNumber(r.view.state.doc.lines));return o==e.number?e:new NumberMarker(o)},domEventHandlers:n.facet(lineNumberConfig).domEventHandlers}));function lineNumbers(n={}){return[lineNumberConfig.of(n),gutters(),lineNumberGutter]}function maxLineNumber(n){let e=9;for(;e<n;)e=e*10+9;return e}const activeLineGutterMarker=new class extends GutterMarker{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},activeLineGutterHighlighter=gutterLineClass.compute(["selection"],n=>{let e=[],r=-1;for(let o of n.selection.ranges){let s=n.doc.lineAt(o.head).from;s>r&&(r=s,e.push(activeLineGutterMarker.range(s)))}return RangeSet.of(e)});function highlightActiveLineGutter(){return activeLineGutterHighlighter}const DefaultBufferLength=1024;let nextPropID=0;class Range{constructor(e,r){this.from=e,this.to=r}}class NodeProp{constructor(e={}){this.id=nextPropID++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=NodeType.match(e)),r=>{let o=e(r);return o===void 0?null:[this,o]}}}NodeProp.closedBy=new NodeProp({deserialize:n=>n.split(" ")});NodeProp.openedBy=new NodeProp({deserialize:n=>n.split(" ")});NodeProp.group=new NodeProp({deserialize:n=>n.split(" ")});NodeProp.contextHash=new NodeProp({perNode:!0});NodeProp.lookAhead=new NodeProp({perNode:!0});NodeProp.mounted=new NodeProp({perNode:!0});const noProps=Object.create(null);class NodeType{constructor(e,r,o,s=0){this.name=e,this.props=r,this.id=o,this.flags=s}static define(e){let r=e.props&&e.props.length?Object.create(null):noProps,o=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),s=new NodeType(e.name||"",r,e.id,o);if(e.props){for(let l of e.props)if(Array.isArray(l)||(l=l(s)),l){if(l[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");r[l[0].id]=l[1]}}return s}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let r=this.prop(NodeProp.group);return r?r.indexOf(e)>-1:!1}return this.id==e}static match(e){let r=Object.create(null);for(let o in e)for(let s of o.split(" "))r[s]=e[o];return o=>{for(let s=o.prop(NodeProp.group),l=-1;l<(s?s.length:0);l++){let a=r[l<0?o.name:s[l]];if(a)return a}}}}NodeType.none=new NodeType("",Object.create(null),0,8);class NodeSet{constructor(e){this.types=e;for(let r=0;r<e.length;r++)if(e[r].id!=r)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let r=[];for(let o of this.types){let s=null;for(let l of e){let a=l(o);a&&(s||(s=Object.assign({},o.props)),s[a[0].id]=a[1])}r.push(s?new NodeType(o.name,s,o.id,o.flags):o)}return new NodeSet(r)}}const CachedNode=new WeakMap,CachedInnerNode=new WeakMap;var IterMode;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(IterMode||(IterMode={}));class Tree{constructor(e,r,o,s,l){if(this.type=e,this.children=r,this.positions=o,this.length=s,this.props=null,l&&l.length){this.props=Object.create(null);for(let[a,c]of l)this.props[typeof a=="number"?a:a.id]=c}}toString(){let e=this.prop(NodeProp.mounted);if(e&&!e.overlay)return e.tree.toString();let r="";for(let o of this.children){let s=o.toString();s&&(r&&(r+=","),r+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(r.length?"("+r+")":""):r}cursor(e=0){return new TreeCursor(this.topNode,e)}cursorAt(e,r=0,o=0){let s=CachedNode.get(this)||this.topNode,l=new TreeCursor(s);return l.moveTo(e,r),CachedNode.set(this,l._tree),l}get topNode(){return new TreeNode(this,0,0,null)}resolve(e,r=0){let o=resolveNode(CachedNode.get(this)||this.topNode,e,r,!1);return CachedNode.set(this,o),o}resolveInner(e,r=0){let o=resolveNode(CachedInnerNode.get(this)||this.topNode,e,r,!0);return CachedInnerNode.set(this,o),o}iterate(e){let{enter:r,leave:o,from:s=0,to:l=this.length}=e;for(let a=this.cursor((e.mode||0)|IterMode.IncludeAnonymous);;){let c=!1;if(a.from<=l&&a.to>=s&&(a.type.isAnonymous||r(a)!==!1)){if(a.firstChild())continue;c=!0}for(;c&&o&&!a.type.isAnonymous&&o(a),!a.nextSibling();){if(!a.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let r in this.props)e.push([+r,this.props[r]]);return e}balance(e={}){return this.children.length<=8?this:balanceRange(NodeType.none,this.children,this.positions,0,this.children.length,0,this.length,(r,o,s)=>new Tree(this.type,r,o,s,this.propValues),e.makeTree||((r,o,s)=>new Tree(NodeType.none,r,o,s)))}static build(e){return buildTree(e)}}Tree.empty=new Tree(NodeType.none,[],[],0);class FlatBufferCursor{constructor(e,r){this.buffer=e,this.index=r}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new FlatBufferCursor(this.buffer,this.index)}}class TreeBuffer{constructor(e,r,o){this.buffer=e,this.length=r,this.set=o}get type(){return NodeType.none}toString(){let e=[];for(let r=0;r<this.buffer.length;)e.push(this.childString(r)),r=this.buffer[r+3];return e.join(",")}childString(e){let r=this.buffer[e],o=this.buffer[e+3],s=this.set.types[r],l=s.name;if(/\W/.test(l)&&!s.isError&&(l=JSON.stringify(l)),e+=4,o==e)return l;let a=[];for(;e<o;)a.push(this.childString(e)),e=this.buffer[e+3];return l+"("+a.join(",")+")"}findChild(e,r,o,s,l){let{buffer:a}=this,c=-1;for(let u=e;u!=r&&!(checkSide(l,s,a[u+1],a[u+2])&&(c=u,o>0));u=a[u+3]);return c}slice(e,r,o){let s=this.buffer,l=new Uint16Array(r-e),a=0;for(let c=e,u=0;c<r;){l[u++]=s[c++],l[u++]=s[c++]-o;let f=l[u++]=s[c++]-o;l[u++]=s[c++]-e,a=Math.max(a,f)}return new TreeBuffer(l,a,this.set)}}function checkSide(n,e,r,o){switch(n){case-2:return r<e;case-1:return o>=e&&r<e;case 0:return r<e&&o>e;case 1:return r<=e&&o>e;case 2:return o>e;case 4:return!0}}function enterUnfinishedNodesBefore(n,e){let r=n.childBefore(e);for(;r;){let o=r.lastChild;if(!o||o.to!=r.to)break;o.type.isError&&o.from==o.to?(n=r,r=o.prevSibling):r=o}return n}function resolveNode(n,e,r,o){for(var s;n.from==n.to||(r<1?n.from>=e:n.from>e)||(r>-1?n.to<=e:n.to<e);){let a=!o&&n instanceof TreeNode&&n.index<0?null:n.parent;if(!a)return n;n=a}let l=o?0:IterMode.IgnoreOverlays;if(o)for(let a=n,c=a.parent;c;a=c,c=a.parent)a instanceof TreeNode&&a.index<0&&((s=c.enter(e,r,l))===null||s===void 0?void 0:s.from)!=a.from&&(n=c);for(;;){let a=n.enter(e,r,l);if(!a)return n;n=a}}class TreeNode{constructor(e,r,o,s){this._tree=e,this.from=r,this.index=o,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,r,o,s,l=0){for(let a=this;;){for(let{children:c,positions:u}=a._tree,f=r>0?c.length:-1;e!=f;e+=r){let d=c[e],g=u[e]+a.from;if(checkSide(s,o,g,g+d.length)){if(d instanceof TreeBuffer){if(l&IterMode.ExcludeBuffers)continue;let m=d.findChild(0,d.buffer.length,r,o-g,s);if(m>-1)return new BufferNode(new BufferContext(a,d,e,g),null,m)}else if(l&IterMode.IncludeAnonymous||!d.type.isAnonymous||hasChild(d)){let m;if(!(l&IterMode.IgnoreMounts)&&d.props&&(m=d.prop(NodeProp.mounted))&&!m.overlay)return new TreeNode(m.tree,g,e,a);let v=new TreeNode(d,g,e,a);return l&IterMode.IncludeAnonymous||!v.type.isAnonymous?v:v.nextChild(r<0?d.children.length-1:0,r,o,s)}}}if(l&IterMode.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+r:e=r<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,r,o=0){let s;if(!(o&IterMode.IgnoreOverlays)&&(s=this._tree.prop(NodeProp.mounted))&&s.overlay){let l=e-this.from;for(let{from:a,to:c}of s.overlay)if((r>0?a<=l:a<l)&&(r<0?c>=l:c>l))return new TreeNode(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,r,o)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new TreeCursor(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,r=0){return resolveNode(this,e,r,!1)}resolveInner(e,r=0){return resolveNode(this,e,r,!0)}enterUnfinishedNodesBefore(e){return enterUnfinishedNodesBefore(this,e)}getChild(e,r=null,o=null){let s=getChildren(this,e,r,o);return s.length?s[0]:null}getChildren(e,r=null,o=null){return getChildren(this,e,r,o)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return matchNodeContext(this,e)}}function getChildren(n,e,r,o){let s=n.cursor(),l=[];if(!s.firstChild())return l;if(r!=null){for(;!s.type.is(r);)if(!s.nextSibling())return l}for(;;){if(o!=null&&s.type.is(o))return l;if(s.type.is(e)&&l.push(s.node),!s.nextSibling())return o==null?l:[]}}function matchNodeContext(n,e,r=e.length-1){for(let o=n.parent;r>=0;o=o.parent){if(!o)return!1;if(!o.type.isAnonymous){if(e[r]&&e[r]!=o.name)return!1;r--}}return!0}class BufferContext{constructor(e,r,o,s){this.parent=e,this.buffer=r,this.index=o,this.start=s}}class BufferNode{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,r,o){this.context=e,this._parent=r,this.index=o,this.type=e.buffer.set.types[e.buffer.buffer[o]]}child(e,r,o){let{buffer:s}=this.context,l=s.findChild(this.index+4,s.buffer[this.index+3],e,r-this.context.start,o);return l<0?null:new BufferNode(this.context,this,l)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,r,o=0){if(o&IterMode.ExcludeBuffers)return null;let{buffer:s}=this.context,l=s.findChild(this.index+4,s.buffer[this.index+3],r>0?1:-1,e-this.context.start,r);return l<0?null:new BufferNode(this.context,this,l)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,r=e.buffer[this.index+3];return r<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new BufferNode(this.context,this._parent,r):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,r=this._parent?this._parent.index+4:0;return this.index==r?this.externalSibling(-1):new BufferNode(this.context,this._parent,e.findChild(r,this.index,-1,0,4))}cursor(e=0){return new TreeCursor(this,e)}get tree(){return null}toTree(){let e=[],r=[],{buffer:o}=this.context,s=this.index+4,l=o.buffer[this.index+3];if(l>s){let a=o.buffer[this.index+1];e.push(o.slice(s,l,a)),r.push(0)}return new Tree(this.type,e,r,this.to-this.from)}resolve(e,r=0){return resolveNode(this,e,r,!1)}resolveInner(e,r=0){return resolveNode(this,e,r,!0)}enterUnfinishedNodesBefore(e){return enterUnfinishedNodesBefore(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,r=null,o=null){let s=getChildren(this,e,r,o);return s.length?s[0]:null}getChildren(e,r=null,o=null){return getChildren(this,e,r,o)}get node(){return this}matchContext(e){return matchNodeContext(this,e)}}class TreeCursor{get name(){return this.type.name}constructor(e,r=0){if(this.mode=r,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof TreeNode)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let o=e._parent;o;o=o._parent)this.stack.unshift(o.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,r){this.index=e;let{start:o,buffer:s}=this.buffer;return this.type=r||s.set.types[s.buffer[e]],this.from=o+s.buffer[e+1],this.to=o+s.buffer[e+2],!0}yield(e){return e?e instanceof TreeNode?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,r,o){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,r,o,this.mode));let{buffer:s}=this.buffer,l=s.findChild(this.index+4,s.buffer[this.index+3],e,r-this.buffer.start,o);return l<0?!1:(this.stack.push(this.index),this.yieldBuf(l))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,r,o=this.mode){return this.buffer?o&IterMode.ExcludeBuffers?!1:this.enterChild(1,e,r):this.yield(this._tree.enter(e,r,o))}parent(){if(!this.buffer)return this.yieldNode(this.mode&IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:r}=this.buffer,o=this.stack.length-1;if(e<0){let s=o<0?0:this.stack[o]+4;if(this.index!=s)return this.yieldBuf(r.findChild(s,this.index,-1,0,4))}else{let s=r.buffer[this.index+3];if(s<(o<0?r.buffer.length:r.buffer[this.stack[o]+3]))return this.yieldBuf(s)}return o<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let r,o,{buffer:s}=this;if(s){if(e>0){if(this.index<s.buffer.buffer.length)return!1}else for(let l=0;l<this.index;l++)if(s.buffer.buffer[l+3]<this.index)return!1;({index:r,parent:o}=s)}else({index:r,_parent:o}=this._tree);for(;o;{index:r,_parent:o}=o)if(r>-1)for(let l=r+e,a=e<0?-1:o._tree.children.length;l!=a;l+=e){let c=o._tree.children[l];if(this.mode&IterMode.IncludeAnonymous||c instanceof TreeBuffer||!c.type.isAnonymous||hasChild(c))return!1}return!0}move(e,r){if(r&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,r=0){for(;(this.from==this.to||(r<1?this.from>=e:this.from>e)||(r>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,r););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,r=null,o=0;if(e&&e.context==this.buffer)e:for(let s=this.index,l=this.stack.length;l>=0;){for(let a=e;a;a=a._parent)if(a.index==s){if(s==this.index)return a;r=a,o=l+1;break e}s=this.stack[--l]}for(let s=o;s<this.stack.length;s++)r=new BufferNode(this.buffer,r,this.stack[s]);return this.bufferNode=new BufferNode(this.buffer,r,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,r){for(let o=0;;){let s=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){o++;continue}this.type.isAnonymous||(s=!0)}for(;s&&r&&r(this),s=this.type.isAnonymous,!this.nextSibling();){if(!o)return;this.parent(),o--,s=!0}}}matchContext(e){if(!this.buffer)return matchNodeContext(this.node,e);let{buffer:r}=this.buffer,{types:o}=r.set;for(let s=e.length-1,l=this.stack.length-1;s>=0;l--){if(l<0)return matchNodeContext(this.node,e,s);let a=o[r.buffer[this.stack[l]]];if(!a.isAnonymous){if(e[s]&&e[s]!=a.name)return!1;s--}}return!0}}function hasChild(n){return n.children.some(e=>e instanceof TreeBuffer||!e.type.isAnonymous||hasChild(e))}function buildTree(n){var e;let{buffer:r,nodeSet:o,maxBufferLength:s=DefaultBufferLength,reused:l=[],minRepeatType:a=o.types.length}=n,c=Array.isArray(r)?new FlatBufferCursor(r,r.length):r,u=o.types,f=0,d=0;function g(_,L,Y,I,Le){let{id:oe,start:G,end:Z,size:Ee}=c,We=d;for(;Ee<0;)if(c.next(),Ee==-1){let Ae=l[oe];Y.push(Ae),I.push(G-_);return}else if(Ee==-3){f=oe;return}else if(Ee==-4){d=oe;return}else throw new RangeError(`Unrecognized record size: ${Ee}`);let K=u[oe],ge,ne,le=G-_;if(Z-G<=s&&(ne=k(c.pos-L,Le))){let Ae=new Uint16Array(ne.size-ne.skip),Ve=c.pos-ne.size,fe=Ae.length;for(;c.pos>Ve;)fe=A(ne.start,Ae,fe);ge=new TreeBuffer(Ae,Z-ne.start,o),le=ne.start-_}else{let Ae=c.pos-Ee;c.next();let Ve=[],fe=[],Ze=oe>=a?oe:-1,_e=0,ut=Z;for(;c.pos>Ae;)Ze>=0&&c.id==Ze&&c.size>=0?(c.end<=ut-s&&(v(Ve,fe,G,_e,c.end,ut,Ze,We),_e=Ve.length,ut=c.end),c.next()):g(G,Ae,Ve,fe,Ze);if(Ze>=0&&_e>0&&_e<Ve.length&&v(Ve,fe,G,_e,G,ut,Ze,We),Ve.reverse(),fe.reverse(),Ze>-1&&_e>0){let st=m(K);ge=balanceRange(K,Ve,fe,0,Ve.length,0,Z-G,st,st)}else ge=b(K,Ve,fe,Z-G,We-Z)}Y.push(ge),I.push(le)}function m(_){return(L,Y,I)=>{let Le=0,oe=L.length-1,G,Z;if(oe>=0&&(G=L[oe])instanceof Tree){if(!oe&&G.type==_&&G.length==I)return G;(Z=G.prop(NodeProp.lookAhead))&&(Le=Y[oe]+G.length+Z)}return b(_,L,Y,I,Le)}}function v(_,L,Y,I,Le,oe,G,Z){let Ee=[],We=[];for(;_.length>I;)Ee.push(_.pop()),We.push(L.pop()+Y-Le);_.push(b(o.types[G],Ee,We,oe-Le,Z-oe)),L.push(Le-Y)}function b(_,L,Y,I,Le=0,oe){if(f){let G=[NodeProp.contextHash,f];oe=oe?[G].concat(oe):[G]}if(Le>25){let G=[NodeProp.lookAhead,Le];oe=oe?[G].concat(oe):[G]}return new Tree(_,L,Y,I,oe)}function k(_,L){let Y=c.fork(),I=0,Le=0,oe=0,G=Y.end-s,Z={size:0,start:0,skip:0};e:for(let Ee=Y.pos-_;Y.pos>Ee;){let We=Y.size;if(Y.id==L&&We>=0){Z.size=I,Z.start=Le,Z.skip=oe,oe+=4,I+=4,Y.next();continue}let K=Y.pos-We;if(We<0||K<Ee||Y.start<G)break;let ge=Y.id>=a?4:0,ne=Y.start;for(Y.next();Y.pos>K;){if(Y.size<0)if(Y.size==-3)ge+=4;else break e;else Y.id>=a&&(ge+=4);Y.next()}Le=ne,I+=We,oe+=ge}return(L<0||I==_)&&(Z.size=I,Z.start=Le,Z.skip=oe),Z.size>4?Z:void 0}function A(_,L,Y){let{id:I,start:Le,end:oe,size:G}=c;if(c.next(),G>=0&&I<a){let Z=Y;if(G>4){let Ee=c.pos-(G-4);for(;c.pos>Ee;)Y=A(_,L,Y)}L[--Y]=Z,L[--Y]=oe-_,L[--Y]=Le-_,L[--Y]=I}else G==-3?f=I:G==-4&&(d=I);return Y}let R=[],$=[];for(;c.pos>0;)g(n.start||0,n.bufferStart||0,R,$,-1);let J=(e=n.length)!==null&&e!==void 0?e:R.length?$[0]+R[0].length:0;return new Tree(u[n.topID],R.reverse(),$.reverse(),J)}const nodeSizeCache=new WeakMap;function nodeSize(n,e){if(!n.isAnonymous||e instanceof TreeBuffer||e.type!=n)return 1;let r=nodeSizeCache.get(e);if(r==null){r=1;for(let o of e.children){if(o.type!=n||!(o instanceof Tree)){r=1;break}r+=nodeSize(n,o)}nodeSizeCache.set(e,r)}return r}function balanceRange(n,e,r,o,s,l,a,c,u){let f=0;for(let b=o;b<s;b++)f+=nodeSize(n,e[b]);let d=Math.ceil(f*1.5/8),g=[],m=[];function v(b,k,A,R,$){for(let J=A;J<R;){let _=J,L=k[J],Y=nodeSize(n,b[J]);for(J++;J<R;J++){let I=nodeSize(n,b[J]);if(Y+I>=d)break;Y+=I}if(J==_+1){if(Y>d){let I=b[_];v(I.children,I.positions,0,I.children.length,k[_]+$);continue}g.push(b[_])}else{let I=k[J-1]+b[J-1].length-L;g.push(balanceRange(n,b,k,_,J,L,I,null,u))}m.push(L+$-l)}}return v(e,r,o,s,0),(c||u)(g,m,a)}class TreeFragment{constructor(e,r,o,s,l=!1,a=!1){this.from=e,this.to=r,this.tree=o,this.offset=s,this.open=(l?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,r=[],o=!1){let s=[new TreeFragment(0,e.length,e,0,!1,o)];for(let l of r)l.to>e.length&&s.push(l);return s}static applyChanges(e,r,o=128){if(!r.length)return e;let s=[],l=1,a=e.length?e[0]:null;for(let c=0,u=0,f=0;;c++){let d=c<r.length?r[c]:null,g=d?d.fromA:1e9;if(g-u>=o)for(;a&&a.from<g;){let m=a;if(u>=m.from||g<=m.to||f){let v=Math.max(m.from,u)-f,b=Math.min(m.to,g)-f;m=v>=b?null:new TreeFragment(v,b,m.tree,m.offset+f,c>0,!!d)}if(m&&s.push(m),a.to>g)break;a=l<e.length?e[l++]:null}if(!d)break;u=d.toA,f=d.toA-d.toB}return s}}class Parser{startParse(e,r,o){return typeof e=="string"&&(e=new StringInput(e)),o=o?o.length?o.map(s=>new Range(s.from,s.to)):[new Range(0,0)]:[new Range(0,e.length)],this.createParse(e,r||[],o)}parse(e,r,o){let s=this.startParse(e,r,o);for(;;){let l=s.advance();if(l)return l}}}class StringInput{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,r){return this.string.slice(e,r)}}new NodeProp({perNode:!0});let nextTagID=0;class Tag{constructor(e,r,o){this.set=e,this.base=r,this.modified=o,this.id=nextTagID++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let r=new Tag([],null,[]);if(r.set.push(r),e)for(let o of e.set)r.set.push(o);return r}static defineModifier(){let e=new Modifier;return r=>r.modified.indexOf(e)>-1?r:Modifier.get(r.base||r,r.modified.concat(e).sort((o,s)=>o.id-s.id))}}let nextModifierID=0;class Modifier{constructor(){this.instances=[],this.id=nextModifierID++}static get(e,r){if(!r.length)return e;let o=r[0].instances.find(c=>c.base==e&&sameArray(r,c.modified));if(o)return o;let s=[],l=new Tag(s,e,r);for(let c of r)c.instances.push(l);let a=powerSet(r);for(let c of e.set)if(!c.modified.length)for(let u of a)s.push(Modifier.get(c,u));return l}}function sameArray(n,e){return n.length==e.length&&n.every((r,o)=>r==e[o])}function powerSet(n){let e=[[]];for(let r=0;r<n.length;r++)for(let o=0,s=e.length;o<s;o++)e.push(e[o].concat(n[r]));return e.sort((r,o)=>o.length-r.length)}function styleTags(n){let e=Object.create(null);for(let r in n){let o=n[r];Array.isArray(o)||(o=[o]);for(let s of r.split(" "))if(s){let l=[],a=2,c=s;for(let g=0;;){if(c=="..."&&g>0&&g+3==s.length){a=1;break}let m=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(c);if(!m)throw new RangeError("Invalid path: "+s);if(l.push(m[0]=="*"?"":m[0][0]=='"'?JSON.parse(m[0]):m[0]),g+=m[0].length,g==s.length)break;let v=s[g++];if(g==s.length&&v=="!"){a=0;break}if(v!="/")throw new RangeError("Invalid path: "+s);c=s.slice(g)}let u=l.length-1,f=l[u];if(!f)throw new RangeError("Invalid path: "+s);let d=new Rule(o,a,u>0?l.slice(0,u):null);e[f]=d.sort(e[f])}}return ruleNodeProp.add(e)}const ruleNodeProp=new NodeProp;class Rule{constructor(e,r,o,s){this.tags=e,this.mode=r,this.context=o,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Rule.empty=new Rule([],2,null);function tagHighlighter(n,e){let r=Object.create(null);for(let l of n)if(!Array.isArray(l.tag))r[l.tag.id]=l.class;else for(let a of l.tag)r[a.id]=l.class;let{scope:o,all:s=null}=e||{};return{style:l=>{let a=s;for(let c of l)for(let u of c.set){let f=r[u.id];if(f){a=a?a+" "+f:f;break}}return a},scope:o}}function highlightTags(n,e){let r=null;for(let o of n){let s=o.style(e);s&&(r=r?r+" "+s:s)}return r}function highlightTree(n,e,r,o=0,s=n.length){let l=new HighlightBuilder(o,Array.isArray(e)?e:[e],r);l.highlightRange(n.cursor(),o,s,"",l.highlighters),l.flush(s)}class HighlightBuilder{constructor(e,r,o){this.at=e,this.highlighters=r,this.span=o,this.class=""}startSpan(e,r){r!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=r)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,r,o,s,l){let{type:a,from:c,to:u}=e;if(c>=o||u<=r)return;a.isTop&&(l=this.highlighters.filter(v=>!v.scope||v.scope(a)));let f=s,d=getStyleTags(e)||Rule.empty,g=highlightTags(l,d.tags);if(g&&(f&&(f+=" "),f+=g,d.mode==1&&(s+=(s?" ":"")+g)),this.startSpan(e.from,f),d.opaque)return;let m=e.tree&&e.tree.prop(NodeProp.mounted);if(m&&m.overlay){let v=e.node.enter(m.overlay[0].from+c,1),b=this.highlighters.filter(A=>!A.scope||A.scope(m.tree.type)),k=e.firstChild();for(let A=0,R=c;;A++){let $=A<m.overlay.length?m.overlay[A]:null,J=$?$.from+c:u,_=Math.max(r,R),L=Math.min(o,J);if(_<L&&k)for(;e.from<L&&(this.highlightRange(e,_,L,s,l),this.startSpan(Math.min(L,e.to),f),!(e.to>=J||!e.nextSibling())););if(!$||J>o)break;R=$.to+c,R>r&&(this.highlightRange(v.cursor(),Math.max(r,$.from+c),Math.min(o,R),s,b),this.startSpan(R,f))}k&&e.parent()}else if(e.firstChild()){do if(!(e.to<=r)){if(e.from>=o)break;this.highlightRange(e,r,o,s,l),this.startSpan(Math.min(o,e.to),f)}while(e.nextSibling());e.parent()}}}function getStyleTags(n){let e=n.type.prop(ruleNodeProp);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const t=Tag.define,comment=t(),name=t(),typeName=t(name),propertyName=t(name),literal=t(),string=t(literal),number=t(literal),content=t(),heading=t(content),keyword=t(),operator=t(),punctuation=t(),bracket=t(punctuation),meta=t(),tags={comment,lineComment:t(comment),blockComment:t(comment),docComment:t(comment),name,variableName:t(name),typeName,tagName:t(typeName),propertyName,attributeName:t(propertyName),className:t(name),labelName:t(name),namespace:t(name),macroName:t(name),literal,string,docString:t(string),character:t(string),attributeValue:t(string),number,integer:t(number),float:t(number),bool:t(literal),regexp:t(literal),escape:t(literal),color:t(literal),url:t(literal),keyword,self:t(keyword),null:t(keyword),atom:t(keyword),unit:t(keyword),modifier:t(keyword),operatorKeyword:t(keyword),controlKeyword:t(keyword),definitionKeyword:t(keyword),moduleKeyword:t(keyword),operator,derefOperator:t(operator),arithmeticOperator:t(operator),logicOperator:t(operator),bitwiseOperator:t(operator),compareOperator:t(operator),updateOperator:t(operator),definitionOperator:t(operator),typeOperator:t(operator),controlOperator:t(operator),punctuation,separator:t(punctuation),bracket,angleBracket:t(bracket),squareBracket:t(bracket),paren:t(bracket),brace:t(bracket),content,heading,heading1:t(heading),heading2:t(heading),heading3:t(heading),heading4:t(heading),heading5:t(heading),heading6:t(heading),contentSeparator:t(content),list:t(content),quote:t(content),emphasis:t(content),strong:t(content),link:t(content),monospace:t(content),strikethrough:t(content),inserted:t(),deleted:t(),changed:t(),invalid:t(),meta,documentMeta:t(meta),annotation:t(meta),processingInstruction:t(meta),definition:Tag.defineModifier(),constant:Tag.defineModifier(),function:Tag.defineModifier(),standard:Tag.defineModifier(),local:Tag.defineModifier(),special:Tag.defineModifier()};tagHighlighter([{tag:tags.link,class:"tok-link"},{tag:tags.heading,class:"tok-heading"},{tag:tags.emphasis,class:"tok-emphasis"},{tag:tags.strong,class:"tok-strong"},{tag:tags.keyword,class:"tok-keyword"},{tag:tags.atom,class:"tok-atom"},{tag:tags.bool,class:"tok-bool"},{tag:tags.url,class:"tok-url"},{tag:tags.labelName,class:"tok-labelName"},{tag:tags.inserted,class:"tok-inserted"},{tag:tags.deleted,class:"tok-deleted"},{tag:tags.literal,class:"tok-literal"},{tag:tags.string,class:"tok-string"},{tag:tags.number,class:"tok-number"},{tag:[tags.regexp,tags.escape,tags.special(tags.string)],class:"tok-string2"},{tag:tags.variableName,class:"tok-variableName"},{tag:tags.local(tags.variableName),class:"tok-variableName tok-local"},{tag:tags.definition(tags.variableName),class:"tok-variableName tok-definition"},{tag:tags.special(tags.variableName),class:"tok-variableName2"},{tag:tags.definition(tags.propertyName),class:"tok-propertyName tok-definition"},{tag:tags.typeName,class:"tok-typeName"},{tag:tags.namespace,class:"tok-namespace"},{tag:tags.className,class:"tok-className"},{tag:tags.macroName,class:"tok-macroName"},{tag:tags.propertyName,class:"tok-propertyName"},{tag:tags.operator,class:"tok-operator"},{tag:tags.comment,class:"tok-comment"},{tag:tags.meta,class:"tok-meta"},{tag:tags.invalid,class:"tok-invalid"},{tag:tags.punctuation,class:"tok-punctuation"}]);var _a$1;const languageDataProp=new NodeProp;function defineLanguageFacet(n){return Facet.define({combine:n?e=>e.concat(n):void 0})}const sublanguageProp=new NodeProp;class Language{constructor(e,r,o=[],s=""){this.data=e,this.name=s,EditorState.prototype.hasOwnProperty("tree")||Object.defineProperty(EditorState.prototype,"tree",{get(){return syntaxTree(this)}}),this.parser=r,this.extension=[language.of(this),EditorState.languageData.of((l,a,c)=>{let u=topNodeAt(l,a,c),f=u.type.prop(languageDataProp);if(!f)return[];let d=l.facet(f),g=u.type.prop(sublanguageProp);if(g){let m=u.resolve(a-u.from,c);for(let v of g)if(v.test(m,l)){let b=l.facet(v.facet);return v.type=="replace"?b:b.concat(d)}}return d})].concat(o)}isActiveAt(e,r,o=-1){return topNodeAt(e,r,o).type.prop(languageDataProp)==this.data}findRegions(e){let r=e.facet(language);if((r==null?void 0:r.data)==this.data)return[{from:0,to:e.doc.length}];if(!r||!r.allowsNesting)return[];let o=[],s=(l,a)=>{if(l.prop(languageDataProp)==this.data){o.push({from:a,to:a+l.length});return}let c=l.prop(NodeProp.mounted);if(c){if(c.tree.prop(languageDataProp)==this.data){if(c.overlay)for(let u of c.overlay)o.push({from:u.from+a,to:u.to+a});else o.push({from:a,to:a+l.length});return}else if(c.overlay){let u=o.length;if(s(c.tree,c.overlay[0].from+a),o.length>u)return}}for(let u=0;u<l.children.length;u++){let f=l.children[u];f instanceof Tree&&s(f,l.positions[u]+a)}};return s(syntaxTree(e),0),o}get allowsNesting(){return!0}}Language.setState=StateEffect.define();function topNodeAt(n,e,r){let o=n.facet(language),s=syntaxTree(n).topNode;if(!o||o.allowsNesting)for(let l=s;l;l=l.enter(e,r,IterMode.ExcludeBuffers))l.type.isTop&&(s=l);return s}class LRLanguage extends Language{constructor(e,r,o){super(e,r,[],o),this.parser=r}static define(e){let r=defineLanguageFacet(e.languageData);return new LRLanguage(r,e.parser.configure({props:[languageDataProp.add(o=>o.isTop?r:void 0)]}),e.name)}configure(e,r){return new LRLanguage(this.data,this.parser.configure(e),r||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function syntaxTree(n){let e=n.field(Language.state,!1);return e?e.tree:Tree.empty}class DocInput{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,r){let o=this.cursorPos-this.string.length;return e<o||r>=this.cursorPos?this.doc.sliceString(e,r):this.string.slice(e-o,r-o)}}let currentContext=null;class ParseContext{constructor(e,r,o=[],s,l,a,c,u){this.parser=e,this.state=r,this.fragments=o,this.tree=s,this.treeLen=l,this.viewport=a,this.skipped=c,this.scheduleOn=u,this.parse=null,this.tempSkipped=[]}static create(e,r,o){return new ParseContext(e,r,[],Tree.empty,0,o,[],null)}startParse(){return this.parser.startParse(new DocInput(this.state.doc),this.fragments)}work(e,r){return r!=null&&r>=this.state.doc.length&&(r=void 0),this.tree!=Tree.empty&&this.isDone(r??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var o;if(typeof e=="number"){let s=Date.now()+e;e=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),r!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>r)&&r<this.state.doc.length&&this.parse.stopAt(r);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(TreeFragment.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(o=this.parse.stoppedAt)!==null&&o!==void 0?o:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(r??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,r;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(r=this.parse.advance()););}),this.treeLen=e,this.tree=r,this.fragments=this.withoutTempSkipped(TreeFragment.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let r=currentContext;currentContext=this;try{return e()}finally{currentContext=r}}withoutTempSkipped(e){for(let r;r=this.tempSkipped.pop();)e=cutFragments(e,r.from,r.to);return e}changes(e,r){let{fragments:o,tree:s,treeLen:l,viewport:a,skipped:c}=this;if(this.takeTree(),!e.empty){let u=[];if(e.iterChangedRanges((f,d,g,m)=>u.push({fromA:f,toA:d,fromB:g,toB:m})),o=TreeFragment.applyChanges(o,u),s=Tree.empty,l=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){c=[];for(let f of this.skipped){let d=e.mapPos(f.from,1),g=e.mapPos(f.to,-1);d<g&&c.push({from:d,to:g})}}}return new ParseContext(this.parser,r,o,s,l,a,c,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let r=this.skipped.length;for(let o=0;o<this.skipped.length;o++){let{from:s,to:l}=this.skipped[o];s<e.to&&l>e.from&&(this.fragments=cutFragments(this.fragments,s,l),this.skipped.splice(o--,1))}return this.skipped.length>=r?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,r){this.skipped.push({from:e,to:r})}static getSkippingParser(e){return new class extends Parser{createParse(r,o,s){let l=s[0].from,a=s[s.length-1].to;return{parsedPos:l,advance(){let u=currentContext;if(u){for(let f of s)u.tempSkipped.push(f);e&&(u.scheduleOn=u.scheduleOn?Promise.all([u.scheduleOn,e]):e)}return this.parsedPos=a,new Tree(NodeType.none,[],[],a-l)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let r=this.fragments;return this.treeLen>=e&&r.length&&r[0].from==0&&r[0].to>=e}static get(){return currentContext}}function cutFragments(n,e,r){return TreeFragment.applyChanges(n,[{fromA:e,toA:r,fromB:e,toB:r}])}class LanguageState{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let r=this.context.changes(e.changes,e.state),o=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),r.viewport.to);return r.work(20,o)||r.takeTree(),new LanguageState(r)}static init(e){let r=Math.min(3e3,e.doc.length),o=ParseContext.create(e.facet(language).parser,e,{from:0,to:r});return o.work(20,r)||o.takeTree(),new LanguageState(o)}}Language.state=StateField.define({create:LanguageState.init,update(n,e){for(let r of e.effects)if(r.is(Language.setState))return r.value;return e.startState.facet(language)!=e.state.facet(language)?LanguageState.init(e.state):n.apply(e)}});let requestIdle=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(requestIdle=n=>{let e=-1,r=setTimeout(()=>{e=requestIdleCallback(n,{timeout:500-100})},100);return()=>e<0?clearTimeout(r):cancelIdleCallback(e)});const isInputPending=typeof navigator<"u"&&(!((_a$1=navigator.scheduling)===null||_a$1===void 0)&&_a$1.isInputPending)?()=>navigator.scheduling.isInputPending():null,parseWorker=ViewPlugin.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let r=this.view.state.field(Language.state).context;(r.updateViewport(e.view.viewport)||this.view.viewport.to>r.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(r)}scheduleWork(){if(this.working)return;let{state:e}=this.view,r=e.field(Language.state);(r.tree!=r.context.tree||!r.context.isDone(e.doc.length))&&(this.working=requestIdle(this.work))}work(e){this.working=null;let r=Date.now();if(this.chunkEnd<r&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=r+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:o,viewport:{to:s}}=this.view,l=o.field(Language.state);if(l.tree==l.context.tree&&l.context.isDone(s+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!isInputPending?Math.max(25,e.timeRemaining()-5):1e9),c=l.context.treeLen<s&&o.doc.length>s+1e3,u=l.context.work(()=>isInputPending&&isInputPending()||Date.now()>a,s+(c?0:1e5));this.chunkBudget-=Date.now()-r,(u||this.chunkBudget<=0)&&(l.context.takeTree(),this.view.dispatch({effects:Language.setState.of(new LanguageState(l.context))})),this.chunkBudget>0&&!(u&&!c)&&this.scheduleWork(),this.checkAsyncSchedule(l.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(r=>logException(this.view.state,r)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),language=Facet.define({combine(n){return n.length?n[0]:null},enables:n=>[Language.state,parseWorker,EditorView.contentAttributes.compute([n],e=>{let r=e.facet(n);return r&&r.name?{"data-language":r.name}:{}})]});class LanguageSupport{constructor(e,r=[]){this.language=e,this.support=r,this.extension=[e,r]}}const indentService=Facet.define(),indentUnit=Facet.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(r=>r!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function getIndentUnit(n){let e=n.facet(indentUnit);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function indentString(n,e){let r="",o=n.tabSize,s=n.facet(indentUnit)[0];if(s=="	"){for(;e>=o;)r+="	",e-=o;s=" "}for(let l=0;l<e;l++)r+=s;return r}function getIndentation(n,e){n instanceof EditorState&&(n=new IndentContext(n));for(let o of n.state.facet(indentService)){let s=o(n,e);if(s!==void 0)return s}let r=syntaxTree(n.state);return r?syntaxIndentation(n,r,e):null}class IndentContext{constructor(e,r={}){this.state=e,this.options=r,this.unit=getIndentUnit(e)}lineAt(e,r=1){let o=this.state.doc.lineAt(e),{simulateBreak:s,simulateDoubleBreak:l}=this.options;return s!=null&&s>=o.from&&s<=o.to?l&&s==e?{text:"",from:e}:(r<0?s<e:s<=e)?{text:o.text.slice(s-o.from),from:s}:{text:o.text.slice(0,s-o.from),from:o.from}:o}textAfterPos(e,r=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:o,from:s}=this.lineAt(e,r);return o.slice(e-s,Math.min(o.length,e+100-s))}column(e,r=1){let{text:o,from:s}=this.lineAt(e,r),l=this.countColumn(o,e-s),a=this.options.overrideIndentation?this.options.overrideIndentation(s):-1;return a>-1&&(l+=a-this.countColumn(o,o.search(/\S|$/))),l}countColumn(e,r=e.length){return countColumn(e,this.state.tabSize,r)}lineIndent(e,r=1){let{text:o,from:s}=this.lineAt(e,r),l=this.options.overrideIndentation;if(l){let a=l(s);if(a>-1)return a}return this.countColumn(o,o.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const indentNodeProp=new NodeProp;function syntaxIndentation(n,e,r){return indentFrom(e.resolveInner(r).enterUnfinishedNodesBefore(r),r,n)}function ignoreClosed(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function indentStrategy(n){let e=n.type.prop(indentNodeProp);if(e)return e;let r=n.firstChild,o;if(r&&(o=r.type.prop(NodeProp.closedBy))){let s=n.lastChild,l=s&&o.indexOf(s.name)>-1;return a=>delimitedStrategy(a,!0,1,void 0,l&&!ignoreClosed(a)?s.from:void 0)}return n.parent==null?topIndent:null}function indentFrom(n,e,r){for(;n;n=n.parent){let o=indentStrategy(n);if(o)return o(TreeIndentContext.create(r,e,n))}return null}function topIndent(){return 0}class TreeIndentContext extends IndentContext{constructor(e,r,o){super(e.state,e.options),this.base=e,this.pos=r,this.node=o}static create(e,r,o){return new TreeIndentContext(e,r,o)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let e=this.state.doc.lineAt(this.node.from);for(;;){let r=this.node.resolve(e.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(isParent(r,this.node))break;e=this.state.doc.lineAt(r.from)}return this.lineIndent(e.from)}continue(){let e=this.node.parent;return e?indentFrom(e,this.pos,this.base):0}}function isParent(n,e){for(let r=e;r;r=r.parent)if(n==r)return!0;return!1}function bracketedAligned(n){let e=n.node,r=e.childAfter(e.from),o=e.lastChild;if(!r)return null;let s=n.options.simulateBreak,l=n.state.doc.lineAt(r.from),a=s==null||s<=l.from?l.to:Math.min(l.to,s);for(let c=r.to;;){let u=e.childAfter(c);if(!u||u==o)return null;if(!u.type.isSkipped)return u.from<a?r:null;c=u.to}}function delimitedStrategy(n,e,r,o,s){let l=n.textAfter,a=l.match(/^\s*/)[0].length,c=o&&l.slice(a,a+o.length)==o||s==n.pos+a,u=e?bracketedAligned(n):null;return u?c?n.column(u.from):n.column(u.to):n.baseIndent+(c?0:n.unit*r)}function continuedIndent({except:n,units:e=1}={}){return r=>{let o=n&&n.test(r.textAfter);return r.baseIndent+(o?0:e*r.unit)}}const DontIndentBeyond=200;function indentOnInput(){return EditorState.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let e=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!e.length)return n;let r=n.newDoc,{head:o}=n.newSelection.main,s=r.lineAt(o);if(o>s.from+DontIndentBeyond)return n;let l=r.sliceString(s.from,o);if(!e.some(f=>f.test(l)))return n;let{state:a}=n,c=-1,u=[];for(let{head:f}of a.selection.ranges){let d=a.doc.lineAt(f);if(d.from==c)continue;c=d.from;let g=getIndentation(a,d.from);if(g==null)continue;let m=/^\s*/.exec(d.text)[0],v=indentString(a,g);m!=v&&u.push({from:d.from,to:d.from+m.length,insert:v})}return u.length?[n,{changes:u,sequential:!0}]:n})}const foldService=Facet.define(),foldNodeProp=new NodeProp;function foldInside(n){let e=n.firstChild,r=n.lastChild;return e&&e.to<r.from?{from:e.to,to:r.type.isError?n.to:r.from}:null}function syntaxFolding(n,e,r){let o=syntaxTree(n);if(o.length<r)return null;let s=o.resolveInner(r,1),l=null;for(let a=s;a;a=a.parent){if(a.to<=r||a.from>r)continue;if(l&&a.from<e)break;let c=a.type.prop(foldNodeProp);if(c&&(a.to<o.length-50||o.length==n.doc.length||!isUnfinished(a))){let u=c(a,n);u&&u.from<=r&&u.from>=e&&u.to>r&&(l=u)}}return l}function isUnfinished(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function foldable(n,e,r){for(let o of n.facet(foldService)){let s=o(n,e,r);if(s)return s}return syntaxFolding(n,e,r)}function mapRange(n,e){let r=e.mapPos(n.from,1),o=e.mapPos(n.to,-1);return r>=o?void 0:{from:r,to:o}}const foldEffect=StateEffect.define({map:mapRange}),unfoldEffect=StateEffect.define({map:mapRange});function selectedLines(n){let e=[];for(let{head:r}of n.state.selection.ranges)e.some(o=>o.from<=r&&o.to>=r)||e.push(n.lineBlockAt(r));return e}const foldState=StateField.define({create(){return Decoration.none},update(n,e){n=n.map(e.changes);for(let r of e.effects)r.is(foldEffect)&&!foldExists(n,r.value.from,r.value.to)?n=n.update({add:[foldWidget.range(r.value.from,r.value.to)]}):r.is(unfoldEffect)&&(n=n.update({filter:(o,s)=>r.value.from!=o||r.value.to!=s,filterFrom:r.value.from,filterTo:r.value.to}));if(e.selection){let r=!1,{head:o}=e.selection.main;n.between(o,o,(s,l)=>{s<o&&l>o&&(r=!0)}),r&&(n=n.update({filterFrom:o,filterTo:o,filter:(s,l)=>l<=o||s>=o}))}return n},provide:n=>EditorView.decorations.from(n),toJSON(n,e){let r=[];return n.between(0,e.doc.length,(o,s)=>{r.push(o,s)}),r},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let r=0;r<n.length;){let o=n[r++],s=n[r++];if(typeof o!="number"||typeof s!="number")throw new RangeError("Invalid JSON for fold state");e.push(foldWidget.range(o,s))}return Decoration.set(e,!0)}});function findFold(n,e,r){var o;let s=null;return(o=n.field(foldState,!1))===null||o===void 0||o.between(e,r,(l,a)=>{(!s||s.from>l)&&(s={from:l,to:a})}),s}function foldExists(n,e,r){let o=!1;return n.between(e,e,(s,l)=>{s==e&&l==r&&(o=!0)}),o}function maybeEnable(n,e){return n.field(foldState,!1)?e:e.concat(StateEffect.appendConfig.of(codeFolding()))}const foldCode=n=>{for(let e of selectedLines(n)){let r=foldable(n.state,e.from,e.to);if(r)return n.dispatch({effects:maybeEnable(n.state,[foldEffect.of(r),announceFold(n,r)])}),!0}return!1},unfoldCode=n=>{if(!n.state.field(foldState,!1))return!1;let e=[];for(let r of selectedLines(n)){let o=findFold(n.state,r.from,r.to);o&&e.push(unfoldEffect.of(o),announceFold(n,o,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function announceFold(n,e,r=!0){let o=n.state.doc.lineAt(e.from).number,s=n.state.doc.lineAt(e.to).number;return EditorView.announce.of(`${n.state.phrase(r?"Folded lines":"Unfolded lines")} ${o} ${n.state.phrase("to")} ${s}.`)}const foldAll=n=>{let{state:e}=n,r=[];for(let o=0;o<e.doc.length;){let s=n.lineBlockAt(o),l=foldable(e,s.from,s.to);l&&r.push(foldEffect.of(l)),o=(l?n.lineBlockAt(l.to):s).to+1}return r.length&&n.dispatch({effects:maybeEnable(n.state,r)}),!!r.length},unfoldAll=n=>{let e=n.state.field(foldState,!1);if(!e||!e.size)return!1;let r=[];return e.between(0,n.state.doc.length,(o,s)=>{r.push(unfoldEffect.of({from:o,to:s}))}),n.dispatch({effects:r}),!0},foldKeymap=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:foldCode},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:unfoldCode},{key:"Ctrl-Alt-[",run:foldAll},{key:"Ctrl-Alt-]",run:unfoldAll}],defaultConfig={placeholderDOM:null,placeholderText:""},foldConfig=Facet.define({combine(n){return combineConfig(n,defaultConfig)}});function codeFolding(n){let e=[foldState,baseTheme$1$2];return n&&e.push(foldConfig.of(n)),e}const foldWidget=Decoration.replace({widget:new class extends WidgetType{toDOM(n){let{state:e}=n,r=e.facet(foldConfig),o=l=>{let a=n.lineBlockAt(n.posAtDOM(l.target)),c=findFold(n.state,a.from,a.to);c&&n.dispatch({effects:unfoldEffect.of(c)}),l.preventDefault()};if(r.placeholderDOM)return r.placeholderDOM(n,o);let s=document.createElement("span");return s.textContent=r.placeholderText,s.setAttribute("aria-label",e.phrase("folded code")),s.title=e.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=o,s}}}),foldGutterDefaults={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class FoldMarker extends GutterMarker{constructor(e,r){super(),this.config=e,this.open=r}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let r=document.createElement("span");return r.textContent=this.open?this.config.openText:this.config.closedText,r.title=e.state.phrase(this.open?"Fold line":"Unfold line"),r}}function foldGutter(n={}){let e=Object.assign(Object.assign({},foldGutterDefaults),n),r=new FoldMarker(e,!0),o=new FoldMarker(e,!1),s=ViewPlugin.fromClass(class{constructor(a){this.from=a.viewport.from,this.markers=this.buildMarkers(a)}update(a){(a.docChanged||a.viewportChanged||a.startState.facet(language)!=a.state.facet(language)||a.startState.field(foldState,!1)!=a.state.field(foldState,!1)||syntaxTree(a.startState)!=syntaxTree(a.state)||e.foldingChanged(a))&&(this.markers=this.buildMarkers(a.view))}buildMarkers(a){let c=new RangeSetBuilder;for(let u of a.viewportLineBlocks){let f=findFold(a.state,u.from,u.to)?o:foldable(a.state,u.from,u.to)?r:null;f&&c.add(u.from,u.from,f)}return c.finish()}}),{domEventHandlers:l}=e;return[s,gutter({class:"cm-foldGutter",markers(a){var c;return((c=a.plugin(s))===null||c===void 0?void 0:c.markers)||RangeSet.empty},initialSpacer(){return new FoldMarker(e,!1)},domEventHandlers:Object.assign(Object.assign({},l),{click:(a,c,u)=>{if(l.click&&l.click(a,c,u))return!0;let f=findFold(a.state,c.from,c.to);if(f)return a.dispatch({effects:unfoldEffect.of(f)}),!0;let d=foldable(a.state,c.from,c.to);return d?(a.dispatch({effects:foldEffect.of(d)}),!0):!1}})}),codeFolding()]}const baseTheme$1$2=EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class HighlightStyle{constructor(e,r){this.specs=e;let o;function s(c){let u=StyleModule.newName();return(o||(o=Object.create(null)))["."+u]=c,u}const l=typeof r.all=="string"?r.all:r.all?s(r.all):void 0,a=r.scope;this.scope=a instanceof Language?c=>c.prop(languageDataProp)==a.data:a?c=>c==a:void 0,this.style=tagHighlighter(e.map(c=>({tag:c.tag,class:c.class||s(Object.assign({},c,{tag:null}))})),{all:l}).style,this.module=o?new StyleModule(o):null,this.themeType=r.themeType}static define(e,r){return new HighlightStyle(e,r||{})}}const highlighterFacet=Facet.define(),fallbackHighlighter=Facet.define({combine(n){return n.length?[n[0]]:null}});function getHighlighters(n){let e=n.facet(highlighterFacet);return e.length?e:n.facet(fallbackHighlighter)}function syntaxHighlighting(n,e){let r=[treeHighlighter],o;return n instanceof HighlightStyle&&(n.module&&r.push(EditorView.styleModule.of(n.module)),o=n.themeType),e!=null&&e.fallback?r.push(fallbackHighlighter.of(n)):o?r.push(highlighterFacet.computeN([EditorView.darkTheme],s=>s.facet(EditorView.darkTheme)==(o=="dark")?[n]:[])):r.push(highlighterFacet.of(n)),r}class TreeHighlighter{constructor(e){this.markCache=Object.create(null),this.tree=syntaxTree(e.state),this.decorations=this.buildDeco(e,getHighlighters(e.state))}update(e){let r=syntaxTree(e.state),o=getHighlighters(e.state),s=o!=getHighlighters(e.startState);r.length<e.view.viewport.to&&!s&&r.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(r!=this.tree||e.viewportChanged||s)&&(this.tree=r,this.decorations=this.buildDeco(e.view,o))}buildDeco(e,r){if(!r||!this.tree.length)return Decoration.none;let o=new RangeSetBuilder;for(let{from:s,to:l}of e.visibleRanges)highlightTree(this.tree,r,(a,c,u)=>{o.add(a,c,this.markCache[u]||(this.markCache[u]=Decoration.mark({class:u})))},s,l);return o.finish()}}const treeHighlighter=Prec.high(ViewPlugin.fromClass(TreeHighlighter,{decorations:n=>n.decorations})),defaultHighlightStyle=HighlightStyle.define([{tag:tags.meta,color:"#404740"},{tag:tags.link,textDecoration:"underline"},{tag:tags.heading,textDecoration:"underline",fontWeight:"bold"},{tag:tags.emphasis,fontStyle:"italic"},{tag:tags.strong,fontWeight:"bold"},{tag:tags.strikethrough,textDecoration:"line-through"},{tag:tags.keyword,color:"#708"},{tag:[tags.atom,tags.bool,tags.url,tags.contentSeparator,tags.labelName],color:"#219"},{tag:[tags.literal,tags.inserted],color:"#164"},{tag:[tags.string,tags.deleted],color:"#a11"},{tag:[tags.regexp,tags.escape,tags.special(tags.string)],color:"#e40"},{tag:tags.definition(tags.variableName),color:"#00f"},{tag:tags.local(tags.variableName),color:"#30a"},{tag:[tags.typeName,tags.namespace],color:"#085"},{tag:tags.className,color:"#167"},{tag:[tags.special(tags.variableName),tags.macroName],color:"#256"},{tag:tags.definition(tags.propertyName),color:"#00c"},{tag:tags.comment,color:"#940"},{tag:tags.invalid,color:"#f00"}]),baseTheme$3=EditorView.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),DefaultScanDist=1e4,DefaultBrackets="()[]{}",bracketMatchingConfig=Facet.define({combine(n){return combineConfig(n,{afterCursor:!0,brackets:DefaultBrackets,maxScanDistance:DefaultScanDist,renderMatch:defaultRenderMatch})}}),matchingMark=Decoration.mark({class:"cm-matchingBracket"}),nonmatchingMark=Decoration.mark({class:"cm-nonmatchingBracket"});function defaultRenderMatch(n){let e=[],r=n.matched?matchingMark:nonmatchingMark;return e.push(r.range(n.start.from,n.start.to)),n.end&&e.push(r.range(n.end.from,n.end.to)),e}const bracketMatchingState=StateField.define({create(){return Decoration.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let r=[],o=e.state.facet(bracketMatchingConfig);for(let s of e.state.selection.ranges){if(!s.empty)continue;let l=matchBrackets(e.state,s.head,-1,o)||s.head>0&&matchBrackets(e.state,s.head-1,1,o)||o.afterCursor&&(matchBrackets(e.state,s.head,1,o)||s.head<e.state.doc.length&&matchBrackets(e.state,s.head+1,-1,o));l&&(r=r.concat(o.renderMatch(l,e.state)))}return Decoration.set(r,!0)},provide:n=>EditorView.decorations.from(n)}),bracketMatchingUnique=[bracketMatchingState,baseTheme$3];function bracketMatching(n={}){return[bracketMatchingConfig.of(n),bracketMatchingUnique]}const bracketMatchingHandle=new NodeProp;function matchingNodes(n,e,r){let o=n.prop(e<0?NodeProp.openedBy:NodeProp.closedBy);if(o)return o;if(n.name.length==1){let s=r.indexOf(n.name);if(s>-1&&s%2==(e<0?1:0))return[r[s+e]]}return null}function findHandle(n){let e=n.type.prop(bracketMatchingHandle);return e?e(n.node):n}function matchBrackets(n,e,r,o={}){let s=o.maxScanDistance||DefaultScanDist,l=o.brackets||DefaultBrackets,a=syntaxTree(n),c=a.resolveInner(e,r);for(let u=c;u;u=u.parent){let f=matchingNodes(u.type,r,l);if(f&&u.from<u.to){let d=findHandle(u);if(d&&(r>0?e>=d.from&&e<d.to:e>d.from&&e<=d.to))return matchMarkedBrackets(n,e,r,u,d,f,l)}}return matchPlainBrackets(n,e,r,a,c.type,s,l)}function matchMarkedBrackets(n,e,r,o,s,l,a){let c=o.parent,u={from:s.from,to:s.to},f=0,d=c==null?void 0:c.cursor();if(d&&(r<0?d.childBefore(o.from):d.childAfter(o.to)))do if(r<0?d.to<=o.from:d.from>=o.to){if(f==0&&l.indexOf(d.type.name)>-1&&d.from<d.to){let g=findHandle(d);return{start:u,end:g?{from:g.from,to:g.to}:void 0,matched:!0}}else if(matchingNodes(d.type,r,a))f++;else if(matchingNodes(d.type,-r,a)){if(f==0){let g=findHandle(d);return{start:u,end:g&&g.from<g.to?{from:g.from,to:g.to}:void 0,matched:!1}}f--}}while(r<0?d.prevSibling():d.nextSibling());return{start:u,matched:!1}}function matchPlainBrackets(n,e,r,o,s,l,a){let c=r<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),u=a.indexOf(c);if(u<0||u%2==0!=r>0)return null;let f={from:r<0?e-1:e,to:r>0?e+1:e},d=n.doc.iterRange(e,r>0?n.doc.length:0),g=0;for(let m=0;!d.next().done&&m<=l;){let v=d.value;r<0&&(m+=v.length);let b=e+m*r;for(let k=r>0?0:v.length-1,A=r>0?v.length:-1;k!=A;k+=r){let R=a.indexOf(v[k]);if(!(R<0||o.resolveInner(b+k,1).type!=s))if(R%2==0==r>0)g++;else{if(g==1)return{start:f,end:{from:b+k,to:b+k+1},matched:R>>1==u>>1};g--}}r>0&&(m+=v.length)}return d.done?{start:f,matched:!1}:null}const noTokens=Object.create(null),typeArray=[NodeType.none],warned=[],defaultTable=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])defaultTable[n]=createTokenType(noTokens,e);function warnForPart(n,e){warned.indexOf(n)>-1||(warned.push(n),console.warn(e))}function createTokenType(n,e){let r=null;for(let l of e.split(".")){let a=n[l]||tags[l];a?typeof a=="function"?r?r=a(r):warnForPart(l,`Modifier ${l} used at start of tag`):r?warnForPart(l,`Tag ${l} used as modifier`):r=a:warnForPart(l,`Unknown highlighting tag ${l}`)}if(!r)return 0;let o=e.replace(/ /g,"_"),s=NodeType.define({id:typeArray.length,name:o,props:[styleTags({[o]:r})]});return typeArray.push(s),s.id}const toggleComment=n=>{let{state:e}=n,r=e.doc.lineAt(e.selection.main.from),o=getConfig(n.state,r.from);return o.line?toggleLineComment(n):o.block?toggleBlockCommentByLine(n):!1};function command(n,e){return({state:r,dispatch:o})=>{if(r.readOnly)return!1;let s=n(e,r);return s?(o(r.update(s)),!0):!1}}const toggleLineComment=command(changeLineComment,0),toggleBlockComment=command(changeBlockComment,0),toggleBlockCommentByLine=command((n,e)=>changeBlockComment(n,e,selectedLineRanges(e)),0);function getConfig(n,e){let r=n.languageDataAt("commentTokens",e);return r.length?r[0]:{}}const SearchMargin=50;function findBlockComment(n,{open:e,close:r},o,s){let l=n.sliceDoc(o-SearchMargin,o),a=n.sliceDoc(s,s+SearchMargin),c=/\s*$/.exec(l)[0].length,u=/^\s*/.exec(a)[0].length,f=l.length-c;if(l.slice(f-e.length,f)==e&&a.slice(u,u+r.length)==r)return{open:{pos:o-c,margin:c&&1},close:{pos:s+u,margin:u&&1}};let d,g;s-o<=2*SearchMargin?d=g=n.sliceDoc(o,s):(d=n.sliceDoc(o,o+SearchMargin),g=n.sliceDoc(s-SearchMargin,s));let m=/^\s*/.exec(d)[0].length,v=/\s*$/.exec(g)[0].length,b=g.length-v-r.length;return d.slice(m,m+e.length)==e&&g.slice(b,b+r.length)==r?{open:{pos:o+m+e.length,margin:/\s/.test(d.charAt(m+e.length))?1:0},close:{pos:s-v-r.length,margin:/\s/.test(g.charAt(b-1))?1:0}}:null}function selectedLineRanges(n){let e=[];for(let r of n.selection.ranges){let o=n.doc.lineAt(r.from),s=r.to<=o.to?o:n.doc.lineAt(r.to),l=e.length-1;l>=0&&e[l].to>o.from?e[l].to=s.to:e.push({from:o.from,to:s.to})}return e}function changeBlockComment(n,e,r=e.selection.ranges){let o=r.map(l=>getConfig(e,l.from).block);if(!o.every(l=>l))return null;let s=r.map((l,a)=>findBlockComment(e,o[a],l.from,l.to));if(n!=2&&!s.every(l=>l))return{changes:e.changes(r.map((l,a)=>s[a]?[]:[{from:l.from,insert:o[a].open+" "},{from:l.to,insert:" "+o[a].close}]))};if(n!=1&&s.some(l=>l)){let l=[];for(let a=0,c;a<s.length;a++)if(c=s[a]){let u=o[a],{open:f,close:d}=c;l.push({from:f.pos-u.open.length,to:f.pos+f.margin},{from:d.pos-d.margin,to:d.pos+u.close.length})}return{changes:l}}return null}function changeLineComment(n,e,r=e.selection.ranges){let o=[],s=-1;for(let{from:l,to:a}of r){let c=o.length,u=1e9,f=getConfig(e,l).line;if(f){for(let d=l;d<=a;){let g=e.doc.lineAt(d);if(g.from>s&&(l==a||a>g.from)){s=g.from;let m=/^\s*/.exec(g.text)[0].length,v=m==g.length,b=g.text.slice(m,m+f.length)==f?m:-1;m<g.text.length&&m<u&&(u=m),o.push({line:g,comment:b,token:f,indent:m,empty:v,single:!1})}d=g.to+1}if(u<1e9)for(let d=c;d<o.length;d++)o[d].indent<o[d].line.text.length&&(o[d].indent=u);o.length==c+1&&(o[c].single=!0)}}if(n!=2&&o.some(l=>l.comment<0&&(!l.empty||l.single))){let l=[];for(let{line:c,token:u,indent:f,empty:d,single:g}of o)(g||!d)&&l.push({from:c.from+f,insert:u+" "});let a=e.changes(l);return{changes:a,selection:e.selection.map(a,1)}}else if(n!=1&&o.some(l=>l.comment>=0)){let l=[];for(let{line:a,comment:c,token:u}of o)if(c>=0){let f=a.from+c,d=f+u.length;a.text[d-a.from]==" "&&d++,l.push({from:f,to:d})}return{changes:l}}return null}const fromHistory=Annotation.define(),isolateHistory=Annotation.define(),invertedEffects=Facet.define(),historyConfig=Facet.define({combine(n){return combineConfig(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,r)=>r},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,r)=>(o,s)=>e(o,s)||r(o,s)})}});function changeEnd(n){let e=0;return n.iterChangedRanges((r,o)=>e=o),e}const historyField_=StateField.define({create(){return HistoryState.empty},update(n,e){let r=e.state.facet(historyConfig),o=e.annotation(fromHistory);if(o){let u=e.docChanged?EditorSelection.single(changeEnd(e.changes)):void 0,f=HistEvent.fromTransaction(e,u),d=o.side,g=d==0?n.undone:n.done;return f?g=updateBranch(g,g.length,r.minDepth,f):g=addSelection(g,e.startState.selection),new HistoryState(d==0?o.rest:g,d==0?g:o.rest)}let s=e.annotation(isolateHistory);if((s=="full"||s=="before")&&(n=n.isolate()),e.annotation(Transaction.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let l=HistEvent.fromTransaction(e),a=e.annotation(Transaction.time),c=e.annotation(Transaction.userEvent);return l?n=n.addChanges(l,a,c,r,e):e.selection&&(n=n.addSelection(e.startState.selection,a,c,r.newGroupDelay)),(s=="full"||s=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new HistoryState(n.done.map(HistEvent.fromJSON),n.undone.map(HistEvent.fromJSON))}});function history$1(n={}){return[historyField_,historyConfig.of(n),EditorView.domEventHandlers({beforeinput(e,r){let o=e.inputType=="historyUndo"?undo:e.inputType=="historyRedo"?redo:null;return o?(e.preventDefault(),o(r)):!1}})]}function cmd(n,e){return function({state:r,dispatch:o}){if(!e&&r.readOnly)return!1;let s=r.field(historyField_,!1);if(!s)return!1;let l=s.pop(n,r,e);return l?(o(l),!0):!1}}const undo=cmd(0,!1),redo=cmd(1,!1),undoSelection=cmd(0,!0),redoSelection=cmd(1,!0);class HistEvent{constructor(e,r,o,s,l){this.changes=e,this.effects=r,this.mapped=o,this.startSelection=s,this.selectionsAfter=l}setSelAfter(e){return new HistEvent(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,r,o;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(r=this.mapped)===null||r===void 0?void 0:r.toJSON(),startSelection:(o=this.startSelection)===null||o===void 0?void 0:o.toJSON(),selectionsAfter:this.selectionsAfter.map(s=>s.toJSON())}}static fromJSON(e){return new HistEvent(e.changes&&ChangeSet.fromJSON(e.changes),[],e.mapped&&ChangeDesc.fromJSON(e.mapped),e.startSelection&&EditorSelection.fromJSON(e.startSelection),e.selectionsAfter.map(EditorSelection.fromJSON))}static fromTransaction(e,r){let o=none$1;for(let s of e.startState.facet(invertedEffects)){let l=s(e);l.length&&(o=o.concat(l))}return!o.length&&e.changes.empty?null:new HistEvent(e.changes.invert(e.startState.doc),o,void 0,r||e.startState.selection,none$1)}static selection(e){return new HistEvent(void 0,none$1,void 0,void 0,e)}}function updateBranch(n,e,r,o){let s=e+1>r+20?e-r-1:0,l=n.slice(s,e);return l.push(o),l}function isAdjacent(n,e){let r=[],o=!1;return n.iterChangedRanges((s,l)=>r.push(s,l)),e.iterChangedRanges((s,l,a,c)=>{for(let u=0;u<r.length;){let f=r[u++],d=r[u++];c>=f&&a<=d&&(o=!0)}}),o}function eqSelectionShape(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((r,o)=>r.empty!=e.ranges[o].empty).length===0}function conc(n,e){return n.length?e.length?n.concat(e):n:e}const none$1=[],MaxSelectionsPerEvent=200;function addSelection(n,e){if(n.length){let r=n[n.length-1],o=r.selectionsAfter.slice(Math.max(0,r.selectionsAfter.length-MaxSelectionsPerEvent));return o.length&&o[o.length-1].eq(e)?n:(o.push(e),updateBranch(n,n.length-1,1e9,r.setSelAfter(o)))}else return[HistEvent.selection([e])]}function popSelection(n){let e=n[n.length-1],r=n.slice();return r[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),r}function addMappingToBranch(n,e){if(!n.length)return n;let r=n.length,o=none$1;for(;r;){let s=mapEvent(n[r-1],e,o);if(s.changes&&!s.changes.empty||s.effects.length){let l=n.slice(0,r);return l[r-1]=s,l}else e=s.mapped,r--,o=s.selectionsAfter}return o.length?[HistEvent.selection(o)]:none$1}function mapEvent(n,e,r){let o=conc(n.selectionsAfter.length?n.selectionsAfter.map(c=>c.map(e)):none$1,r);if(!n.changes)return HistEvent.selection(o);let s=n.changes.map(e),l=e.mapDesc(n.changes,!0),a=n.mapped?n.mapped.composeDesc(l):l;return new HistEvent(s,StateEffect.mapEffects(n.effects,e),a,n.startSelection.map(l),o)}const joinableUserEvent=/^(input\.type|delete)($|\.)/;class HistoryState{constructor(e,r,o=0,s=void 0){this.done=e,this.undone=r,this.prevTime=o,this.prevUserEvent=s}isolate(){return this.prevTime?new HistoryState(this.done,this.undone):this}addChanges(e,r,o,s,l){let a=this.done,c=a[a.length-1];return c&&c.changes&&!c.changes.empty&&e.changes&&(!o||joinableUserEvent.test(o))&&(!c.selectionsAfter.length&&r-this.prevTime<s.newGroupDelay&&s.joinToEvent(l,isAdjacent(c.changes,e.changes))||o=="input.type.compose")?a=updateBranch(a,a.length-1,s.minDepth,new HistEvent(e.changes.compose(c.changes),conc(e.effects,c.effects),c.mapped,c.startSelection,none$1)):a=updateBranch(a,a.length,s.minDepth,e),new HistoryState(a,none$1,r,o)}addSelection(e,r,o,s){let l=this.done.length?this.done[this.done.length-1].selectionsAfter:none$1;return l.length>0&&r-this.prevTime<s&&o==this.prevUserEvent&&o&&/^select($|\.)/.test(o)&&eqSelectionShape(l[l.length-1],e)?this:new HistoryState(addSelection(this.done,e),this.undone,r,o)}addMapping(e){return new HistoryState(addMappingToBranch(this.done,e),addMappingToBranch(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,r,o){let s=e==0?this.done:this.undone;if(s.length==0)return null;let l=s[s.length-1];if(o&&l.selectionsAfter.length)return r.update({selection:l.selectionsAfter[l.selectionsAfter.length-1],annotations:fromHistory.of({side:e,rest:popSelection(s)}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(l.changes){let a=s.length==1?none$1:s.slice(0,s.length-1);return l.mapped&&(a=addMappingToBranch(a,l.mapped)),r.update({changes:l.changes,selection:l.startSelection,effects:l.effects,annotations:fromHistory.of({side:e,rest:a}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}HistoryState.empty=new HistoryState(none$1,none$1);const historyKeymap=[{key:"Mod-z",run:undo,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:redo,preventDefault:!0},{linux:"Ctrl-Shift-z",run:redo,preventDefault:!0},{key:"Mod-u",run:undoSelection,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:redoSelection,preventDefault:!0}];function updateSel(n,e){return EditorSelection.create(n.ranges.map(e),n.mainIndex)}function setSel(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function moveSel({state:n,dispatch:e},r){let o=updateSel(n.selection,r);return o.eq(n.selection)?!1:(e(setSel(n,o)),!0)}function rangeEnd(n,e){return EditorSelection.cursor(e?n.to:n.from)}function cursorByChar(n,e){return moveSel(n,r=>r.empty?n.moveByChar(r,e):rangeEnd(r,e))}function ltrAtCursor(n){return n.textDirectionAt(n.state.selection.main.head)==Direction.LTR}const cursorCharLeft=n=>cursorByChar(n,!ltrAtCursor(n)),cursorCharRight=n=>cursorByChar(n,ltrAtCursor(n));function cursorByGroup(n,e){return moveSel(n,r=>r.empty?n.moveByGroup(r,e):rangeEnd(r,e))}const cursorGroupLeft=n=>cursorByGroup(n,!ltrAtCursor(n)),cursorGroupRight=n=>cursorByGroup(n,ltrAtCursor(n));function interestingNode(n,e,r){if(e.type.prop(r))return!0;let o=e.to-e.from;return o&&(o>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function moveBySyntax(n,e,r){let o=syntaxTree(n).resolveInner(e.head),s=r?NodeProp.closedBy:NodeProp.openedBy;for(let u=e.head;;){let f=r?o.childAfter(u):o.childBefore(u);if(!f)break;interestingNode(n,f,s)?o=f:u=r?f.to:f.from}let l=o.type.prop(s),a,c;return l&&(a=r?matchBrackets(n,o.from,1):matchBrackets(n,o.to,-1))&&a.matched?c=r?a.end.to:a.end.from:c=r?o.to:o.from,EditorSelection.cursor(c,r?-1:1)}const cursorSyntaxLeft=n=>moveSel(n,e=>moveBySyntax(n.state,e,!ltrAtCursor(n))),cursorSyntaxRight=n=>moveSel(n,e=>moveBySyntax(n.state,e,ltrAtCursor(n)));function cursorByLine(n,e){return moveSel(n,r=>{if(!r.empty)return rangeEnd(r,e);let o=n.moveVertically(r,e);return o.head!=r.head?o:n.moveToLineBoundary(r,e)})}const cursorLineUp=n=>cursorByLine(n,!1),cursorLineDown=n=>cursorByLine(n,!0);function pageInfo(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,r=0,o=0,s;if(e){for(let l of n.state.facet(EditorView.scrollMargins)){let a=l(n);a!=null&&a.top&&(r=Math.max(a==null?void 0:a.top,r)),a!=null&&a.bottom&&(o=Math.max(a==null?void 0:a.bottom,o))}s=n.scrollDOM.clientHeight-r-o}else s=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:r,marginBottom:o,selfScroll:e,height:Math.max(n.defaultLineHeight,s-5)}}function cursorByPage(n,e){let r=pageInfo(n),{state:o}=n,s=updateSel(o.selection,a=>a.empty?n.moveVertically(a,e,r.height):rangeEnd(a,e));if(s.eq(o.selection))return!1;let l;if(r.selfScroll){let a=n.coordsAtPos(o.selection.main.head),c=n.scrollDOM.getBoundingClientRect(),u=c.top+r.marginTop,f=c.bottom-r.marginBottom;a&&a.top>u&&a.bottom<f&&(l=EditorView.scrollIntoView(s.main.head,{y:"start",yMargin:a.top-u}))}return n.dispatch(setSel(o,s),{effects:l}),!0}const cursorPageUp=n=>cursorByPage(n,!1),cursorPageDown=n=>cursorByPage(n,!0);function moveByLineBoundary(n,e,r){let o=n.lineBlockAt(e.head),s=n.moveToLineBoundary(e,r);if(s.head==e.head&&s.head!=(r?o.to:o.from)&&(s=n.moveToLineBoundary(e,r,!1)),!r&&s.head==o.from&&o.length){let l=/^\s*/.exec(n.state.sliceDoc(o.from,Math.min(o.from+100,o.to)))[0].length;l&&e.head!=o.from+l&&(s=EditorSelection.cursor(o.from+l))}return s}const cursorLineBoundaryForward=n=>moveSel(n,e=>moveByLineBoundary(n,e,!0)),cursorLineBoundaryBackward=n=>moveSel(n,e=>moveByLineBoundary(n,e,!1)),cursorLineBoundaryLeft=n=>moveSel(n,e=>moveByLineBoundary(n,e,!ltrAtCursor(n))),cursorLineBoundaryRight=n=>moveSel(n,e=>moveByLineBoundary(n,e,ltrAtCursor(n))),cursorLineStart=n=>moveSel(n,e=>EditorSelection.cursor(n.lineBlockAt(e.head).from,1)),cursorLineEnd=n=>moveSel(n,e=>EditorSelection.cursor(n.lineBlockAt(e.head).to,-1));function toMatchingBracket(n,e,r){let o=!1,s=updateSel(n.selection,l=>{let a=matchBrackets(n,l.head,-1)||matchBrackets(n,l.head,1)||l.head>0&&matchBrackets(n,l.head-1,1)||l.head<n.doc.length&&matchBrackets(n,l.head+1,-1);if(!a||!a.end)return l;o=!0;let c=a.start.from==l.head?a.end.to:a.end.from;return r?EditorSelection.range(l.anchor,c):EditorSelection.cursor(c)});return o?(e(setSel(n,s)),!0):!1}const cursorMatchingBracket=({state:n,dispatch:e})=>toMatchingBracket(n,e,!1);function extendSel(n,e){let r=updateSel(n.state.selection,o=>{let s=e(o);return EditorSelection.range(o.anchor,s.head,s.goalColumn,s.bidiLevel||void 0)});return r.eq(n.state.selection)?!1:(n.dispatch(setSel(n.state,r)),!0)}function selectByChar(n,e){return extendSel(n,r=>n.moveByChar(r,e))}const selectCharLeft=n=>selectByChar(n,!ltrAtCursor(n)),selectCharRight=n=>selectByChar(n,ltrAtCursor(n));function selectByGroup(n,e){return extendSel(n,r=>n.moveByGroup(r,e))}const selectGroupLeft=n=>selectByGroup(n,!ltrAtCursor(n)),selectGroupRight=n=>selectByGroup(n,ltrAtCursor(n)),selectSyntaxLeft=n=>extendSel(n,e=>moveBySyntax(n.state,e,!ltrAtCursor(n))),selectSyntaxRight=n=>extendSel(n,e=>moveBySyntax(n.state,e,ltrAtCursor(n)));function selectByLine(n,e){return extendSel(n,r=>n.moveVertically(r,e))}const selectLineUp=n=>selectByLine(n,!1),selectLineDown=n=>selectByLine(n,!0);function selectByPage(n,e){return extendSel(n,r=>n.moveVertically(r,e,pageInfo(n).height))}const selectPageUp=n=>selectByPage(n,!1),selectPageDown=n=>selectByPage(n,!0),selectLineBoundaryForward=n=>extendSel(n,e=>moveByLineBoundary(n,e,!0)),selectLineBoundaryBackward=n=>extendSel(n,e=>moveByLineBoundary(n,e,!1)),selectLineBoundaryLeft=n=>extendSel(n,e=>moveByLineBoundary(n,e,!ltrAtCursor(n))),selectLineBoundaryRight=n=>extendSel(n,e=>moveByLineBoundary(n,e,ltrAtCursor(n))),selectLineStart=n=>extendSel(n,e=>EditorSelection.cursor(n.lineBlockAt(e.head).from)),selectLineEnd=n=>extendSel(n,e=>EditorSelection.cursor(n.lineBlockAt(e.head).to)),cursorDocStart=({state:n,dispatch:e})=>(e(setSel(n,{anchor:0})),!0),cursorDocEnd=({state:n,dispatch:e})=>(e(setSel(n,{anchor:n.doc.length})),!0),selectDocStart=({state:n,dispatch:e})=>(e(setSel(n,{anchor:n.selection.main.anchor,head:0})),!0),selectDocEnd=({state:n,dispatch:e})=>(e(setSel(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),selectAll=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),selectLine=({state:n,dispatch:e})=>{let r=selectedLineBlocks(n).map(({from:o,to:s})=>EditorSelection.range(o,Math.min(s+1,n.doc.length)));return e(n.update({selection:EditorSelection.create(r),userEvent:"select"})),!0},selectParentSyntax=({state:n,dispatch:e})=>{let r=updateSel(n.selection,o=>{var s;let l=syntaxTree(n).resolveInner(o.head,1);for(;!(l.from<o.from&&l.to>=o.to||l.to>o.to&&l.from<=o.from||!(!((s=l.parent)===null||s===void 0)&&s.parent));)l=l.parent;return EditorSelection.range(l.to,l.from)});return e(setSel(n,r)),!0},simplifySelection=({state:n,dispatch:e})=>{let r=n.selection,o=null;return r.ranges.length>1?o=EditorSelection.create([r.main]):r.main.empty||(o=EditorSelection.create([EditorSelection.cursor(r.main.head)])),o?(e(setSel(n,o)),!0):!1};function deleteBy(n,e){if(n.state.readOnly)return!1;let r="delete.selection",{state:o}=n,s=o.changeByRange(l=>{let{from:a,to:c}=l;if(a==c){let u=e(a);u<a?(r="delete.backward",u=skipAtomic(n,u,!1)):u>a&&(r="delete.forward",u=skipAtomic(n,u,!0)),a=Math.min(a,u),c=Math.max(c,u)}else a=skipAtomic(n,a,!1),c=skipAtomic(n,c,!0);return a==c?{range:l}:{changes:{from:a,to:c},range:EditorSelection.cursor(a)}});return s.changes.empty?!1:(n.dispatch(o.update(s,{scrollIntoView:!0,userEvent:r,effects:r=="delete.selection"?EditorView.announce.of(o.phrase("Selection deleted")):void 0})),!0)}function skipAtomic(n,e,r){if(n instanceof EditorView)for(let o of n.state.facet(EditorView.atomicRanges).map(s=>s(n)))o.between(e,e,(s,l)=>{s<e&&l>e&&(e=r?l:s)});return e}const deleteByChar=(n,e)=>deleteBy(n,r=>{let{state:o}=n,s=o.doc.lineAt(r),l,a;if(!e&&r>s.from&&r<s.from+200&&!/[^ \t]/.test(l=s.text.slice(0,r-s.from))){if(l[l.length-1]=="	")return r-1;let c=countColumn(l,o.tabSize),u=c%getIndentUnit(o)||getIndentUnit(o);for(let f=0;f<u&&l[l.length-1-f]==" ";f++)r--;a=r}else a=findClusterBreak(s.text,r-s.from,e,e)+s.from,a==r&&s.number!=(e?o.doc.lines:1)&&(a+=e?1:-1);return a}),deleteCharBackward=n=>deleteByChar(n,!1),deleteCharForward=n=>deleteByChar(n,!0),deleteByGroup=(n,e)=>deleteBy(n,r=>{let o=r,{state:s}=n,l=s.doc.lineAt(o),a=s.charCategorizer(o);for(let c=null;;){if(o==(e?l.to:l.from)){o==r&&l.number!=(e?s.doc.lines:1)&&(o+=e?1:-1);break}let u=findClusterBreak(l.text,o-l.from,e)+l.from,f=l.text.slice(Math.min(o,u)-l.from,Math.max(o,u)-l.from),d=a(f);if(c!=null&&d!=c)break;(f!=" "||o!=r)&&(c=d),o=u}return o}),deleteGroupBackward=n=>deleteByGroup(n,!1),deleteGroupForward=n=>deleteByGroup(n,!0),deleteToLineEnd=n=>deleteBy(n,e=>{let r=n.lineBlockAt(e).to;return e<r?r:Math.min(n.state.doc.length,e+1)}),deleteToLineStart=n=>deleteBy(n,e=>{let r=n.lineBlockAt(e).from;return e>r?r:Math.max(0,e-1)}),splitLine=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let r=n.changeByRange(o=>({changes:{from:o.from,to:o.to,insert:Text.of(["",""])},range:EditorSelection.cursor(o.from)}));return e(n.update(r,{scrollIntoView:!0,userEvent:"input"})),!0},transposeChars=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let r=n.changeByRange(o=>{if(!o.empty||o.from==0||o.from==n.doc.length)return{range:o};let s=o.from,l=n.doc.lineAt(s),a=s==l.from?s-1:findClusterBreak(l.text,s-l.from,!1)+l.from,c=s==l.to?s+1:findClusterBreak(l.text,s-l.from,!0)+l.from;return{changes:{from:a,to:c,insert:n.doc.slice(s,c).append(n.doc.slice(a,s))},range:EditorSelection.cursor(c)}});return r.changes.empty?!1:(e(n.update(r,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function selectedLineBlocks(n){let e=[],r=-1;for(let o of n.selection.ranges){let s=n.doc.lineAt(o.from),l=n.doc.lineAt(o.to);if(!o.empty&&o.to==l.from&&(l=n.doc.lineAt(o.to-1)),r>=s.number){let a=e[e.length-1];a.to=l.to,a.ranges.push(o)}else e.push({from:s.from,to:l.to,ranges:[o]});r=l.number+1}return e}function moveLine(n,e,r){if(n.readOnly)return!1;let o=[],s=[];for(let l of selectedLineBlocks(n)){if(r?l.to==n.doc.length:l.from==0)continue;let a=n.doc.lineAt(r?l.to+1:l.from-1),c=a.length+1;if(r){o.push({from:l.to,to:a.to},{from:l.from,insert:a.text+n.lineBreak});for(let u of l.ranges)s.push(EditorSelection.range(Math.min(n.doc.length,u.anchor+c),Math.min(n.doc.length,u.head+c)))}else{o.push({from:a.from,to:l.from},{from:l.to,insert:n.lineBreak+a.text});for(let u of l.ranges)s.push(EditorSelection.range(u.anchor-c,u.head-c))}}return o.length?(e(n.update({changes:o,scrollIntoView:!0,selection:EditorSelection.create(s,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const moveLineUp=({state:n,dispatch:e})=>moveLine(n,e,!1),moveLineDown=({state:n,dispatch:e})=>moveLine(n,e,!0);function copyLine(n,e,r){if(n.readOnly)return!1;let o=[];for(let s of selectedLineBlocks(n))r?o.push({from:s.from,insert:n.doc.slice(s.from,s.to)+n.lineBreak}):o.push({from:s.to,insert:n.lineBreak+n.doc.slice(s.from,s.to)});return e(n.update({changes:o,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const copyLineUp=({state:n,dispatch:e})=>copyLine(n,e,!1),copyLineDown=({state:n,dispatch:e})=>copyLine(n,e,!0),deleteLine=n=>{if(n.state.readOnly)return!1;let{state:e}=n,r=e.changes(selectedLineBlocks(e).map(({from:s,to:l})=>(s>0?s--:l<e.doc.length&&l++,{from:s,to:l}))),o=updateSel(e.selection,s=>n.moveVertically(s,!0)).map(r);return n.dispatch({changes:r,selection:o,scrollIntoView:!0,userEvent:"delete.line"}),!0};function isBetweenBrackets(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let r=syntaxTree(n).resolveInner(e),o=r.childBefore(e),s=r.childAfter(e),l;return o&&s&&o.to<=e&&s.from>=e&&(l=o.type.prop(NodeProp.closedBy))&&l.indexOf(s.name)>-1&&n.doc.lineAt(o.to).from==n.doc.lineAt(s.from).from?{from:o.to,to:s.from}:null}const insertNewlineAndIndent=newlineAndIndent(!1),insertBlankLine=newlineAndIndent(!0);function newlineAndIndent(n){return({state:e,dispatch:r})=>{if(e.readOnly)return!1;let o=e.changeByRange(s=>{let{from:l,to:a}=s,c=e.doc.lineAt(l),u=!n&&l==a&&isBetweenBrackets(e,l);n&&(l=a=(a<=c.to?c:e.doc.lineAt(a)).to);let f=new IndentContext(e,{simulateBreak:l,simulateDoubleBreak:!!u}),d=getIndentation(f,l);for(d==null&&(d=/^\s*/.exec(e.doc.lineAt(l).text)[0].length);a<c.to&&/\s/.test(c.text[a-c.from]);)a++;u?{from:l,to:a}=u:l>c.from&&l<c.from+100&&!/\S/.test(c.text.slice(0,l))&&(l=c.from);let g=["",indentString(e,d)];return u&&g.push(indentString(e,f.lineIndent(c.from,-1))),{changes:{from:l,to:a,insert:Text.of(g)},range:EditorSelection.cursor(l+1+g[1].length)}});return r(e.update(o,{scrollIntoView:!0,userEvent:"input"})),!0}}function changeBySelectedLine(n,e){let r=-1;return n.changeByRange(o=>{let s=[];for(let a=o.from;a<=o.to;){let c=n.doc.lineAt(a);c.number>r&&(o.empty||o.to>c.from)&&(e(c,s,o),r=c.number),a=c.to+1}let l=n.changes(s);return{changes:s,range:EditorSelection.range(l.mapPos(o.anchor,1),l.mapPos(o.head,1))}})}const indentSelection=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let r=Object.create(null),o=new IndentContext(n,{overrideIndentation:l=>{let a=r[l];return a??-1}}),s=changeBySelectedLine(n,(l,a,c)=>{let u=getIndentation(o,l.from);if(u==null)return;/\S/.test(l.text)||(u=0);let f=/^\s*/.exec(l.text)[0],d=indentString(n,u);(f!=d||c.from<l.from+f.length)&&(r[l.from]=u,a.push({from:l.from,to:l.from+f.length,insert:d}))});return s.changes.empty||e(n.update(s,{userEvent:"indent"})),!0},indentMore=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(changeBySelectedLine(n,(r,o)=>{o.push({from:r.from,insert:n.facet(indentUnit)})}),{userEvent:"input.indent"})),!0),indentLess=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(changeBySelectedLine(n,(r,o)=>{let s=/^\s*/.exec(r.text)[0];if(!s)return;let l=countColumn(s,n.tabSize),a=0,c=indentString(n,Math.max(0,l-getIndentUnit(n)));for(;a<s.length&&a<c.length&&s.charCodeAt(a)==c.charCodeAt(a);)a++;o.push({from:r.from+a,to:r.from+s.length,insert:c.slice(a)})}),{userEvent:"delete.dedent"})),!0),emacsStyleKeymap=[{key:"Ctrl-b",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Ctrl-f",run:cursorCharRight,shift:selectCharRight},{key:"Ctrl-p",run:cursorLineUp,shift:selectLineUp},{key:"Ctrl-n",run:cursorLineDown,shift:selectLineDown},{key:"Ctrl-a",run:cursorLineStart,shift:selectLineStart},{key:"Ctrl-e",run:cursorLineEnd,shift:selectLineEnd},{key:"Ctrl-d",run:deleteCharForward},{key:"Ctrl-h",run:deleteCharBackward},{key:"Ctrl-k",run:deleteToLineEnd},{key:"Ctrl-Alt-h",run:deleteGroupBackward},{key:"Ctrl-o",run:splitLine},{key:"Ctrl-t",run:transposeChars},{key:"Ctrl-v",run:cursorPageDown}],standardKeymap=[{key:"ArrowLeft",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:cursorGroupLeft,shift:selectGroupLeft,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:cursorLineBoundaryLeft,shift:selectLineBoundaryLeft,preventDefault:!0},{key:"ArrowRight",run:cursorCharRight,shift:selectCharRight,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:cursorGroupRight,shift:selectGroupRight,preventDefault:!0},{mac:"Cmd-ArrowRight",run:cursorLineBoundaryRight,shift:selectLineBoundaryRight,preventDefault:!0},{key:"ArrowUp",run:cursorLineUp,shift:selectLineUp,preventDefault:!0},{mac:"Cmd-ArrowUp",run:cursorDocStart,shift:selectDocStart},{mac:"Ctrl-ArrowUp",run:cursorPageUp,shift:selectPageUp},{key:"ArrowDown",run:cursorLineDown,shift:selectLineDown,preventDefault:!0},{mac:"Cmd-ArrowDown",run:cursorDocEnd,shift:selectDocEnd},{mac:"Ctrl-ArrowDown",run:cursorPageDown,shift:selectPageDown},{key:"PageUp",run:cursorPageUp,shift:selectPageUp},{key:"PageDown",run:cursorPageDown,shift:selectPageDown},{key:"Home",run:cursorLineBoundaryBackward,shift:selectLineBoundaryBackward,preventDefault:!0},{key:"Mod-Home",run:cursorDocStart,shift:selectDocStart},{key:"End",run:cursorLineBoundaryForward,shift:selectLineBoundaryForward,preventDefault:!0},{key:"Mod-End",run:cursorDocEnd,shift:selectDocEnd},{key:"Enter",run:insertNewlineAndIndent},{key:"Mod-a",run:selectAll},{key:"Backspace",run:deleteCharBackward,shift:deleteCharBackward},{key:"Delete",run:deleteCharForward},{key:"Mod-Backspace",mac:"Alt-Backspace",run:deleteGroupBackward},{key:"Mod-Delete",mac:"Alt-Delete",run:deleteGroupForward},{mac:"Mod-Backspace",run:deleteToLineStart},{mac:"Mod-Delete",run:deleteToLineEnd}].concat(emacsStyleKeymap.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),defaultKeymap=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:cursorSyntaxLeft,shift:selectSyntaxLeft},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:cursorSyntaxRight,shift:selectSyntaxRight},{key:"Alt-ArrowUp",run:moveLineUp},{key:"Shift-Alt-ArrowUp",run:copyLineUp},{key:"Alt-ArrowDown",run:moveLineDown},{key:"Shift-Alt-ArrowDown",run:copyLineDown},{key:"Escape",run:simplifySelection},{key:"Mod-Enter",run:insertBlankLine},{key:"Alt-l",mac:"Ctrl-l",run:selectLine},{key:"Mod-i",run:selectParentSyntax,preventDefault:!0},{key:"Mod-[",run:indentLess},{key:"Mod-]",run:indentMore},{key:"Mod-Alt-\\",run:indentSelection},{key:"Shift-Mod-k",run:deleteLine},{key:"Shift-Mod-\\",run:cursorMatchingBracket},{key:"Mod-/",run:toggleComment},{key:"Alt-A",run:toggleBlockComment}].concat(standardKeymap),indentWithTab={key:"Tab",run:indentMore,shift:indentLess};function crelt(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,r=arguments[1];if(r&&typeof r=="object"&&r.nodeType==null&&!Array.isArray(r)){for(var o in r)if(Object.prototype.hasOwnProperty.call(r,o)){var s=r[o];typeof s=="string"?n.setAttribute(o,s):s!=null&&(n[o]=s)}e++}for(;e<arguments.length;e++)add(n,arguments[e]);return n}function add(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var r=0;r<e.length;r++)add(n,e[r]);else throw new RangeError("Unsupported child node: "+e)}const basicNormalize=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class SearchCursor{constructor(e,r,o=0,s=e.length,l,a){this.test=a,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(o,s),this.bufferStart=o,this.normalize=l?c=>l(basicNormalize(c)):basicNormalize,this.query=this.normalize(r)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return codePointAt(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let r=fromCodePoint(e),o=this.bufferStart+this.bufferPos;this.bufferPos+=codePointSize(e);let s=this.normalize(r);for(let l=0,a=o;;l++){let c=s.charCodeAt(l),u=this.match(c,a);if(u)return this.value=u,this;if(l==s.length-1)break;a==o&&l<r.length&&r.charCodeAt(l)==c&&a++}}}match(e,r){let o=null;for(let s=0;s<this.matches.length;s+=2){let l=this.matches[s],a=!1;this.query.charCodeAt(l)==e&&(l==this.query.length-1?o={from:this.matches[s+1],to:r+1}:(this.matches[s]++,a=!0)),a||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?o={from:r,to:r+1}:this.matches.push(1,r)),o&&this.test&&!this.test(o.from,o.to,this.buffer,this.bufferPos)&&(o=null),o}}typeof Symbol<"u"&&(SearchCursor.prototype[Symbol.iterator]=function(){return this});const empty={from:-1,to:-1,match:/.*/.exec("")},baseFlags="gm"+(/x/.unicode==null?"":"u");class RegExpCursor{constructor(e,r,o,s=0,l=e.length){if(this.text=e,this.to=l,this.curLine="",this.done=!1,this.value=empty,/\\[sWDnr]|\n|\r|\[\^/.test(r))return new MultilineRegExpCursor(e,r,o,s,l);this.re=new RegExp(r,baseFlags+(o!=null&&o.ignoreCase?"i":"")),this.test=o==null?void 0:o.test,this.iter=e.iter();let a=e.lineAt(s);this.curLineStart=a.from,this.matchPos=toCharEnd(e,s),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let r=this.matchPos<=this.to&&this.re.exec(this.curLine);if(r){let o=this.curLineStart+r.index,s=o+r[0].length;if(this.matchPos=toCharEnd(this.text,s+(o==s?1:0)),o==this.curLineStart+this.curLine.length&&this.nextLine(),(o<s||o>this.value.to)&&(!this.test||this.test(o,s,r)))return this.value={from:o,to:s,match:r},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const flattened=new WeakMap;class FlattenedDoc{constructor(e,r){this.from=e,this.text=r}get to(){return this.from+this.text.length}static get(e,r,o){let s=flattened.get(e);if(!s||s.from>=o||s.to<=r){let c=new FlattenedDoc(r,e.sliceString(r,o));return flattened.set(e,c),c}if(s.from==r&&s.to==o)return s;let{text:l,from:a}=s;return a>r&&(l=e.sliceString(r,a)+l,a=r),s.to<o&&(l+=e.sliceString(s.to,o)),flattened.set(e,new FlattenedDoc(a,l)),new FlattenedDoc(r,l.slice(r-a,o-a))}}class MultilineRegExpCursor{constructor(e,r,o,s,l){this.text=e,this.to=l,this.done=!1,this.value=empty,this.matchPos=toCharEnd(e,s),this.re=new RegExp(r,baseFlags+(o!=null&&o.ignoreCase?"i":"")),this.test=o==null?void 0:o.test,this.flat=FlattenedDoc.get(e,s,this.chunkEnd(s+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,r=this.re.exec(this.flat.text);if(r&&!r[0]&&r.index==e&&(this.re.lastIndex=e+1,r=this.re.exec(this.flat.text)),r){let o=this.flat.from+r.index,s=o+r[0].length;if((this.flat.to>=this.to||r.index+r[0].length<=this.flat.text.length-10)&&(!this.test||this.test(o,s,r)))return this.value={from:o,to:s,match:r},this.matchPos=toCharEnd(this.text,s+(o==s?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=FlattenedDoc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(RegExpCursor.prototype[Symbol.iterator]=MultilineRegExpCursor.prototype[Symbol.iterator]=function(){return this});function validRegExp(n){try{return new RegExp(n,baseFlags),!0}catch{return!1}}function toCharEnd(n,e){if(e>=n.length)return e;let r=n.lineAt(e),o;for(;e<r.to&&(o=r.text.charCodeAt(e-r.from))>=56320&&o<57344;)e++;return e}function createLineDialog(n){let e=crelt("input",{class:"cm-textfield",name:"line"}),r=crelt("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),n.dispatch({effects:dialogEffect.of(!1)}),n.focus()):s.keyCode==13&&(s.preventDefault(),o())},onsubmit:s=>{s.preventDefault(),o()}},crelt("label",n.state.phrase("Go to line"),": ",e)," ",crelt("button",{class:"cm-button",type:"submit"},n.state.phrase("go")));function o(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!s)return;let{state:l}=n,a=l.doc.lineAt(l.selection.main.head),[,c,u,f,d]=s,g=f?+f.slice(1):0,m=u?+u:a.number;if(u&&d){let b=m/100;c&&(b=b*(c=="-"?-1:1)+a.number/l.doc.lines),m=Math.round(l.doc.lines*b)}else u&&c&&(m=m*(c=="-"?-1:1)+a.number);let v=l.doc.line(Math.max(1,Math.min(l.doc.lines,m)));n.dispatch({effects:dialogEffect.of(!1),selection:EditorSelection.cursor(v.from+Math.max(0,Math.min(g,v.length))),scrollIntoView:!0}),n.focus()}return{dom:r}}const dialogEffect=StateEffect.define(),dialogField=StateField.define({create(){return!0},update(n,e){for(let r of e.effects)r.is(dialogEffect)&&(n=r.value);return n},provide:n=>showPanel.from(n,e=>e?createLineDialog:null)}),gotoLine=n=>{let e=getPanel(n,createLineDialog);if(!e){let r=[dialogEffect.of(!0)];n.state.field(dialogField,!1)==null&&r.push(StateEffect.appendConfig.of([dialogField,baseTheme$1$1])),n.dispatch({effects:r}),e=getPanel(n,createLineDialog)}return e&&e.dom.querySelector("input").focus(),!0},baseTheme$1$1=EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),defaultHighlightOptions={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},highlightConfig=Facet.define({combine(n){return combineConfig(n,defaultHighlightOptions,{highlightWordAroundCursor:(e,r)=>e||r,minSelectionLength:Math.min,maxMatches:Math.min})}});function highlightSelectionMatches(n){let e=[defaultTheme,matchHighlighter];return n&&e.push(highlightConfig.of(n)),e}const matchDeco=Decoration.mark({class:"cm-selectionMatch"}),mainMatchDeco=Decoration.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function insideWordBoundaries(n,e,r,o){return(r==0||n(e.sliceDoc(r-1,r))!=CharCategory.Word)&&(o==e.doc.length||n(e.sliceDoc(o,o+1))!=CharCategory.Word)}function insideWord(n,e,r,o){return n(e.sliceDoc(r,r+1))==CharCategory.Word&&n(e.sliceDoc(o-1,o))==CharCategory.Word}const matchHighlighter=ViewPlugin.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(highlightConfig),{state:r}=n,o=r.selection;if(o.ranges.length>1)return Decoration.none;let s=o.main,l,a=null;if(s.empty){if(!e.highlightWordAroundCursor)return Decoration.none;let u=r.wordAt(s.head);if(!u)return Decoration.none;a=r.charCategorizer(s.head),l=r.sliceDoc(u.from,u.to)}else{let u=s.to-s.from;if(u<e.minSelectionLength||u>200)return Decoration.none;if(e.wholeWords){if(l=r.sliceDoc(s.from,s.to),a=r.charCategorizer(s.head),!(insideWordBoundaries(a,r,s.from,s.to)&&insideWord(a,r,s.from,s.to)))return Decoration.none}else if(l=r.sliceDoc(s.from,s.to).trim(),!l)return Decoration.none}let c=[];for(let u of n.visibleRanges){let f=new SearchCursor(r.doc,l,u.from,u.to);for(;!f.next().done;){let{from:d,to:g}=f.value;if((!a||insideWordBoundaries(a,r,d,g))&&(s.empty&&d<=s.from&&g>=s.to?c.push(mainMatchDeco.range(d,g)):(d>=s.to||g<=s.from)&&c.push(matchDeco.range(d,g)),c.length>e.maxMatches))return Decoration.none}}return Decoration.set(c)}},{decorations:n=>n.decorations}),defaultTheme=EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),selectWord=({state:n,dispatch:e})=>{let{selection:r}=n,o=EditorSelection.create(r.ranges.map(s=>n.wordAt(s.head)||EditorSelection.cursor(s.head)),r.mainIndex);return o.eq(r)?!1:(e(n.update({selection:o})),!0)};function findNextOccurrence(n,e){let{main:r,ranges:o}=n.selection,s=n.wordAt(r.head),l=s&&s.from==r.from&&s.to==r.to;for(let a=!1,c=new SearchCursor(n.doc,e,o[o.length-1].to);;)if(c.next(),c.done){if(a)return null;c=new SearchCursor(n.doc,e,0,Math.max(0,o[o.length-1].from-1)),a=!0}else{if(a&&o.some(u=>u.from==c.value.from))continue;if(l){let u=n.wordAt(c.value.from);if(!u||u.from!=c.value.from||u.to!=c.value.to)continue}return c.value}}const selectNextOccurrence=({state:n,dispatch:e})=>{let{ranges:r}=n.selection;if(r.some(l=>l.from===l.to))return selectWord({state:n,dispatch:e});let o=n.sliceDoc(r[0].from,r[0].to);if(n.selection.ranges.some(l=>n.sliceDoc(l.from,l.to)!=o))return!1;let s=findNextOccurrence(n,o);return s?(e(n.update({selection:n.selection.addRange(EditorSelection.range(s.from,s.to),!1),effects:EditorView.scrollIntoView(s.to)})),!0):!1},searchConfigFacet=Facet.define({combine(n){return combineConfig(n,{top:!1,caseSensitive:!1,literal:!1,wholeWord:!1,createPanel:e=>new SearchPanel(e),scrollToMatch:e=>EditorView.scrollIntoView(e)})}});class SearchQuery{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||validRegExp(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(r,o)=>o=="n"?`
`:o=="r"?"\r":o=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new RegExpQuery(this):new StringQuery(this)}getCursor(e,r=0,o){let s=e.doc?e:EditorState.create({doc:e});return o==null&&(o=s.doc.length),this.regexp?regexpCursor(this,s,r,o):stringCursor(this,s,r,o)}}class QueryType{constructor(e){this.spec=e}}function stringCursor(n,e,r,o){return new SearchCursor(e.doc,n.unquoted,r,o,n.caseSensitive?void 0:s=>s.toLowerCase(),n.wholeWord?stringWordTest(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function stringWordTest(n,e){return(r,o,s,l)=>((l>r||l+s.length<o)&&(l=Math.max(0,r-2),s=n.sliceString(l,Math.min(n.length,o+2))),(e(charBefore(s,r-l))!=CharCategory.Word||e(charAfter(s,r-l))!=CharCategory.Word)&&(e(charAfter(s,o-l))!=CharCategory.Word||e(charBefore(s,o-l))!=CharCategory.Word))}class StringQuery extends QueryType{constructor(e){super(e)}nextMatch(e,r,o){let s=stringCursor(this.spec,e,o,e.doc.length).nextOverlapping();return s.done&&(s=stringCursor(this.spec,e,0,r).nextOverlapping()),s.done?null:s.value}prevMatchInRange(e,r,o){for(let s=o;;){let l=Math.max(r,s-1e4-this.spec.unquoted.length),a=stringCursor(this.spec,e,l,s),c=null;for(;!a.nextOverlapping().done;)c=a.value;if(c)return c;if(l==r)return null;s-=1e4}}prevMatch(e,r,o){return this.prevMatchInRange(e,0,r)||this.prevMatchInRange(e,o,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,r){let o=stringCursor(this.spec,e,0,e.doc.length),s=[];for(;!o.next().done;){if(s.length>=r)return null;s.push(o.value)}return s}highlight(e,r,o,s){let l=stringCursor(this.spec,e,Math.max(0,r-this.spec.unquoted.length),Math.min(o+this.spec.unquoted.length,e.doc.length));for(;!l.next().done;)s(l.value.from,l.value.to)}}function regexpCursor(n,e,r,o){return new RegExpCursor(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:n.wholeWord?regexpWordTest(e.charCategorizer(e.selection.main.head)):void 0},r,o)}function charBefore(n,e){return n.slice(findClusterBreak(n,e,!1),e)}function charAfter(n,e){return n.slice(e,findClusterBreak(n,e))}function regexpWordTest(n){return(e,r,o)=>!o[0].length||(n(charBefore(o.input,o.index))!=CharCategory.Word||n(charAfter(o.input,o.index))!=CharCategory.Word)&&(n(charAfter(o.input,o.index+o[0].length))!=CharCategory.Word||n(charBefore(o.input,o.index+o[0].length))!=CharCategory.Word)}class RegExpQuery extends QueryType{nextMatch(e,r,o){let s=regexpCursor(this.spec,e,o,e.doc.length).next();return s.done&&(s=regexpCursor(this.spec,e,0,r).next()),s.done?null:s.value}prevMatchInRange(e,r,o){for(let s=1;;s++){let l=Math.max(r,o-s*1e4),a=regexpCursor(this.spec,e,l,o),c=null;for(;!a.next().done;)c=a.value;if(c&&(l==r||c.from>l+10))return c;if(l==r)return null}}prevMatch(e,r,o){return this.prevMatchInRange(e,0,r)||this.prevMatchInRange(e,o,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,(r,o)=>o=="$"?"$":o=="&"?e.match[0]:o!="0"&&+o<e.match.length?e.match[o]:r))}matchAll(e,r){let o=regexpCursor(this.spec,e,0,e.doc.length),s=[];for(;!o.next().done;){if(s.length>=r)return null;s.push(o.value)}return s}highlight(e,r,o,s){let l=regexpCursor(this.spec,e,Math.max(0,r-250),Math.min(o+250,e.doc.length));for(;!l.next().done;)s(l.value.from,l.value.to)}}const setSearchQuery=StateEffect.define(),togglePanel$1=StateEffect.define(),searchState=StateField.define({create(n){return new SearchState(defaultQuery(n).create(),null)},update(n,e){for(let r of e.effects)r.is(setSearchQuery)?n=new SearchState(r.value.create(),n.panel):r.is(togglePanel$1)&&(n=new SearchState(n.query,r.value?createSearchPanel:null));return n},provide:n=>showPanel.from(n,e=>e.panel)});class SearchState{constructor(e,r){this.query=e,this.panel=r}}const matchMark=Decoration.mark({class:"cm-searchMatch"}),selectedMatchMark=Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"}),searchHighlighter=ViewPlugin.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(searchState))}update(n){let e=n.state.field(searchState);(e!=n.startState.field(searchState)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return Decoration.none;let{view:r}=this,o=new RangeSetBuilder;for(let s=0,l=r.visibleRanges,a=l.length;s<a;s++){let{from:c,to:u}=l[s];for(;s<a-1&&u>l[s+1].from-2*250;)u=l[++s].to;n.highlight(r.state,c,u,(f,d)=>{let g=r.state.selection.ranges.some(m=>m.from==f&&m.to==d);o.add(f,d,g?selectedMatchMark:matchMark)})}return o.finish()}},{decorations:n=>n.decorations});function searchCommand(n){return e=>{let r=e.state.field(searchState,!1);return r&&r.query.spec.valid?n(e,r):openSearchPanel(e)}}const findNext=searchCommand((n,{query:e})=>{let{to:r}=n.state.selection.main,o=e.nextMatch(n.state,r,r);if(!o)return!1;let s=EditorSelection.single(o.from,o.to),l=n.state.facet(searchConfigFacet);return n.dispatch({selection:s,effects:[announceMatch(n,o),l.scrollToMatch(s.main)],userEvent:"select.search"}),!0}),findPrevious=searchCommand((n,{query:e})=>{let{state:r}=n,{from:o}=r.selection.main,s=e.prevMatch(r,o,o);if(!s)return!1;let l=EditorSelection.single(s.from,s.to),a=n.state.facet(searchConfigFacet);return n.dispatch({selection:l,effects:[announceMatch(n,s),a.scrollToMatch(l.main)],userEvent:"select.search"}),!0}),selectMatches=searchCommand((n,{query:e})=>{let r=e.matchAll(n.state,1e3);return!r||!r.length?!1:(n.dispatch({selection:EditorSelection.create(r.map(o=>EditorSelection.range(o.from,o.to))),userEvent:"select.search.matches"}),!0)}),selectSelectionMatches=({state:n,dispatch:e})=>{let r=n.selection;if(r.ranges.length>1||r.main.empty)return!1;let{from:o,to:s}=r.main,l=[],a=0;for(let c=new SearchCursor(n.doc,n.sliceDoc(o,s));!c.next().done;){if(l.length>1e3)return!1;c.value.from==o&&(a=l.length),l.push(EditorSelection.range(c.value.from,c.value.to))}return e(n.update({selection:EditorSelection.create(l,a),userEvent:"select.search.matches"})),!0},replaceNext=searchCommand((n,{query:e})=>{let{state:r}=n,{from:o,to:s}=r.selection.main;if(r.readOnly)return!1;let l=e.nextMatch(r,o,o);if(!l)return!1;let a=[],c,u,f=[];if(l.from==o&&l.to==s&&(u=r.toText(e.getReplacement(l)),a.push({from:l.from,to:l.to,insert:u}),l=e.nextMatch(r,l.from,l.to),f.push(EditorView.announce.of(r.phrase("replaced match on line $",r.doc.lineAt(o).number)+"."))),l){let d=a.length==0||a[0].from>=l.to?0:l.to-l.from-u.length;c=EditorSelection.single(l.from-d,l.to-d),f.push(announceMatch(n,l)),f.push(r.facet(searchConfigFacet).scrollToMatch(c.main))}return n.dispatch({changes:a,selection:c,effects:f,userEvent:"input.replace"}),!0}),replaceAll=searchCommand((n,{query:e})=>{if(n.state.readOnly)return!1;let r=e.matchAll(n.state,1e9).map(s=>{let{from:l,to:a}=s;return{from:l,to:a,insert:e.getReplacement(s)}});if(!r.length)return!1;let o=n.state.phrase("replaced $ matches",r.length)+".";return n.dispatch({changes:r,effects:EditorView.announce.of(o),userEvent:"input.replace.all"}),!0});function createSearchPanel(n){return n.state.facet(searchConfigFacet).createPanel(n)}function defaultQuery(n,e){var r,o,s,l;let a=n.selection.main,c=a.empty||a.to>a.from+100?"":n.sliceDoc(a.from,a.to);if(e&&!c)return e;let u=n.facet(searchConfigFacet);return new SearchQuery({search:((r=e==null?void 0:e.literal)!==null&&r!==void 0?r:u.literal)?c:c.replace(/\n/g,"\\n"),caseSensitive:(o=e==null?void 0:e.caseSensitive)!==null&&o!==void 0?o:u.caseSensitive,literal:(s=e==null?void 0:e.literal)!==null&&s!==void 0?s:u.literal,wholeWord:(l=e==null?void 0:e.wholeWord)!==null&&l!==void 0?l:u.wholeWord})}const openSearchPanel=n=>{let e=n.state.field(searchState,!1);if(e&&e.panel){let r=getPanel(n,createSearchPanel);if(!r)return!1;let o=r.dom.querySelector("[main-field]");if(o&&o!=n.root.activeElement){let s=defaultQuery(n.state,e.query.spec);s.valid&&n.dispatch({effects:setSearchQuery.of(s)}),o.focus(),o.select()}}else n.dispatch({effects:[togglePanel$1.of(!0),e?setSearchQuery.of(defaultQuery(n.state,e.query.spec)):StateEffect.appendConfig.of(searchExtensions)]});return!0},closeSearchPanel=n=>{let e=n.state.field(searchState,!1);if(!e||!e.panel)return!1;let r=getPanel(n,createSearchPanel);return r&&r.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:togglePanel$1.of(!1)}),!0},searchKeymap=[{key:"Mod-f",run:openSearchPanel,scope:"editor search-panel"},{key:"F3",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:closeSearchPanel,scope:"editor search-panel"},{key:"Mod-Shift-l",run:selectSelectionMatches},{key:"Alt-g",run:gotoLine},{key:"Mod-d",run:selectNextOccurrence,preventDefault:!0}];class SearchPanel{constructor(e){this.view=e;let r=this.query=e.state.field(searchState).query.spec;this.commit=this.commit.bind(this),this.searchField=crelt("input",{value:r.search,placeholder:phrase(e,"Find"),"aria-label":phrase(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=crelt("input",{value:r.replace,placeholder:phrase(e,"Replace"),"aria-label":phrase(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=crelt("input",{type:"checkbox",name:"case",form:"",checked:r.caseSensitive,onchange:this.commit}),this.reField=crelt("input",{type:"checkbox",name:"re",form:"",checked:r.regexp,onchange:this.commit}),this.wordField=crelt("input",{type:"checkbox",name:"word",form:"",checked:r.wholeWord,onchange:this.commit});function o(s,l,a){return crelt("button",{class:"cm-button",name:s,onclick:l,type:"button"},a)}this.dom=crelt("div",{onkeydown:s=>this.keydown(s),class:"cm-search"},[this.searchField,o("next",()=>findNext(e),[phrase(e,"next")]),o("prev",()=>findPrevious(e),[phrase(e,"previous")]),o("select",()=>selectMatches(e),[phrase(e,"all")]),crelt("label",null,[this.caseField,phrase(e,"match case")]),crelt("label",null,[this.reField,phrase(e,"regexp")]),crelt("label",null,[this.wordField,phrase(e,"by word")]),...e.state.readOnly?[]:[crelt("br"),this.replaceField,o("replace",()=>replaceNext(e),[phrase(e,"replace")]),o("replaceAll",()=>replaceAll(e),[phrase(e,"replace all")])],crelt("button",{name:"close",onclick:()=>closeSearchPanel(e),"aria-label":phrase(e,"close"),type:"button"},[""])])}commit(){let e=new SearchQuery({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:setSearchQuery.of(e)}))}keydown(e){runScopeHandlers(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?findPrevious:findNext)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),replaceNext(this.view))}update(e){for(let r of e.transactions)for(let o of r.effects)o.is(setSearchQuery)&&!o.value.eq(this.query)&&this.setQuery(o.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(searchConfigFacet).top}}function phrase(n,e){return n.state.phrase(e)}const AnnounceMargin=30,Break=/[\s\.,:;?!]/;function announceMatch(n,{from:e,to:r}){let o=n.state.doc.lineAt(e),s=n.state.doc.lineAt(r).to,l=Math.max(o.from,e-AnnounceMargin),a=Math.min(s,r+AnnounceMargin),c=n.state.sliceDoc(l,a);if(l!=o.from){for(let u=0;u<AnnounceMargin;u++)if(!Break.test(c[u+1])&&Break.test(c[u])){c=c.slice(u);break}}if(a!=s){for(let u=c.length-1;u>c.length-AnnounceMargin;u--)if(!Break.test(c[u-1])&&Break.test(c[u])){c=c.slice(0,u);break}}return EditorView.announce.of(`${n.state.phrase("current match")}. ${c} ${n.state.phrase("on line")} ${o.number}.`)}const baseTheme$2=EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),searchExtensions=[searchState,Prec.lowest(searchHighlighter),baseTheme$2];class CompletionContext{constructor(e,r,o){this.state=e,this.pos=r,this.explicit=o,this.abortListeners=[]}tokenBefore(e){let r=syntaxTree(this.state).resolveInner(this.pos,-1);for(;r&&e.indexOf(r.name)<0;)r=r.parent;return r?{from:r.from,to:this.pos,text:this.state.sliceDoc(r.from,this.pos),type:r.type}:null}matchBefore(e){let r=this.state.doc.lineAt(this.pos),o=Math.max(r.from,this.pos-250),s=r.text.slice(o-r.from,this.pos-r.from),l=s.search(ensureAnchor(e,!1));return l<0?null:{from:o+l,to:this.pos,text:s.slice(l)}}get aborted(){return this.abortListeners==null}addEventListener(e,r){e=="abort"&&this.abortListeners&&this.abortListeners.push(r)}}function toSet(n){let e=Object.keys(n).join(""),r=/\w/.test(e);return r&&(e=e.replace(/\w/g,"")),`[${r?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function prefixMatch(n){let e=Object.create(null),r=Object.create(null);for(let{label:s}of n){e[s[0]]=!0;for(let l=1;l<s.length;l++)r[s[l]]=!0}let o=toSet(e)+toSet(r)+"*$";return[new RegExp("^"+o),new RegExp(o)]}function completeFromList(n){let e=n.map(s=>typeof s=="string"?{label:s}:s),[r,o]=e.every(s=>/^\w+$/.test(s.label))?[/\w*$/,/\w+$/]:prefixMatch(e);return s=>{let l=s.matchBefore(o);return l||s.explicit?{from:l?l.from:s.pos,options:e,validFor:r}:null}}class Option{constructor(e,r,o,s){this.completion=e,this.source=r,this.match=o,this.score=s}}function cur(n){return n.selection.main.from}function ensureAnchor(n,e){var r;let{source:o}=n,s=e&&o[0]!="^",l=o[o.length-1]!="$";return!s&&!l?n:new RegExp(`${s?"^":""}(?:${o})${l?"$":""}`,(r=n.flags)!==null&&r!==void 0?r:n.ignoreCase?"i":"")}const pickedCompletion=Annotation.define();function insertCompletionText(n,e,r,o){let{main:s}=n.selection,l=o-r;return Object.assign(Object.assign({},n.changeByRange(a=>a!=s&&l&&n.sliceDoc(a.from-l,a.from+o-s.from)!=n.sliceDoc(r,o)?{range:a}:{changes:{from:a.from-l,to:o==s.from?a.to:a.from+o-s.from,insert:e},range:EditorSelection.cursor(a.from-l+e.length)})),{userEvent:"input.complete"})}function applyCompletion(n,e){const r=e.completion.apply||e.completion.label;let o=e.source;typeof r=="string"?n.dispatch(Object.assign(Object.assign({},insertCompletionText(n.state,r,o.from,o.to)),{annotations:pickedCompletion.of(e.completion)})):r(n,e.completion,o.from,o.to)}const SourceCache=new WeakMap;function asSource(n){if(!Array.isArray(n))return n;let e=SourceCache.get(n);return e||SourceCache.set(n,e=completeFromList(n)),e}const startCompletionEffect=StateEffect.define(),closeCompletionEffect=StateEffect.define();class FuzzyMatcher{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let r=0;r<e.length;){let o=codePointAt(e,r),s=codePointSize(o);this.chars.push(o);let l=e.slice(r,r+s),a=l.toUpperCase();this.folded.push(codePointAt(a==l?l.toLowerCase():a,0)),r+=s}this.astral=e.length!=this.chars.length}match(e){if(this.pattern.length==0)return[0];if(e.length<this.pattern.length)return null;let{chars:r,folded:o,any:s,precise:l,byWord:a}=this;if(r.length==1){let $=codePointAt(e,0),J=codePointSize($),_=J==e.length?0:-100;if($!=r[0])if($==o[0])_+=-200;else return null;return[_,0,J]}let c=e.indexOf(this.pattern);if(c==0)return[e.length==this.pattern.length?0:-100,0,this.pattern.length];let u=r.length,f=0;if(c<0){for(let $=0,J=Math.min(e.length,200);$<J&&f<u;){let _=codePointAt(e,$);(_==r[f]||_==o[f])&&(s[f++]=$),$+=codePointSize(_)}if(f<u)return null}let d=0,g=0,m=!1,v=0,b=-1,k=-1,A=/[a-z]/.test(e),R=!0;for(let $=0,J=Math.min(e.length,200),_=0;$<J&&g<u;){let L=codePointAt(e,$);c<0&&(d<u&&L==r[d]&&(l[d++]=$),v<u&&(L==r[v]||L==o[v]?(v==0&&(b=$),k=$+1,v++):v=0));let Y,I=L<255?L>=48&&L<=57||L>=97&&L<=122?2:L>=65&&L<=90?1:0:(Y=fromCodePoint(L))!=Y.toLowerCase()?1:Y!=Y.toUpperCase()?2:0;(!$||I==1&&A||_==0&&I!=0)&&(r[g]==L||o[g]==L&&(m=!0)?a[g++]=$:a.length&&(R=!1)),_=I,$+=codePointSize(L)}return g==u&&a[0]==0&&R?this.result(-100+(m?-200:0),a,e):v==u&&b==0?[-200-e.length+(k==e.length?0:-100),0,k]:c>-1?[-700-e.length,c,c+this.pattern.length]:v==u?[-200+-700-e.length,b,k]:g==u?this.result(-100+(m?-200:0)+-700+(R?0:-1100),a,e):r.length==2?null:this.result((s[0]?-700:0)+-200+-1100,s,e)}result(e,r,o){let s=[e-o.length],l=1;for(let a of r){let c=a+(this.astral?codePointSize(codePointAt(o,a)):1);l>1&&s[l-1]==a?s[l-1]=c:(s[l++]=a,s[l++]=c)}return s}}const completionConfig=Facet.define({combine(n){return combineConfig(n,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:defaultPositionInfo,compareCompletions:(e,r)=>e.label.localeCompare(r.label),interactionDelay:75},{defaultKeymap:(e,r)=>e&&r,closeOnBlur:(e,r)=>e&&r,icons:(e,r)=>e&&r,tooltipClass:(e,r)=>o=>joinClass(e(o),r(o)),optionClass:(e,r)=>o=>joinClass(e(o),r(o)),addToOptions:(e,r)=>e.concat(r)})}});function joinClass(n,e){return n?e?n+" "+e:n:e}function defaultPositionInfo(n,e,r,o,s){let l=n.textDirection==Direction.RTL,a=l,c=!1,u="top",f,d,g=e.left-s.left,m=s.right-e.right,v=o.right-o.left,b=o.bottom-o.top;if(a&&g<Math.min(v,m)?a=!1:!a&&m<Math.min(v,g)&&(a=!0),v<=(a?g:m))f=Math.max(s.top,Math.min(r.top,s.bottom-b))-e.top,d=Math.min(400,a?g:m);else{c=!0,d=Math.min(400,(l?e.right:s.right-e.left)-30);let k=s.bottom-e.bottom;k>=b||k>e.top?f=r.bottom-e.top:(u="bottom",f=e.bottom-r.top)}return{style:`${u}: ${f}px; max-width: ${d}px`,class:"cm-completionInfo-"+(c?l?"left-narrow":"right-narrow":a?"left":"right")}}function optionContent(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(r){let o=document.createElement("div");return o.classList.add("cm-completionIcon"),r.type&&o.classList.add(...r.type.split(/\s+/g).map(s=>"cm-completionIcon-"+s)),o.setAttribute("aria-hidden","true"),o},position:20}),e.push({render(r,o,s){let l=document.createElement("span");l.className="cm-completionLabel";let{label:a}=r,c=0;for(let u=1;u<s.length;){let f=s[u++],d=s[u++];f>c&&l.appendChild(document.createTextNode(a.slice(c,f)));let g=l.appendChild(document.createElement("span"));g.appendChild(document.createTextNode(a.slice(f,d))),g.className="cm-completionMatchedText",c=d}return c<a.length&&l.appendChild(document.createTextNode(a.slice(c))),l},position:50},{render(r){if(!r.detail)return null;let o=document.createElement("span");return o.className="cm-completionDetail",o.textContent=r.detail,o},position:80}),e.sort((r,o)=>r.position-o.position).map(r=>r.render)}function rangeAroundSelected(n,e,r){if(n<=r)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let s=Math.floor(e/r);return{from:s*r,to:(s+1)*r}}let o=Math.floor((n-e)/r);return{from:n-(o+1)*r,to:n-o*r}}class CompletionTooltip{constructor(e,r){this.view=e,this.stateField=r,this.info=null,this.placeInfoReq={read:()=>this.measureInfo(),write:c=>this.placeInfo(c),key:this},this.space=null,this.currentClass="";let o=e.state.field(r),{options:s,selected:l}=o.open,a=e.state.facet(completionConfig);this.optionContent=optionContent(a),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=rangeAroundSelected(s.length,l,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",c=>{for(let u=c.target,f;u&&u!=this.dom;u=u.parentNode)if(u.nodeName=="LI"&&(f=/-(\d+)$/.exec(u.id))&&+f[1]<s.length){applyCompletion(e,s[+f[1]]),c.preventDefault();return}}),this.dom.addEventListener("focusout",c=>{let u=e.state.field(this.stateField,!1);u&&u.tooltip&&e.state.facet(completionConfig).closeOnBlur&&c.relatedTarget!=e.contentDOM&&e.dispatch({effects:closeCompletionEffect.of(null)})}),this.list=this.dom.appendChild(this.createListBox(s,o.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}mount(){this.updateSel()}update(e){var r,o,s;let l=e.state.field(this.stateField),a=e.startState.field(this.stateField);this.updateTooltipClass(e.state),l!=a&&(this.updateSel(),((r=l.open)===null||r===void 0?void 0:r.disabled)!=((o=a.open)===null||o===void 0?void 0:o.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!(!((s=l.open)===null||s===void 0)&&s.disabled)))}updateTooltipClass(e){let r=this.tooltipClass(e);if(r!=this.currentClass){for(let o of this.currentClass.split(" "))o&&this.dom.classList.remove(o);for(let o of r.split(" "))o&&this.dom.classList.add(o);this.currentClass=r}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),r=e.open;if((r.selected>-1&&r.selected<this.range.from||r.selected>=this.range.to)&&(this.range=rangeAroundSelected(r.options.length,r.selected,this.view.state.facet(completionConfig).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(r.options,e.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})),this.updateSelectedOption(r.selected)){this.info&&(this.info.remove(),this.info=null);let{completion:o}=r.options[r.selected],{info:s}=o;if(!s)return;let l=typeof s=="string"?document.createTextNode(s):s(o);if(!l)return;"then"in l?l.then(a=>{a&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(a)}).catch(a=>logException(this.view.state,a,"completion info")):this.addInfoPane(l)}}addInfoPane(e){let r=this.info=document.createElement("div");r.className="cm-tooltip cm-completionInfo",r.appendChild(e),this.dom.appendChild(r),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let r=null;for(let o=this.list.firstChild,s=this.range.from;o;o=o.nextSibling,s++)o.nodeName!="LI"||!o.id?s--:s==e?o.hasAttribute("aria-selected")||(o.setAttribute("aria-selected","true"),r=o):o.hasAttribute("aria-selected")&&o.removeAttribute("aria-selected");return r&&scrollIntoView(this.list,r),r}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let r=this.dom.getBoundingClientRect(),o=this.info.getBoundingClientRect(),s=e.getBoundingClientRect(),l=this.space;if(!l){let a=this.dom.ownerDocument.defaultView||window;l={left:0,top:0,right:a.innerWidth,bottom:a.innerHeight}}return s.top>Math.min(l.bottom,r.bottom)-10||s.bottom<Math.max(l.top,r.top)+10?null:this.view.state.facet(completionConfig).positionInfo(this.view,r,s,o,l)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,r,o){const s=document.createElement("ul");s.id=r,s.setAttribute("role","listbox"),s.setAttribute("aria-expanded","true"),s.setAttribute("aria-label",this.view.state.phrase("Completions"));let l=null;for(let a=o.from;a<o.to;a++){let{completion:c,match:u}=e[a],{section:f}=c;if(f){let m=typeof f=="string"?f:f.name;if(m!=l&&(a>o.from||o.from==0))if(l=m,typeof f!="string"&&f.header)s.appendChild(f.header(f));else{let v=s.appendChild(document.createElement("completion-section"));v.textContent=m}}const d=s.appendChild(document.createElement("li"));d.id=r+"-"+a,d.setAttribute("role","option");let g=this.optionClass(c);g&&(d.className=g);for(let m of this.optionContent){let v=m(c,this.view.state,u);v&&d.appendChild(v)}}return o.from&&s.classList.add("cm-completionListIncompleteTop"),o.to<e.length&&s.classList.add("cm-completionListIncompleteBottom"),s}}function completionTooltip(n){return e=>new CompletionTooltip(e,n)}function scrollIntoView(n,e){let r=n.getBoundingClientRect(),o=e.getBoundingClientRect();o.top<r.top?n.scrollTop-=r.top-o.top:o.bottom>r.bottom&&(n.scrollTop+=o.bottom-r.bottom)}function score(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function sortOptions(n,e){let r=[],o=null,s=u=>{r.push(u);let{section:f}=u.completion;if(f){o||(o=[]);let d=typeof f=="string"?f:f.name;o.some(g=>g.name==d)||o.push(typeof f=="string"?{name:d}:f)}};for(let u of n)if(u.hasResult())if(u.result.filter===!1){let f=u.result.getMatch;for(let d of u.result.options){let g=[1e9-r.length];if(f)for(let m of f(d))g.push(m);s(new Option(d,u,g,g[0]))}}else{let f=new FuzzyMatcher(e.sliceDoc(u.from,u.to)),d;for(let g of u.result.options)(d=f.match(g.label))&&s(new Option(g,u,d,d[0]+(g.boost||0)))}if(o){let u=Object.create(null),f=0,d=(g,m)=>{var v,b;return((v=g.rank)!==null&&v!==void 0?v:1e9)-((b=m.rank)!==null&&b!==void 0?b:1e9)||(g.name<m.name?-1:1)};for(let g of o.sort(d))f-=1e5,u[g.name]=f;for(let g of r){let{section:m}=g.completion;m&&(g.score+=u[typeof m=="string"?m:m.name])}}let l=[],a=null,c=e.facet(completionConfig).compareCompletions;for(let u of r.sort((f,d)=>d.score-f.score||c(f.completion,d.completion)))!a||a.label!=u.completion.label||a.detail!=u.completion.detail||a.type!=null&&u.completion.type!=null&&a.type!=u.completion.type||a.apply!=u.completion.apply?l.push(u):score(u.completion)>score(a)&&(l[l.length-1]=u),a=u.completion;return l}class CompletionDialog{constructor(e,r,o,s,l,a){this.options=e,this.attrs=r,this.tooltip=o,this.timestamp=s,this.selected=l,this.disabled=a}setSelected(e,r){return e==this.selected||e>=this.options.length?this:new CompletionDialog(this.options,makeAttrs(r,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,r,o,s,l){let a=sortOptions(e,r);if(!a.length)return s&&e.some(u=>u.state==1)?new CompletionDialog(s.options,s.attrs,s.tooltip,s.timestamp,s.selected,!0):null;let c=r.facet(completionConfig).selectOnOpen?0:-1;if(s&&s.selected!=c&&s.selected!=-1){let u=s.options[s.selected].completion;for(let f=0;f<a.length;f++)if(a[f].completion==u){c=f;break}}return new CompletionDialog(a,makeAttrs(o,c),{pos:e.reduce((u,f)=>f.hasResult()?Math.min(u,f.from):u,1e8),create:completionTooltip(completionState),above:l.aboveCursor},s?s.timestamp:Date.now(),c,!1)}map(e){return new CompletionDialog(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class CompletionState{constructor(e,r,o){this.active=e,this.id=r,this.open=o}static start(){return new CompletionState(none,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:r}=e,o=r.facet(completionConfig),l=(o.override||r.languageDataAt("autocomplete",cur(r)).map(asSource)).map(c=>(this.active.find(f=>f.source==c)||new ActiveSource(c,this.active.some(f=>f.state!=0)?1:0)).update(e,o));l.length==this.active.length&&l.every((c,u)=>c==this.active[u])&&(l=this.active);let a=this.open;a&&e.docChanged&&(a=a.map(e.changes)),e.selection||l.some(c=>c.hasResult()&&e.changes.touchesRange(c.from,c.to))||!sameResults(l,this.active)?a=CompletionDialog.build(l,r,this.id,a,o):a&&a.disabled&&!l.some(c=>c.state==1)&&(a=null),!a&&l.every(c=>c.state!=1)&&l.some(c=>c.hasResult())&&(l=l.map(c=>c.hasResult()?new ActiveSource(c.source,0):c));for(let c of e.effects)c.is(setSelectedEffect)&&(a=a&&a.setSelected(c.value,this.id));return l==this.active&&a==this.open?this:new CompletionState(l,this.id,a)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:baseAttrs}}function sameResults(n,e){if(n==e)return!0;for(let r=0,o=0;;){for(;r<n.length&&!n[r].hasResult;)r++;for(;o<e.length&&!e[o].hasResult;)o++;let s=r==n.length,l=o==e.length;if(s||l)return s==l;if(n[r++].result!=e[o++].result)return!1}}const baseAttrs={"aria-autocomplete":"list"};function makeAttrs(n,e){let r={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(r["aria-activedescendant"]=n+"-"+e),r}const none=[];function getUserEvent(n){return n.isUserEvent("input.type")?"input":n.isUserEvent("delete.backward")?"delete":null}class ActiveSource{constructor(e,r,o=-1){this.source=e,this.state=r,this.explicitPos=o}hasResult(){return!1}update(e,r){let o=getUserEvent(e),s=this;o?s=s.handleUserEvent(e,o,r):e.docChanged?s=s.handleChange(e):e.selection&&s.state!=0&&(s=new ActiveSource(s.source,0));for(let l of e.effects)if(l.is(startCompletionEffect))s=new ActiveSource(s.source,1,l.value?cur(e.state):-1);else if(l.is(closeCompletionEffect))s=new ActiveSource(s.source,0);else if(l.is(setActiveEffect))for(let a of l.value)a.source==s.source&&(s=a);return s}handleUserEvent(e,r,o){return r=="delete"||!o.activateOnTyping?this.map(e.changes):new ActiveSource(this.source,1)}handleChange(e){return e.changes.touchesRange(cur(e.startState))?new ActiveSource(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new ActiveSource(this.source,this.state,e.mapPos(this.explicitPos))}}class ActiveResult extends ActiveSource{constructor(e,r,o,s,l){super(e,2,r),this.result=o,this.from=s,this.to=l}hasResult(){return!0}handleUserEvent(e,r,o){var s;let l=e.changes.mapPos(this.from),a=e.changes.mapPos(this.to,1),c=cur(e.state);if((this.explicitPos<0?c<=l:c<this.from)||c>a||r=="delete"&&cur(e.startState)==this.from)return new ActiveSource(this.source,r=="input"&&o.activateOnTyping?1:0);let u=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos),f;return checkValid(this.result.validFor,e.state,l,a)?new ActiveResult(this.source,u,this.result,l,a):this.result.update&&(f=this.result.update(this.result,l,a,new CompletionContext(e.state,c,u>=0)))?new ActiveResult(this.source,u,f,f.from,(s=f.to)!==null&&s!==void 0?s:cur(e.state)):new ActiveSource(this.source,1,u)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new ActiveSource(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new ActiveResult(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1))}}function checkValid(n,e,r,o){if(!n)return!1;let s=e.sliceDoc(r,o);return typeof n=="function"?n(s,r,o,e):ensureAnchor(n,!0).test(s)}const setActiveEffect=StateEffect.define({map(n,e){return n.map(r=>r.map(e))}}),setSelectedEffect=StateEffect.define(),completionState=StateField.define({create(){return CompletionState.start()},update(n,e){return n.update(e)},provide:n=>[showTooltip.from(n,e=>e.tooltip),EditorView.contentAttributes.from(n,e=>e.attrs)]});function moveCompletionSelection(n,e="option"){return r=>{let o=r.state.field(completionState,!1);if(!o||!o.open||o.open.disabled||Date.now()-o.open.timestamp<r.state.facet(completionConfig).interactionDelay)return!1;let s=1,l;e=="page"&&(l=getTooltip(r,o.open.tooltip))&&(s=Math.max(2,Math.floor(l.dom.offsetHeight/l.dom.querySelector("li").offsetHeight)-1));let{length:a}=o.open.options,c=o.open.selected>-1?o.open.selected+s*(n?1:-1):n?0:a-1;return c<0?c=e=="page"?0:a-1:c>=a&&(c=e=="page"?a-1:0),r.dispatch({effects:setSelectedEffect.of(c)}),!0}}const acceptCompletion=n=>{let e=n.state.field(completionState,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||Date.now()-e.open.timestamp<n.state.facet(completionConfig).interactionDelay?!1:(e.open.disabled||applyCompletion(n,e.open.options[e.open.selected]),!0)},startCompletion=n=>n.state.field(completionState,!1)?(n.dispatch({effects:startCompletionEffect.of(!0)}),!0):!1,closeCompletion=n=>{let e=n.state.field(completionState,!1);return!e||!e.active.some(r=>r.state!=0)?!1:(n.dispatch({effects:closeCompletionEffect.of(null)}),!0)};class RunningQuery{constructor(e,r){this.active=e,this.context=r,this.time=Date.now(),this.updates=[],this.done=void 0}}const DebounceTime=50,MaxUpdateCount=50,MinAbortTime=1e3,completionPlugin=ViewPlugin.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let e of n.state.field(completionState).active)e.state==1&&this.startQuery(e)}update(n){let e=n.state.field(completionState);if(!n.selectionSet&&!n.docChanged&&n.startState.field(completionState)==e)return;let r=n.transactions.some(o=>(o.selection||o.docChanged)&&!getUserEvent(o));for(let o=0;o<this.running.length;o++){let s=this.running[o];if(r||s.updates.length+n.transactions.length>MaxUpdateCount&&Date.now()-s.time>MinAbortTime){for(let l of s.context.abortListeners)try{l()}catch(a){logException(this.view.state,a)}s.context.abortListeners=null,this.running.splice(o--,1)}else s.updates.push(...n.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=e.active.some(o=>o.state==1&&!this.running.some(s=>s.active.source==o.source))?setTimeout(()=>this.startUpdate(),DebounceTime):-1,this.composing!=0)for(let o of n.transactions)getUserEvent(o)=="input"?this.composing=2:this.composing==2&&o.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:n}=this.view,e=n.field(completionState);for(let r of e.active)r.state==1&&!this.running.some(o=>o.active.source==r.source)&&this.startQuery(r)}startQuery(n){let{state:e}=this.view,r=cur(e),o=new CompletionContext(e,r,n.explicitPos==r),s=new RunningQuery(n,o);this.running.push(s),Promise.resolve(n.source(o)).then(l=>{s.context.aborted||(s.done=l||null,this.scheduleAccept())},l=>{this.view.dispatch({effects:closeCompletionEffect.of(null)}),logException(this.view.state,l)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),DebounceTime))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],r=this.view.state.facet(completionConfig);for(let o=0;o<this.running.length;o++){let s=this.running[o];if(s.done===void 0)continue;if(this.running.splice(o--,1),s.done){let a=new ActiveResult(s.active.source,s.active.explicitPos,s.done,s.done.from,(n=s.done.to)!==null&&n!==void 0?n:cur(s.updates.length?s.updates[0].startState:this.view.state));for(let c of s.updates)a=a.update(c,r);if(a.hasResult()){e.push(a);continue}}let l=this.view.state.field(completionState).active.find(a=>a.source==s.active.source);if(l&&l.state==1)if(s.done==null){let a=new ActiveSource(s.active.source,0);for(let c of s.updates)a=a.update(c,r);a.state!=1&&e.push(a)}else this.startQuery(l)}e.length&&this.view.dispatch({effects:setActiveEffect.of(e)})}},{eventHandlers:{blur(n){let e=this.view.state.field(completionState,!1);if(e&&e.tooltip&&this.view.state.facet(completionConfig).closeOnBlur){let r=e.open&&getTooltip(this.view,e.open.tooltip);(!r||!r.dom.contains(n.relatedTarget))&&this.view.dispatch({effects:closeCompletionEffect.of(null)})}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:startCompletionEffect.of(!1)}),20),this.composing=0}}}),baseTheme$1=EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),defaults={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},closeBracketEffect=StateEffect.define({map(n,e){let r=e.mapPos(n,-1,MapMode.TrackAfter);return r??void 0}}),closedBracket=new class extends RangeValue{};closedBracket.startSide=1;closedBracket.endSide=-1;const bracketState=StateField.define({create(){return RangeSet.empty},update(n,e){if(e.selection){let r=e.state.doc.lineAt(e.selection.main.head).from,o=e.startState.doc.lineAt(e.startState.selection.main.head).from;r!=e.changes.mapPos(o,-1)&&(n=RangeSet.empty)}n=n.map(e.changes);for(let r of e.effects)r.is(closeBracketEffect)&&(n=n.update({add:[closedBracket.range(r.value,r.value+1)]}));return n}});function closeBrackets(){return[inputHandler,bracketState]}const definedClosing="()[]{}<>";function closing(n){for(let e=0;e<definedClosing.length;e+=2)if(definedClosing.charCodeAt(e)==n)return definedClosing.charAt(e+1);return fromCodePoint(n<128?n:n+1)}function config(n,e){return n.languageDataAt("closeBrackets",e)[0]||defaults}const android=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),inputHandler=EditorView.inputHandler.of((n,e,r,o)=>{if((android?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let s=n.state.selection.main;if(o.length>2||o.length==2&&codePointSize(codePointAt(o,0))==1||e!=s.from||r!=s.to)return!1;let l=insertBracket(n.state,o);return l?(n.dispatch(l),!0):!1}),deleteBracketPair=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let o=config(n,n.selection.main.head).brackets||defaults.brackets,s=null,l=n.changeByRange(a=>{if(a.empty){let c=prevChar(n.doc,a.head);for(let u of o)if(u==c&&nextChar(n.doc,a.head)==closing(codePointAt(u,0)))return{changes:{from:a.head-u.length,to:a.head+u.length},range:EditorSelection.cursor(a.head-u.length)}}return{range:s=a}});return s||e(n.update(l,{scrollIntoView:!0,userEvent:"delete.backward"})),!s},closeBracketsKeymap=[{key:"Backspace",run:deleteBracketPair}];function insertBracket(n,e){let r=config(n,n.selection.main.head),o=r.brackets||defaults.brackets;for(let s of o){let l=closing(codePointAt(s,0));if(e==s)return l==s?handleSame(n,s,o.indexOf(s+s+s)>-1,r):handleOpen(n,s,l,r.before||defaults.before);if(e==l&&closedBracketAt(n,n.selection.main.from))return handleClose(n,s,l)}return null}function closedBracketAt(n,e){let r=!1;return n.field(bracketState).between(0,n.doc.length,o=>{o==e&&(r=!0)}),r}function nextChar(n,e){let r=n.sliceString(e,e+2);return r.slice(0,codePointSize(codePointAt(r,0)))}function prevChar(n,e){let r=n.sliceString(e-2,e);return codePointSize(codePointAt(r,0))==r.length?r:r.slice(1)}function handleOpen(n,e,r,o){let s=null,l=n.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:r,from:a.to}],effects:closeBracketEffect.of(a.to+e.length),range:EditorSelection.range(a.anchor+e.length,a.head+e.length)};let c=nextChar(n.doc,a.head);return!c||/\s/.test(c)||o.indexOf(c)>-1?{changes:{insert:e+r,from:a.head},effects:closeBracketEffect.of(a.head+e.length),range:EditorSelection.cursor(a.head+e.length)}:{range:s=a}});return s?null:n.update(l,{scrollIntoView:!0,userEvent:"input.type"})}function handleClose(n,e,r){let o=null,s=n.changeByRange(l=>l.empty&&nextChar(n.doc,l.head)==r?{changes:{from:l.head,to:l.head+r.length,insert:r},range:EditorSelection.cursor(l.head+r.length)}:o={range:l});return o?null:n.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function handleSame(n,e,r,o){let s=o.stringPrefixes||defaults.stringPrefixes,l=null,a=n.changeByRange(c=>{if(!c.empty)return{changes:[{insert:e,from:c.from},{insert:e,from:c.to}],effects:closeBracketEffect.of(c.to+e.length),range:EditorSelection.range(c.anchor+e.length,c.head+e.length)};let u=c.head,f=nextChar(n.doc,u),d;if(f==e){if(nodeStart(n,u))return{changes:{insert:e+e,from:u},effects:closeBracketEffect.of(u+e.length),range:EditorSelection.cursor(u+e.length)};if(closedBracketAt(n,u)){let m=r&&n.sliceDoc(u,u+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:u,to:u+m.length,insert:m},range:EditorSelection.cursor(u+m.length)}}}else{if(r&&n.sliceDoc(u-2*e.length,u)==e+e&&(d=canStartStringAt(n,u-2*e.length,s))>-1&&nodeStart(n,d))return{changes:{insert:e+e+e+e,from:u},effects:closeBracketEffect.of(u+e.length),range:EditorSelection.cursor(u+e.length)};if(n.charCategorizer(u)(f)!=CharCategory.Word&&canStartStringAt(n,u,s)>-1&&!probablyInString(n,u,e,s))return{changes:{insert:e+e,from:u},effects:closeBracketEffect.of(u+e.length),range:EditorSelection.cursor(u+e.length)}}return{range:l=c}});return l?null:n.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function nodeStart(n,e){let r=syntaxTree(n).resolveInner(e+1);return r.parent&&r.from==e}function probablyInString(n,e,r,o){let s=syntaxTree(n).resolveInner(e,-1),l=o.reduce((a,c)=>Math.max(a,c.length),0);for(let a=0;a<5;a++){let c=n.sliceDoc(s.from,Math.min(s.to,s.from+r.length+l)),u=c.indexOf(r);if(!u||u>-1&&o.indexOf(c.slice(0,u))>-1){let d=s.firstChild;for(;d&&d.from==s.from&&d.to-d.from>r.length+u;){if(n.sliceDoc(d.to-r.length,d.to)==r)return!1;d=d.firstChild}return!0}let f=s.to==e&&s.parent;if(!f)break;s=f}return!1}function canStartStringAt(n,e,r){let o=n.charCategorizer(e);if(o(n.sliceDoc(e-1,e))!=CharCategory.Word)return e;for(let s of r){let l=e-s.length;if(n.sliceDoc(l,e)==s&&o(n.sliceDoc(l-1,l))!=CharCategory.Word)return l}return-1}function autocompletion(n={}){return[completionState,completionConfig.of(n),completionPlugin,completionKeymapExt,baseTheme$1]}const completionKeymap=[{key:"Ctrl-Space",run:startCompletion},{key:"Escape",run:closeCompletion},{key:"ArrowDown",run:moveCompletionSelection(!0)},{key:"ArrowUp",run:moveCompletionSelection(!1)},{key:"PageDown",run:moveCompletionSelection(!0,"page")},{key:"PageUp",run:moveCompletionSelection(!1,"page")},{key:"Enter",run:acceptCompletion}],completionKeymapExt=Prec.highest(keymap.computeN([completionConfig],n=>n.facet(completionConfig).defaultKeymap?[completionKeymap]:[]));class SelectedDiagnostic{constructor(e,r,o){this.from=e,this.to=r,this.diagnostic=o}}class LintState{constructor(e,r,o){this.diagnostics=e,this.panel=r,this.selected=o}static init(e,r,o){let s=e,l=o.facet(lintConfig).markerFilter;l&&(s=l(s));let a=Decoration.set(s.map(c=>c.from==c.to||c.from==c.to-1&&o.doc.lineAt(c.from).to==c.from?Decoration.widget({widget:new DiagnosticWidget(c),diagnostic:c}).range(c.from):Decoration.mark({attributes:{class:"cm-lintRange cm-lintRange-"+c.severity},diagnostic:c}).range(c.from,c.to)),!0);return new LintState(a,r,findDiagnostic(a))}}function findDiagnostic(n,e=null,r=0){let o=null;return n.between(r,1e9,(s,l,{spec:a})=>{if(!(e&&a.diagnostic!=e))return o=new SelectedDiagnostic(s,l,a.diagnostic),!1}),o}function hideTooltip(n,e){return!!(n.effects.some(r=>r.is(setDiagnosticsEffect))||n.changes.touchesRange(e.pos))}function maybeEnableLint(n,e){return n.field(lintState,!1)?e:e.concat(StateEffect.appendConfig.of(lintExtensions))}const setDiagnosticsEffect=StateEffect.define(),togglePanel=StateEffect.define(),movePanelSelection=StateEffect.define(),lintState=StateField.define({create(){return new LintState(Decoration.none,null,null)},update(n,e){if(e.docChanged){let r=n.diagnostics.map(e.changes),o=null;if(n.selected){let s=e.changes.mapPos(n.selected.from,1);o=findDiagnostic(r,n.selected.diagnostic,s)||findDiagnostic(r,null,s)}n=new LintState(r,n.panel,o)}for(let r of e.effects)r.is(setDiagnosticsEffect)?n=LintState.init(r.value,n.panel,e.state):r.is(togglePanel)?n=new LintState(n.diagnostics,r.value?LintPanel.open:null,n.selected):r.is(movePanelSelection)&&(n=new LintState(n.diagnostics,n.panel,r.value));return n},provide:n=>[showPanel.from(n,e=>e.panel),EditorView.decorations.from(n,e=>e.diagnostics)]}),activeMark=Decoration.mark({class:"cm-lintRange cm-lintRange-active"});function lintTooltip(n,e,r){let{diagnostics:o}=n.state.field(lintState),s=[],l=2e8,a=0;o.between(e-(r<0?1:0),e+(r>0?1:0),(u,f,{spec:d})=>{e>=u&&e<=f&&(u==f||(e>u||r>0)&&(e<f||r<0))&&(s.push(d.diagnostic),l=Math.min(u,l),a=Math.max(f,a))});let c=n.state.facet(lintConfig).tooltipFilter;return c&&(s=c(s)),s.length?{pos:l,end:a,above:n.state.doc.lineAt(l).to<a,create(){return{dom:diagnosticsTooltip(n,s)}}}:null}function diagnosticsTooltip(n,e){return crelt("ul",{class:"cm-tooltip-lint"},e.map(r=>renderDiagnostic(n,r,!1)))}const openLintPanel=n=>{let e=n.state.field(lintState,!1);(!e||!e.panel)&&n.dispatch({effects:maybeEnableLint(n.state,[togglePanel.of(!0)])});let r=getPanel(n,LintPanel.open);return r&&r.dom.querySelector(".cm-panel-lint ul").focus(),!0},closeLintPanel=n=>{let e=n.state.field(lintState,!1);return!e||!e.panel?!1:(n.dispatch({effects:togglePanel.of(!1)}),!0)},nextDiagnostic=n=>{let e=n.state.field(lintState,!1);if(!e)return!1;let r=n.state.selection.main,o=e.diagnostics.iter(r.to+1);return!o.value&&(o=e.diagnostics.iter(0),!o.value||o.from==r.from&&o.to==r.to)?!1:(n.dispatch({selection:{anchor:o.from,head:o.to},scrollIntoView:!0}),!0)},lintKeymap=[{key:"Mod-Shift-m",run:openLintPanel,preventDefault:!0},{key:"F8",run:nextDiagnostic}],lintConfig=Facet.define({combine(n){return Object.assign({sources:n.map(e=>e.source)},combineConfig(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(e,r)=>e?r?o=>e(o)||r(o):e:r}))}});function assignKeys(n){let e=[];if(n)e:for(let{name:r}of n){for(let o=0;o<r.length;o++){let s=r[o];if(/[a-zA-Z]/.test(s)&&!e.some(l=>l.toLowerCase()==s.toLowerCase())){e.push(s);continue e}}e.push("")}return e}function renderDiagnostic(n,e,r){var o;let s=r?assignKeys(e.actions):[];return crelt("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},crelt("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage():e.message),(o=e.actions)===null||o===void 0?void 0:o.map((l,a)=>{let c=!1,u=m=>{if(m.preventDefault(),c)return;c=!0;let v=findDiagnostic(n.state.field(lintState).diagnostics,e);v&&l.apply(n,v.from,v.to)},{name:f}=l,d=s[a]?f.indexOf(s[a]):-1,g=d<0?f:[f.slice(0,d),crelt("u",f.slice(d,d+1)),f.slice(d+1)];return crelt("button",{type:"button",class:"cm-diagnosticAction",onclick:u,onmousedown:u,"aria-label":` Action: ${f}${d<0?"":` (access key "${s[a]})"`}.`},g)}),e.source&&crelt("div",{class:"cm-diagnosticSource"},e.source))}class DiagnosticWidget extends WidgetType{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return crelt("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class PanelItem{constructor(e,r){this.diagnostic=r,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=renderDiagnostic(e,r,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class LintPanel{constructor(e){this.view=e,this.items=[];let r=s=>{if(s.keyCode==27)closeLintPanel(this.view),this.view.focus();else if(s.keyCode==38||s.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(s.keyCode==40||s.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(s.keyCode==36)this.moveSelection(0);else if(s.keyCode==35)this.moveSelection(this.items.length-1);else if(s.keyCode==13)this.view.focus();else if(s.keyCode>=65&&s.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:l}=this.items[this.selectedIndex],a=assignKeys(l.actions);for(let c=0;c<a.length;c++)if(a[c].toUpperCase().charCodeAt(0)==s.keyCode){let u=findDiagnostic(this.view.state.field(lintState).diagnostics,l);u&&l.actions[c].apply(e,u.from,u.to)}}else return;s.preventDefault()},o=s=>{for(let l=0;l<this.items.length;l++)this.items[l].dom.contains(s.target)&&this.moveSelection(l)};this.list=crelt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:r,onclick:o}),this.dom=crelt("div",{class:"cm-panel-lint"},this.list,crelt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>closeLintPanel(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(lintState).selected;if(!e)return-1;for(let r=0;r<this.items.length;r++)if(this.items[r].diagnostic==e.diagnostic)return r;return-1}update(){let{diagnostics:e,selected:r}=this.view.state.field(lintState),o=0,s=!1,l=null;for(e.between(0,this.view.state.doc.length,(a,c,{spec:u})=>{let f=-1,d;for(let g=o;g<this.items.length;g++)if(this.items[g].diagnostic==u.diagnostic){f=g;break}f<0?(d=new PanelItem(this.view,u.diagnostic),this.items.splice(o,0,d),s=!0):(d=this.items[f],f>o&&(this.items.splice(o,f-o),s=!0)),r&&d.diagnostic==r.diagnostic?d.dom.hasAttribute("aria-selected")||(d.dom.setAttribute("aria-selected","true"),l=d):d.dom.hasAttribute("aria-selected")&&d.dom.removeAttribute("aria-selected"),o++});o<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)s=!0,this.items.pop();this.items.length==0&&(this.items.push(new PanelItem(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),s=!0),l?(this.list.setAttribute("aria-activedescendant",l.id),this.view.requestMeasure({key:this,read:()=>({sel:l.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:a,panel:c})=>{a.top<c.top?this.list.scrollTop-=c.top-a.top:a.bottom>c.bottom&&(this.list.scrollTop+=a.bottom-c.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),s&&this.sync()}sync(){let e=this.list.firstChild;function r(){let o=e;e=o.nextSibling,o.remove()}for(let o of this.items)if(o.dom.parentNode==this.list){for(;e!=o.dom;)r();e=o.dom.nextSibling}else this.list.insertBefore(o.dom,e);for(;e;)r()}moveSelection(e){if(this.selectedIndex<0)return;let r=this.view.state.field(lintState),o=findDiagnostic(r.diagnostics,this.items[e].diagnostic);o&&this.view.dispatch({selection:{anchor:o.from,head:o.to},scrollIntoView:!0,effects:movePanelSelection.of(o)})}static open(e){return new LintPanel(e)}}function svg(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function underline(n){return svg(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const baseTheme=EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:underline("#d11")},".cm-lintRange-warning":{backgroundImage:underline("orange")},".cm-lintRange-info":{backgroundImage:underline("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),lintExtensions=[lintState,EditorView.decorations.compute([lintState],n=>{let{selected:e,panel:r}=n.field(lintState);return!e||!r||e.from==e.to?Decoration.none:Decoration.set([activeMark.range(e.from,e.to)])}),hoverTooltip(lintTooltip,{hideOn:hideTooltip}),baseTheme],basicSetup=(()=>[lineNumbers(),highlightActiveLineGutter(),highlightSpecialChars(),history$1(),foldGutter(),drawSelection(),dropCursor(),EditorState.allowMultipleSelections.of(!0),indentOnInput(),syntaxHighlighting(defaultHighlightStyle,{fallback:!0}),bracketMatching(),closeBrackets(),autocompletion(),rectangularSelection(),crosshairCursor(),highlightActiveLine(),highlightSelectionMatches(),keymap.of([...closeBracketsKeymap,...defaultKeymap,...searchKeymap,...historyKeymap,...foldKeymap,...completionKeymap,...lintKeymap])])();/*!
* VueCodemirror v6.1.1
* Copyright (c) Surmon. All rights reserved.
* Released under the MIT License.
* Surmon
*/var h=Object.freeze({autofocus:!1,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"",autoDestroy:!0,extensions:[basicSetup]}),y=Symbol("vue-codemirror-global-config"),O,j=function(n){var e=n.onUpdate,r=n.onChange,o=n.onFocus,s=n.onBlur,l=function(a,c){var u={};for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&c.indexOf(f)<0&&(u[f]=a[f]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function"){var d=0;for(f=Object.getOwnPropertySymbols(a);d<f.length;d++)c.indexOf(f[d])<0&&Object.prototype.propertyIsEnumerable.call(a,f[d])&&(u[f[d]]=a[f[d]])}return u}(n,["onUpdate","onChange","onFocus","onBlur"]);return EditorState.create({doc:l.doc,selection:l.selection,extensions:(Array.isArray(l.extensions)?l.extensions:[l.extensions]).concat([EditorView.updateListener.of(function(a){e(a),a.docChanged&&r(a.state.doc.toString(),a),a.focusChanged&&(a.view.hasFocus?o(a):s(a))})])})},S=function(n){var e=new Compartment;return{compartment:e,run:function(r){e.get(n.state)?n.dispatch({effects:e.reconfigure(r)}):n.dispatch({effects:StateEffect.appendConfig.of(e.of(r))})}}},x=function(n,e){var r=S(n),o=r.compartment,s=r.run;return function(l){var a=o.get(n.state);s(l??a!==e?e:[])}},C={type:Boolean,default:void 0},D={autofocus:C,disabled:C,indentWithTab:C,tabSize:Number,placeholder:String,style:Object,autoDestroy:C,phrases:Object,root:Object,extensions:Array,selection:Object},U={modelValue:{type:String,default:""}},w=Object.assign(Object.assign({},D),U);(function(n){n.Change="change",n.Update="update",n.Focus="focus",n.Blur="blur",n.Ready="ready",n.ModelUpdate="update:modelValue"})(O||(O={}));var z={};z[O.Change]=function(n,e){return!0},z[O.Update]=function(n){return!0},z[O.Focus]=function(n){return!0},z[O.Blur]=function(n){return!0},z[O.Ready]=function(n){return!0};var B={};B[O.ModelUpdate]=z[O.Change];var F=Object.assign(Object.assign({},z),B),P=defineComponent({name:"VueCodemirror",props:Object.assign({},w),emits:Object.assign({},F),setup:function(n,e){var r=shallowRef(),o=shallowRef(),s=shallowRef(),l=Object.assign(Object.assign({},h),inject(y,{})),a=computed(function(){var c={};return Object.keys(toRaw(n)).forEach(function(u){var f;u!=="modelValue"&&(c[u]=(f=n[u])!==null&&f!==void 0?f:l[u])}),c});return onMounted(function(){var c;o.value=j({doc:n.modelValue,selection:a.value.selection,extensions:(c=l.extensions)!==null&&c!==void 0?c:[],onFocus:function(f){return e.emit(O.Focus,f)},onBlur:function(f){return e.emit(O.Blur,f)},onUpdate:function(f){return e.emit(O.Update,f)},onChange:function(f,d){f!==n.modelValue&&(e.emit(O.Change,f,d),e.emit(O.ModelUpdate,f,d))}}),s.value=function(f){return new EditorView(Object.assign({},f))}({state:o.value,parent:r.value,root:a.value.root});var u=function(f){var d=function(){return f.state.doc.toString()},g=S(f).run,m=x(f,[EditorView.editable.of(!1),EditorState.readOnly.of(!0)]),v=x(f,keymap.of([indentWithTab])),b=S(f).run,k=S(f).run,A=S(f).run,R=S(f).run;return{focus:function(){return f.focus()},getDoc:d,setDoc:function($){$!==d()&&f.dispatch({changes:{from:0,to:f.state.doc.length,insert:$}})},reExtensions:g,toggleDisabled:m,toggleIndentWithTab:v,setTabSize:function($){b([EditorState.tabSize.of($),indentUnit.of(" ".repeat($))])},setPhrases:function($){k([EditorState.phrases.of($)])},setPlaceholder:function($){A(placeholder($))},setStyle:function($){$===void 0&&($={}),R(EditorView.theme({"&":Object.assign({},$)}))}}}(s.value);watch(function(){return n.modelValue},function(f){f!==u.getDoc()&&u.setDoc(f)}),watch(function(){return n.extensions},function(f){return u.reExtensions(f||[])},{immediate:!0}),watch(function(){return a.value.disabled},function(f){return u.toggleDisabled(f)},{immediate:!0}),watch(function(){return a.value.indentWithTab},function(f){return u.toggleIndentWithTab(f)},{immediate:!0}),watch(function(){return a.value.tabSize},function(f){return u.setTabSize(f)},{immediate:!0}),watch(function(){return a.value.phrases},function(f){return u.setPhrases(f||{})},{immediate:!0}),watch(function(){return a.value.placeholder},function(f){return u.setPlaceholder(f)},{immediate:!0}),watch(function(){return a.value.style},function(f){return u.setStyle(f)},{immediate:!0}),a.value.autofocus&&u.focus(),e.emit(O.Ready,{state:o.value,view:s.value,container:r.value})}),onBeforeUnmount(function(){a.value.autoDestroy&&s.value&&function(c){c.destroy()}(s.value)}),function(){return h$1("div",{class:"v-codemirror",style:{display:"contents"},ref:r})}}}),T=P,V=function(n,e){n.component(P.name,P),n.component("Codemirror",P),function(r,o){r.provide(y,o)}(n,e)},W={Codemirror:T,install:V};/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const isBrowser=typeof window<"u";function isESModule(n){return n.__esModule||n[Symbol.toStringTag]==="Module"}const assign=Object.assign;function applyToParams(n,e){const r={};for(const o in e){const s=e[o];r[o]=isArray(s)?s.map(n):n(s)}return r}const noop=()=>{},isArray=Array.isArray,TRAILING_SLASH_RE=/\/$/,removeTrailingSlash=n=>n.replace(TRAILING_SLASH_RE,"");function parseURL(n,e,r="/"){let o,s={},l="",a="";const c=e.indexOf("#");let u=e.indexOf("?");return c<u&&c>=0&&(u=-1),u>-1&&(o=e.slice(0,u),l=e.slice(u+1,c>-1?c:e.length),s=n(l)),c>-1&&(o=o||e.slice(0,c),a=e.slice(c,e.length)),o=resolveRelativePath(o??e,r),{fullPath:o+(l&&"?")+l+a,path:o,query:s,hash:a}}function stringifyURL(n,e){const r=e.query?n(e.query):"";return e.path+(r&&"?")+r+(e.hash||"")}function stripBase(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function isSameRouteLocation(n,e,r){const o=e.matched.length-1,s=r.matched.length-1;return o>-1&&o===s&&isSameRouteRecord(e.matched[o],r.matched[s])&&isSameRouteLocationParams(e.params,r.params)&&n(e.query)===n(r.query)&&e.hash===r.hash}function isSameRouteRecord(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function isSameRouteLocationParams(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const r in n)if(!isSameRouteLocationParamsValue(n[r],e[r]))return!1;return!0}function isSameRouteLocationParamsValue(n,e){return isArray(n)?isEquivalentArray(n,e):isArray(e)?isEquivalentArray(e,n):n===e}function isEquivalentArray(n,e){return isArray(e)?n.length===e.length&&n.every((r,o)=>r===e[o]):n.length===1&&n[0]===e}function resolveRelativePath(n,e){if(n.startsWith("/"))return n;if(!n)return e;const r=e.split("/"),o=n.split("/");let s=r.length-1,l,a;for(l=0;l<o.length;l++)if(a=o[l],a!==".")if(a==="..")s>1&&s--;else break;return r.slice(0,s).join("/")+"/"+o.slice(l-(l===o.length?1:0)).join("/")}var NavigationType;(function(n){n.pop="pop",n.push="push"})(NavigationType||(NavigationType={}));var NavigationDirection;(function(n){n.back="back",n.forward="forward",n.unknown=""})(NavigationDirection||(NavigationDirection={}));function normalizeBase(n){if(!n)if(isBrowser){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),removeTrailingSlash(n)}const BEFORE_HASH_RE=/^[^#]+#/;function createHref(n,e){return n.replace(BEFORE_HASH_RE,"#")+e}function getElementPosition(n,e){const r=document.documentElement.getBoundingClientRect(),o=n.getBoundingClientRect();return{behavior:e.behavior,left:o.left-r.left-(e.left||0),top:o.top-r.top-(e.top||0)}}const computeScrollPosition=()=>({left:window.pageXOffset,top:window.pageYOffset});function scrollToPosition(n){let e;if("el"in n){const r=n.el,o=typeof r=="string"&&r.startsWith("#"),s=typeof r=="string"?o?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!s)return;e=getElementPosition(s,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function getScrollKey(n,e){return(history.state?history.state.position-e:-1)+n}const scrollPositions=new Map;function saveScrollPosition(n,e){scrollPositions.set(n,e)}function getSavedScrollPosition(n){const e=scrollPositions.get(n);return scrollPositions.delete(n),e}let createBaseLocation=()=>location.protocol+"//"+location.host;function createCurrentLocation(n,e){const{pathname:r,search:o,hash:s}=e,l=n.indexOf("#");if(l>-1){let c=s.includes(n.slice(l))?n.slice(l).length:1,u=s.slice(c);return u[0]!=="/"&&(u="/"+u),stripBase(u,"")}return stripBase(r,n)+o+s}function useHistoryListeners(n,e,r,o){let s=[],l=[],a=null;const c=({state:m})=>{const v=createCurrentLocation(n,location),b=r.value,k=e.value;let A=0;if(m){if(r.value=v,e.value=m,a&&a===b){a=null;return}A=k?m.position-k.position:0}else o(v);s.forEach(R=>{R(r.value,b,{delta:A,type:NavigationType.pop,direction:A?A>0?NavigationDirection.forward:NavigationDirection.back:NavigationDirection.unknown})})};function u(){a=r.value}function f(m){s.push(m);const v=()=>{const b=s.indexOf(m);b>-1&&s.splice(b,1)};return l.push(v),v}function d(){const{history:m}=window;m.state&&m.replaceState(assign({},m.state,{scroll:computeScrollPosition()}),"")}function g(){for(const m of l)m();l=[],window.removeEventListener("popstate",c),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",c),window.addEventListener("beforeunload",d),{pauseListeners:u,listen:f,destroy:g}}function buildState(n,e,r,o=!1,s=!1){return{back:n,current:e,forward:r,replaced:o,position:window.history.length,scroll:s?computeScrollPosition():null}}function useHistoryStateNavigation(n){const{history:e,location:r}=window,o={value:createCurrentLocation(n,r)},s={value:e.state};s.value||l(o.value,{back:null,current:o.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function l(u,f,d){const g=n.indexOf("#"),m=g>-1?(r.host&&document.querySelector("base")?n:n.slice(g))+u:createBaseLocation()+n+u;try{e[d?"replaceState":"pushState"](f,"",m),s.value=f}catch(v){console.error(v),r[d?"replace":"assign"](m)}}function a(u,f){const d=assign({},e.state,buildState(s.value.back,u,s.value.forward,!0),f,{position:s.value.position});l(u,d,!0),o.value=u}function c(u,f){const d=assign({},s.value,e.state,{forward:u,scroll:computeScrollPosition()});l(d.current,d,!0);const g=assign({},buildState(o.value,u,null),{position:d.position+1},f);l(u,g,!1),o.value=u}return{location:o,state:s,push:c,replace:a}}function createWebHistory(n){n=normalizeBase(n);const e=useHistoryStateNavigation(n),r=useHistoryListeners(n,e.state,e.location,e.replace);function o(l,a=!0){a||r.pauseListeners(),history.go(l)}const s=assign({location:"",base:n,go:o,createHref:createHref.bind(null,n)},e,r);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function isRouteLocation(n){return typeof n=="string"||n&&typeof n=="object"}function isRouteName(n){return typeof n=="string"||typeof n=="symbol"}const START_LOCATION_NORMALIZED={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},NavigationFailureSymbol=Symbol("");var NavigationFailureType;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(NavigationFailureType||(NavigationFailureType={}));function createRouterError(n,e){return assign(new Error,{type:n,[NavigationFailureSymbol]:!0},e)}function isNavigationFailure(n,e){return n instanceof Error&&NavigationFailureSymbol in n&&(e==null||!!(n.type&e))}const BASE_PARAM_PATTERN="[^/]+?",BASE_PATH_PARSER_OPTIONS={sensitive:!1,strict:!1,start:!0,end:!0},REGEX_CHARS_RE=/[.+*?^${}()[\]/\\]/g;function tokensToParser(n,e){const r=assign({},BASE_PATH_PARSER_OPTIONS,e),o=[];let s=r.start?"^":"";const l=[];for(const f of n){const d=f.length?[]:[90];r.strict&&!f.length&&(s+="/");for(let g=0;g<f.length;g++){const m=f[g];let v=40+(r.sensitive?.25:0);if(m.type===0)g||(s+="/"),s+=m.value.replace(REGEX_CHARS_RE,"\\$&"),v+=40;else if(m.type===1){const{value:b,repeatable:k,optional:A,regexp:R}=m;l.push({name:b,repeatable:k,optional:A});const $=R||BASE_PARAM_PATTERN;if($!==BASE_PARAM_PATTERN){v+=10;try{new RegExp(`(${$})`)}catch(_){throw new Error(`Invalid custom RegExp for param "${b}" (${$}): `+_.message)}}let J=k?`((?:${$})(?:/(?:${$}))*)`:`(${$})`;g||(J=A&&f.length<2?`(?:/${J})`:"/"+J),A&&(J+="?"),s+=J,v+=20,A&&(v+=-8),k&&(v+=-20),$===".*"&&(v+=-50)}d.push(v)}o.push(d)}if(r.strict&&r.end){const f=o.length-1;o[f][o[f].length-1]+=.7000000000000001}r.strict||(s+="/?"),r.end?s+="$":r.strict&&(s+="(?:/|$)");const a=new RegExp(s,r.sensitive?"":"i");function c(f){const d=f.match(a),g={};if(!d)return null;for(let m=1;m<d.length;m++){const v=d[m]||"",b=l[m-1];g[b.name]=v&&b.repeatable?v.split("/"):v}return g}function u(f){let d="",g=!1;for(const m of n){(!g||!d.endsWith("/"))&&(d+="/"),g=!1;for(const v of m)if(v.type===0)d+=v.value;else if(v.type===1){const{value:b,repeatable:k,optional:A}=v,R=b in f?f[b]:"";if(isArray(R)&&!k)throw new Error(`Provided param "${b}" is an array but it is not repeatable (* or + modifiers)`);const $=isArray(R)?R.join("/"):R;if(!$)if(A)m.length<2&&(d.endsWith("/")?d=d.slice(0,-1):g=!0);else throw new Error(`Missing required param "${b}"`);d+=$}}return d||"/"}return{re:a,score:o,keys:l,parse:c,stringify:u}}function compareScoreArray(n,e){let r=0;for(;r<n.length&&r<e.length;){const o=e[r]-n[r];if(o)return o;r++}return n.length<e.length?n.length===1&&n[0]===40+40?-1:1:n.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function comparePathParserScore(n,e){let r=0;const o=n.score,s=e.score;for(;r<o.length&&r<s.length;){const l=compareScoreArray(o[r],s[r]);if(l)return l;r++}if(Math.abs(s.length-o.length)===1){if(isLastScoreNegative(o))return 1;if(isLastScoreNegative(s))return-1}return s.length-o.length}function isLastScoreNegative(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const ROOT_TOKEN={type:0,value:""},VALID_PARAM_RE=/[a-zA-Z0-9_]/;function tokenizePath(n){if(!n)return[[]];if(n==="/")return[[ROOT_TOKEN]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(v){throw new Error(`ERR (${r})/"${f}": ${v}`)}let r=0,o=r;const s=[];let l;function a(){l&&s.push(l),l=[]}let c=0,u,f="",d="";function g(){f&&(r===0?l.push({type:0,value:f}):r===1||r===2||r===3?(l.length>1&&(u==="*"||u==="+")&&e(`A repeatable param (${f}) must be alone in its segment. eg: '/:ids+.`),l.push({type:1,value:f,regexp:d,repeatable:u==="*"||u==="+",optional:u==="*"||u==="?"})):e("Invalid state to consume buffer"),f="")}function m(){f+=u}for(;c<n.length;){if(u=n[c++],u==="\\"&&r!==2){o=r,r=4;continue}switch(r){case 0:u==="/"?(f&&g(),a()):u===":"?(g(),r=1):m();break;case 4:m(),r=o;break;case 1:u==="("?r=2:VALID_PARAM_RE.test(u)?m():(g(),r=0,u!=="*"&&u!=="?"&&u!=="+"&&c--);break;case 2:u===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+u:r=3:d+=u;break;case 3:g(),r=0,u!=="*"&&u!=="?"&&u!=="+"&&c--,d="";break;default:e("Unknown state");break}}return r===2&&e(`Unfinished custom RegExp for param "${f}"`),g(),a(),s}function createRouteRecordMatcher(n,e,r){const o=tokensToParser(tokenizePath(n.path),r),s=assign(o,{record:n,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function createRouterMatcher(n,e){const r=[],o=new Map;e=mergeOptions({strict:!1,end:!0,sensitive:!1},e);function s(d){return o.get(d)}function l(d,g,m){const v=!m,b=normalizeRouteRecord(d);b.aliasOf=m&&m.record;const k=mergeOptions(e,d),A=[b];if("alias"in d){const J=typeof d.alias=="string"?[d.alias]:d.alias;for(const _ of J)A.push(assign({},b,{components:m?m.record.components:b.components,path:_,aliasOf:m?m.record:b}))}let R,$;for(const J of A){const{path:_}=J;if(g&&_[0]!=="/"){const L=g.record.path,Y=L[L.length-1]==="/"?"":"/";J.path=g.record.path+(_&&Y+_)}if(R=createRouteRecordMatcher(J,g,k),m?m.alias.push(R):($=$||R,$!==R&&$.alias.push(R),v&&d.name&&!isAliasRecord(R)&&a(d.name)),b.children){const L=b.children;for(let Y=0;Y<L.length;Y++)l(L[Y],R,m&&m.children[Y])}m=m||R,(R.record.components&&Object.keys(R.record.components).length||R.record.name||R.record.redirect)&&u(R)}return $?()=>{a($)}:noop}function a(d){if(isRouteName(d)){const g=o.get(d);g&&(o.delete(d),r.splice(r.indexOf(g),1),g.children.forEach(a),g.alias.forEach(a))}else{const g=r.indexOf(d);g>-1&&(r.splice(g,1),d.record.name&&o.delete(d.record.name),d.children.forEach(a),d.alias.forEach(a))}}function c(){return r}function u(d){let g=0;for(;g<r.length&&comparePathParserScore(d,r[g])>=0&&(d.record.path!==r[g].record.path||!isRecordChildOf(d,r[g]));)g++;r.splice(g,0,d),d.record.name&&!isAliasRecord(d)&&o.set(d.record.name,d)}function f(d,g){let m,v={},b,k;if("name"in d&&d.name){if(m=o.get(d.name),!m)throw createRouterError(1,{location:d});k=m.record.name,v=assign(paramsFromLocation(g.params,m.keys.filter($=>!$.optional).map($=>$.name)),d.params&&paramsFromLocation(d.params,m.keys.map($=>$.name))),b=m.stringify(v)}else if("path"in d)b=d.path,m=r.find($=>$.re.test(b)),m&&(v=m.parse(b),k=m.record.name);else{if(m=g.name?o.get(g.name):r.find($=>$.re.test(g.path)),!m)throw createRouterError(1,{location:d,currentLocation:g});k=m.record.name,v=assign({},g.params,d.params),b=m.stringify(v)}const A=[];let R=m;for(;R;)A.unshift(R.record),R=R.parent;return{name:k,path:b,params:v,matched:A,meta:mergeMetaFields(A)}}return n.forEach(d=>l(d)),{addRoute:l,resolve:f,removeRoute:a,getRoutes:c,getRecordMatcher:s}}function paramsFromLocation(n,e){const r={};for(const o of e)o in n&&(r[o]=n[o]);return r}function normalizeRouteRecord(n){return{path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:void 0,beforeEnter:n.beforeEnter,props:normalizeRecordProps(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}}}function normalizeRecordProps(n){const e={},r=n.props||!1;if("component"in n)e.default=r;else for(const o in n.components)e[o]=typeof r=="boolean"?r:r[o];return e}function isAliasRecord(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function mergeMetaFields(n){return n.reduce((e,r)=>assign(e,r.meta),{})}function mergeOptions(n,e){const r={};for(const o in n)r[o]=o in e?e[o]:n[o];return r}function isRecordChildOf(n,e){return e.children.some(r=>r===n||isRecordChildOf(n,r))}const HASH_RE=/#/g,AMPERSAND_RE=/&/g,SLASH_RE=/\//g,EQUAL_RE=/=/g,IM_RE=/\?/g,PLUS_RE=/\+/g,ENC_BRACKET_OPEN_RE=/%5B/g,ENC_BRACKET_CLOSE_RE=/%5D/g,ENC_CARET_RE=/%5E/g,ENC_BACKTICK_RE=/%60/g,ENC_CURLY_OPEN_RE=/%7B/g,ENC_PIPE_RE=/%7C/g,ENC_CURLY_CLOSE_RE=/%7D/g,ENC_SPACE_RE=/%20/g;function commonEncode(n){return encodeURI(""+n).replace(ENC_PIPE_RE,"|").replace(ENC_BRACKET_OPEN_RE,"[").replace(ENC_BRACKET_CLOSE_RE,"]")}function encodeHash(n){return commonEncode(n).replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryValue(n){return commonEncode(n).replace(PLUS_RE,"%2B").replace(ENC_SPACE_RE,"+").replace(HASH_RE,"%23").replace(AMPERSAND_RE,"%26").replace(ENC_BACKTICK_RE,"`").replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryKey(n){return encodeQueryValue(n).replace(EQUAL_RE,"%3D")}function encodePath(n){return commonEncode(n).replace(HASH_RE,"%23").replace(IM_RE,"%3F")}function encodeParam(n){return n==null?"":encodePath(n).replace(SLASH_RE,"%2F")}function decode(n){try{return decodeURIComponent(""+n)}catch{}return""+n}function parseQuery(n){const e={};if(n===""||n==="?")return e;const o=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<o.length;++s){const l=o[s].replace(PLUS_RE," "),a=l.indexOf("="),c=decode(a<0?l:l.slice(0,a)),u=a<0?null:decode(l.slice(a+1));if(c in e){let f=e[c];isArray(f)||(f=e[c]=[f]),f.push(u)}else e[c]=u}return e}function stringifyQuery(n){let e="";for(let r in n){const o=n[r];if(r=encodeQueryKey(r),o==null){o!==void 0&&(e+=(e.length?"&":"")+r);continue}(isArray(o)?o.map(l=>l&&encodeQueryValue(l)):[o&&encodeQueryValue(o)]).forEach(l=>{l!==void 0&&(e+=(e.length?"&":"")+r,l!=null&&(e+="="+l))})}return e}function normalizeQuery(n){const e={};for(const r in n){const o=n[r];o!==void 0&&(e[r]=isArray(o)?o.map(s=>s==null?null:""+s):o==null?o:""+o)}return e}const matchedRouteKey=Symbol(""),viewDepthKey=Symbol(""),routerKey=Symbol(""),routeLocationKey=Symbol(""),routerViewLocationKey=Symbol("");function useCallbacks(){let n=[];function e(o){return n.push(o),()=>{const s=n.indexOf(o);s>-1&&n.splice(s,1)}}function r(){n=[]}return{add:e,list:()=>n,reset:r}}function guardToPromiseFn(n,e,r,o,s){const l=o&&(o.enterCallbacks[s]=o.enterCallbacks[s]||[]);return()=>new Promise((a,c)=>{const u=g=>{g===!1?c(createRouterError(4,{from:r,to:e})):g instanceof Error?c(g):isRouteLocation(g)?c(createRouterError(2,{from:e,to:g})):(l&&o.enterCallbacks[s]===l&&typeof g=="function"&&l.push(g),a())},f=n.call(o&&o.instances[s],e,r,u);let d=Promise.resolve(f);n.length<3&&(d=d.then(u)),d.catch(g=>c(g))})}function extractComponentsGuards(n,e,r,o){const s=[];for(const l of n)for(const a in l.components){let c=l.components[a];if(!(e!=="beforeRouteEnter"&&!l.instances[a]))if(isRouteComponent(c)){const f=(c.__vccOpts||c)[e];f&&s.push(guardToPromiseFn(f,r,o,l,a))}else{let u=c();s.push(()=>u.then(f=>{if(!f)return Promise.reject(new Error(`Couldn't resolve component "${a}" at "${l.path}"`));const d=isESModule(f)?f.default:f;l.components[a]=d;const m=(d.__vccOpts||d)[e];return m&&guardToPromiseFn(m,r,o,l,a)()}))}}return s}function isRouteComponent(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function useLink(n){const e=inject(routerKey),r=inject(routeLocationKey),o=computed(()=>e.resolve(unref(n.to))),s=computed(()=>{const{matched:u}=o.value,{length:f}=u,d=u[f-1],g=r.matched;if(!d||!g.length)return-1;const m=g.findIndex(isSameRouteRecord.bind(null,d));if(m>-1)return m;const v=getOriginalPath(u[f-2]);return f>1&&getOriginalPath(d)===v&&g[g.length-1].path!==v?g.findIndex(isSameRouteRecord.bind(null,u[f-2])):m}),l=computed(()=>s.value>-1&&includesParams(r.params,o.value.params)),a=computed(()=>s.value>-1&&s.value===r.matched.length-1&&isSameRouteLocationParams(r.params,o.value.params));function c(u={}){return guardEvent(u)?e[unref(n.replace)?"replace":"push"](unref(n.to)).catch(noop):Promise.resolve()}return{route:o,href:computed(()=>o.value.href),isActive:l,isExactActive:a,navigate:c}}const RouterLinkImpl=defineComponent({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink,setup(n,{slots:e}){const r=reactive(useLink(n)),{options:o}=inject(routerKey),s=computed(()=>({[getLinkClass(n.activeClass,o.linkActiveClass,"router-link-active")]:r.isActive,[getLinkClass(n.exactActiveClass,o.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const l=e.default&&e.default(r);return n.custom?l:h$1("a",{"aria-current":r.isExactActive?n.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:s.value},l)}}}),RouterLink=RouterLinkImpl;function guardEvent(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function includesParams(n,e){for(const r in e){const o=e[r],s=n[r];if(typeof o=="string"){if(o!==s)return!1}else if(!isArray(s)||s.length!==o.length||o.some((l,a)=>l!==s[a]))return!1}return!0}function getOriginalPath(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const getLinkClass=(n,e,r)=>n??e??r,RouterViewImpl=defineComponent({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:r}){const o=inject(routerViewLocationKey),s=computed(()=>n.route||o.value),l=inject(viewDepthKey,0),a=computed(()=>{let f=unref(l);const{matched:d}=s.value;let g;for(;(g=d[f])&&!g.components;)f++;return f}),c=computed(()=>s.value.matched[a.value]);provide(viewDepthKey,computed(()=>a.value+1)),provide(matchedRouteKey,c),provide(routerViewLocationKey,s);const u=ref();return watch(()=>[u.value,c.value,n.name],([f,d,g],[m,v,b])=>{d&&(d.instances[g]=f,v&&v!==d&&f&&f===m&&(d.leaveGuards.size||(d.leaveGuards=v.leaveGuards),d.updateGuards.size||(d.updateGuards=v.updateGuards))),f&&d&&(!v||!isSameRouteRecord(d,v)||!m)&&(d.enterCallbacks[g]||[]).forEach(k=>k(f))},{flush:"post"}),()=>{const f=s.value,d=n.name,g=c.value,m=g&&g.components[d];if(!m)return normalizeSlot(r.default,{Component:m,route:f});const v=g.props[d],b=v?v===!0?f.params:typeof v=="function"?v(f):v:null,A=h$1(m,assign({},b,e,{onVnodeUnmounted:R=>{R.component.isUnmounted&&(g.instances[d]=null)},ref:u}));return normalizeSlot(r.default,{Component:A,route:f})||A}}});function normalizeSlot(n,e){if(!n)return null;const r=n(e);return r.length===1?r[0]:r}const RouterView=RouterViewImpl;function createRouter(n){const e=createRouterMatcher(n.routes,n),r=n.parseQuery||parseQuery,o=n.stringifyQuery||stringifyQuery,s=n.history,l=useCallbacks(),a=useCallbacks(),c=useCallbacks(),u=shallowRef(START_LOCATION_NORMALIZED);let f=START_LOCATION_NORMALIZED;isBrowser&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=applyToParams.bind(null,re=>""+re),g=applyToParams.bind(null,encodeParam),m=applyToParams.bind(null,decode);function v(re,ee){let N,H;return isRouteName(re)?(N=e.getRecordMatcher(re),H=ee):H=re,e.addRoute(H,N)}function b(re){const ee=e.getRecordMatcher(re);ee&&e.removeRoute(ee)}function k(){return e.getRoutes().map(re=>re.record)}function A(re){return!!e.getRecordMatcher(re)}function R(re,ee){if(ee=assign({},ee||u.value),typeof re=="string"){const E=parseURL(r,re,ee.path),M=e.resolve({path:E.path},ee),q=s.createHref(E.fullPath);return assign(E,M,{params:m(M.params),hash:decode(E.hash),redirectedFrom:void 0,href:q})}let N;if("path"in re)N=assign({},re,{path:parseURL(r,re.path,ee.path).path});else{const E=assign({},re.params);for(const M in E)E[M]==null&&delete E[M];N=assign({},re,{params:g(re.params)}),ee.params=g(ee.params)}const H=e.resolve(N,ee),ae=re.hash||"";H.params=d(m(H.params));const Ce=stringifyURL(o,assign({},re,{hash:encodeHash(ae),path:H.path})),ye=s.createHref(Ce);return assign({fullPath:Ce,hash:ae,query:o===stringifyQuery?normalizeQuery(re.query):re.query||{}},H,{redirectedFrom:void 0,href:ye})}function $(re){return typeof re=="string"?parseURL(r,re,u.value.path):assign({},re)}function J(re,ee){if(f!==re)return createRouterError(8,{from:ee,to:re})}function _(re){return I(re)}function L(re){return _(assign($(re),{replace:!0}))}function Y(re){const ee=re.matched[re.matched.length-1];if(ee&&ee.redirect){const{redirect:N}=ee;let H=typeof N=="function"?N(re):N;return typeof H=="string"&&(H=H.includes("?")||H.includes("#")?H=$(H):{path:H},H.params={}),assign({query:re.query,hash:re.hash,params:"path"in H?{}:re.params},H)}}function I(re,ee){const N=f=R(re),H=u.value,ae=re.state,Ce=re.force,ye=re.replace===!0,E=Y(N);if(E)return I(assign($(E),{state:typeof E=="object"?assign({},ae,E.state):ae,force:Ce,replace:ye}),ee||N);const M=N;M.redirectedFrom=ee;let q;return!Ce&&isSameRouteLocation(o,H,N)&&(q=createRouterError(16,{to:M,from:H}),fe(H,H,!0,!1)),(q?Promise.resolve(q):oe(M,H)).catch(te=>isNavigationFailure(te)?isNavigationFailure(te,2)?te:Ve(te):le(te,M,H)).then(te=>{if(te){if(isNavigationFailure(te,2))return I(assign({replace:ye},$(te.to),{state:typeof te.to=="object"?assign({},ae,te.to.state):ae,force:Ce}),ee||M)}else te=Z(M,H,!0,ye,ae);return G(M,H,te),te})}function Le(re,ee){const N=J(re,ee);return N?Promise.reject(N):Promise.resolve()}function oe(re,ee){let N;const[H,ae,Ce]=extractChangingRecords(re,ee);N=extractComponentsGuards(H.reverse(),"beforeRouteLeave",re,ee);for(const E of H)E.leaveGuards.forEach(M=>{N.push(guardToPromiseFn(M,re,ee))});const ye=Le.bind(null,re,ee);return N.push(ye),runGuardQueue(N).then(()=>{N=[];for(const E of l.list())N.push(guardToPromiseFn(E,re,ee));return N.push(ye),runGuardQueue(N)}).then(()=>{N=extractComponentsGuards(ae,"beforeRouteUpdate",re,ee);for(const E of ae)E.updateGuards.forEach(M=>{N.push(guardToPromiseFn(M,re,ee))});return N.push(ye),runGuardQueue(N)}).then(()=>{N=[];for(const E of re.matched)if(E.beforeEnter&&!ee.matched.includes(E))if(isArray(E.beforeEnter))for(const M of E.beforeEnter)N.push(guardToPromiseFn(M,re,ee));else N.push(guardToPromiseFn(E.beforeEnter,re,ee));return N.push(ye),runGuardQueue(N)}).then(()=>(re.matched.forEach(E=>E.enterCallbacks={}),N=extractComponentsGuards(Ce,"beforeRouteEnter",re,ee),N.push(ye),runGuardQueue(N))).then(()=>{N=[];for(const E of a.list())N.push(guardToPromiseFn(E,re,ee));return N.push(ye),runGuardQueue(N)}).catch(E=>isNavigationFailure(E,8)?E:Promise.reject(E))}function G(re,ee,N){for(const H of c.list())H(re,ee,N)}function Z(re,ee,N,H,ae){const Ce=J(re,ee);if(Ce)return Ce;const ye=ee===START_LOCATION_NORMALIZED,E=isBrowser?history.state:{};N&&(H||ye?s.replace(re.fullPath,assign({scroll:ye&&E&&E.scroll},ae)):s.push(re.fullPath,ae)),u.value=re,fe(re,ee,N,ye),Ve()}let Ee;function We(){Ee||(Ee=s.listen((re,ee,N)=>{if(!st.listening)return;const H=R(re),ae=Y(H);if(ae){I(assign(ae,{replace:!0}),H).catch(noop);return}f=H;const Ce=u.value;isBrowser&&saveScrollPosition(getScrollKey(Ce.fullPath,N.delta),computeScrollPosition()),oe(H,Ce).catch(ye=>isNavigationFailure(ye,12)?ye:isNavigationFailure(ye,2)?(I(ye.to,H).then(E=>{isNavigationFailure(E,20)&&!N.delta&&N.type===NavigationType.pop&&s.go(-1,!1)}).catch(noop),Promise.reject()):(N.delta&&s.go(-N.delta,!1),le(ye,H,Ce))).then(ye=>{ye=ye||Z(H,Ce,!1),ye&&(N.delta&&!isNavigationFailure(ye,8)?s.go(-N.delta,!1):N.type===NavigationType.pop&&isNavigationFailure(ye,20)&&s.go(-1,!1)),G(H,Ce,ye)}).catch(noop)}))}let K=useCallbacks(),ge=useCallbacks(),ne;function le(re,ee,N){Ve(re);const H=ge.list();return H.length?H.forEach(ae=>ae(re,ee,N)):console.error(re),Promise.reject(re)}function Ae(){return ne&&u.value!==START_LOCATION_NORMALIZED?Promise.resolve():new Promise((re,ee)=>{K.add([re,ee])})}function Ve(re){return ne||(ne=!re,We(),K.list().forEach(([ee,N])=>re?N(re):ee()),K.reset()),re}function fe(re,ee,N,H){const{scrollBehavior:ae}=n;if(!isBrowser||!ae)return Promise.resolve();const Ce=!N&&getSavedScrollPosition(getScrollKey(re.fullPath,0))||(H||!N)&&history.state&&history.state.scroll||null;return nextTick().then(()=>ae(re,ee,Ce)).then(ye=>ye&&scrollToPosition(ye)).catch(ye=>le(ye,re,ee))}const Ze=re=>s.go(re);let _e;const ut=new Set,st={currentRoute:u,listening:!0,addRoute:v,removeRoute:b,hasRoute:A,getRoutes:k,resolve:R,options:n,push:_,replace:L,go:Ze,back:()=>Ze(-1),forward:()=>Ze(1),beforeEach:l.add,beforeResolve:a.add,afterEach:c.add,onError:ge.add,isReady:Ae,install(re){const ee=this;re.component("RouterLink",RouterLink),re.component("RouterView",RouterView),re.config.globalProperties.$router=ee,Object.defineProperty(re.config.globalProperties,"$route",{enumerable:!0,get:()=>unref(u)}),isBrowser&&!_e&&u.value===START_LOCATION_NORMALIZED&&(_e=!0,_(s.location).catch(ae=>{}));const N={};for(const ae in START_LOCATION_NORMALIZED)N[ae]=computed(()=>u.value[ae]);re.provide(routerKey,ee),re.provide(routeLocationKey,reactive(N)),re.provide(routerViewLocationKey,u);const H=re.unmount;ut.add(re),re.unmount=function(){ut.delete(re),ut.size<1&&(f=START_LOCATION_NORMALIZED,Ee&&Ee(),Ee=null,u.value=START_LOCATION_NORMALIZED,_e=!1,ne=!1),H()}}};return st}function runGuardQueue(n){return n.reduce((e,r)=>e.then(()=>r()),Promise.resolve())}function extractChangingRecords(n,e){const r=[],o=[],s=[],l=Math.max(e.matched.length,n.matched.length);for(let a=0;a<l;a++){const c=e.matched[a];c&&(n.matched.find(f=>isSameRouteRecord(f,c))?o.push(c):r.push(c));const u=n.matched[a];u&&(e.matched.find(f=>isSameRouteRecord(f,u))||s.push(u))}return[r,o,s]}const _sfc_main$3={__name:"App",setup(n){return(e,r)=>(openBlock(),createBlock(unref(RouterView)))}};class Stack{constructor(e,r,o,s,l,a,c,u,f,d=0,g){this.p=e,this.stack=r,this.state=o,this.reducePos=s,this.pos=l,this.score=a,this.buffer=c,this.bufferBase=u,this.curContext=f,this.lookAhead=d,this.parent=g}toString(){return`[${this.stack.filter((e,r)=>r%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,r,o=0){let s=e.parser.context;return new Stack(e,[],r,o,o,0,[],0,s?new StackContext(s,s.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,r){this.stack.push(this.state,r,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var r;let o=e>>19,s=e&65535,{parser:l}=this.p,a=l.dynamicPrecedence(s);if(a&&(this.score+=a),o==0){this.pushState(l.getGoto(this.state,s,!0),this.reducePos),s<l.minRepeatTerm&&this.storeNode(s,this.reducePos,this.reducePos,4,!0),this.reduceContext(s,this.reducePos);return}let c=this.stack.length-(o-1)*3-(e&262144?6:0),u=c?this.stack[c-2]:this.p.ranges[0].from,f=this.reducePos-u;f>=2e3&&!(!((r=this.p.parser.nodeSet.types[s])===null||r===void 0)&&r.isAnonymous)&&(u==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=f):this.p.lastBigReductionSize<f&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=u,this.p.lastBigReductionSize=f));let d=c?this.stack[c-1]:0,g=this.bufferBase+this.buffer.length-d;if(s<l.minRepeatTerm||e&131072){let m=l.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(s,u,m,g+4,!0)}if(e&262144)this.state=this.stack[c];else{let m=this.stack[c-3];this.state=l.getGoto(m,s,!0)}for(;this.stack.length>c;)this.stack.pop();this.reduceContext(s,u)}storeNode(e,r,o,s=4,l=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let a=this,c=this.buffer.length;if(c==0&&a.parent&&(c=a.bufferBase-a.parent.bufferBase,a=a.parent),c>0&&a.buffer[c-4]==0&&a.buffer[c-1]>-1){if(r==o)return;if(a.buffer[c-2]>=r){a.buffer[c-2]=o;return}}}if(!l||this.pos==o)this.buffer.push(e,r,o,s);else{let a=this.buffer.length;if(a>0&&this.buffer[a-4]!=0)for(;a>0&&this.buffer[a-2]>o;)this.buffer[a]=this.buffer[a-4],this.buffer[a+1]=this.buffer[a-3],this.buffer[a+2]=this.buffer[a-2],this.buffer[a+3]=this.buffer[a-1],a-=4,s>4&&(s-=4);this.buffer[a]=e,this.buffer[a+1]=r,this.buffer[a+2]=o,this.buffer[a+3]=s}}shift(e,r,o){let s=this.pos;if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=o,this.shiftContext(r,s),r<=this.p.parser.maxNode&&this.buffer.push(r,s,o,4);else{let l=e,{parser:a}=this.p;(o>this.pos||r<=a.maxNode)&&(this.pos=o,a.stateFlag(l,1)||(this.reducePos=o)),this.pushState(l,s),this.shiftContext(r,s),r<=a.maxNode&&this.buffer.push(r,s,o,4)}}apply(e,r,o){e&65536?this.reduce(e):this.shift(e,r,o)}useNode(e,r){let o=this.p.reused.length-1;(o<0||this.p.reused[o]!=e)&&(this.p.reused.push(e),o++);let s=this.pos;this.reducePos=this.pos=s+e.length,this.pushState(r,s),this.buffer.push(o,s,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,r=e.buffer.length;for(;r>0&&e.buffer[r-2]>e.reducePos;)r-=4;let o=e.buffer.slice(r),s=e.bufferBase+r;for(;e&&s==e.bufferBase;)e=e.parent;return new Stack(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,o,s,this.curContext,this.lookAhead,e)}recoverByDelete(e,r){let o=e<=this.p.parser.maxNode;o&&this.storeNode(e,this.pos,r,4),this.storeNode(0,this.pos,r,o?8:4),this.pos=this.reducePos=r,this.score-=190}canShift(e){for(let r=new SimulatedStack(this);;){let o=this.p.parser.stateSlot(r.state,4)||this.p.parser.hasAction(r.state,e);if(o==0)return!1;if(!(o&65536))return!0;r.reduce(o)}}recoverByInsert(e){if(this.stack.length>=300)return[];let r=this.p.parser.nextStates(this.state);if(r.length>4<<1||this.stack.length>=120){let s=[];for(let l=0,a;l<r.length;l+=2)(a=r[l+1])!=this.state&&this.p.parser.hasAction(a,e)&&s.push(r[l],a);if(this.stack.length<120)for(let l=0;s.length<4<<1&&l<r.length;l+=2){let a=r[l+1];s.some((c,u)=>u&1&&c==a)||s.push(r[l],a)}r=s}let o=[];for(let s=0;s<r.length&&o.length<4;s+=2){let l=r[s+1];if(l==this.state)continue;let a=this.split();a.pushState(l,this.pos),a.storeNode(0,a.pos,a.pos,4,!0),a.shiftContext(r[s],this.pos),a.score-=200,o.push(a)}return o}forceReduce(){let e=this.p.parser.stateSlot(this.state,5);if(!(e&65536))return!1;let{parser:r}=this.p;if(!r.validAction(this.state,e)){let o=e>>19,s=e&65535,l=this.stack.length-o*3;if(l<0||r.getGoto(this.stack[l],s,!1)<0)return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let r=0;r<this.stack.length;r+=3)if(this.stack[r]!=e.stack[r])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,r){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(r)))}reduceContext(e,r){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(r)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4)}updateContext(e){if(e!=this.curContext.context){let r=new StackContext(this.curContext.tracker,e);r.hash!=this.curContext.hash&&this.emitContext(),this.curContext=r}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class StackContext{constructor(e,r){this.tracker=e,this.context=r,this.hash=e.strict?e.hash(r):0}}var Recover;(function(n){n[n.Insert=200]="Insert",n[n.Delete=190]="Delete",n[n.Reduce=100]="Reduce",n[n.MaxNext=4]="MaxNext",n[n.MaxInsertStackDepth=300]="MaxInsertStackDepth",n[n.DampenInsertStackDepth=120]="DampenInsertStackDepth",n[n.MinBigReduction=2e3]="MinBigReduction"})(Recover||(Recover={}));class SimulatedStack{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let r=e&65535,o=e>>19;o==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(o-1)*3;let s=this.start.p.parser.getGoto(this.stack[this.base-3],r,!0);this.state=s}}class StackBufferCursor{constructor(e,r,o){this.stack=e,this.pos=r,this.index=o,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,r=e.bufferBase+e.buffer.length){return new StackBufferCursor(e,r,r-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new StackBufferCursor(this.stack,this.pos,this.index)}}function decodeArray(n,e=Uint16Array){if(typeof n!="string")return n;let r=null;for(let o=0,s=0;o<n.length;){let l=0;for(;;){let a=n.charCodeAt(o++),c=!1;if(a==126){l=65535;break}a>=92&&a--,a>=34&&a--;let u=a-32;if(u>=46&&(u-=46,c=!0),l+=u,c)break;l*=46}r?r[s++]=l:r=new e(l)}return r}class CachedToken{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const nullToken=new CachedToken;class InputStream{constructor(e,r){this.input=e,this.ranges=r,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=nullToken,this.rangeIndex=0,this.pos=this.chunkPos=r[0].from,this.range=r[0],this.end=r[r.length-1].to,this.readNext()}resolveOffset(e,r){let o=this.range,s=this.rangeIndex,l=this.pos+e;for(;l<o.from;){if(!s)return null;let a=this.ranges[--s];l-=o.from-a.to,o=a}for(;r<0?l>o.to:l>=o.to;){if(s==this.ranges.length-1)return null;let a=this.ranges[++s];l+=a.from-o.to,o=a}return l}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let r of this.ranges)if(r.to>e)return Math.max(e,r.from);return this.end}peek(e){let r=this.chunkOff+e,o,s;if(r>=0&&r<this.chunk.length)o=this.pos+e,s=this.chunk.charCodeAt(r);else{let l=this.resolveOffset(e,1);if(l==null)return-1;if(o=l,o>=this.chunk2Pos&&o<this.chunk2Pos+this.chunk2.length)s=this.chunk2.charCodeAt(o-this.chunk2Pos);else{let a=this.rangeIndex,c=this.range;for(;c.to<=o;)c=this.ranges[++a];this.chunk2=this.input.chunk(this.chunk2Pos=o),o+this.chunk2.length>c.to&&(this.chunk2=this.chunk2.slice(0,c.to-o)),s=this.chunk2.charCodeAt(0)}}return o>=this.token.lookAhead&&(this.token.lookAhead=o+1),s}acceptToken(e,r=0){let o=r?this.resolveOffset(r,-1):this.pos;if(o==null||o<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=o}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:r}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=r,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),r=this.pos+e.length;this.chunk=r>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,r){if(r?(this.token=r,r.start=e,r.lookAhead=e+1,r.value=r.extended=-1):this.token=nullToken,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,r){if(e>=this.chunkPos&&r<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,r-this.chunkPos);if(e>=this.chunk2Pos&&r<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,r-this.chunk2Pos);if(e>=this.range.from&&r<=this.range.to)return this.input.read(e,r);let o="";for(let s of this.ranges){if(s.from>=r)break;s.to>e&&(o+=this.input.read(Math.max(s.from,e),Math.min(s.to,r)))}return o}}class TokenGroup{constructor(e,r){this.data=e,this.id=r}token(e,r){let{parser:o}=r.p;readToken(this.data,e,r,this.id,o.data,o.tokenPrecTable)}}TokenGroup.prototype.contextual=TokenGroup.prototype.fallback=TokenGroup.prototype.extend=!1;TokenGroup.prototype.fallback=TokenGroup.prototype.extend=!1;function readToken(n,e,r,o,s,l){let a=0,c=1<<o,{dialect:u}=r.p.parser;e:for(;c&n[a];){let f=n[a+1];for(let v=a+3;v<f;v+=2)if((n[v+1]&c)>0){let b=n[v];if(u.allows(b)&&(e.token.value==-1||e.token.value==b||overrides(b,e.token.value,s,l))){e.acceptToken(b);break}}let d=e.next,g=0,m=n[a+2];if(e.next<0&&m>g&&n[f+m*3-3]==65535&&n[f+m*3-3]==65535){a=n[f+m*3-1];continue e}for(;g<m;){let v=g+m>>1,b=f+v+(v<<1),k=n[b],A=n[b+1]||65536;if(d<k)m=v;else if(d>=A)g=v+1;else{a=n[b+2],e.advance();continue e}}break}}function findOffset(n,e,r){for(let o=e,s;(s=n[o])!=65535;o++)if(s==r)return o-e;return-1}function overrides(n,e,r,o){let s=findOffset(r,o,e);return s<0||findOffset(r,o,n)<s}const verbose=typeof process<"u"&&process.env&&/\bparse\b/.test({}.LOG);let stackIDs=null;var Safety;(function(n){n[n.Margin=25]="Margin"})(Safety||(Safety={}));function cutAt(n,e,r){let o=n.cursor(IterMode.IncludeAnonymous);for(o.moveTo(e);;)if(!(r<0?o.childBefore(e):o.childAfter(e)))for(;;){if((r<0?o.to<e:o.from>e)&&!o.type.isError)return r<0?Math.max(0,Math.min(o.to-1,e-25)):Math.min(n.length,Math.max(o.from+1,e+25));if(r<0?o.prevSibling():o.nextSibling())break;if(!o.parent())return r<0?0:n.length}}class FragmentCursor{constructor(e,r){this.fragments=e,this.nodeSet=r,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?cutAt(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?cutAt(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let r=this.trees.length-1;if(r<0)return this.nextFragment(),null;let o=this.trees[r],s=this.index[r];if(s==o.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let l=o.children[s],a=this.start[r]+o.positions[s];if(a>e)return this.nextStart=a,null;if(l instanceof Tree){if(a==e){if(a<this.safeFrom)return null;let c=a+l.length;if(c<=this.safeTo){let u=l.prop(NodeProp.lookAhead);if(!u||c+u<this.fragment.to)return l}}this.index[r]++,a+l.length>=Math.max(this.safeFrom,e)&&(this.trees.push(l),this.start.push(a),this.index.push(0))}else this.index[r]++,this.nextStart=a+l.length}}}class TokenCache{constructor(e,r){this.stream=r,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(o=>new CachedToken)}getActions(e){let r=0,o=null,{parser:s}=e.p,{tokenizers:l}=s,a=s.stateSlot(e.state,3),c=e.curContext?e.curContext.hash:0,u=0;for(let f=0;f<l.length;f++){if(!(1<<f&a))continue;let d=l[f],g=this.tokens[f];if(!(o&&!d.fallback)&&((d.contextual||g.start!=e.pos||g.mask!=a||g.context!=c)&&(this.updateCachedToken(g,d,e),g.mask=a,g.context=c),g.lookAhead>g.end+25&&(u=Math.max(g.lookAhead,u)),g.value!=0)){let m=r;if(g.extended>-1&&(r=this.addActions(e,g.extended,g.end,r)),r=this.addActions(e,g.value,g.end,r),!d.extend&&(o=g,r>m))break}}for(;this.actions.length>r;)this.actions.pop();return u&&e.setLookAhead(u),!o&&e.pos==this.stream.end&&(o=new CachedToken,o.value=e.p.parser.eofTerm,o.start=o.end=e.pos,r=this.addActions(e,o.value,o.end,r)),this.mainToken=o,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let r=new CachedToken,{pos:o,p:s}=e;return r.start=o,r.end=Math.min(o+1,s.stream.end),r.value=o==s.stream.end?s.parser.eofTerm:0,r}updateCachedToken(e,r,o){let s=this.stream.clipPos(o.pos);if(r.token(this.stream.reset(s,e),o),e.value>-1){let{parser:l}=o.p;for(let a=0;a<l.specialized.length;a++)if(l.specialized[a]==e.value){let c=l.specializers[a](this.stream.read(e.start,e.end),o);if(c>=0&&o.p.parser.dialect.allows(c>>1)){c&1?e.extended=c>>1:e.value=c>>1;break}}}else e.value=0,e.end=this.stream.clipPos(s+1)}putAction(e,r,o,s){for(let l=0;l<s;l+=3)if(this.actions[l]==e)return s;return this.actions[s++]=e,this.actions[s++]=r,this.actions[s++]=o,s}addActions(e,r,o,s){let{state:l}=e,{parser:a}=e.p,{data:c}=a;for(let u=0;u<2;u++)for(let f=a.stateSlot(l,u?2:1);;f+=3){if(c[f]==65535)if(c[f+1]==1)f=pair(c,f+2);else{s==0&&c[f+1]==2&&(s=this.putAction(pair(c,f+2),r,o,s));break}c[f]==r&&(s=this.putAction(pair(c,f+1),r,o,s))}return s}}var Rec;(function(n){n[n.Distance=5]="Distance",n[n.MaxRemainingPerStep=3]="MaxRemainingPerStep",n[n.MinBufferLengthPrune=500]="MinBufferLengthPrune",n[n.ForceReduceLimit=10]="ForceReduceLimit",n[n.CutDepth=15e3]="CutDepth",n[n.CutTo=9e3]="CutTo",n[n.MaxLeftAssociativeReductionCount=300]="MaxLeftAssociativeReductionCount",n[n.MaxStackCount=12]="MaxStackCount"})(Rec||(Rec={}));class Parse{constructor(e,r,o,s){this.parser=e,this.input=r,this.ranges=s,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new InputStream(r,s),this.tokens=new TokenCache(e,this.stream),this.topTerm=e.top[1];let{from:l}=s[0];this.stacks=[Stack.start(this,e.top[0],l)],this.fragments=o.length&&this.stream.end-l>e.bufferLength*4?new FragmentCursor(o,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,r=this.minStackPos,o=this.stacks=[],s,l;if(this.bigReductionCount>300&&e.length==1){let[a]=e;for(;a.forceReduce()&&a.stack.length&&a.stack[a.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let a=0;a<e.length;a++){let c=e[a];for(;;){if(this.tokens.mainToken=null,c.pos>r)o.push(c);else{if(this.advanceStack(c,o,e))continue;{s||(s=[],l=[]),s.push(c);let u=this.tokens.getMainToken(c);l.push(u.value,u.end)}}break}}if(!o.length){let a=s&&findFinished(s);if(a)return this.stackToTree(a);if(this.parser.strict)throw verbose&&s&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+r);this.recovering||(this.recovering=5)}if(this.recovering&&s){let a=this.stoppedAt!=null&&s[0].pos>this.stoppedAt?s[0]:this.runRecovery(s,l,o);if(a)return this.stackToTree(a.forceAll())}if(this.recovering){let a=this.recovering==1?1:this.recovering*3;if(o.length>a)for(o.sort((c,u)=>u.score-c.score);o.length>a;)o.pop();o.some(c=>c.reducePos>r)&&this.recovering--}else if(o.length>1){e:for(let a=0;a<o.length-1;a++){let c=o[a];for(let u=a+1;u<o.length;u++){let f=o[u];if(c.sameState(f)||c.buffer.length>500&&f.buffer.length>500)if((c.score-f.score||c.buffer.length-f.buffer.length)>0)o.splice(u--,1);else{o.splice(a--,1);continue e}}}o.length>12&&o.splice(12,o.length-12)}this.minStackPos=o[0].pos;for(let a=1;a<o.length;a++)o[a].pos<this.minStackPos&&(this.minStackPos=o[a].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,r,o){let s=e.pos,{parser:l}=this,a=verbose?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&s>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let f=e.curContext&&e.curContext.tracker.strict,d=f?e.curContext.hash:0;for(let g=this.fragments.nodeAt(s);g;){let m=this.parser.nodeSet.types[g.type.id]==g.type?l.getGoto(e.state,g.type.id):-1;if(m>-1&&g.length&&(!f||(g.prop(NodeProp.contextHash)||0)==d))return e.useNode(g,m),verbose&&console.log(a+this.stackID(e)+` (via reuse of ${l.getName(g.type.id)})`),!0;if(!(g instanceof Tree)||g.children.length==0||g.positions[0]>0)break;let v=g.children[0];if(v instanceof Tree&&g.positions[0]==0)g=v;else break}}let c=l.stateSlot(e.state,4);if(c>0)return e.reduce(c),verbose&&console.log(a+this.stackID(e)+` (via always-reduce ${l.getName(c&65535)})`),!0;if(e.stack.length>=15e3)for(;e.stack.length>9e3&&e.forceReduce(););let u=this.tokens.getActions(e);for(let f=0;f<u.length;){let d=u[f++],g=u[f++],m=u[f++],v=f==u.length||!o,b=v?e:e.split();if(b.apply(d,g,m),verbose&&console.log(a+this.stackID(b)+` (via ${d&65536?`reduce of ${l.getName(d&65535)}`:"shift"} for ${l.getName(g)} @ ${s}${b==e?"":", split"})`),v)return!0;b.pos>s?r.push(b):o.push(b)}return!1}advanceFully(e,r){let o=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>o)return pushStackDedup(e,r),!0}}runRecovery(e,r,o){let s=null,l=!1;for(let a=0;a<e.length;a++){let c=e[a],u=r[a<<1],f=r[(a<<1)+1],d=verbose?this.stackID(c)+" -> ":"";if(c.deadEnd&&(l||(l=!0,c.restart(),verbose&&console.log(d+this.stackID(c)+" (restarted)"),this.advanceFully(c,o))))continue;let g=c.split(),m=d;for(let v=0;g.forceReduce()&&v<10&&(verbose&&console.log(m+this.stackID(g)+" (via force-reduce)"),!this.advanceFully(g,o));v++)verbose&&(m=this.stackID(g)+" -> ");for(let v of c.recoverByInsert(u))verbose&&console.log(d+this.stackID(v)+" (via recover-insert)"),this.advanceFully(v,o);this.stream.end>c.pos?(f==c.pos&&(f++,u=0),c.recoverByDelete(u,f),verbose&&console.log(d+this.stackID(c)+` (via recover-delete ${this.parser.getName(u)})`),pushStackDedup(c,o)):(!s||s.score<c.score)&&(s=c)}return s}stackToTree(e){return e.close(),Tree.build({buffer:StackBufferCursor.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let r=(stackIDs||(stackIDs=new WeakMap)).get(e);return r||stackIDs.set(e,r=String.fromCodePoint(this.nextStackID++)),r+e}}function pushStackDedup(n,e){for(let r=0;r<e.length;r++){let o=e[r];if(o.pos==n.pos&&o.sameState(n)){e[r].score<n.score&&(e[r]=n);return}}e.push(n)}class Dialect{constructor(e,r,o){this.source=e,this.flags=r,this.disabled=o}allows(e){return!this.disabled||this.disabled[e]==0}}class LRParser extends Parser{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let r=e.nodeNames.split(" ");this.minRepeatTerm=r.length;for(let c=0;c<e.repeatNodeCount;c++)r.push("");let o=Object.keys(e.topRules).map(c=>e.topRules[c][1]),s=[];for(let c=0;c<r.length;c++)s.push([]);function l(c,u,f){s[c].push([u,u.deserialize(String(f))])}if(e.nodeProps)for(let c of e.nodeProps){let u=c[0];typeof u=="string"&&(u=NodeProp[u]);for(let f=1;f<c.length;){let d=c[f++];if(d>=0)l(d,u,c[f++]);else{let g=c[f+-d];for(let m=-d;m>0;m--)l(c[f++],u,g);f++}}}this.nodeSet=new NodeSet(r.map((c,u)=>NodeType.define({name:u>=this.minRepeatTerm?void 0:c,id:u,props:s[u],top:o.indexOf(u)>-1,error:u==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(u)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=DefaultBufferLength;let a=decodeArray(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let c=0;c<this.specializerSpecs.length;c++)this.specialized[c]=this.specializerSpecs[c].term;this.specializers=this.specializerSpecs.map(getSpecializer),this.states=decodeArray(e.states,Uint32Array),this.data=decodeArray(e.stateData),this.goto=decodeArray(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(c=>typeof c=="number"?new TokenGroup(a,c):c),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,r,o){let s=new Parse(this,e,r,o);for(let l of this.wrappers)s=l(s,e,r,o);return s}getGoto(e,r,o=!1){let s=this.goto;if(r>=s[0])return-1;for(let l=s[r+1];;){let a=s[l++],c=a&1,u=s[l++];if(c&&o)return u;for(let f=l+(a>>1);l<f;l++)if(s[l]==e)return u;if(c)return-1}}hasAction(e,r){let o=this.data;for(let s=0;s<2;s++)for(let l=this.stateSlot(e,s?2:1),a;;l+=3){if((a=o[l])==65535)if(o[l+1]==1)a=o[l=pair(o,l+2)];else{if(o[l+1]==2)return pair(o,l+2);break}if(a==r||a==0)return pair(o,l+1)}return 0}stateSlot(e,r){return this.states[e*6+r]}stateFlag(e,r){return(this.stateSlot(e,0)&r)>0}validAction(e,r){if(r==this.stateSlot(e,4))return!0;for(let o=this.stateSlot(e,1);;o+=3){if(this.data[o]==65535)if(this.data[o+1]==1)o=pair(this.data,o+2);else return!1;if(r==pair(this.data,o+1))return!0}}nextStates(e){let r=[];for(let o=this.stateSlot(e,1);;o+=3){if(this.data[o]==65535)if(this.data[o+1]==1)o=pair(this.data,o+2);else break;if(!(this.data[o+2]&1)){let s=this.data[o+1];r.some((l,a)=>a&1&&l==s)||r.push(this.data[o],s)}}return r}configure(e){let r=Object.assign(Object.create(LRParser.prototype),this);if(e.props&&(r.nodeSet=this.nodeSet.extend(...e.props)),e.top){let o=this.topRules[e.top];if(!o)throw new RangeError(`Invalid top rule name ${e.top}`);r.top=o}return e.tokenizers&&(r.tokenizers=this.tokenizers.map(o=>{let s=e.tokenizers.find(l=>l.from==o);return s?s.to:o})),e.specializers&&(r.specializers=this.specializers.slice(),r.specializerSpecs=this.specializerSpecs.map((o,s)=>{let l=e.specializers.find(c=>c.from==o.external);if(!l)return o;let a=Object.assign(Object.assign({},o),{external:l.to});return r.specializers[s]=getSpecializer(a),a})),e.contextTracker&&(r.context=e.contextTracker),e.dialect&&(r.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(r.strict=e.strict),e.wrap&&(r.wrappers=r.wrappers.concat(e.wrap)),e.bufferLength!=null&&(r.bufferLength=e.bufferLength),r}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let r=this.dynamicPrecedences;return r==null?0:r[e]||0}parseDialect(e){let r=Object.keys(this.dialects),o=r.map(()=>!1);if(e)for(let l of e.split(" ")){let a=r.indexOf(l);a>=0&&(o[a]=!0)}let s=null;for(let l=0;l<r.length;l++)if(!o[l])for(let a=this.dialects[r[l]],c;(c=this.data[a++])!=65535;)(s||(s=new Uint8Array(this.maxTerm+1)))[c]=1;return new Dialect(e,o,s)}static deserialize(e){return new LRParser(e)}}function pair(n,e){return n[e]|n[e+1]<<16}function findFinished(n){let e=null;for(let r of n){let o=r.p.stoppedAt;(r.pos==r.p.stream.end||o!=null&&r.pos>o)&&r.p.parser.stateFlag(r.state,2)&&(!e||e.score<r.score)&&(e=r)}return e}function getSpecializer(n){if(n.external){let e=n.extend?1:0;return(r,o)=>n.external(r,o)<<1|e}return n.get}const jsonHighlighting=styleTags({String:tags.string,Number:tags.number,"True False":tags.bool,PropertyName:tags.propertyName,Null:tags.null,",":tags.separator,"[ ]":tags.squareBracket,"{ }":tags.brace}),parser=LRParser.deserialize({version:14,states:"$bOVQPOOOOQO'#Cb'#CbOnQPO'#CeOvQPO'#CjOOQO'#Cp'#CpQOQPOOOOQO'#Cg'#CgO}QPO'#CfO!SQPO'#CrOOQO,59P,59PO![QPO,59PO!aQPO'#CuOOQO,59U,59UO!iQPO,59UOVQPO,59QOqQPO'#CkO!nQPO,59^OOQO1G.k1G.kOVQPO'#ClO!vQPO,59aOOQO1G.p1G.pOOQO1G.l1G.lOOQO,59V,59VOOQO-E6i-E6iOOQO,59W,59WOOQO-E6j-E6j",stateData:"#O~OcOS~OQSORSOSSOTSOWQO]ROePO~OVXOeUO~O[[O~PVOg^O~Oh_OVfX~OVaO~OhbO[iX~O[dO~Oh_OVfa~OhbO[ia~O",goto:"!kjPPPPPPkPPkqwPPk{!RPPP!XP!ePP!hXSOR^bQWQRf_TVQ_Q`WRg`QcZRicQTOQZRQe^RhbRYQR]R",nodeNames:" JsonText True False Null Number String } { Object Property PropertyName ] [ Array",maxTerm:25,nodeProps:[["openedBy",7,"{",12,"["],["closedBy",8,"}",13,"]"]],propSources:[jsonHighlighting],skippedNodes:[0],repeatNodeCount:2,tokenData:"(p~RaXY!WYZ!W]^!Wpq!Wrs!]|}$i}!O$n!Q!R$w!R![&V![!]&h!}#O&m#P#Q&r#Y#Z&w#b#c'f#h#i'}#o#p(f#q#r(k~!]Oc~~!`Upq!]qr!]rs!rs#O!]#O#P!w#P~!]~!wOe~~!zXrs!]!P!Q!]#O#P!]#U#V!]#Y#Z!]#b#c!]#f#g!]#h#i!]#i#j#g~#jR!Q![#s!c!i#s#T#Z#s~#vR!Q![$P!c!i$P#T#Z$P~$SR!Q![$]!c!i$]#T#Z$]~$`R!Q![!]!c!i!]#T#Z!]~$nOh~~$qQ!Q!R$w!R![&V~$|RT~!O!P%V!g!h%k#X#Y%k~%YP!Q![%]~%bRT~!Q![%]!g!h%k#X#Y%k~%nR{|%w}!O%w!Q![%}~%zP!Q![%}~&SPT~!Q![%}~&[ST~!O!P%V!Q![&V!g!h%k#X#Y%k~&mOg~~&rO]~~&wO[~~&zP#T#U&}~'QP#`#a'T~'WP#g#h'Z~'^P#X#Y'a~'fOR~~'iP#i#j'l~'oP#`#a'r~'uP#`#a'x~'}OS~~(QP#f#g(T~(WP#i#j(Z~(^P#X#Y(a~(fOQ~~(kOW~~(pOV~",tokenizers:[0],topRules:{JsonText:[0,1]},tokenPrec:0}),jsonLanguage=LRLanguage.define({name:"json",parser:parser.configure({props:[indentNodeProp.add({Object:continuedIndent({except:/^\s*\}/}),Array:continuedIndent({except:/^\s*\]/})}),foldNodeProp.add({"Object Array":foldInside})]}),languageData:{closeBrackets:{brackets:["[","{",'"']},indentOnInput:/^\s*[\}\]]$/}});function json(){return new LanguageSupport(jsonLanguage)}const chalky="#e5c07b",coral="#e06c75",cyan="#56b6c2",invalid="#ffffff",ivory="#abb2bf",stone="#7d8799",malibu="#61afef",sage="#98c379",whiskey="#d19a66",violet="#c678dd",darkBackground="#21252b",highlightBackground="#2c313a",background="#282c34",tooltipBackground="#353a42",selection="#3E4451",cursor="#528bff",oneDarkTheme=EditorView.theme({"&":{color:ivory,backgroundColor:background},".cm-content":{caretColor:cursor},".cm-cursor, .cm-dropCursor":{borderLeftColor:cursor},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:selection},".cm-panels":{backgroundColor:darkBackground,color:ivory},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:background,color:stone,border:"none"},".cm-activeLineGutter":{backgroundColor:highlightBackground},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:tooltipBackground},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:tooltipBackground,borderBottomColor:tooltipBackground},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:highlightBackground,color:ivory}}},{dark:!0}),oneDarkHighlightStyle=HighlightStyle.define([{tag:tags.keyword,color:violet},{tag:[tags.name,tags.deleted,tags.character,tags.propertyName,tags.macroName],color:coral},{tag:[tags.function(tags.variableName),tags.labelName],color:malibu},{tag:[tags.color,tags.constant(tags.name),tags.standard(tags.name)],color:whiskey},{tag:[tags.definition(tags.name),tags.separator],color:ivory},{tag:[tags.typeName,tags.className,tags.number,tags.changed,tags.annotation,tags.modifier,tags.self,tags.namespace],color:chalky},{tag:[tags.operator,tags.operatorKeyword,tags.url,tags.escape,tags.regexp,tags.link,tags.special(tags.string)],color:cyan},{tag:[tags.meta,tags.comment],color:stone},{tag:tags.strong,fontWeight:"bold"},{tag:tags.emphasis,fontStyle:"italic"},{tag:tags.strikethrough,textDecoration:"line-through"},{tag:tags.link,color:stone,textDecoration:"underline"},{tag:tags.heading,fontWeight:"bold",color:coral},{tag:[tags.atom,tags.bool,tags.special(tags.variableName)],color:whiskey},{tag:[tags.processingInstruction,tags.string,tags.inserted],color:sage},{tag:tags.invalid,color:invalid}]),oneDark=[oneDarkTheme,syntaxHighlighting(oneDarkHighlightStyle)];var _o;const to=typeof window<"u",Ir=n=>typeof n<"u",Tr=n=>typeof n=="boolean",ze=n=>typeof n=="function",Te=n=>typeof n=="number",Pe=n=>typeof n=="string",Pr=()=>{};to&&(_o=window==null?void 0:window.navigator)!=null&&_o.userAgent&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function se(n){return typeof n=="function"?n():unref(n)}function Dr(n,e){function r(...o){return new Promise((s,l)=>{Promise.resolve(n(()=>e.apply(this,o),{fn:e,thisArg:this,args:o})).then(s).catch(l)})}return r}const vi=n=>n();function Ar(n=vi){const e=ref(!0);function r(){e.value=!1}function o(){e.value=!0}const s=(...l)=>{e.value&&n(...l)};return{isActive:readonly(e),pause:r,resume:o,eventFilter:s}}function wo(n,e=!1,r="Timeout"){return new Promise((o,s)=>{setTimeout(e?()=>s(r):o,n)})}function zr(n){return n}function wn(n,e){let r,o,s;const l=ref(!0),a=()=>{l.value=!0,s()};watch(n,a,{flush:"sync"});const c=ze(e)?e:e.get,u=ze(e)?void 0:e.set,f=customRef((d,g)=>(o=d,s=g,{get(){return l.value&&(r=c(),l.value=!1),o(),r},set(m){u==null||u(m)}}));return Object.isExtensible(f)&&(f.trigger=a),f}function Mt(n){return getCurrentScope()?(onScopeDispose(n),!0):!1}function Br(n,e=!0){getCurrentInstance()?onMounted(n):e?n():nextTick(n)}function Rn(n,e=!1){function r(g,{flush:m="sync",deep:v=!1,timeout:b,throwOnTimeout:k}={}){let A=null;const R=[new Promise($=>{A=watch(n,J=>{g(J)!==e&&(A==null||A(),$(J))},{flush:m,deep:v,immediate:!0})})];return b!=null&&R.push(wo(b,k).then(()=>se(n)).finally(()=>A==null?void 0:A())),Promise.race(R)}function o(g,m){if(!isRef(g))return r(J=>J===g,m);const{flush:v="sync",deep:b=!1,timeout:k,throwOnTimeout:A}=m??{};let R=null;const $=[new Promise(J=>{R=watch([n,g],([_,L])=>{e!==(_===L)&&(R==null||R(),J(_))},{flush:v,deep:b,immediate:!0})})];return k!=null&&$.push(wo(k,A).then(()=>se(n)).finally(()=>(R==null||R(),se(n)))),Promise.race($)}function s(g){return r(m=>!!m,g)}function l(g){return o(null,g)}function a(g){return o(void 0,g)}function c(g){return r(Number.isNaN,g)}function u(g,m){return r(v=>{const b=Array.from(v);return b.includes(g)||b.includes(se(g))},m)}function f(g){return d(1,g)}function d(g=1,m){let v=-1;return r(()=>(v+=1,v>=g),m)}return Array.isArray(se(n))?{toMatch:r,toContains:u,changed:f,changedTimes:d,get not(){return Rn(n,!e)}}:{toMatch:r,toBe:o,toBeTruthy:s,toBeNull:l,toBeNaN:c,toBeUndefined:a,changed:f,changedTimes:d,get not(){return Rn(n,!e)}}}function pe(n){return Rn(n)}var bo=Object.getOwnPropertySymbols,Rr=Object.prototype.hasOwnProperty,Vr=Object.prototype.propertyIsEnumerable,Hr=(n,e)=>{var r={};for(var o in n)Rr.call(n,o)&&e.indexOf(o)<0&&(r[o]=n[o]);if(n!=null&&bo)for(var o of bo(n))e.indexOf(o)<0&&Vr.call(n,o)&&(r[o]=n[o]);return r};function Lr(n,e,r={}){const o=r,{eventFilter:s=vi}=o,l=Hr(o,["eventFilter"]);return watch(n,Dr(s,e),l)}var Fr=Object.defineProperty,Gr=Object.defineProperties,Yr=Object.getOwnPropertyDescriptors,Ft=Object.getOwnPropertySymbols,mi=Object.prototype.hasOwnProperty,pi=Object.prototype.propertyIsEnumerable,Eo=(n,e,r)=>e in n?Fr(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Xr=(n,e)=>{for(var r in e||(e={}))mi.call(e,r)&&Eo(n,r,e[r]);if(Ft)for(var r of Ft(e))pi.call(e,r)&&Eo(n,r,e[r]);return n},Ur=(n,e)=>Gr(n,Yr(e)),Zr=(n,e)=>{var r={};for(var o in n)mi.call(n,o)&&e.indexOf(o)<0&&(r[o]=n[o]);if(n!=null&&Ft)for(var o of Ft(n))e.indexOf(o)<0&&pi.call(n,o)&&(r[o]=n[o]);return r};function Je(n,e,r={}){const o=r,{eventFilter:s}=o,l=Zr(o,["eventFilter"]),{eventFilter:a,pause:c,resume:u,isActive:f}=Ar(s);return{stop:Lr(n,e,Ur(Xr({},l),{eventFilter:a})),pause:c,resume:u,isActive:f}}function yi(n){var e;const r=se(n);return(e=r==null?void 0:r.$el)!=null?e:r}const no=to?window:void 0;function oo(...n){let e,r,o,s;if(Pe(n[0])||Array.isArray(n[0])?([r,o,s]=n,e=no):[e,r,o,s]=n,!e)return Pr;Array.isArray(r)||(r=[r]),Array.isArray(o)||(o=[o]);const l=[],a=()=>{l.forEach(d=>d()),l.length=0},c=(d,g,m,v)=>(d.addEventListener(g,m,v),()=>d.removeEventListener(g,m,v)),u=watch(()=>[yi(e),se(s)],([d,g])=>{a(),d&&l.push(...r.flatMap(m=>o.map(v=>c(d,m,v,g))))},{immediate:!0,flush:"post"}),f=()=>{u(),a()};return Mt(f),f}const Kr=n=>typeof n=="function"?n:typeof n=="string"?e=>e.key===n:Array.isArray(n)?e=>n.includes(e.key):()=>!0;function So(...n){let e,r,o={};n.length===3?(e=n[0],r=n[1],o=n[2]):n.length===2?typeof n[1]=="object"?(e=!0,r=n[0],o=n[1]):(e=n[0],r=n[1]):(e=!0,r=n[0]);const{target:s=no,eventName:l="keydown",passive:a=!1}=o,c=Kr(e);return oo(s,l,u=>{c(u)&&r(u)},a)}function Wr(n,e=!1){const r=ref(),o=()=>r.value=!!n();return o(),Br(o,e),r}function qr(n){return JSON.parse(JSON.stringify(n))}const Vn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Hn="__vueuse_ssr_handlers__";Vn[Hn]=Vn[Hn]||{};var No=Object.getOwnPropertySymbols,jr=Object.prototype.hasOwnProperty,Qr=Object.prototype.propertyIsEnumerable,Jr=(n,e)=>{var r={};for(var o in n)jr.call(n,o)&&e.indexOf(o)<0&&(r[o]=n[o]);if(n!=null&&No)for(var o of No(n))e.indexOf(o)<0&&Qr.call(n,o)&&(r[o]=n[o]);return r};function ea(n,e,r={}){const o=r,{window:s=no}=o,l=Jr(o,["window"]);let a;const c=Wr(()=>s&&"ResizeObserver"in s),u=()=>{a&&(a.disconnect(),a=void 0)},f=watch(()=>yi(n),g=>{u(),c.value&&s&&g&&(a=new ResizeObserver(e),a.observe(g,l))},{immediate:!0,flush:"post"}),d=()=>{u(),f()};return Mt(d),{isSupported:c,stop:d}}var Co;(function(n){n.UP="UP",n.RIGHT="RIGHT",n.DOWN="DOWN",n.LEFT="LEFT",n.NONE="NONE"})(Co||(Co={}));var ta=Object.defineProperty,Mo=Object.getOwnPropertySymbols,na=Object.prototype.hasOwnProperty,oa=Object.prototype.propertyIsEnumerable,$o=(n,e,r)=>e in n?ta(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,ia=(n,e)=>{for(var r in e||(e={}))na.call(e,r)&&$o(n,r,e[r]);if(Mo)for(var r of Mo(e))oa.call(e,r)&&$o(n,r,e[r]);return n};const ra={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};ia({linear:zr},ra);function yt(n,e,r,o={}){var s,l,a;const{clone:c=!1,passive:u=!1,eventName:f,deep:d=!1,defaultValue:g}=o,m=getCurrentInstance(),v=r||(m==null?void 0:m.emit)||((s=m==null?void 0:m.$emit)==null?void 0:s.bind(m))||((a=(l=m==null?void 0:m.proxy)==null?void 0:l.$emit)==null?void 0:a.bind(m==null?void 0:m.proxy));let b=f;e||(e="modelValue"),b=f||b||`update:${e.toString()}`;const k=R=>c?ze(c)?c(R):qr(R):R,A=()=>Ir(n[e])?k(n[e]):g;if(u){const R=A(),$=ref(R);return watch(()=>n[e],J=>$.value=k(J)),watch($,J=>{(J!==n[e]||d)&&v(b,J)},{deep:d}),$}else return computed({get(){return A()},set(R){v(b,R)}})}function X(n=()=>{}){const e=ref(new Set);n&&e.value.add(n);const r=o=>{e.value.delete(o)};return{on:o=>{e.value.has(n)&&e.value.delete(n),e.value.add(o);const s=()=>r(o);return Mt(s),{off:s}},off:r,trigger:o=>Promise.all(Array.from(e.value).map(s=>s(o))),fns:e}}const aa=["production","prod"];function wt(n,...e){aa.includes("production")||console.warn(`[Vue Flow]: ${n}`,...e)}function sa(){return{edgesChange:X(),nodesChange:X(),nodeDoubleClick:X(),nodeClick:X(),nodeMouseEnter:X(),nodeMouseMove:X(),nodeMouseLeave:X(),nodeContextMenu:X(),nodeDragStart:X(),nodeDrag:X(),nodeDragStop:X(),nodesInitialized:X(),miniMapNodeClick:X(),miniMapNodeDoubleClick:X(),miniMapNodeMouseEnter:X(),miniMapNodeMouseMove:X(),miniMapNodeMouseLeave:X(),connect:X(),connectStart:X(),connectEnd:X(),clickConnectStart:X(),clickConnectEnd:X(),paneReady:X(),move:X(),moveStart:X(),moveEnd:X(),selectionDragStart:X(),selectionDrag:X(),selectionDragStop:X(),selectionContextMenu:X(),selectionStart:X(),selectionEnd:X(),viewportChangeStart:X(),viewportChange:X(),viewportChangeEnd:X(),paneScroll:X(),paneClick:X(),paneContextMenu:X(),paneMouseEnter:X(),paneMouseMove:X(),paneMouseLeave:X(),edgeContextMenu:X(),edgeMouseEnter:X(),edgeMouseMove:X(),edgeMouseLeave:X(),edgeDoubleClick:X(),edgeClick:X(),edgeUpdateStart:X(),edgeUpdate:X(),edgeUpdateEnd:X(),updateNodeInternals:X(),error:X(n=>wt(n.message))}}function la(n,e){onBeforeMount(()=>{for(const[r,o]of Object.entries(e.value)){const s=l=>{n(r,l)};o.on(s),Mt(()=>{o.off(s)})}})}var he=(n=>(n.MISSING_VIEWPORT_DIMENSIONS="MISSING_VIEWPORT_DIMENSIONS",n.NODE_NOT_FOUND="NODE_NOT_FOUND",n.NODE_MISSING_PARENT="NODE_MISSING_PARENT",n.NODE_TYPE_MISSING="NODE_TYPE_MISSING",n.NODE_EXTENT_INVALID="NODE_EXTENT_INVALID",n.EDGE_INVALID="EDGE_INVALID",n.EDGE_NOT_FOUND="EDGE_NOT_FOUND",n.EDGE_SOURCE_MISSING="EDGE_SOURCE_MISSING",n.EDGE_TARGET_MISSING="EDGE_TARGET_MISSING",n.EDGE_TYPE_MISSING="EDGE_TYPE_MISSING",n.EDGE_SOURCE_TARGET_SAME="EDGE_SOURCE_TARGET_SAME",n.EDGE_SOURCE_TARGET_MISSING="EDGE_SOURCE_TARGET_MISSING",n.EDGE_ORPHANED="EDGE_ORPHANED",n))(he||{});const bn={MISSING_VIEWPORT_DIMENSIONS:()=>"The Vue Flow parent container needs a width and a height to render the graph",NODE_NOT_FOUND:n=>`Node not found
Node: ${n}`,NODE_MISSING_PARENT:(n,e)=>`Node is missing a parent
Node: ${n}
Parent: ${e}`,NODE_TYPE_MISSING:n=>`Node type is missing
Type: ${n}`,NODE_EXTENT_INVALID:n=>`Only child nodes can use a parent extent
Node: ${n}`,EDGE_INVALID:n=>`An edge needs a source and a target
Edge: ${n}`,EDGE_SOURCE_MISSING:(n,e)=>`Edge source is missing
Edge: ${n} 
Source: ${e}`,EDGE_TARGET_MISSING:(n,e)=>`Edge target is missing
Edge: ${n} 
Target: ${e}`,EDGE_TYPE_MISSING:n=>`Edge type is missing
Type: ${n}`,EDGE_SOURCE_TARGET_SAME:(n,e,r)=>`Edge source and target are the same
Edge: ${n} 
Source: ${e} 
Target: ${r}`,EDGE_SOURCE_TARGET_MISSING:(n,e,r)=>`Edge source or target is missing
Edge: ${n} 
Source: ${e} 
Target: ${r}`,EDGE_ORPHANED:n=>`Edge was orphaned (suddenly missing source or target) and has been removed
Edge: ${n}`,EDGE_NOT_FOUND:n=>`Edge not found
Edge: ${n}`};class ve extends Error{constructor(e,...r){var o;super((o=bn[e])==null?void 0:o.call(bn,...r)),this.code=e}}const io=()=>typeof window<"u"?window:{chrome:!1};function ko(n){return{...n.computedPosition||{x:0,y:0},width:n.dimensions.width||0,height:n.dimensions.height||0}}function Ln(n,e){const r=Math.max(0,Math.min(n.x+n.width,e.x+e.width)-Math.max(n.x,e.x)),o=Math.max(0,Math.min(n.y+n.height,e.y+e.height)-Math.max(n.y,e.y));return Math.ceil(r*o)}function nn(n){return{width:n.offsetWidth,height:n.offsetHeight}}function ct(n,e=0,r=1){return Math.min(Math.max(n,e),r)}function ro(n,e){return{x:ct(n.x,e[0][0],e[1][0]),y:ct(n.y,e[0][1],e[1][1])}}function Oo(n){const e=n.getRootNode(),r=io();return"elementFromPoint"in e?e:r.document}function $e(n){return n&&"id"in n&&"source"in n&&"target"in n}function ua(n){return $e(n)&&"sourceNode"in n&&"targetNode"in n}function xt(n){return n&&"id"in n&&!$e(n)}function et(n){return xt(n)&&"computedPosition"in n}function ca(n){return!!n.width&&!!n.height&&!!n.x&&!!n.y}function da(n,e={}){let r=e;return et(n)||(r={type:n.type??e.type??"default",dimensions:markRaw({width:0,height:0}),handleBounds:{source:[],target:[]},computedPosition:markRaw({z:0,...n.position}),draggable:void 0,selectable:void 0,connectable:void 0,focusable:void 0,selected:!1,dragging:!1,resizing:!1,initialized:!1,...e,data:de(n.data)?n.data:{},events:markRaw(de(n.events)?n.events:{})}),Object.assign({},r,n,{id:n.id.toString()})}function ao(n,e={}){const r=de(n.events)?n.events:e.events&&de(e.events)?e.events:{},o=de(n.data)?n.data:e.data&&de(e.data)?e.data:{};return e=ua(n)?e:{...e,sourceHandle:(n.sourceHandle?n.sourceHandle.toString():void 0)||e.sourceHandle,targetHandle:(n.targetHandle?n.targetHandle.toString():void 0)||e.targetHandle,type:n.type??e.type??"default",source:n.source.toString()||e.source,target:n.target.toString()||e.target,updatable:n.updatable??e.updatable,selectable:n.selectable??e.selectable,focusable:n.focusable??e.focusable,data:o,events:markRaw(r),label:(n.label&&!Pe(n.label)?markRaw(n.label):n.label)||e.label,interactionWidth:n.interactionWidth||e.interactionWidth},Object.assign({},e,n,{id:n.id.toString()})}function on({source:n,sourceHandle:e,target:r,targetHandle:o}){return`vueflow__edge-${n}${e??""}-${r}${o??""}`}function _i(n,e){return e.some(r=>$e(r)&&r.source===n.source&&r.target===n.target&&(r.sourceHandle===n.sourceHandle||!r.sourceHandle&&!n.sourceHandle)&&(r.targetHandle===n.targetHandle||!r.targetHandle&&!n.targetHandle))}function fa({x:n,y:e},{x:r,y:o,zoom:s}){return{x:n*s+r,y:e*s+o}}function so({x:n,y:e},{x:r,y:o,zoom:s},l,[a,c]){const u={x:(n-r)/s,y:(e-o)/s};return l?{x:a*Math.round(u.x/a),y:c*Math.round(u.y/c)}:u}function wi(n,e){return{x:Math.min(n.x,e.x),y:Math.min(n.y,e.y),x2:Math.max(n.x2,e.x2),y2:Math.max(n.y2,e.y2)}}function Gt({x:n,y:e,width:r,height:o}){return{x:n,y:e,x2:n+r,y2:e+o}}function bi({x:n,y:e,x2:r,y2:o}){return{x:n,y:e,width:r-n,height:o-e}}function lo(n){const e=n.reduce((r,{computedPosition:o={x:0,y:0},dimensions:s={width:0,height:0}}={})=>wi(r,Gt({...o,...s})),{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return bi(e)}function Ei(n,e,{x:r,y:o,zoom:s}={x:0,y:0,zoom:1},l=!1,a=!1){const c={x:(e.x-r)/s,y:(e.y-o)/s,width:e.width/s,height:e.height/s};return n.filter(u=>{const{computedPosition:f={x:0,y:0},dimensions:d={width:0,height:0},selectable:g}=u;if(a&&!g)return!1;const m={...f,width:d.width||0,height:d.height||0},v=Ln(c,m),b=typeof d.width>"u"||typeof d.height>"u"||d.width===0||d.height===0,k=l&&v>0,A=d.width*d.height;return b||k||v>=A})}function rn(n,e){const r=n.map(o=>Pe(o)?o:o.id);return e.filter(o=>r.includes(o.source)||r.includes(o.target))}function Yt(n,e,r,o,s,l=.1,a={x:0,y:0}){const c=e/(n.width*(1+l)),u=r/(n.height*(1+l)),f=Math.min(c,u),d=ct(f,o,s),g=n.x+n.width/2,m=n.y+n.height/2,v=e/2-g*d+(a.x??0),b=r/2-m*d+(a.y??0);return{x:v,y:b,zoom:d}}function ha(n,e){return{x:e.x+n.x,y:e.y+n.y,z:(n.z>e.z?n.z:e.z)+1}}function Si(n,e){if(!n.parentNode)return!1;const r=e(n.parentNode);return r?r.selected?!0:Si(r,e):!1}function Xe(n,e){return typeof n>"u"?"":typeof n=="string"?n:`${e?`${e}__`:""}${Object.keys(n).sort().map(r=>`${r}=${n[r]}`).join("&")}`}function de(n){return typeof unref(n)<"u"}function ga(n,e,r){if(!n.source||!n.target)return r(new ve(he.EDGE_INVALID,n.id)),!1;let o;return $e(n)?o=n:o={...n,id:on(n)},o=ao(o),_i(o,e)?!1:o}function va(n,e,r,o,s,l){if(!e.source||!e.target)return l(new ve(he.EDGE_INVALID,n.id)),!1;const a=o(n.id);if(!a)return l(new ve(he.EDGE_NOT_FOUND,n.id)),!1;const{id:c,...u}=n,f={...u,id:s?on(e):c,source:e.source,target:e.target,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle};return r.splice(r.indexOf(a),1,f),f}function Io(n,e,r,o){const s={},l=n.map(c=>{const u=da(c,{...r(c.id),parentNode:c.parentNode});return c.parentNode&&(s[c.parentNode]=!0),u}),a=[...l,...e];return l.forEach(c=>{const u=a.find(f=>f.id===c.parentNode);c.parentNode&&!u&&o(new ve(he.NODE_MISSING_PARENT,c.id,c.parentNode)),(c.parentNode||s[c.id])&&(s[c.id]&&(c.isParent=!0),u&&(u.isParent=!0))}),l}var Q=(n=>(n.Left="left",n.Top="top",n.Right="right",n.Bottom="bottom",n))(Q||{}),uo=(n=>(n.Partial="partial",n.Full="full",n))(uo||{}),Ye=(n=>(n.Bezier="default",n.SimpleBezier="simple-bezier",n.Straight="straight",n.Step="step",n.SmoothStep="smoothstep",n))(Ye||{}),je=(n=>(n.Strict="strict",n.Loose="loose",n))(je||{}),Fn=(n=>(n.Arrow="arrow",n.ArrowClosed="arrowclosed",n))(Fn||{}),Xt=(n=>(n.Free="free",n.Vertical="vertical",n.Horizontal="horizontal",n))(Xt||{});const To=Symbol("vueFlow"),Ni=Symbol("nodeId"),Ci=Symbol("nodeRef"),Mi=Symbol("edgeId"),$i=Symbol("edgeRef"),an=Symbol("slots");function pa(n){const e=n??inject(Ni,""),r=inject(Ci,null),{findNode:o,edges:s,emits:l}=ce(),a=o(e);return a||l.error(new ve(he.NODE_NOT_FOUND,e)),{id:e,nodeEl:r,node:a,parentNode:computed(()=>o(a.parentNode)),connectedEdges:computed(()=>rn([a],s.value))}}function co(n){return"clientX"in n}function ot(n,e){var r,o;const s=co(n),l=s?n.clientX:(r=n.touches)==null?void 0:r[0].clientX,a=s?n.clientY:(o=n.touches)==null?void 0:o[0].clientY;return{x:l-((e==null?void 0:e.left)??0),y:a-((e==null?void 0:e.top)??0)}}function Ut(n,e,r){const o=((r==null?void 0:r.x)??0)+e.x,s=((r==null?void 0:r.y)??0)+e.y,l=(r==null?void 0:r.width)??e.width,a=(r==null?void 0:r.height)??e.height;switch(n){case Q.Top:return{x:o+l/2,y:s};case Q.Right:return{x:o+l,y:s+a/2};case Q.Bottom:return{x:o+l/2,y:s+a};case Q.Left:return{x:o,y:s+a/2}}}function Po(n=[],e){return n.length?!e||n.length===1?n[0]:e&&n.find(r=>r.id===e)||null:null}function ya(n,e,r,o,s,l){const a=Ut(r,{...n.dimensions,...n.computedPosition},e),c=Ut(l,{...o.dimensions,...o.computedPosition},s);return{sourceX:a.x,sourceY:a.y,targetX:c.x,targetY:c.y}}function xa({sourcePos:n,targetPos:e,sourceWidth:r,sourceHeight:o,targetWidth:s,targetHeight:l,width:a,height:c,viewport:u}){const f={x:Math.min(n.x,e.x),y:Math.min(n.y,e.y),x2:Math.max(n.x+r,e.x+s),y2:Math.max(n.y+o,e.y+l)};f.x===f.x2&&(f.x2+=1),f.y===f.y2&&(f.y2+=1);const d=Gt({x:(0-u.x)/u.zoom,y:(0-u.y)/u.zoom,width:a/u.zoom,height:c/u.zoom}),g=Math.max(0,Math.min(d.x2,f.x2)-Math.max(d.x,f.x)),m=Math.max(0,Math.min(d.y2,f.y2)-Math.max(d.y,f.y));return Math.ceil(g*m)>0}function _a(n,e,r=!1){let o=-1;const s=n.reduce((l,a)=>{const c=Te(a.zIndex);let u=c?a.zIndex:0;const f=e(a.source),d=e(a.target);return!f||!d||(r&&(u=c?a.zIndex:Math.max(f.computedPosition.z||0,d.computedPosition.z||0)),l[u]?l[u].push(a):l[u]=[a],o=u>o?u:o),l},{});return Object.entries(Object.keys(s).length?s:{0:[]}).map(([l,a])=>{const c=+l;return{edges:a,level:c,isMaxLevel:c===o}})}function En(n){n==null||n.classList.remove("valid","connecting","vue-flow__handle-valid","vue-flow__handle-connecting")}function Do(n,e,r,o){return(e[r]||[]).reduce((s,l)=>(`${n.id}-${l.id}-${r}`!==o&&s.push({id:l.id||null,type:r,nodeId:n.id,...Ut(l.position,{...n.dimensions,...n.computedPosition},l)}),s),[])}function wa(n,e,r){let o=null,s=1/0;return r.forEach(l=>{const a=Math.sqrt((l.x-n.x)**2+(l.y-n.y)**2);a<=e&&a<s&&(s=a,o=l)}),o}function Ao(n,e,r,o,s,l,a,c,u,f){const d=l==="target",g=c.querySelector(`.vue-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),{x:m,y:v}=ot(n),b=c.elementFromPoint(m,v),k=b!=null&&b.classList.contains("vue-flow__handle")?b:g,A={handleDomNode:k,isValid:!1,connection:{source:"",target:"",sourceHandle:null,targetHandle:null},endHandle:null};if(k){const R=ki(void 0,k),$=k.getAttribute("data-nodeid"),J=k.getAttribute("data-handleid"),_=k.classList.contains("connectable"),L=k.classList.contains("connectableend"),Y={source:d?$:o,sourceHandle:d?J:s,target:d?o:$,targetHandle:d?s:J};A.connection=Y,_&&L&&(r===je.Strict?d&&R==="source"||!d&&R==="target":$!==o||J!==s)&&(A.endHandle={nodeId:$,handleId:J,type:R},A.isValid=a(Y,{edges:u,sourceNode:f(Y.source),targetNode:f(Y.target)}))}return A}function ba({nodes:n,nodeId:e,handleId:r,handleType:o}){return n.reduce((s,l)=>{const{handleBounds:a}=l;let c=[],u=[];return a&&(c=Do(l,a,"source",`${e}-${r}-${o}`),u=Do(l,a,"target",`${e}-${r}-${o}`)),s.push(...c,...u),s},[])}function ki(n,e){return n||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function Ea(n,e){let r=null;return e?r="valid":n&&!e&&(r="invalid"),r}function zo(n,e,r){return n<e?ct(Math.abs(n-e),1,50)/50:n>r?-ct(Math.abs(n-r),1,50)/50:0}function Oi(n,e){const r=zo(n.x,35,e.width-35)*20,o=zo(n.y,35,e.height-35)*20;return[r,o]}function Ot(){return!0}function Ii({handleId:n,nodeId:e,type:r,isValidConnection:o,edgeUpdaterType:s,onEdgeUpdate:l,onEdgeUpdateEnd:a}){const c=computed(()=>se(r)==="target"),{vueFlowRef:u,connectionMode:f,connectionRadius:d,connectOnClick:g,connectionClickStartHandle:m,nodesConnectable:v,autoPanOnConnect:b,findNode:k,panBy:A,getNodes:R,startConnection:$,updateConnection:J,endConnection:_,emits:L,viewport:Y,edges:I,isValidConnection:Le}=ce();let oe=null,G=!1,Z=null;function Ee(K){var ge;const ne=co(K),le=Oo(K.target);if(ne&&K.button===0||!ne){let Ae=function(q){Ce=ot(q,H),_e=wa(so(Ce,Y.value,!1,[1,1]),d.value,E),ye||(M(),ye=!0);const te=Ao(q,_e,f.value,se(e),se(n),c.value?"target":"source",Ze,le,I.value,k);if(oe=te.connection,G=te.isValid,Z=te.handleDomNode,J(_e&&G?fa({x:_e.x,y:_e.y},Y.value):Ce,te.endHandle,Ea(!!_e,G)),!_e&&!G&&!Z)return En(ae);oe&&oe.source!==oe.target&&Z&&(En(ae),ae=Z,Z.classList.add("connecting","vue-flow__handle-connecting"),Z.classList.toggle("valid",G),Z.classList.toggle("vue-flow__handle-valid",G))},Ve=function(q){(_e||Z)&&oe&&G&&(l?l(q,oe):L.connect(oe)),L.connectEnd(q),s&&(a==null||a(q)),En(ae),cancelAnimationFrame(ut),_(q),ye=!1,G=!1,oe=null,Z=null,le.removeEventListener("mousemove",Ae),le.removeEventListener("mouseup",Ve),le.removeEventListener("touchmove",Ae),le.removeEventListener("touchend",Ve)};const fe=k(se(e));let Ze=o||Le.value||Ot;!Ze&&fe&&(Ze=(c?fe.isValidSourcePos:fe.isValidTargetPos)||Ot);let _e,ut=0;const{x:st,y:re}=ot(K),ee=le==null?void 0:le.elementFromPoint(st,re),N=ki(se(s),ee),H=(ge=u.value)==null?void 0:ge.getBoundingClientRect();if(!H||!N)return;let ae,Ce=ot(K,H),ye=!1;const E=ba({nodes:R.value,nodeId:se(e),handleId:se(n),handleType:N}),M=()=>{if(!b)return;const[q,te]=Oi(Ce,H);A({x:q,y:te}),ut=requestAnimationFrame(M)};$({nodeId:se(e),handleId:se(n),type:N},{x:st-H.left,y:re-H.top},K),L.connectStart({event:K,nodeId:se(e),handleId:se(n),handleType:N}),le.addEventListener("mousemove",Ae),le.addEventListener("mouseup",Ve),le.addEventListener("touchmove",Ae),le.addEventListener("touchend",Ve)}}function We(K){if(g.value)if(!m.value)L.clickConnectStart({event:K,nodeId:se(e),handleId:se(n)}),$({nodeId:se(e),type:se(r),handleId:se(n)},void 0,K,!0);else{let ge=o||Le.value||Ot;const ne=k(se(e));if(!ge&&ne&&(ge=(c?ne.isValidSourcePos:ne.isValidTargetPos)||Ot),ne&&(typeof ne.connectable>"u"?v.value:ne.connectable)===!1)return;const le=Oo(K.target),{connection:Ae,isValid:Ve}=Ao(K,{nodeId:se(e),id:se(n),type:se(r)},f.value,m.value.nodeId,m.value.handleId||null,m.value.type,ge,le,I.value,k),fe=Ae.source===Ae.target;Ve&&!fe&&L.connect(Ae),L.clickConnectEnd(K),_(K,!0)}}return{handlePointerDown:Ee,handleClick:We}}function Sa(n,e){const r={};for(const o in n)e.includes(o)||Object.defineProperty(r,o,{enumerable:!0,get:()=>n[o]});return r}const Na=["data-id","data-handleid","data-nodeid","data-handlepos"],Ca={name:"Handle",compatConfig:{MODE:3}},Zt=defineComponent({...Ca,props:{id:null,type:null,position:{default:Q.Top},isValidConnection:{type:Function},connectable:{type:[Boolean,String,Function],default:void 0},connectableStart:{type:Boolean,default:!0},connectableEnd:{type:Boolean,default:!0}},setup(n){const e=Sa(n,["position","connectable","connectableStart","connectableEnd","id","isValidConnection"]),r=toRef(e,"type","source"),{connectionStartHandle:o,connectionClickStartHandle:s,connectionEndHandle:l,vueFlowRef:a,nodesConnectable:c,noDragClassName:u,noPanClassName:f}=ce(),{id:d,node:g,nodeEl:m,connectedEdges:v}=pa(),b=ref(),k=computed(()=>n.id??`${d}__handle-${n.position}`),A=computed(()=>typeof n.connectableStart<"u"?n.connectableStart:!0),R=computed(()=>typeof n.connectableEnd<"u"?n.connectableEnd:!0),{handlePointerDown:$,handleClick:J}=Ii({nodeId:d,handleId:k,isValidConnection:n.isValidConnection,type:r}),_=computed(()=>Pe(n.connectable)&&n.connectable==="single"?!v.value.some(oe=>{const G=oe[`${r.value}Handle`];return oe[r.value]!==d?!1:G?G===k.value:!0}):ze(n.connectable)?n.connectable(g,v.value):de(n.connectable)?n.connectable:c.value),L=computed(()=>{var oe,G,Z,Ee,We,K;return((oe=o.value)==null?void 0:oe.nodeId)===d&&((G=o.value)==null?void 0:G.handleId)===k.value&&((Z=o.value)==null?void 0:Z.type)===r.value||((Ee=l.value)==null?void 0:Ee.nodeId)===d&&((We=l.value)==null?void 0:We.handleId)===k.value&&((K=l.value)==null?void 0:K.type)===r.value}),Y=computed(()=>{var oe,G,Z;return((oe=s.value)==null?void 0:oe.nodeId)===d&&((G=s.value)==null?void 0:G.handleId)===k.value&&((Z=s.value)==null?void 0:Z.type)===r.value});pe(()=>g.initialized).toBe(!0,{flush:"post"}).then(()=>{var oe;const G=(oe=g.handleBounds[r.value])==null?void 0:oe.find(le=>le.id===k.value);if(!a.value||G)return;const Z=a.value.querySelector(".vue-flow__transformationpane");if(!m||!b.value||!Z||!k.value)return;const Ee=m.value.getBoundingClientRect(),We=b.value.getBoundingClientRect(),K=window.getComputedStyle(Z),{m22:ge}=new window.DOMMatrixReadOnly(K.transform),ne={id:k.value,position:n.position,x:(We.left-Ee.left)/ge,y:(We.top-Ee.top)/ge,...nn(b.value)};g.handleBounds[r.value]=[...g.handleBounds[r.value]??[],ne]});function I(oe){const G=co(oe);_.value&&A.value&&(G&&oe.button===0||!G)&&$(oe)}function Le(oe){!d||!s.value&&!A.value||_.value&&J(oe)}return(oe,G)=>(openBlock(),createElementBlock("div",{ref_key:"handle",ref:b,"data-id":`${unref(d)}-${unref(k)}-${unref(r)}`,"data-handleid":unref(k),"data-nodeid":unref(d),"data-handlepos":n.position,class:normalizeClass(["vue-flow__handle",[`vue-flow__handle-${n.position}`,`vue-flow__handle-${unref(k)}`,unref(u),unref(f),unref(r),{connectable:unref(_),connecting:unref(Y),connectablestart:unref(A),connectableend:unref(R),connectionindicator:unref(_)&&(unref(A)&&!unref(L)||unref(R)&&unref(L))}]]),onMousedown:I,onTouchstartPassive:I,onClick:Le},[renderSlot(oe.$slots,"default",{id:n.id})],42,Na))}}),sn=function({sourcePosition:n=Q.Bottom,targetPosition:e=Q.Top,label:r,connectable:o=!0,isValidTargetPos:s,isValidSourcePos:l}){return[h$1(Zt,{type:"target",position:e,connectable:o,isValidConnection:s}),typeof r!="string"&&r?h$1(r):h$1("div",{innerHTML:r}),h$1(Zt,{type:"source",position:n,connectable:o,isValidConnection:l})]};sn.props=["sourcePosition","targetPosition","label","isValidTargetPos","isValidSourcePos","connectable"];sn.inheritAttrs=!1;sn.compatConfig={MODE:3};const Ma=sn,ln=function({sourcePosition:n=Q.Bottom,label:e,connectable:r=!0,isValidSourcePos:o}){return[typeof e!="string"&&e?h$1(e):h$1("div",{innerHTML:e}),h$1(Zt,{type:"source",position:n,connectable:r,isValidConnection:o})]};ln.props=["sourcePosition","label","isValidSourcePos","connectable"];ln.inheritAttrs=!1;ln.compatConfig={MODE:3};const $a=ln,un=function({targetPosition:n=Q.Top,label:e,connectable:r=!0,isValidTargetPos:o}){return[h$1(Zt,{type:"target",position:n,connectable:r,isValidConnection:o}),typeof e!="string"&&e?h$1(e):h$1("div",{innerHTML:e})]};un.props=["targetPosition","label","isValidTargetPos","connectable"];un.inheritAttrs=!1;un.compatConfig={MODE:3};const ka=un;function Bo(n,e,r){let o=n;do{if(o&&o.matches(e))return!0;if(o===r)return!1;o=o.parentElement}while(o);return!1}function Oa(n,e,r,o,s){return n.filter(l=>(l.selected||l.id===s)&&(!l.parentNode||!Si(l,o))&&(l.draggable||e&&typeof l.draggable>"u")).map(l=>{var a,c;return markRaw({id:l.id,position:l.position||{x:0,y:0},distance:{x:r.x-((a=l.computedPosition)==null?void 0:a.x)||0,y:r.y-((c=l.computedPosition)==null?void 0:c.y)||0},from:l.computedPosition,extent:l.extent,parentNode:l.parentNode,dimensions:l.dimensions})})}function Sn({id:n,dragItems:e,findNode:r}){const o=e.map(s=>r(s.id));return[n?o.find(s=>s.id===n):o[0],o]}function Ti(n){if(Array.isArray(n))switch(n.length){case 1:return[n[0],n[0],n[0],n[0]];case 2:return[n[0],n[1],n[0],n[1]];case 3:return[n[0],n[1],n[2],n[1]];case 4:return n;default:return[0,0,0,0]}return[n,n,n,n]}function Ia(n,e,r){const[o,s,l,a]=typeof n!="string"?Ti(n.padding):[0,0,0,0];return r&&Te(r.computedPosition.x)&&Te(r.computedPosition.y)&&Te(r.dimensions.width)&&Te(r.dimensions.height)?[[r.computedPosition.x+a,r.computedPosition.y+o],[r.computedPosition.x+(r.dimensions.width-e.dimensions.width)-s,r.computedPosition.y+(r.dimensions.height-e.dimensions.height)-l]]:!1}function Ta(n,e,r,o){let s=n.extent||r;if(s==="parent"||!Array.isArray(s)&&(s==null?void 0:s.range)==="parent")if(n.parentNode&&o&&n.dimensions.width&&n.dimensions.height){const l=Ia(s,n,o);l&&(s=l)}else e(new ve(he.NODE_EXTENT_INVALID,n.id)),s=r;else if(Array.isArray(s)){const l=(o==null?void 0:o.computedPosition.x)||0,a=(o==null?void 0:o.computedPosition.y)||0;s=[[s[0][0]+l,s[0][1]+a],[s[1][0]+l,s[1][1]+a]]}else if(s!=null&&s.range&&Array.isArray(s.range)){const[l,a,c,u]=Ti(s.padding),f=(o==null?void 0:o.computedPosition.x)||0,d=(o==null?void 0:o.computedPosition.y)||0;s=[[s.range[0][0]+f+u,s.range[0][1]+d+l],[s.range[1][0]+f-a,s.range[1][1]+d-c]]}return s}function fo(n,e,r,o,s){const l=Ta(n,r,o,s),a=ro(e,l);return{position:{x:a.x-((s==null?void 0:s.computedPosition.x)||0),y:a.y-((s==null?void 0:s.computedPosition.y)||0)},computedPosition:a}}function Pi(){const{getSelectedNodes:n,nodeExtent:e,updateNodePositions:r,findNode:o,snapGrid:s,snapToGrid:l,nodesDraggable:a,emits:c}=ce();return(u,f=!1)=>{const d=l.value?s.value[0]:5,g=l.value?s.value[1]:5,m=f?4:1,v=u.x*d*m,b=u.y*g*m,k=n.value.filter(A=>A.draggable||a&&typeof A.draggable>"u").map(A=>{const R={x:A.computedPosition.x+v,y:A.computedPosition.y+b},{computedPosition:$}=fo(A,R,c.error,e.value,A.parentNode?o(A.parentNode):void 0);return{id:A.id,position:$,from:A.position,distance:{x:u.x,y:u.y},dimensions:A.dimensions}});r(k,!0,!1)}}function Pa(){return{doubleClick:X(),click:X(),mouseEnter:X(),mouseMove:X(),mouseLeave:X(),contextMenu:X(),dragStart:X(),drag:X(),dragStop:X()}}function Da(n,e){const r=Pa();return r.doubleClick.on(o=>{var s,l;e.nodeDoubleClick(o),(l=(s=n.events)==null?void 0:s.doubleClick)==null||l.call(s,o)}),r.click.on(o=>{var s,l;e.nodeClick(o),(l=(s=n.events)==null?void 0:s.click)==null||l.call(s,o)}),r.mouseEnter.on(o=>{var s,l;e.nodeMouseEnter(o),(l=(s=n.events)==null?void 0:s.mouseEnter)==null||l.call(s,o)}),r.mouseMove.on(o=>{var s,l;e.nodeMouseMove(o),(l=(s=n.events)==null?void 0:s.mouseMove)==null||l.call(s,o)}),r.mouseLeave.on(o=>{var s,l;e.nodeMouseLeave(o),(l=(s=n.events)==null?void 0:s.mouseLeave)==null||l.call(s,o)}),r.contextMenu.on(o=>{var s,l;e.nodeContextMenu(o),(l=(s=n.events)==null?void 0:s.contextMenu)==null||l.call(s,o)}),r.dragStart.on(o=>{var s,l;e.nodeDragStart(o),(l=(s=n.events)==null?void 0:s.dragStart)==null||l.call(s,o)}),r.drag.on(o=>{var s,l;e.nodeDrag(o),(l=(s=n.events)==null?void 0:s.drag)==null||l.call(s,o)}),r.dragStop.on(o=>{var s,l;e.nodeDragStop(o),(l=(s=n.events)==null?void 0:s.dragStop)==null||l.call(s,o)}),Object.entries(r).reduce((o,[s,l])=>(o.emit[s]=l.trigger,o.on[s]=l.on,o),{emit:{},on:{}})}function Aa(){const{viewport:n,snapGrid:e,snapToGrid:r}=ce();return({sourceEvent:o})=>{const s=o.touches?o.touches[0].clientX:o.clientX,l=o.touches?o.touches[0].clientY:o.clientY,a={x:(s-n.value.x)/n.value.zoom,y:(l-n.value.y)/n.value.zoom};return{xSnapped:r.value?e.value[0]*Math.round(a.x/e.value[0]):a.x,ySnapped:r.value?e.value[1]*Math.round(a.y/e.value[1]):a.y,...a}}}function Ro(n,e,r){const o=e.querySelectorAll(`.vue-flow__handle${n}`);if(!o||!o.length)return;const s=Array.from(o),l=e.getBoundingClientRect();return s.map(a=>{const c=a.getBoundingClientRect();return{id:a.getAttribute("data-handleid"),position:a.getAttribute("data-handlepos"),x:(c.left-l.left)/r,y:(c.top-l.top)/r,...nn(a)}})}function Gn(n,e,r,o,s,l=!1,a){s.value=!1,n.selected?(l||n.selected&&e)&&(o([n]),nextTick(a.blur)):r([n])}var za={value:()=>{}};function cn(){for(var n=0,e=arguments.length,r={},o;n<e;++n){if(!(o=arguments[n]+"")||o in r||/[\s.]/.test(o))throw new Error("illegal type: "+o);r[o]=[]}return new Rt(r)}function Rt(n){this._=n}function Ba(n,e){return n.trim().split(/^|\s+/).map(function(r){var o="",s=r.indexOf(".");if(s>=0&&(o=r.slice(s+1),r=r.slice(0,s)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:o}})}Rt.prototype=cn.prototype={constructor:Rt,on:function(n,e){var r=this._,o=Ba(n+"",r),s,l=-1,a=o.length;if(arguments.length<2){for(;++l<a;)if((s=(n=o[l]).type)&&(s=Ra(r[s],n.name)))return s;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++l<a;)if(s=(n=o[l]).type)r[s]=Vo(r[s],n.name,e);else if(e==null)for(s in r)r[s]=Vo(r[s],n.name,null);return this},copy:function(){var n={},e=this._;for(var r in e)n[r]=e[r].slice();return new Rt(n)},call:function(n,e){if((s=arguments.length-2)>0)for(var r=new Array(s),o=0,s,l;o<s;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(l=this._[n],o=0,s=l.length;o<s;++o)l[o].value.apply(e,r)},apply:function(n,e,r){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var o=this._[n],s=0,l=o.length;s<l;++s)o[s].value.apply(e,r)}};function Ra(n,e){for(var r=0,o=n.length,s;r<o;++r)if((s=n[r]).name===e)return s.value}function Vo(n,e,r){for(var o=0,s=n.length;o<s;++o)if(n[o].name===e){n[o]=za,n=n.slice(0,o).concat(n.slice(o+1));break}return r!=null&&n.push({name:e,value:r}),n}var Yn="http://www.w3.org/1999/xhtml";const Ho={svg:"http://www.w3.org/2000/svg",xhtml:Yn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function dn(n){var e=n+="",r=e.indexOf(":");return r>=0&&(e=n.slice(0,r))!=="xmlns"&&(n=n.slice(r+1)),Ho.hasOwnProperty(e)?{space:Ho[e],local:n}:n}function Va(n){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===Yn&&e.documentElement.namespaceURI===Yn?e.createElement(n):e.createElementNS(r,n)}}function Ha(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function Di(n){var e=dn(n);return(e.local?Ha:Va)(e)}function La(){}function ho(n){return n==null?La:function(){return this.querySelector(n)}}function Fa(n){typeof n!="function"&&(n=ho(n));for(var e=this._groups,r=e.length,o=new Array(r),s=0;s<r;++s)for(var l=e[s],a=l.length,c=o[s]=new Array(a),u,f,d=0;d<a;++d)(u=l[d])&&(f=n.call(u,u.__data__,d,l))&&("__data__"in u&&(f.__data__=u.__data__),c[d]=f);return new xe(o,this._parents)}function Ga(n){return n==null?[]:Array.isArray(n)?n:Array.from(n)}function Ya(){return[]}function Ai(n){return n==null?Ya:function(){return this.querySelectorAll(n)}}function Xa(n){return function(){return Ga(n.apply(this,arguments))}}function Ua(n){typeof n=="function"?n=Xa(n):n=Ai(n);for(var e=this._groups,r=e.length,o=[],s=[],l=0;l<r;++l)for(var a=e[l],c=a.length,u,f=0;f<c;++f)(u=a[f])&&(o.push(n.call(u,u.__data__,f,a)),s.push(u));return new xe(o,s)}function zi(n){return function(){return this.matches(n)}}function Bi(n){return function(e){return e.matches(n)}}var Za=Array.prototype.find;function Ka(n){return function(){return Za.call(this.children,n)}}function Wa(){return this.firstElementChild}function qa(n){return this.select(n==null?Wa:Ka(typeof n=="function"?n:Bi(n)))}var ja=Array.prototype.filter;function Qa(){return Array.from(this.children)}function Ja(n){return function(){return ja.call(this.children,n)}}function es(n){return this.selectAll(n==null?Qa:Ja(typeof n=="function"?n:Bi(n)))}function ts(n){typeof n!="function"&&(n=zi(n));for(var e=this._groups,r=e.length,o=new Array(r),s=0;s<r;++s)for(var l=e[s],a=l.length,c=o[s]=[],u,f=0;f<a;++f)(u=l[f])&&n.call(u,u.__data__,f,l)&&c.push(u);return new xe(o,this._parents)}function Ri(n){return new Array(n.length)}function ns(){return new xe(this._enter||this._groups.map(Ri),this._parents)}function Kt(n,e){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=e}Kt.prototype={constructor:Kt,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,e){return this._parent.insertBefore(n,e)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};function os(n){return function(){return n}}function is(n,e,r,o,s,l){for(var a=0,c,u=e.length,f=l.length;a<f;++a)(c=e[a])?(c.__data__=l[a],o[a]=c):r[a]=new Kt(n,l[a]);for(;a<u;++a)(c=e[a])&&(s[a]=c)}function rs(n,e,r,o,s,l,a){var c,u,f=new Map,d=e.length,g=l.length,m=new Array(d),v;for(c=0;c<d;++c)(u=e[c])&&(m[c]=v=a.call(u,u.__data__,c,e)+"",f.has(v)?s[c]=u:f.set(v,u));for(c=0;c<g;++c)v=a.call(n,l[c],c,l)+"",(u=f.get(v))?(o[c]=u,u.__data__=l[c],f.delete(v)):r[c]=new Kt(n,l[c]);for(c=0;c<d;++c)(u=e[c])&&f.get(m[c])===u&&(s[c]=u)}function as(n){return n.__data__}function ss(n,e){if(!arguments.length)return Array.from(this,as);var r=e?rs:is,o=this._parents,s=this._groups;typeof n!="function"&&(n=os(n));for(var l=s.length,a=new Array(l),c=new Array(l),u=new Array(l),f=0;f<l;++f){var d=o[f],g=s[f],m=g.length,v=ls(n.call(d,d&&d.__data__,f,o)),b=v.length,k=c[f]=new Array(b),A=a[f]=new Array(b),R=u[f]=new Array(m);r(d,g,k,A,R,v,e);for(var $=0,J=0,_,L;$<b;++$)if(_=k[$]){for($>=J&&(J=$+1);!(L=A[J])&&++J<b;);_._next=L||null}}return a=new xe(a,o),a._enter=c,a._exit=u,a}function ls(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function us(){return new xe(this._exit||this._groups.map(Ri),this._parents)}function cs(n,e,r){var o=this.enter(),s=this,l=this.exit();return typeof n=="function"?(o=n(o),o&&(o=o.selection())):o=o.append(n+""),e!=null&&(s=e(s),s&&(s=s.selection())),r==null?l.remove():r(l),o&&s?o.merge(s).order():s}function ds(n){for(var e=n.selection?n.selection():n,r=this._groups,o=e._groups,s=r.length,l=o.length,a=Math.min(s,l),c=new Array(s),u=0;u<a;++u)for(var f=r[u],d=o[u],g=f.length,m=c[u]=new Array(g),v,b=0;b<g;++b)(v=f[b]||d[b])&&(m[b]=v);for(;u<s;++u)c[u]=r[u];return new xe(c,this._parents)}function fs(){for(var n=this._groups,e=-1,r=n.length;++e<r;)for(var o=n[e],s=o.length-1,l=o[s],a;--s>=0;)(a=o[s])&&(l&&a.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(a,l),l=a);return this}function hs(n){n||(n=gs);function e(g,m){return g&&m?n(g.__data__,m.__data__):!g-!m}for(var r=this._groups,o=r.length,s=new Array(o),l=0;l<o;++l){for(var a=r[l],c=a.length,u=s[l]=new Array(c),f,d=0;d<c;++d)(f=a[d])&&(u[d]=f);u.sort(e)}return new xe(s,this._parents).order()}function gs(n,e){return n<e?-1:n>e?1:n>=e?0:NaN}function vs(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this}function ms(){return Array.from(this)}function ps(){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var o=n[e],s=0,l=o.length;s<l;++s){var a=o[s];if(a)return a}return null}function ys(){let n=0;for(const e of this)++n;return n}function xs(){return!this.node()}function _s(n){for(var e=this._groups,r=0,o=e.length;r<o;++r)for(var s=e[r],l=0,a=s.length,c;l<a;++l)(c=s[l])&&n.call(c,c.__data__,l,s);return this}function ws(n){return function(){this.removeAttribute(n)}}function bs(n){return function(){this.removeAttributeNS(n.space,n.local)}}function Es(n,e){return function(){this.setAttribute(n,e)}}function Ss(n,e){return function(){this.setAttributeNS(n.space,n.local,e)}}function Ns(n,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(n):this.setAttribute(n,r)}}function Cs(n,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,r)}}function Ms(n,e){var r=dn(n);if(arguments.length<2){var o=this.node();return r.local?o.getAttributeNS(r.space,r.local):o.getAttribute(r)}return this.each((e==null?r.local?bs:ws:typeof e=="function"?r.local?Cs:Ns:r.local?Ss:Es)(r,e))}function Vi(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function $s(n){return function(){this.style.removeProperty(n)}}function ks(n,e,r){return function(){this.style.setProperty(n,e,r)}}function Os(n,e,r){return function(){var o=e.apply(this,arguments);o==null?this.style.removeProperty(n):this.style.setProperty(n,o,r)}}function Is(n,e,r){return arguments.length>1?this.each((e==null?$s:typeof e=="function"?Os:ks)(n,e,r??"")):dt(this.node(),n)}function dt(n,e){return n.style.getPropertyValue(e)||Vi(n).getComputedStyle(n,null).getPropertyValue(e)}function Ts(n){return function(){delete this[n]}}function Ps(n,e){return function(){this[n]=e}}function Ds(n,e){return function(){var r=e.apply(this,arguments);r==null?delete this[n]:this[n]=r}}function As(n,e){return arguments.length>1?this.each((e==null?Ts:typeof e=="function"?Ds:Ps)(n,e)):this.node()[n]}function Hi(n){return n.trim().split(/^|\s+/)}function go(n){return n.classList||new Li(n)}function Li(n){this._node=n,this._names=Hi(n.getAttribute("class")||"")}Li.prototype={add:function(n){var e=this._names.indexOf(n);e<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var e=this._names.indexOf(n);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};function Fi(n,e){for(var r=go(n),o=-1,s=e.length;++o<s;)r.add(e[o])}function Gi(n,e){for(var r=go(n),o=-1,s=e.length;++o<s;)r.remove(e[o])}function zs(n){return function(){Fi(this,n)}}function Bs(n){return function(){Gi(this,n)}}function Rs(n,e){return function(){(e.apply(this,arguments)?Fi:Gi)(this,n)}}function Vs(n,e){var r=Hi(n+"");if(arguments.length<2){for(var o=go(this.node()),s=-1,l=r.length;++s<l;)if(!o.contains(r[s]))return!1;return!0}return this.each((typeof e=="function"?Rs:e?zs:Bs)(r,e))}function Hs(){this.textContent=""}function Ls(n){return function(){this.textContent=n}}function Fs(n){return function(){var e=n.apply(this,arguments);this.textContent=e??""}}function Gs(n){return arguments.length?this.each(n==null?Hs:(typeof n=="function"?Fs:Ls)(n)):this.node().textContent}function Ys(){this.innerHTML=""}function Xs(n){return function(){this.innerHTML=n}}function Us(n){return function(){var e=n.apply(this,arguments);this.innerHTML=e??""}}function Zs(n){return arguments.length?this.each(n==null?Ys:(typeof n=="function"?Us:Xs)(n)):this.node().innerHTML}function Ks(){this.nextSibling&&this.parentNode.appendChild(this)}function Ws(){return this.each(Ks)}function qs(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function js(){return this.each(qs)}function Qs(n){var e=typeof n=="function"?n:Di(n);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Js(){return null}function el(n,e){var r=typeof n=="function"?n:Di(n),o=e==null?Js:typeof e=="function"?e:ho(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),o.apply(this,arguments)||null)})}function tl(){var n=this.parentNode;n&&n.removeChild(this)}function nl(){return this.each(tl)}function ol(){var n=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(n,this.nextSibling):n}function il(){var n=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(n,this.nextSibling):n}function rl(n){return this.select(n?il:ol)}function al(n){return arguments.length?this.property("__data__",n):this.node().__data__}function sl(n){return function(e){n.call(this,e,this.__data__)}}function ll(n){return n.trim().split(/^|\s+/).map(function(e){var r="",o=e.indexOf(".");return o>=0&&(r=e.slice(o+1),e=e.slice(0,o)),{type:e,name:r}})}function ul(n){return function(){var e=this.__on;if(e){for(var r=0,o=-1,s=e.length,l;r<s;++r)l=e[r],(!n.type||l.type===n.type)&&l.name===n.name?this.removeEventListener(l.type,l.listener,l.options):e[++o]=l;++o?e.length=o:delete this.__on}}}function cl(n,e,r){return function(){var o=this.__on,s,l=sl(e);if(o){for(var a=0,c=o.length;a<c;++a)if((s=o[a]).type===n.type&&s.name===n.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=l,s.options=r),s.value=e;return}}this.addEventListener(n.type,l,r),s={type:n.type,name:n.name,value:e,listener:l,options:r},o?o.push(s):this.__on=[s]}}function dl(n,e,r){var o=ll(n+""),s,l=o.length,a;if(arguments.length<2){var c=this.node().__on;if(c){for(var u=0,f=c.length,d;u<f;++u)for(s=0,d=c[u];s<l;++s)if((a=o[s]).type===d.type&&a.name===d.name)return d.value}return}for(c=e?cl:ul,s=0;s<l;++s)this.each(c(o[s],e,r));return this}function Yi(n,e,r){var o=Vi(n),s=o.CustomEvent;typeof s=="function"?s=new s(e,r):(s=o.document.createEvent("Event"),r?(s.initEvent(e,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(e,!1,!1)),n.dispatchEvent(s)}function fl(n,e){return function(){return Yi(this,n,e)}}function hl(n,e){return function(){return Yi(this,n,e.apply(this,arguments))}}function gl(n,e){return this.each((typeof e=="function"?hl:fl)(n,e))}function*vl(){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var o=n[e],s=0,l=o.length,a;s<l;++s)(a=o[s])&&(yield a)}var Xi=[null];function xe(n,e){this._groups=n,this._parents=e}function $t(){return new xe([[document.documentElement]],Xi)}function ml(){return this}xe.prototype=$t.prototype={constructor:xe,select:Fa,selectAll:Ua,selectChild:qa,selectChildren:es,filter:ts,data:ss,enter:ns,exit:us,join:cs,merge:ds,selection:ml,order:fs,sort:hs,call:vs,nodes:ms,node:ps,size:ys,empty:xs,each:_s,attr:Ms,style:Is,property:As,classed:Vs,text:Gs,html:Zs,raise:Ws,lower:js,append:Qs,insert:el,remove:nl,clone:rl,datum:al,on:dl,dispatch:gl,[Symbol.iterator]:vl};function we(n){return typeof n=="string"?new xe([[document.querySelector(n)]],[document.documentElement]):new xe([[n]],Xi)}function pl(n){let e;for(;e=n.sourceEvent;)n=e;return n}function Ne(n,e){if(n=pl(n),e===void 0&&(e=n.currentTarget),e){var r=e.ownerSVGElement||e;if(r.createSVGPoint){var o=r.createSVGPoint();return o.x=n.clientX,o.y=n.clientY,o=o.matrixTransform(e.getScreenCTM().inverse()),[o.x,o.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[n.clientX-s.left-e.clientLeft,n.clientY-s.top-e.clientTop]}}return[n.pageX,n.pageY]}const yl={passive:!1},bt={capture:!0,passive:!1};function Nn(n){n.stopImmediatePropagation()}function it(n){n.preventDefault(),n.stopImmediatePropagation()}function Ui(n){var e=n.document.documentElement,r=we(n).on("dragstart.drag",it,bt);"onselectstart"in e?r.on("selectstart.drag",it,bt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Zi(n,e){var r=n.document.documentElement,o=we(n).on("dragstart.drag",null);e&&(o.on("click.drag",it,bt),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in r?o.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const It=n=>()=>n;function Xn(n,{sourceEvent:e,subject:r,target:o,identifier:s,active:l,x:a,y:c,dx:u,dy:f,dispatch:d}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:d}})}Xn.prototype.on=function(){var n=this._.on.apply(this._,arguments);return n===this._?this:n};function xl(n){return!n.ctrlKey&&!n.button}function _l(){return this.parentNode}function wl(n,e){return e??{x:n.x,y:n.y}}function bl(){return navigator.maxTouchPoints||"ontouchstart"in this}function El(){var n=xl,e=_l,r=wl,o=bl,s={},l=cn("start","drag","end"),a=0,c,u,f,d,g=0;function m(_){_.on("mousedown.drag",v).filter(o).on("touchstart.drag",A).on("touchmove.drag",R,yl).on("touchend.drag touchcancel.drag",$).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(_,L){if(!(d||!n.call(this,_,L))){var Y=J(this,e.call(this,_,L),_,L,"mouse");Y&&(we(_.view).on("mousemove.drag",b,bt).on("mouseup.drag",k,bt),Ui(_.view),Nn(_),f=!1,c=_.clientX,u=_.clientY,Y("start",_))}}function b(_){if(it(_),!f){var L=_.clientX-c,Y=_.clientY-u;f=L*L+Y*Y>g}s.mouse("drag",_)}function k(_){we(_.view).on("mousemove.drag mouseup.drag",null),Zi(_.view,f),it(_),s.mouse("end",_)}function A(_,L){if(n.call(this,_,L)){var Y=_.changedTouches,I=e.call(this,_,L),Le=Y.length,oe,G;for(oe=0;oe<Le;++oe)(G=J(this,I,_,L,Y[oe].identifier,Y[oe]))&&(Nn(_),G("start",_,Y[oe]))}}function R(_){var L=_.changedTouches,Y=L.length,I,Le;for(I=0;I<Y;++I)(Le=s[L[I].identifier])&&(it(_),Le("drag",_,L[I]))}function $(_){var L=_.changedTouches,Y=L.length,I,Le;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),I=0;I<Y;++I)(Le=s[L[I].identifier])&&(Nn(_),Le("end",_,L[I]))}function J(_,L,Y,I,Le,oe){var G=l.copy(),Z=Ne(oe||Y,L),Ee,We,K;if((K=r.call(_,new Xn("beforestart",{sourceEvent:Y,target:m,identifier:Le,active:a,x:Z[0],y:Z[1],dx:0,dy:0,dispatch:G}),I))!=null)return Ee=K.x-Z[0]||0,We=K.y-Z[1]||0,function ge(ne,le,Ae){var Ve=Z,fe;switch(ne){case"start":s[Le]=ge,fe=a++;break;case"end":delete s[Le],--a;case"drag":Z=Ne(Ae||le,L),fe=a;break}G.call(ne,_,new Xn(ne,{sourceEvent:le,subject:K,target:m,identifier:Le,active:fe,x:Z[0]+Ee,y:Z[1]+We,dx:Z[0]-Ve[0],dy:Z[1]-Ve[1],dispatch:G}),I)}}return m.filter=function(_){return arguments.length?(n=typeof _=="function"?_:It(!!_),m):n},m.container=function(_){return arguments.length?(e=typeof _=="function"?_:It(_),m):e},m.subject=function(_){return arguments.length?(r=typeof _=="function"?_:It(_),m):r},m.touchable=function(_){return arguments.length?(o=typeof _=="function"?_:It(!!_),m):o},m.on=function(){var _=l.on.apply(l,arguments);return _===l?m:_},m.clickDistance=function(_){return arguments.length?(g=(_=+_)*_,m):Math.sqrt(g)},m}function Ki(n){const e=ce(),r=toRef(e,"vueFlowRef"),o=toRef(e,"snapToGrid"),s=toRef(e,"snapGrid"),l=toRef(e,"noDragClassName"),a=toRef(e,"nodes"),c=toRef(e,"nodeExtent"),u=toRef(e,"viewport"),f=toRef(e,"autoPanOnNodeDrag"),d=toRef(e,"nodesDraggable"),g=toRef(e,"panBy"),m=toRef(e,"findNode"),v=toRef(e,"multiSelectionActive"),b=toRef(e,"nodesSelectionActive"),k=toRef(e,"selectNodesOnDrag"),A=toRef(e,"removeSelectedElements"),R=toRef(e,"addSelectedNodes"),$=toRef(e,"updateNodePositions"),J=toRef(e,"emits"),{onStart:_,onDrag:L,onStop:Y,el:I,disabled:Le,id:oe,selectable:G}=n,Z=ref(!1);let Ee=ref([]),We=ref(),K=ref(null),ge=ref({x:void 0,y:void 0}),ne=ref({x:0,y:0}),le=ref(null),Ae=ref(0),Ve=ref(!1),fe=ref({x:0,y:0});const Ze=Aa(),_e=({x:st,y:re})=>{ge.value={x:st,y:re};let ee=!1;if(Ee.value=Ee.value.map(N=>{const H={x:st-N.distance.x,y:re-N.distance.y};o.value&&(H.x=s.value[0]*Math.round(H.x/s.value[0]),H.y=s.value[1]*Math.round(H.y/s.value[1]));const{computedPosition:ae}=fo(N,H,J.value.error,c.value,N.parentNode?m.value(N.parentNode):void 0);return ee=ee||N.position.x!==ae.x||N.position.y!==ae.y,N.position=ae,N}),!!ee&&($.value(Ee.value,!0,!0),Z.value=!0,le.value)){const[N,H]=Sn({id:oe,dragItems:Ee.value,findNode:m.value});L({event:le.value,node:N,nodes:H})}},ut=()=>{if(!K.value)return;const[st,re]=Oi(ne.value,K.value);if(st!==0||re!==0){const ee={x:(ge.value.x??0)-st/u.value.zoom,y:(ge.value.y??0)-re/u.value.zoom};g.value({x:st,y:re},N=>{(Math.round(N.x)!==Math.round(fe.value.x)||Math.round(N.y)!==Math.round(fe.value.y))&&(_e(ee),fe.value=N,ge.value=ee)})}Ae.value=requestAnimationFrame(ut)};return watch([()=>se(Le),I],([st,re])=>{if(re){const ee=we(re);if(st)ee.on(".drag",null);else{const N=m.value(oe);We.value=El().on("start",H=>{var ae;!k.value&&!v.value&&N&&(N.selected||A.value()),N&&se(G)&&k.value&&Gn(N,v.value,R.value,A.value,b,!1,re);const Ce=Ze(H);if(ge.value=Ce,Ee.value=Oa(a.value,d.value,Ce,m.value,oe),Ee.value.length){const[ye,E]=Sn({id:oe,dragItems:Ee.value,findNode:m.value});_({event:H.sourceEvent,node:ye,nodes:E})}K.value=((ae=r.value)==null?void 0:ae.getBoundingClientRect())||null,ne.value=ot(H.sourceEvent,K.value)}).on("drag",H=>{const ae=Ze(H);!Ve.value&&f.value&&(Ve.value=!0,ut()),(ge.value.x!==ae.xSnapped||ge.value.y!==ae.ySnapped)&&Ee.value.length&&(le.value=H.sourceEvent,ne.value=ot(H.sourceEvent,K.value),_e(ae))}).on("end",H=>{if(Z.value=!1,Ve.value=!1,cancelAnimationFrame(Ae.value),Ee.value.length){$.value(Ee.value,!1,!1);const[ae,Ce]=Sn({id:oe,dragItems:Ee.value,findNode:m.value});Y({event:H.sourceEvent,node:ae,nodes:Ce})}}).filter(H=>{const ae=H.target;return!H.button&&(!l.value||!Bo(ae,`.${l.value}`,re)&&(!(N!=null&&N.dragHandle)||Bo(ae,N.dragHandle,re)))}),ee.call(We.value)}}}),Z}const Wi="vue-flow__node-desc",qi="vue-flow__edge-desc",Sl="vue-flow__aria-live",ji=["Enter"," ","Escape"],rt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};function Un(n){var e,r;const o=((r=(e=n.composedPath)==null?void 0:e.call(n))==null?void 0:r[0])||n.target,s=ze(o.hasAttribute)?o.hasAttribute("contenteditable"):!1,l=ze(o.closest)?o.closest(".nokey"):null;return["INPUT","SELECT","TEXTAREA"].includes(o==null?void 0:o.nodeName)||s||!!l}function Nl(n){return n.ctrlKey||n.metaKey||n.shiftKey}function Cl(n,e){return r=>n.some(o=>{const s=o.split("+").map(l=>l.trim().toLowerCase());return s.length===1?r.key===o:(e.add(r.key.toLowerCase()),s.every(l=>e.has(l)))})}const _t=(n,e)=>{const r=io(),o=ref(se(n)===!0),s=ref(!1),l=ref(new Set);return watch(o,()=>{e==null||e(o.value)}),watchEffect(()=>{let a=se(n);if(r&&typeof r.addEventListener<"u"&&oo(r,"blur",()=>{o.value=!1}),Tr(a)){o.value=a;return}Array.isArray(a)&&(a=Cl(a,l.value)),a&&(So(a,c=>{s.value=Nl(c),!(!s.value&&Un(c))&&(c.preventDefault(),o.value=!0)},{eventName:"keydown"}),So(a,c=>{if(o.value){if(!s.value&&Un(c))return;s.value=!1,l.value.clear(),o.value=!1}},{eventName:"keyup"}))}),o},Ml=defineComponent({name:"Node",compatConfig:{MODE:3},props:["name","type","id","draggable","selectable","focusable","connectable","node","resizeObserver"],setup(n){provide(Ni,n.id);const e=ce(),r=toRef(e,"id"),o=toRef(e,"edges"),s=toRef(e,"noPanClassName"),l=toRef(e,"selectNodesOnDrag"),a=toRef(e,"nodesSelectionActive"),c=toRef(e,"multiSelectionActive"),u=toRef(e,"emits"),f=toRef(e,"findNode"),d=toRef(e,"removeSelectedNodes"),g=toRef(e,"addSelectedNodes"),m=toRef(e,"updateNodeDimensions"),v=toRef(e,"onUpdateNodeInternals"),b=toRef(e,"getIntersectingNodes"),k=toRef(e,"getNodeTypes"),A=toRef(e,"nodeExtent"),R=toRef(e,"elevateNodesOnSelect"),$=toRef(e,"disableKeyboardA11y"),J=toRef(e,"ariaLiveMessage"),_=toRef(e,"snapToGrid"),L=toRef(e,"snapGrid"),Y=Pi(),I=yt(n,"node"),Le=computed(()=>f.value(I.value.parentNode)),oe=computed(()=>rn([I.value],o.value)),G=ref();provide(Ci,G);const{emit:Z,on:Ee}=Da(I.value,u.value),We=Ki({id:n.id,el:G,disabled:()=>!n.draggable,selectable:()=>n.selectable,onStart(ee){Z.dragStart({...ee,intersections:b.value(I.value)})},onDrag(ee){Z.drag({...ee,intersections:b.value(I.value)})},onStop(ee){Z.dragStop({...ee,intersections:b.value(I.value)})}}),K=computed(()=>I.value.class instanceof Function?I.value.class(I.value):I.value.class),ge=computed(()=>{const ee=(I.value.style instanceof Function?I.value.style(I.value):I.value.style)||{},N=I.value.width instanceof Function?I.value.width(I.value):I.value.width,H=I.value.height instanceof Function?I.value.height(I.value):I.value.height;return N&&(ee.width=typeof N=="string"?N:`${N}px`),H&&(ee.height=typeof H=="string"?H:`${H}px`),ee}),ne=()=>Number(I.value.zIndex??ge.value.zIndex??0);return v.value(ee=>{ee.includes(n.id)&&Ae()}),onMounted(()=>{n.resizeObserver.observe(G.value)}),onBeforeUnmount(()=>{n.resizeObserver.unobserve(G.value)}),watch([()=>I.value.type,()=>I.value.sourcePosition,()=>I.value.targetPosition],()=>{m.value([{id:n.id,nodeElement:G.value,forceUpdate:!0}])},{flush:"pre"}),watch([()=>I.value.position.x,()=>I.value.position.y,()=>{var ee;return(ee=Le.value)==null?void 0:ee.computedPosition.x},()=>{var ee;return(ee=Le.value)==null?void 0:ee.computedPosition.y},()=>{var ee;return(ee=Le.value)==null?void 0:ee.computedPosition.z},()=>ne(),()=>I.value.selected,()=>I.value.dimensions.height,()=>I.value.dimensions.width,()=>{var ee;return(ee=Le.value)==null?void 0:ee.dimensions.height},()=>{var ee;return(ee=Le.value)==null?void 0:ee.dimensions.width}],([ee,N,H,ae,Ce,ye])=>{const E={x:ee,y:N,z:ye+(R.value&&I.value.selected?1e3:0)};Te(H)&&Te(ae)?I.value.computedPosition=ha({x:H,y:ae,z:Ce},E):I.value.computedPosition=E},{flush:"pre",immediate:!0}),watch([()=>I.value.extent,()=>A.value],([ee,N],[H,ae])=>{(ee!==H||N!==ae)&&le()}),I.value.extent==="parent"||typeof I.value.extent=="object"&&"range"in I.value.extent&&I.value.extent.range==="parent"?pe(()=>I.value.initialized).toBe(!0).then(le):le(),()=>h$1("div",{ref:G,"data-id":I.value.id,class:["vue-flow__node",`vue-flow__node-${n.type===!1?"default":n.name}`,{[s.value]:n.draggable,dragging:We==null?void 0:We.value,selected:I.value.selected,selectable:n.selectable},K.value],style:{zIndex:I.value.computedPosition.z??ne(),transform:`translate(${I.value.computedPosition.x}px,${I.value.computedPosition.y}px)`,pointerEvents:n.selectable||n.draggable?"all":"none",visibility:I.value.initialized?"visible":"hidden",...ge.value},tabIndex:n.focusable?0:void 0,role:n.focusable?"button":void 0,"aria-describedby":$.value?void 0:`${Wi}-${r.value}`,"aria-label":I.value.ariaLabel,onMouseenter:Ve,onMousemove:fe,onMouseleave:Ze,onContextmenu:_e,onClick:st,onDblclick:ut,onKeydown:re},[h$1(n.type===!1?k.value.default:n.type,{id:I.value.id,type:I.value.type,data:I.value.data,events:{...I.value.events,...Ee},selected:!!I.value.selected,resizing:!!I.value.resizing,dragging:We.value,connectable:n.connectable,position:I.value.position,dimensions:I.value.dimensions,isValidTargetPos:I.value.isValidTargetPos,isValidSourcePos:I.value.isValidSourcePos,parent:I.value.parentNode,zIndex:I.value.computedPosition.z,targetPosition:I.value.targetPosition,sourcePosition:I.value.sourcePosition,label:I.value.label,dragHandle:I.value.dragHandle,onUpdateNodeInternals:Ae})]);function le(){const ee=I.value.computedPosition;_.value&&(ee.x=L.value[0]*Math.round(ee.x/L.value[0]),ee.y=L.value[1]*Math.round(ee.y/L.value[1]));const{computedPosition:N,position:H}=fo(I.value,ee,u.value.error,A.value,Le.value);(I.value.computedPosition.x!==N.x||I.value.computedPosition.y!==N.y)&&(I.value.computedPosition={...I.value.computedPosition,...N}),(I.value.position.x!==H.x||I.value.position.y!==H.y)&&(I.value.position=H)}function Ae(){G.value&&m.value([{id:n.id,nodeElement:G.value,forceUpdate:!0}])}function Ve(ee){We!=null&&We.value||Z.mouseEnter({event:ee,node:I.value,connectedEdges:oe.value})}function fe(ee){We!=null&&We.value||Z.mouseMove({event:ee,node:I.value,connectedEdges:oe.value})}function Ze(ee){We!=null&&We.value||Z.mouseLeave({event:ee,node:I.value,connectedEdges:oe.value})}function _e(ee){return Z.contextMenu({event:ee,node:I.value,connectedEdges:oe.value})}function ut(ee){return Z.doubleClick({event:ee,node:I.value,connectedEdges:oe.value})}function st(ee){n.selectable&&(!l.value||!n.draggable)&&Gn(I.value,c.value,g.value,d.value,a,!1,G.value),Z.click({event:ee,node:I.value,connectedEdges:oe.value})}function re(ee){var N;if(!Un(ee))if(ji.includes(ee.key)&&n.selectable){const H=ee.key==="Escape";H&&((N=G.value)==null||N.blur()),Gn(I.value,c.value,g.value,d.value,a,H,G.value)}else!$.value&&n.draggable&&I.value.selected&&rt[ee.key]&&(J.value=`Moved selected node ${ee.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~I.value.position.x}, y: ${~~I.value.position.y}`,Y({x:rt[ee.key].x,y:rt[ee.key].y},ee.shiftKey))}}}),$l=Ml,kl=["transform"],Ol=["width","height","x","y","rx","ry"],Il=["y"],Tl={name:"EdgeText",compatConfig:{MODE:3}},Pl=defineComponent({...Tl,props:{x:null,y:null,label:null,labelStyle:{default:{}},labelShowBg:{type:Boolean,default:!0},labelBgStyle:{default:{}},labelBgPadding:{default:[2,4]},labelBgBorderRadius:{default:2}},setup(n){let e=ref({x:0,y:0,width:0,height:0});const r=ref(null),o=computed(()=>`translate(${n.x-e.value.width/2} ${n.y-e.value.height/2})`);onMounted(s),watch([()=>n.x,()=>n.y,r,()=>n.label],s);function s(){if(!r.value)return;const l=r.value.getBBox();(l.width!==e.value.width||l.height!==e.value.height)&&(e.value=l)}return(l,a)=>(openBlock(),createElementBlock("g",{transform:unref(o),class:"vue-flow__edge-textwrapper"},[n.labelShowBg?(openBlock(),createElementBlock("rect",{key:0,class:"vue-flow__edge-textbg",width:`${unref(e).width+2*n.labelBgPadding[0]}px`,height:`${unref(e).height+2*n.labelBgPadding[1]}px`,x:-n.labelBgPadding[0],y:-n.labelBgPadding[1],style:normalizeStyle(n.labelBgStyle),rx:n.labelBgBorderRadius,ry:n.labelBgBorderRadius},null,12,Ol)):createCommentVNode("",!0),createBaseVNode("text",mergeProps(l.$attrs,{ref_key:"el",ref:r,class:"vue-flow__edge-text",y:unref(e).height/2,dy:"0.3em",style:n.labelStyle}),[renderSlot(l.$slots,"default",{},()=>[unref(Pe)(n.label)?(openBlock(),createElementBlock(Fragment,{key:1},[createTextVNode(toDisplayString(n.label),1)],64)):(openBlock(),createBlock(resolveDynamicComponent(n.label),{key:0}))])],16,Il)],8,kl))}}),fn=function({path:n,label:e,labelX:r,labelY:o,labelBgBorderRadius:s,labelBgPadding:l,labelBgStyle:a,labelShowBg:c=!0,labelStyle:u,markerStart:f,markerEnd:d,interactionWidth:g=20},{attrs:m}){return[h$1("path",{style:m.style,class:["vue-flow__edge-path",m.class].join(" "),d:n,"marker-end":d,"marker-start":f}),g?h$1("path",{d:n,fill:"none","stroke-opacity":0,"stroke-width":g}):null,e&&Te(r)&&Te(o)?h$1(Pl,{x:r,y:o,label:e,labelStyle:u,labelShowBg:c,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:s}):null]};fn.props=["path","labelX","labelY","label","labelBgBorderRadius","labelBgPadding","labelBgStyle","labelShowBg","labelStyle","markerStart","markerEnd","interactionWidth"];fn.inheritAttrs=!1;fn.compatConfig={MODE:3};const hn=fn;function Qi({sourceX:n,sourceY:e,targetX:r,targetY:o}){const s=Math.abs(r-n)/2,l=r<n?r+s:r-s,a=Math.abs(o-e)/2,c=o<e?o+a:o-a;return[l,c,s,a]}function Ji({sourceX:n,sourceY:e,targetX:r,targetY:o,sourceControlX:s,sourceControlY:l,targetControlX:a,targetControlY:c}){const u=n*.125+s*.375+a*.375+r*.125,f=e*.125+l*.375+c*.375+o*.125,d=Math.abs(u-n),g=Math.abs(f-e);return[u,f,d,g]}function Tt(n,e){return n>=0?.5*n:e*25*Math.sqrt(-n)}function Lo({pos:n,x1:e,y1:r,x2:o,y2:s,c:l}){let a,c;switch(n){case Q.Left:a=e-Tt(e-o,l),c=r;break;case Q.Right:a=e+Tt(o-e,l),c=r;break;case Q.Top:a=e,c=r-Tt(r-s,l);break;case Q.Bottom:a=e,c=r+Tt(s-r,l);break}return[a,c]}function Zn({sourceX:n,sourceY:e,sourcePosition:r=Q.Bottom,targetX:o,targetY:s,targetPosition:l=Q.Top,curvature:a=.25}){const[c,u]=Lo({pos:r,x1:n,y1:e,x2:o,y2:s,c:a}),[f,d]=Lo({pos:l,x1:o,y1:s,x2:n,y2:e,c:a}),[g,m,v,b]=Ji({sourceX:n,sourceY:e,targetX:o,targetY:s,sourceControlX:c,sourceControlY:u,targetControlX:f,targetControlY:d});return[`M${n},${e} C${c},${u} ${f},${d} ${o},${s}`,g,m,v,b]}const gn=function({sourcePosition:n=Q.Bottom,targetPosition:e=Q.Top,...r},{attrs:o}){const[s,l,a]=Zn({sourcePosition:n,targetPosition:e,...r});return h$1(hn,{path:s,labelX:l,labelY:a,...r,...o})};gn.props=["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","curvature","markerEnd","markerStart","interactionWidth"];gn.inheritAttrs=!1;gn.compatConfig={MODE:3};const Dl=gn;function Fo({pos:n,x1:e,y1:r,x2:o,y2:s}){let l,a;switch(n){case Q.Left:case Q.Right:l=.5*(e+o),a=r;break;case Q.Top:case Q.Bottom:l=e,a=.5*(r+s);break}return[l,a]}function er({sourceX:n,sourceY:e,sourcePosition:r=Q.Bottom,targetX:o,targetY:s,targetPosition:l=Q.Top}){const[a,c]=Fo({pos:r,x1:n,y1:e,x2:o,y2:s}),[u,f]=Fo({pos:l,x1:o,y1:s,x2:n,y2:e}),[d,g,m,v]=Ji({sourceX:n,sourceY:e,targetX:o,targetY:s,sourceControlX:a,sourceControlY:c,targetControlX:u,targetControlY:f});return[`M${n},${e} C${a},${c} ${u},${f} ${o},${s}`,d,g,m,v]}const vn=function({sourcePosition:n=Q.Bottom,targetPosition:e=Q.Top,...r},{attrs:o}){const[s,l,a]=er({sourcePosition:n,targetPosition:e,...r});return h$1(hn,{path:s,labelX:l,labelY:a,...r,...o})};vn.props=["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"];vn.inheritAttrs=!1;vn.compatConfig={MODE:3};const Al=vn,Go={[Q.Left]:{x:-1,y:0},[Q.Right]:{x:1,y:0},[Q.Top]:{x:0,y:-1},[Q.Bottom]:{x:0,y:1}};function zl({source:n,sourcePosition:e=Q.Bottom,target:r}){return e===Q.Left||e===Q.Right?n.x<r.x?{x:1,y:0}:{x:-1,y:0}:n.y<r.y?{x:0,y:1}:{x:0,y:-1}}function Yo(n,e){return Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2)}function Bl({source:n,sourcePosition:e=Q.Bottom,target:r,targetPosition:o=Q.Top,center:s,offset:l}){const a=Go[e],c=Go[o],u={x:n.x+a.x*l,y:n.y+a.y*l},f={x:r.x+c.x*l,y:r.y+c.y*l},d=zl({source:u,sourcePosition:e,target:f}),g=d.x!==0?"x":"y",m=d[g];let v,b,k;const[A,R,$,J]=Qi({sourceX:n.x,sourceY:n.y,targetX:r.x,targetY:r.y});if(a[g]*c[g]===-1){b=s.x||A,k=s.y||R;const _=[{x:b,y:u.y},{x:b,y:f.y}],L=[{x:u.x,y:k},{x:f.x,y:k}];a[g]===m?v=g==="x"?_:L:v=g==="x"?L:_}else{const _=[{x:u.x,y:f.y}],L=[{x:f.x,y:u.y}];if(g==="x"?v=a.x===m?L:_:v=a.y===m?_:L,e!==o){const Y=g==="x"?"y":"x",I=a[g]===c[Y],Le=u[Y]>f[Y],oe=u[Y]<f[Y];(a[g]===1&&(!I&&Le||I&&oe)||a[g]!==1&&(!I&&oe||I&&Le))&&(v=g==="x"?_:L)}b=v[0].x,k=v[0].y}return[[n,u,...v,f,r],b,k,$,J]}function Rl(n,e,r,o){const s=Math.min(Yo(n,e)/2,Yo(e,r)/2,o),{x:l,y:a}=e;if(n.x===l&&l===r.x||n.y===a&&a===r.y)return`L${l} ${a}`;if(n.y===a){const f=n.x<r.x?-1:1,d=n.y<r.y?1:-1;return`L ${l+s*f},${a}Q ${l},${a} ${l},${a+s*d}`}const c=n.x<r.x?1:-1,u=n.y<r.y?-1:1;return`L ${l},${a+s*u}Q ${l},${a} ${l+s*c},${a}`}function Kn({sourceX:n,sourceY:e,sourcePosition:r=Q.Bottom,targetX:o,targetY:s,targetPosition:l=Q.Top,borderRadius:a=5,centerX:c,centerY:u,offset:f=20}){const[d,g,m,v,b]=Bl({source:{x:n,y:e},sourcePosition:r,target:{x:o,y:s},targetPosition:l,center:{x:c,y:u},offset:f});return[d.reduce((k,A,R)=>{let $;return R>0&&R<d.length-1?$=Rl(d[R-1],A,d[R+1],a):$=`${R===0?"M":"L"}${A.x} ${A.y}`,k+=$,k},""),g,m,v,b]}const mn=function({sourcePosition:n=Q.Bottom,targetPosition:e=Q.Top,...r},{attrs:o}){const[s,l,a]=Kn({sourcePosition:n,targetPosition:e,...r});return h$1(hn,{path:s,labelX:l,labelY:a,...r,...o})};mn.props=["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","borderRadius","markerEnd","markerStart","interactionWidth","offset"];mn.inheritAttrs=!1;mn.compatConfig={MODE:3};const tr=mn,pn=function(n,{attrs:e}){return h$1(tr,{...n,...e,borderRadius:0})};pn.props=["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"];pn.inheritAttrs=!1;pn.compatConfig={MODE:3};const Vl=pn;function nr({sourceX:n,sourceY:e,targetX:r,targetY:o}){const[s,l,a,c]=Qi({sourceX:n,sourceY:e,targetX:r,targetY:o});return[`M ${n},${e}L ${r},${o}`,s,l,a,c]}const yn=function(n,{attrs:e}){const[r,o,s]=nr(n);return h$1(hn,{path:r,labelX:o,labelY:s,...n,...e})};yn.props=["label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"];yn.inheritAttrs=!1;yn.compatConfig={MODE:3};const Hl=yn;function Ll(n,e,r){return r===Q.Left?n-e:r===Q.Right?n+e:n}function Fl(n,e,r){return r===Q.Top?n-e:r===Q.Bottom?n+e:n}const vo=function({radius:n=10,centerX:e=0,centerY:r=0,position:o=Q.Top,type:s}){return h$1("circle",{class:`vue-flow__edgeupdater vue-flow__edgeupdater-${s}`,cx:Ll(e,n,o),cy:Fl(r,n,o),r:n,stroke:"transparent",fill:"transparent"})};vo.props=["radius","centerX","centerY","position","type"];vo.compatConfig={MODE:3};const Xo=vo;function Gl(){return{doubleClick:X(),click:X(),mouseEnter:X(),mouseMove:X(),mouseLeave:X(),contextMenu:X(),updateStart:X(),update:X(),updateEnd:X()}}function Yl(n,e){const r=Gl();return r.doubleClick.on(o=>{var s,l;e.edgeDoubleClick(o),(l=(s=n.events)==null?void 0:s.doubleClick)==null||l.call(s,o)}),r.click.on(o=>{var s,l;e.edgeClick(o),(l=(s=n.events)==null?void 0:s.click)==null||l.call(s,o)}),r.mouseEnter.on(o=>{var s,l;e.edgeMouseEnter(o),(l=(s=n.events)==null?void 0:s.mouseEnter)==null||l.call(s,o)}),r.mouseMove.on(o=>{var s,l;e.edgeMouseMove(o),(l=(s=n.events)==null?void 0:s.mouseMove)==null||l.call(s,o)}),r.mouseLeave.on(o=>{var s,l;e.edgeMouseLeave(o),(l=(s=n.events)==null?void 0:s.mouseLeave)==null||l.call(s,o)}),r.contextMenu.on(o=>{var s,l;e.edgeContextMenu(o),(l=(s=n.events)==null?void 0:s.contextMenu)==null||l.call(s,o)}),r.updateStart.on(o=>{var s,l;e.edgeUpdateStart(o),(l=(s=n.events)==null?void 0:s.updateStart)==null||l.call(s,o)}),r.update.on(o=>{var s,l;e.edgeUpdate(o),(l=(s=n.events)==null?void 0:s.update)==null||l.call(s,o)}),r.updateEnd.on(o=>{var s,l;e.edgeUpdateEnd(o),(l=(s=n.events)==null?void 0:s.updateEnd)==null||l.call(s,o)}),Object.entries(r).reduce((o,[s,l])=>(o.emit[s]=l.trigger,o.on[s]=l.on,o),{emit:{},on:{}})}const Xl=defineComponent({name:"Edge",compatConfig:{MODE:3},props:["name","type","id","updatable","selectable","focusable","edge"],setup(n){const{id:e,addSelectedEdges:r,connectionMode:o,edgeUpdaterRadius:s,emits:l,nodesSelectionActive:a,noPanClassName:c,getEdgeTypes:u,removeSelectedEdges:f,findEdge:d,findNode:g,isValidConnection:m}=ce(),v=Yl(n.edge,l),b=yt(n,"edge");let k=ref(!1),A=ref(!1);const R=ref(""),$=ref(null),J=ref("source"),_=ref();provide(Mi,n.id),provide($i,_);const L=computed(()=>b.value.class instanceof Function?b.value.class(b.value):b.value.class),Y=computed(()=>b.value.style instanceof Function?b.value.style(b.value):b.value.style),{handlePointerDown:I}=Ii({nodeId:R,handleId:$,type:J,isValidConnection:m.value,edgeUpdaterType:J,onEdgeUpdate:G,onEdgeUpdateEnd:Z});return()=>{const _e=g(b.value.source),ut=g(b.value.target);if(!_e||!ut||!b.value)return null;let st;o.value===je.Strict?st=_e.handleBounds.source:st=[..._e.handleBounds.source||[],..._e.handleBounds.target||[]];const re=Po(st,b.value.sourceHandle);let ee;o.value===je.Strict?ee=ut.handleBounds.target:ee=[...ut.handleBounds.target||[],...ut.handleBounds.source||[]];const N=Po(ee,b.value.targetHandle),H=re?re.position:Q.Bottom,ae=N?N.position:Q.Top,{sourceX:Ce,sourceY:ye,targetY:E,targetX:M}=ya(_e,re,H,ut,N,ae);return b.value.sourceX=Ce,b.value.sourceY=ye,b.value.targetX=M,b.value.targetY=E,h$1("g",{ref:_,key:n.id,"data-id":n.id,class:["vue-flow__edge",`vue-flow__edge-${n.type===!1?"default":n.name}`,c.value,L.value,{updating:k.value,selected:b.value.selected,animated:b.value.animated,inactive:!n.selectable}],onClick:We,onContextmenu:K,onDblclick:ge,onMouseenter:ne,onMousemove:le,onMouseleave:Ae,onKeyDown:n.focusable?Ze:void 0,tabIndex:n.focusable?0:void 0,"aria-label":b.value.ariaLabel===null?void 0:b.value.ariaLabel||`Edge from ${b.value.source} to ${b.value.target}`,"aria-describedby":n.focusable?`${qi}-${e}`:void 0,role:n.focusable?"button":void 0},[A.value?null:h$1(n.type===!1?u.value.default:n.type,{id:n.id,sourceNode:_e,targetNode:ut,source:b.value.source,target:b.value.target,type:b.value.type,updatable:n.updatable,selected:b.value.selected,animated:b.value.animated,label:b.value.label,labelStyle:b.value.labelStyle,labelShowBg:b.value.labelShowBg,labelBgStyle:b.value.labelBgStyle,labelBgPadding:b.value.labelBgPadding,labelBgBorderRadius:b.value.labelBgBorderRadius,data:b.value.data,events:{...b.value.events,...v.on},style:Y.value,markerStart:`url(#${Xe(b.value.markerStart,e)})`,markerEnd:`url(#${Xe(b.value.markerEnd,e)})`,sourcePosition:H,targetPosition:ae,sourceX:Ce,sourceY:ye,targetX:M,targetY:E,sourceHandleId:b.value.sourceHandle,targetHandleId:b.value.targetHandle,interactionWidth:b.value.interactionWidth}),[n.updatable==="source"||n.updatable===!0?[h$1("g",{onMousedown:Ve,onMouseenter:Le,onMouseout:oe},h$1(Xo,{position:H,centerX:Ce,centerY:ye,radius:s.value,type:"source","data-type":"source"}))]:null,n.updatable==="target"||n.updatable===!0?[h$1("g",{onMousedown:fe,onMouseenter:Le,onMouseout:oe},h$1(Xo,{position:ae,centerX:M,centerY:E,radius:s.value,type:"target","data-type":"target"}))]:null]])};function Le(){k.value=!0}function oe(){k.value=!1}function G(_e,ut){v.emit.update({event:_e,edge:b.value,connection:ut})}function Z(_e){v.emit.updateEnd({event:_e,edge:b.value}),A.value=!1}function Ee(_e,ut){_e.button===0&&(A.value=!0,R.value=ut?b.value.target:b.value.source,$.value=(ut?b.value.targetHandle:b.value.sourceHandle)??"",J.value=ut?"target":"source",v.emit.updateStart({event:_e,edge:b.value}),I(_e))}function We(_e){const ut={event:_e,edge:b.value};n.selectable&&(a.value=!1,r([b.value])),v.emit.click(ut)}function K(_e){v.emit.contextMenu({event:_e,edge:b.value})}function ge(_e){v.emit.doubleClick({event:_e,edge:b.value})}function ne(_e){v.emit.mouseEnter({event:_e,edge:b.value})}function le(_e){v.emit.mouseMove({event:_e,edge:b.value})}function Ae(_e){v.emit.mouseLeave({event:_e,edge:b.value})}function Ve(_e){Ee(_e,!0)}function fe(_e){Ee(_e,!1)}function Ze(_e){var ut;ji.includes(_e.key)&&n.selectable&&(_e.key==="Escape"?((ut=_.value)==null||ut.blur(),f([d(n.id)])):r([d(n.id)]))}}}),Ul=Xl,Wl={class:"vue-flow__connection"},ql=["d","marker-end","marker-start"],jl={name:"ConnectionLine",compatConfig:{MODE:3}},Ql=defineComponent({...jl,props:{sourceNode:null},setup(n){var e;const r=ce(),o=toRef(r,"connectionMode"),s=toRef(r,"connectionStartHandle"),l=toRef(r,"connectionEndHandle"),a=toRef(r,"connectionPosition"),c=toRef(r,"connectionLineType"),u=toRef(r,"connectionLineStyle"),f=toRef(r,"connectionLineOptions"),d=toRef(r,"connectionStatus"),g=toRef(r,"viewport"),m=toRef(r,"findNode"),v={[Q.Left]:Q.Right,[Q.Right]:Q.Left,[Q.Top]:Q.Bottom,[Q.Bottom]:Q.Top},b=(e=inject(an))==null?void 0:e["connection-line"],k=computed(()=>s.value.handleId),A=computed(()=>s.value.type),R=computed(()=>{var G;return((G=l.value)==null?void 0:G.handleId)&&m.value(l.value.nodeId)||null}),$=computed(()=>{var G,Z;return(o.value===je.Strict?(G=n.sourceNode.handleBounds[A.value])==null?void 0:G.find(Ee=>Ee.id===k.value):[...n.sourceNode.handleBounds.source||[],...n.sourceNode.handleBounds.target||[]].find(Ee=>Ee.id===k.value))||((Z=n.sourceNode.handleBounds[A.value??"source"])==null?void 0:Z[0])}),J=computed(()=>{var G,Z,Ee;return R.value&&((G=l.value)==null?void 0:G.handleId)&&((o.value===je.Strict?(Z=R.value.handleBounds[A.value==="source"?"target":"source"])==null?void 0:Z.find(We=>{var K;return We.id===((K=l.value)==null?void 0:K.handleId)}):[...R.value.handleBounds.source||[],...R.value.handleBounds.target||[]].find(We=>{var K;return We.id===((K=l.value)==null?void 0:K.handleId)}))||((Ee=R.value.handleBounds[A.value??"target"])==null?void 0:Ee[0]))||null}),_=computed(()=>{var G;return(G=$.value)==null?void 0:G.position}),L=computed(()=>$.value?Ut(_.value||Q.Top,{...n.sourceNode.dimensions,...n.sourceNode.computedPosition},$.value):{x:n.sourceNode.dimensions.width/2,y:n.sourceNode.dimensions.height/2}),Y=computed(()=>_.value?v[_.value]:void 0),I=computed(()=>(a.value.x-g.value.x)/g.value.zoom),Le=computed(()=>(a.value.y-g.value.y)/g.value.zoom),oe=computed(()=>{let G;const Z={sourceX:L.value.x,sourceY:L.value.y,sourcePosition:_.value,targetX:I.value,targetY:Le.value,targetPosition:Y.value};switch(c.value??f.value.type){case Ye.Bezier:[G]=Zn(Z);break;case Ye.Step:[G]=Kn({...Z,borderRadius:0});break;case Ye.SmoothStep:[G]=Kn(Z);break;case Ye.SimpleBezier:[G]=er(Z);break;case Ye.Straight:[G]=nr(Z);break;default:[G]=Zn(Z);break}return G});return(G,Z)=>{var Ee;return openBlock(),createElementBlock("g",Wl,[unref(b)?(openBlock(),createBlock(resolveDynamicComponent(unref(b)),normalizeProps(mergeProps({key:0},{sourceX:unref(L).x,sourceY:unref(L).y,sourcePosition:(Ee=unref($))==null?void 0:Ee.position,targetX:unref(I),targetY:unref(Le),targetPosition:unref(Y),sourceNode:n.sourceNode,sourceHandle:unref($),targetNode:unref(R),targetHandle:unref(J),markerEnd:`url(#${unref(Xe)(unref(f).markerEnd)})`,markerStart:`url(#${unref(Xe)(unref(f).markerStart)})`,connectionStatus:unref(d)})),null,16)):(openBlock(),createElementBlock("path",{key:1,d:unref(oe),class:normalizeClass(["vue-flow__connection-path",[unref(f).class,unref(d)]]),style:normalizeStyle(unref(u)||unref(f).style||{}),"marker-end":`url(#${unref(Xe)(unref(f).markerEnd)})`,"marker-start":`url(#${unref(Xe)(unref(f).markerStart)})`},null,14,ql))])}}}),Jl=["tabIndex"],eu={name:"NodesSelection",compatConfig:{MODE:3}},tu=defineComponent({...eu,setup(n){const e=ce(),r=toRef(e,"emits"),o=toRef(e,"viewport"),s=toRef(e,"getSelectedNodes"),l=toRef(e,"noPanClassName"),a=toRef(e,"disableKeyboardA11y"),c=toRef(e,"userSelectionActive"),u=Pi(),f=ref(),d=Ki({el:f,onStart(k){r.value.selectionDragStart(k)},onDrag(k){r.value.selectionDrag(k)},onStop(k){r.value.selectionDragStop(k)}});onMounted(()=>{var k;a.value||(k=f.value)==null||k.focus({preventScroll:!0})});const g=computed(()=>lo(s.value)),m=computed(()=>({width:`${g.value.width}px`,height:`${g.value.height}px`,top:`${g.value.y}px`,left:`${g.value.x}px`}));function v(k){r.value.selectionContextMenu({event:k,nodes:s.value})}function b(k){a.value||rt[k.key]&&u({x:rt[k.key].x,y:rt[k.key].y},k.shiftKey)}return(k,A)=>!unref(c)&&unref(g).width&&unref(g).height?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["vue-flow__nodesselection vue-flow__container",unref(l)]),style:normalizeStyle({transform:`translate(${unref(o).x}px,${unref(o).y}px) scale(${unref(o).zoom})`})},[createBaseVNode("div",{ref_key:"el",ref:f,class:normalizeClass([{dragging:unref(d)},"vue-flow__nodesselection-rect"]),style:normalizeStyle(unref(m)),tabIndex:unref(a)?void 0:-1,onContextmenu:v,onKeydown:b},null,46,Jl)],6)):createCommentVNode("",!0)}}),nu={name:"UserSelection",compatConfig:{MODE:3}},ou=defineComponent({...nu,setup(n){const{userSelectionRect:e}=ce();return(r,o)=>{var s,l,a,c;return openBlock(),createElementBlock("div",{class:"vue-flow__selection vue-flow__container",style:normalizeStyle({width:`${(s=unref(e))==null?void 0:s.width}px`,height:`${(l=unref(e))==null?void 0:l.height}px`,transform:`translate(${(a=unref(e))==null?void 0:a.x}px, ${(c=unref(e))==null?void 0:c.y}px)`})},null,4)}}}),iu={input:$a,default:Ma,output:ka},ru={default:Dl,straight:Hl,step:Vl,smoothstep:tr,simplebezier:Al};function au(){return{vueFlowRef:null,viewportRef:null,nodes:[],edges:[],nodeTypes:{},edgeTypes:{},initialized:!1,dimensions:{width:0,height:0},viewport:{x:0,y:0,zoom:1},d3Zoom:null,d3Selection:null,d3ZoomHandler:null,minZoom:.5,maxZoom:2,translateExtent:[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],nodeExtent:[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],selectionMode:uo.Full,paneDragging:!1,preventScrolling:!0,zoomOnScroll:!0,zoomOnPinch:!0,zoomOnDoubleClick:!0,panOnScroll:!1,panOnScrollSpeed:.5,panOnScrollMode:Xt.Free,panOnDrag:!0,edgeUpdaterRadius:10,onlyRenderVisibleElements:!1,defaultViewport:{x:0,y:0,zoom:1},nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,defaultMarkerColor:"#b1b1b7",connectionLineStyle:{},connectionLineType:null,connectionLineOptions:{type:Ye.Bezier,style:{}},connectionMode:je.Loose,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectionPosition:{x:NaN,y:NaN},connectionRadius:20,connectOnClick:!0,connectionStatus:null,isValidConnection:null,snapGrid:[15,15],snapToGrid:!1,edgesUpdatable:!1,edgesFocusable:!0,nodesFocusable:!0,nodesConnectable:!0,nodesDraggable:!0,elementsSelectable:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,selectionKeyCode:"Shift",multiSelectionKeyCode:"Meta",zoomActivationKeyCode:"Meta",deleteKeyCode:"Backspace",panActivationKeyCode:"Space",hooks:sa(),applyDefault:!0,autoConnect:!1,fitViewOnInit:!1,noDragClassName:"nodrag",noWheelClassName:"nowheel",noPanClassName:"nopan",defaultEdgeOptions:void 0,elevateEdgesOnSelect:!1,elevateNodesOnSelect:!0,autoPanOnNodeDrag:!0,autoPanOnConnect:!0,disableKeyboardA11y:!1,ariaLiveMessage:"",__experimentalFeatures:{nestedFlow:!1},vueFlowVersion:"1.19.0"}}function or(n){const e=au();return n&&Object.keys(n).forEach(r=>{const o=n[r];de(o)&&(e[r]=o)}),e}function su(n,e,r){const o=computed(()=>k=>n.nodes&&!e.value.length?n.nodes.find(A=>A.id===k):n.nodes[e.value.indexOf(k)]),s=computed(()=>k=>n.edges&&!r.value.length?n.edges.find(A=>A.id===k):n.edges[r.value.indexOf(k)]),l=computed(()=>{var k;const A={...ru,...n.edgeTypes},R=Object.keys(A);return(k=n.edges)==null||k.forEach($=>$.type&&!R.includes($.type)&&(A[$.type]=$.type)),A}),a=computed(()=>{var k;const A={...iu,...n.nodeTypes},R=Object.keys(A);return(k=n.nodes)==null||k.forEach($=>$.type&&!R.includes($.type)&&(A[$.type]=$.type)),A}),c=computed(()=>{const k=n.nodes.filter(A=>!A.hidden);return n.onlyRenderVisibleElements?k&&Ei(k,{x:0,y:0,width:n.dimensions.width,height:n.dimensions.height},n.viewport,!0):k??[]}),u=(k,A,R)=>{if(A=A??o.value(k.source),R=R??o.value(k.target),!A||!R){n.hooks.error.trigger(new ve(he.EDGE_ORPHANED,k.id));return}return!k.hidden&&!R.hidden&&!A.hidden},f=computed(()=>n.onlyRenderVisibleElements?n.edges.filter(k=>{const A=o.value(k.source),R=o.value(k.target);return u(k,A,R)&&xa({sourcePos:A.computedPosition||{x:0,y:0},targetPos:R.computedPosition||{x:0,y:0},sourceWidth:A.dimensions.width,sourceHeight:A.dimensions.height,targetWidth:R.dimensions.width,targetHeight:R.dimensions.height,width:n.dimensions.width,height:n.dimensions.height,viewport:n.viewport})}):n.edges.filter(k=>u(k))),d=computed(()=>[...c.value,...f.value]),g=computed(()=>n.nodes.filter(k=>k.selected)),m=computed(()=>n.edges.filter(k=>k.selected)),v=computed(()=>[...g.value??[],...m.value??[]]),b=computed(()=>c.value.filter(k=>k.initialized&&k.handleBounds!==void 0));return{getNode:o,getEdge:s,getElements:d,getEdgeTypes:l,getNodeTypes:a,getEdges:f,getNodes:c,getSelectedElements:v,getSelectedNodes:g,getSelectedEdges:m,getNodesInitialized:b}}function mo(n,e,r){n.prototype=e.prototype=r,r.constructor=n}function ir(n,e){var r=Object.create(n.prototype);for(var o in e)r[o]=e[o];return r}function kt(){}var Et=.7,Wt=1/Et,at="\\s*([+-]?\\d+)\\s*",St="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Me="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",lu=/^#([0-9a-f]{3,8})$/,uu=new RegExp(`^rgb\\(${at},${at},${at}\\)$`),cu=new RegExp(`^rgb\\(${Me},${Me},${Me}\\)$`),du=new RegExp(`^rgba\\(${at},${at},${at},${St}\\)$`),fu=new RegExp(`^rgba\\(${Me},${Me},${Me},${St}\\)$`),hu=new RegExp(`^hsl\\(${St},${Me},${Me}\\)$`),gu=new RegExp(`^hsla\\(${St},${Me},${Me},${St}\\)$`),Uo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};mo(kt,Nt,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:Zo,formatHex:Zo,formatHex8:vu,formatHsl:mu,formatRgb:Ko,toString:Ko});function Zo(){return this.rgb().formatHex()}function vu(){return this.rgb().formatHex8()}function mu(){return rr(this).formatHsl()}function Ko(){return this.rgb().formatRgb()}function Nt(n){var e,r;return n=(n+"").trim().toLowerCase(),(e=lu.exec(n))?(r=e[1].length,e=parseInt(e[1],16),r===6?Wo(e):r===3?new me(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Pt(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Pt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=uu.exec(n))?new me(e[1],e[2],e[3],1):(e=cu.exec(n))?new me(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=du.exec(n))?Pt(e[1],e[2],e[3],e[4]):(e=fu.exec(n))?Pt(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=hu.exec(n))?Qo(e[1],e[2]/100,e[3]/100,1):(e=gu.exec(n))?Qo(e[1],e[2]/100,e[3]/100,e[4]):Uo.hasOwnProperty(n)?Wo(Uo[n]):n==="transparent"?new me(NaN,NaN,NaN,0):null}function Wo(n){return new me(n>>16&255,n>>8&255,n&255,1)}function Pt(n,e,r,o){return o<=0&&(n=e=r=NaN),new me(n,e,r,o)}function pu(n){return n instanceof kt||(n=Nt(n)),n?(n=n.rgb(),new me(n.r,n.g,n.b,n.opacity)):new me}function Wn(n,e,r,o){return arguments.length===1?pu(n):new me(n,e,r,o??1)}function me(n,e,r,o){this.r=+n,this.g=+e,this.b=+r,this.opacity=+o}mo(me,Wn,ir(kt,{brighter(n){return n=n==null?Wt:Math.pow(Wt,n),new me(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?Et:Math.pow(Et,n),new me(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new me(Ke(this.r),Ke(this.g),Ke(this.b),qt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qo,formatHex:qo,formatHex8:yu,formatRgb:jo,toString:jo}));function qo(){return`#${Ue(this.r)}${Ue(this.g)}${Ue(this.b)}`}function yu(){return`#${Ue(this.r)}${Ue(this.g)}${Ue(this.b)}${Ue((isNaN(this.opacity)?1:this.opacity)*255)}`}function jo(){const n=qt(this.opacity);return`${n===1?"rgb(":"rgba("}${Ke(this.r)}, ${Ke(this.g)}, ${Ke(this.b)}${n===1?")":`, ${n})`}`}function qt(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function Ke(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function Ue(n){return n=Ke(n),(n<16?"0":"")+n.toString(16)}function Qo(n,e,r,o){return o<=0?n=e=r=NaN:r<=0||r>=1?n=e=NaN:e<=0&&(n=NaN),new be(n,e,r,o)}function rr(n){if(n instanceof be)return new be(n.h,n.s,n.l,n.opacity);if(n instanceof kt||(n=Nt(n)),!n)return new be;if(n instanceof be)return n;n=n.rgb();var e=n.r/255,r=n.g/255,o=n.b/255,s=Math.min(e,r,o),l=Math.max(e,r,o),a=NaN,c=l-s,u=(l+s)/2;return c?(e===l?a=(r-o)/c+(r<o)*6:r===l?a=(o-e)/c+2:a=(e-r)/c+4,c/=u<.5?l+s:2-l-s,a*=60):c=u>0&&u<1?0:a,new be(a,c,u,n.opacity)}function xu(n,e,r,o){return arguments.length===1?rr(n):new be(n,e,r,o??1)}function be(n,e,r,o){this.h=+n,this.s=+e,this.l=+r,this.opacity=+o}mo(be,xu,ir(kt,{brighter(n){return n=n==null?Wt:Math.pow(Wt,n),new be(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?Et:Math.pow(Et,n),new be(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,r=this.l,o=r+(r<.5?r:1-r)*e,s=2*r-o;return new me(Cn(n>=240?n-240:n+120,s,o),Cn(n,s,o),Cn(n<120?n+240:n-120,s,o),this.opacity)},clamp(){return new be(Jo(this.h),Dt(this.s),Dt(this.l),qt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=qt(this.opacity);return`${n===1?"hsl(":"hsla("}${Jo(this.h)}, ${Dt(this.s)*100}%, ${Dt(this.l)*100}%${n===1?")":`, ${n})`}`}}));function Jo(n){return n=(n||0)%360,n<0?n+360:n}function Dt(n){return Math.max(0,Math.min(1,n||0))}function Cn(n,e,r){return(n<60?e+(r-e)*n/60:n<180?r:n<240?e+(r-e)*(240-n)/60:e)*255}const ar=n=>()=>n;function _u(n,e){return function(r){return n+r*e}}function wu(n,e,r){return n=Math.pow(n,r),e=Math.pow(e,r)-n,r=1/r,function(o){return Math.pow(n+o*e,r)}}function bu(n){return(n=+n)==1?sr:function(e,r){return r-e?wu(e,r,n):ar(isNaN(e)?r:e)}}function sr(n,e){var r=e-n;return r?_u(n,r):ar(isNaN(n)?e:n)}const ei=function n(e){var r=bu(e);function o(s,l){var a=r((s=Wn(s)).r,(l=Wn(l)).r),c=r(s.g,l.g),u=r(s.b,l.b),f=sr(s.opacity,l.opacity);return function(d){return s.r=a(d),s.g=c(d),s.b=u(d),s.opacity=f(d),s+""}}return o.gamma=n,o}(1);function Re(n,e){return n=+n,e=+e,function(r){return n*(1-r)+e*r}}var qn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Mn=new RegExp(qn.source,"g");function Eu(n){return function(){return n}}function Su(n){return function(e){return n(e)+""}}function Nu(n,e){var r=qn.lastIndex=Mn.lastIndex=0,o,s,l,a=-1,c=[],u=[];for(n=n+"",e=e+"";(o=qn.exec(n))&&(s=Mn.exec(e));)(l=s.index)>r&&(l=e.slice(r,l),c[a]?c[a]+=l:c[++a]=l),(o=o[0])===(s=s[0])?c[a]?c[a]+=s:c[++a]=s:(c[++a]=null,u.push({i:a,x:Re(o,s)})),r=Mn.lastIndex;return r<e.length&&(l=e.slice(r),c[a]?c[a]+=l:c[++a]=l),c.length<2?u[0]?Su(u[0].x):Eu(e):(e=u.length,function(f){for(var d=0,g;d<e;++d)c[(g=u[d]).i]=g.x(f);return c.join("")})}var ti=180/Math.PI,jn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function lr(n,e,r,o,s,l){var a,c,u;return(a=Math.sqrt(n*n+e*e))&&(n/=a,e/=a),(u=n*r+e*o)&&(r-=n*u,o-=e*u),(c=Math.sqrt(r*r+o*o))&&(r/=c,o/=c,u/=c),n*o<e*r&&(n=-n,e=-e,u=-u,a=-a),{translateX:s,translateY:l,rotate:Math.atan2(e,n)*ti,skewX:Math.atan(u)*ti,scaleX:a,scaleY:c}}var At;function Cu(n){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return e.isIdentity?jn:lr(e.a,e.b,e.c,e.d,e.e,e.f)}function Mu(n){return n==null||(At||(At=document.createElementNS("http://www.w3.org/2000/svg","g")),At.setAttribute("transform",n),!(n=At.transform.baseVal.consolidate()))?jn:(n=n.matrix,lr(n.a,n.b,n.c,n.d,n.e,n.f))}function ur(n,e,r,o){function s(f){return f.length?f.pop()+" ":""}function l(f,d,g,m,v,b){if(f!==g||d!==m){var k=v.push("translate(",null,e,null,r);b.push({i:k-4,x:Re(f,g)},{i:k-2,x:Re(d,m)})}else(g||m)&&v.push("translate("+g+e+m+r)}function a(f,d,g,m){f!==d?(f-d>180?d+=360:d-f>180&&(f+=360),m.push({i:g.push(s(g)+"rotate(",null,o)-2,x:Re(f,d)})):d&&g.push(s(g)+"rotate("+d+o)}function c(f,d,g,m){f!==d?m.push({i:g.push(s(g)+"skewX(",null,o)-2,x:Re(f,d)}):d&&g.push(s(g)+"skewX("+d+o)}function u(f,d,g,m,v,b){if(f!==g||d!==m){var k=v.push(s(v)+"scale(",null,",",null,")");b.push({i:k-4,x:Re(f,g)},{i:k-2,x:Re(d,m)})}else(g!==1||m!==1)&&v.push(s(v)+"scale("+g+","+m+")")}return function(f,d){var g=[],m=[];return f=n(f),d=n(d),l(f.translateX,f.translateY,d.translateX,d.translateY,g,m),a(f.rotate,d.rotate,g,m),c(f.skewX,d.skewX,g,m),u(f.scaleX,f.scaleY,d.scaleX,d.scaleY,g,m),f=d=null,function(v){for(var b=-1,k=m.length,A;++b<k;)g[(A=m[b]).i]=A.x(v);return g.join("")}}}var $u=ur(Cu,"px, ","px)","deg)"),ku=ur(Mu,", ",")",")"),Ou=1e-12;function ni(n){return((n=Math.exp(n))+1/n)/2}function Iu(n){return((n=Math.exp(n))-1/n)/2}function Tu(n){return((n=Math.exp(2*n))-1)/(n+1)}const Pu=function n(e,r,o){function s(l,a){var c=l[0],u=l[1],f=l[2],d=a[0],g=a[1],m=a[2],v=d-c,b=g-u,k=v*v+b*b,A,R;if(k<Ou)R=Math.log(m/f)/e,A=function(I){return[c+I*v,u+I*b,f*Math.exp(e*I*R)]};else{var $=Math.sqrt(k),J=(m*m-f*f+o*k)/(2*f*r*$),_=(m*m-f*f-o*k)/(2*m*r*$),L=Math.log(Math.sqrt(J*J+1)-J),Y=Math.log(Math.sqrt(_*_+1)-_);R=(Y-L)/e,A=function(I){var Le=I*R,oe=ni(L),G=f/(r*$)*(oe*Tu(e*Le+L)-Iu(L));return[c+G*v,u+G*b,f*oe/ni(e*Le+L)]}}return A.duration=R*1e3*e/Math.SQRT2,A}return s.rho=function(l){var a=Math.max(.001,+l),c=a*a,u=c*c;return n(a,c,u)},s}(Math.SQRT2,2,4);var ft=0,mt=0,gt=0,cr=1e3,jt,pt,Qt=0,Qe=0,xn=0,Ct=typeof performance=="object"&&performance.now?performance:Date,dr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function po(){return Qe||(dr(Du),Qe=Ct.now()+xn)}function Du(){Qe=0}function Jt(){this._call=this._time=this._next=null}Jt.prototype=fr.prototype={constructor:Jt,restart:function(n,e,r){if(typeof n!="function")throw new TypeError("callback is not a function");r=(r==null?po():+r)+(e==null?0:+e),!this._next&&pt!==this&&(pt?pt._next=this:jt=this,pt=this),this._call=n,this._time=r,Qn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Qn())}};function fr(n,e,r){var o=new Jt;return o.restart(n,e,r),o}function Au(){po(),++ft;for(var n=jt,e;n;)(e=Qe-n._time)>=0&&n._call.call(void 0,e),n=n._next;--ft}function oi(){Qe=(Qt=Ct.now())+xn,ft=mt=0;try{Au()}finally{ft=0,Bu(),Qe=0}}function zu(){var n=Ct.now(),e=n-Qt;e>cr&&(xn-=e,Qt=n)}function Bu(){for(var n,e=jt,r,o=1/0;e;)e._call?(o>e._time&&(o=e._time),n=e,e=e._next):(r=e._next,e._next=null,e=n?n._next=r:jt=r);pt=n,Qn(o)}function Qn(n){if(!ft){mt&&(mt=clearTimeout(mt));var e=n-Qe;e>24?(n<1/0&&(mt=setTimeout(oi,n-Ct.now()-xn)),gt&&(gt=clearInterval(gt))):(gt||(Qt=Ct.now(),gt=setInterval(zu,cr)),ft=1,dr(oi))}}function ii(n,e,r){var o=new Jt;return e=e==null?0:+e,o.restart(s=>{o.stop(),n(s+e)},e,r),o}var Ru=cn("start","end","cancel","interrupt"),Vu=[],hr=0,ri=1,Jn=2,Vt=3,ai=4,eo=5,Ht=6;function _n(n,e,r,o,s,l){var a=n.__transition;if(!a)n.__transition={};else if(r in a)return;Hu(n,r,{name:e,index:o,group:s,on:Ru,tween:Vu,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:hr})}function yo(n,e){var r=Se(n,e);if(r.state>hr)throw new Error("too late; already scheduled");return r}function ke(n,e){var r=Se(n,e);if(r.state>Vt)throw new Error("too late; already running");return r}function Se(n,e){var r=n.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function Hu(n,e,r){var o=n.__transition,s;o[e]=r,r.timer=fr(l,0,r.time);function l(f){r.state=ri,r.timer.restart(a,r.delay,r.time),r.delay<=f&&a(f-r.delay)}function a(f){var d,g,m,v;if(r.state!==ri)return u();for(d in o)if(v=o[d],v.name===r.name){if(v.state===Vt)return ii(a);v.state===ai?(v.state=Ht,v.timer.stop(),v.on.call("interrupt",n,n.__data__,v.index,v.group),delete o[d]):+d<e&&(v.state=Ht,v.timer.stop(),v.on.call("cancel",n,n.__data__,v.index,v.group),delete o[d])}if(ii(function(){r.state===Vt&&(r.state=ai,r.timer.restart(c,r.delay,r.time),c(f))}),r.state=Jn,r.on.call("start",n,n.__data__,r.index,r.group),r.state===Jn){for(r.state=Vt,s=new Array(m=r.tween.length),d=0,g=-1;d<m;++d)(v=r.tween[d].value.call(n,n.__data__,r.index,r.group))&&(s[++g]=v);s.length=g+1}}function c(f){for(var d=f<r.duration?r.ease.call(null,f/r.duration):(r.timer.restart(u),r.state=eo,1),g=-1,m=s.length;++g<m;)s[g].call(n,d);r.state===eo&&(r.on.call("end",n,n.__data__,r.index,r.group),u())}function u(){r.state=Ht,r.timer.stop(),delete o[e];for(var f in o)return;delete n.__transition}}function Lt(n,e){var r=n.__transition,o,s,l=!0,a;if(r){e=e==null?null:e+"";for(a in r){if((o=r[a]).name!==e){l=!1;continue}s=o.state>Jn&&o.state<eo,o.state=Ht,o.timer.stop(),o.on.call(s?"interrupt":"cancel",n,n.__data__,o.index,o.group),delete r[a]}l&&delete n.__transition}}function Lu(n){return this.each(function(){Lt(this,n)})}function Fu(n,e){var r,o;return function(){var s=ke(this,n),l=s.tween;if(l!==r){o=r=l;for(var a=0,c=o.length;a<c;++a)if(o[a].name===e){o=o.slice(),o.splice(a,1);break}}s.tween=o}}function Gu(n,e,r){var o,s;if(typeof r!="function")throw new Error;return function(){var l=ke(this,n),a=l.tween;if(a!==o){s=(o=a).slice();for(var c={name:e,value:r},u=0,f=s.length;u<f;++u)if(s[u].name===e){s[u]=c;break}u===f&&s.push(c)}l.tween=s}}function Yu(n,e){var r=this._id;if(n+="",arguments.length<2){for(var o=Se(this.node(),r).tween,s=0,l=o.length,a;s<l;++s)if((a=o[s]).name===n)return a.value;return null}return this.each((e==null?Fu:Gu)(r,n,e))}function xo(n,e,r){var o=n._id;return n.each(function(){var s=ke(this,o);(s.value||(s.value={}))[e]=r.apply(this,arguments)}),function(s){return Se(s,o).value[e]}}function gr(n,e){var r;return(typeof e=="number"?Re:e instanceof Nt?ei:(r=Nt(e))?(e=r,ei):Nu)(n,e)}function Xu(n){return function(){this.removeAttribute(n)}}function Uu(n){return function(){this.removeAttributeNS(n.space,n.local)}}function Zu(n,e,r){var o,s=r+"",l;return function(){var a=this.getAttribute(n);return a===s?null:a===o?l:l=e(o=a,r)}}function Ku(n,e,r){var o,s=r+"",l;return function(){var a=this.getAttributeNS(n.space,n.local);return a===s?null:a===o?l:l=e(o=a,r)}}function Wu(n,e,r){var o,s,l;return function(){var a,c=r(this),u;return c==null?void this.removeAttribute(n):(a=this.getAttribute(n),u=c+"",a===u?null:a===o&&u===s?l:(s=u,l=e(o=a,c)))}}function qu(n,e,r){var o,s,l;return function(){var a,c=r(this),u;return c==null?void this.removeAttributeNS(n.space,n.local):(a=this.getAttributeNS(n.space,n.local),u=c+"",a===u?null:a===o&&u===s?l:(s=u,l=e(o=a,c)))}}function ju(n,e){var r=dn(n),o=r==="transform"?ku:gr;return this.attrTween(n,typeof e=="function"?(r.local?qu:Wu)(r,o,xo(this,"attr."+n,e)):e==null?(r.local?Uu:Xu)(r):(r.local?Ku:Zu)(r,o,e))}function Qu(n,e){return function(r){this.setAttribute(n,e.call(this,r))}}function Ju(n,e){return function(r){this.setAttributeNS(n.space,n.local,e.call(this,r))}}function ec(n,e){var r,o;function s(){var l=e.apply(this,arguments);return l!==o&&(r=(o=l)&&Ju(n,l)),r}return s._value=e,s}function tc(n,e){var r,o;function s(){var l=e.apply(this,arguments);return l!==o&&(r=(o=l)&&Qu(n,l)),r}return s._value=e,s}function nc(n,e){var r="attr."+n;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var o=dn(n);return this.tween(r,(o.local?ec:tc)(o,e))}function oc(n,e){return function(){yo(this,n).delay=+e.apply(this,arguments)}}function ic(n,e){return e=+e,function(){yo(this,n).delay=e}}function rc(n){var e=this._id;return arguments.length?this.each((typeof n=="function"?oc:ic)(e,n)):Se(this.node(),e).delay}function ac(n,e){return function(){ke(this,n).duration=+e.apply(this,arguments)}}function sc(n,e){return e=+e,function(){ke(this,n).duration=e}}function lc(n){var e=this._id;return arguments.length?this.each((typeof n=="function"?ac:sc)(e,n)):Se(this.node(),e).duration}function uc(n,e){if(typeof e!="function")throw new Error;return function(){ke(this,n).ease=e}}function cc(n){var e=this._id;return arguments.length?this.each(uc(e,n)):Se(this.node(),e).ease}function dc(n,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;ke(this,n).ease=r}}function fc(n){if(typeof n!="function")throw new Error;return this.each(dc(this._id,n))}function hc(n){typeof n!="function"&&(n=zi(n));for(var e=this._groups,r=e.length,o=new Array(r),s=0;s<r;++s)for(var l=e[s],a=l.length,c=o[s]=[],u,f=0;f<a;++f)(u=l[f])&&n.call(u,u.__data__,f,l)&&c.push(u);return new Be(o,this._parents,this._name,this._id)}function gc(n){if(n._id!==this._id)throw new Error;for(var e=this._groups,r=n._groups,o=e.length,s=r.length,l=Math.min(o,s),a=new Array(o),c=0;c<l;++c)for(var u=e[c],f=r[c],d=u.length,g=a[c]=new Array(d),m,v=0;v<d;++v)(m=u[v]||f[v])&&(g[v]=m);for(;c<o;++c)a[c]=e[c];return new Be(a,this._parents,this._name,this._id)}function vc(n){return(n+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function mc(n,e,r){var o,s,l=vc(e)?yo:ke;return function(){var a=l(this,n),c=a.on;c!==o&&(s=(o=c).copy()).on(e,r),a.on=s}}function pc(n,e){var r=this._id;return arguments.length<2?Se(this.node(),r).on.on(n):this.each(mc(r,n,e))}function yc(n){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==n)return;e&&e.removeChild(this)}}function xc(){return this.on("end.remove",yc(this._id))}function _c(n){var e=this._name,r=this._id;typeof n!="function"&&(n=ho(n));for(var o=this._groups,s=o.length,l=new Array(s),a=0;a<s;++a)for(var c=o[a],u=c.length,f=l[a]=new Array(u),d,g,m=0;m<u;++m)(d=c[m])&&(g=n.call(d,d.__data__,m,c))&&("__data__"in d&&(g.__data__=d.__data__),f[m]=g,_n(f[m],e,r,m,f,Se(d,r)));return new Be(l,this._parents,e,r)}function wc(n){var e=this._name,r=this._id;typeof n!="function"&&(n=Ai(n));for(var o=this._groups,s=o.length,l=[],a=[],c=0;c<s;++c)for(var u=o[c],f=u.length,d,g=0;g<f;++g)if(d=u[g]){for(var m=n.call(d,d.__data__,g,u),v,b=Se(d,r),k=0,A=m.length;k<A;++k)(v=m[k])&&_n(v,e,r,k,m,b);l.push(m),a.push(d)}return new Be(l,a,e,r)}var bc=$t.prototype.constructor;function Ec(){return new bc(this._groups,this._parents)}function Sc(n,e){var r,o,s;return function(){var l=dt(this,n),a=(this.style.removeProperty(n),dt(this,n));return l===a?null:l===r&&a===o?s:s=e(r=l,o=a)}}function vr(n){return function(){this.style.removeProperty(n)}}function Nc(n,e,r){var o,s=r+"",l;return function(){var a=dt(this,n);return a===s?null:a===o?l:l=e(o=a,r)}}function Cc(n,e,r){var o,s,l;return function(){var a=dt(this,n),c=r(this),u=c+"";return c==null&&(u=c=(this.style.removeProperty(n),dt(this,n))),a===u?null:a===o&&u===s?l:(s=u,l=e(o=a,c))}}function Mc(n,e){var r,o,s,l="style."+e,a="end."+l,c;return function(){var u=ke(this,n),f=u.on,d=u.value[l]==null?c||(c=vr(e)):void 0;(f!==r||s!==d)&&(o=(r=f).copy()).on(a,s=d),u.on=o}}function $c(n,e,r){var o=(n+="")=="transform"?$u:gr;return e==null?this.styleTween(n,Sc(n,o)).on("end.style."+n,vr(n)):typeof e=="function"?this.styleTween(n,Cc(n,o,xo(this,"style."+n,e))).each(Mc(this._id,n)):this.styleTween(n,Nc(n,o,e),r).on("end.style."+n,null)}function kc(n,e,r){return function(o){this.style.setProperty(n,e.call(this,o),r)}}function Oc(n,e,r){var o,s;function l(){var a=e.apply(this,arguments);return a!==s&&(o=(s=a)&&kc(n,a,r)),o}return l._value=e,l}function Ic(n,e,r){var o="style."+(n+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(e==null)return this.tween(o,null);if(typeof e!="function")throw new Error;return this.tween(o,Oc(n,e,r??""))}function Tc(n){return function(){this.textContent=n}}function Pc(n){return function(){var e=n(this);this.textContent=e??""}}function Dc(n){return this.tween("text",typeof n=="function"?Pc(xo(this,"text",n)):Tc(n==null?"":n+""))}function Ac(n){return function(e){this.textContent=n.call(this,e)}}function zc(n){var e,r;function o(){var s=n.apply(this,arguments);return s!==r&&(e=(r=s)&&Ac(s)),e}return o._value=n,o}function Bc(n){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(n==null)return this.tween(e,null);if(typeof n!="function")throw new Error;return this.tween(e,zc(n))}function Rc(){for(var n=this._name,e=this._id,r=mr(),o=this._groups,s=o.length,l=0;l<s;++l)for(var a=o[l],c=a.length,u,f=0;f<c;++f)if(u=a[f]){var d=Se(u,e);_n(u,n,r,f,a,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Be(o,this._parents,n,r)}function Vc(){var n,e,r=this,o=r._id,s=r.size();return new Promise(function(l,a){var c={value:a},u={value:function(){--s===0&&l()}};r.each(function(){var f=ke(this,o),d=f.on;d!==n&&(e=(n=d).copy(),e._.cancel.push(c),e._.interrupt.push(c),e._.end.push(u)),f.on=e}),s===0&&l()})}var Hc=0;function Be(n,e,r,o){this._groups=n,this._parents=e,this._name=r,this._id=o}function mr(){return++Hc}var Oe=$t.prototype;Be.prototype={constructor:Be,select:_c,selectAll:wc,selectChild:Oe.selectChild,selectChildren:Oe.selectChildren,filter:hc,merge:gc,selection:Ec,transition:Rc,call:Oe.call,nodes:Oe.nodes,node:Oe.node,size:Oe.size,empty:Oe.empty,each:Oe.each,on:pc,attr:ju,attrTween:nc,style:$c,styleTween:Ic,text:Dc,textTween:Bc,remove:xc,tween:Yu,delay:rc,duration:lc,ease:cc,easeVarying:fc,end:Vc,[Symbol.iterator]:Oe[Symbol.iterator]};function Lc(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}var Fc={time:null,delay:0,duration:250,ease:Lc};function Gc(n,e){for(var r;!(r=n.__transition)||!(r=r[e]);)if(!(n=n.parentNode))throw new Error(`transition ${e} not found`);return r}function Yc(n){var e,r;n instanceof Be?(e=n._id,n=n._name):(e=mr(),(r=Fc).time=po(),n=n==null?null:n+"");for(var o=this._groups,s=o.length,l=0;l<s;++l)for(var a=o[l],c=a.length,u,f=0;f<c;++f)(u=a[f])&&_n(u,n,e,f,a,r||Gc(u,e));return new Be(o,this._parents,n,e)}$t.prototype.interrupt=Lu;$t.prototype.transition=Yc;const zt=n=>()=>n;function Xc(n,{sourceEvent:e,target:r,transform:o,dispatch:s}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:s}})}function De(n,e,r){this.k=n,this.x=e,this.y=r}De.prototype={constructor:De,scale:function(n){return n===1?this:new De(this.k*n,this.x,this.y)},translate:function(n,e){return n===0&e===0?this:new De(this.k,this.x+this.k*n,this.y+this.k*e)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ht=new De(1,0,0);De.prototype;function $n(n){n.stopImmediatePropagation()}function vt(n){n.preventDefault(),n.stopImmediatePropagation()}function Uc(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function Zc(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function si(){return this.__zoom||ht}function Kc(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function Wc(){return navigator.maxTouchPoints||"ontouchstart"in this}function qc(n,e,r){var o=n.invertX(e[0][0])-r[0][0],s=n.invertX(e[1][0])-r[1][0],l=n.invertY(e[0][1])-r[0][1],a=n.invertY(e[1][1])-r[1][1];return n.translate(s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s),a>l?(l+a)/2:Math.min(0,l)||Math.max(0,a))}function jc(){var n=Uc,e=Zc,r=qc,o=Kc,s=Wc,l=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],c=250,u=Pu,f=cn("start","zoom","end"),d,g,m,v=500,b=150,k=0,A=10;function R(K){K.property("__zoom",si).on("wheel.zoom",Le,{passive:!1}).on("mousedown.zoom",oe).on("dblclick.zoom",G).filter(s).on("touchstart.zoom",Z).on("touchmove.zoom",Ee).on("touchend.zoom touchcancel.zoom",We).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}R.transform=function(K,ge,ne,le){var Ae=K.selection?K.selection():K;Ae.property("__zoom",si),K!==Ae?L(K,ge,ne,le):Ae.interrupt().each(function(){Y(this,arguments).event(le).start().zoom(null,typeof ge=="function"?ge.apply(this,arguments):ge).end()})},R.scaleBy=function(K,ge,ne,le){R.scaleTo(K,function(){var Ae=this.__zoom.k,Ve=typeof ge=="function"?ge.apply(this,arguments):ge;return Ae*Ve},ne,le)},R.scaleTo=function(K,ge,ne,le){R.transform(K,function(){var Ae=e.apply(this,arguments),Ve=this.__zoom,fe=ne==null?_(Ae):typeof ne=="function"?ne.apply(this,arguments):ne,Ze=Ve.invert(fe),_e=typeof ge=="function"?ge.apply(this,arguments):ge;return r(J($(Ve,_e),fe,Ze),Ae,a)},ne,le)},R.translateBy=function(K,ge,ne,le){R.transform(K,function(){return r(this.__zoom.translate(typeof ge=="function"?ge.apply(this,arguments):ge,typeof ne=="function"?ne.apply(this,arguments):ne),e.apply(this,arguments),a)},null,le)},R.translateTo=function(K,ge,ne,le,Ae){R.transform(K,function(){var Ve=e.apply(this,arguments),fe=this.__zoom,Ze=le==null?_(Ve):typeof le=="function"?le.apply(this,arguments):le;return r(ht.translate(Ze[0],Ze[1]).scale(fe.k).translate(typeof ge=="function"?-ge.apply(this,arguments):-ge,typeof ne=="function"?-ne.apply(this,arguments):-ne),Ve,a)},le,Ae)};function $(K,ge){return ge=Math.max(l[0],Math.min(l[1],ge)),ge===K.k?K:new De(ge,K.x,K.y)}function J(K,ge,ne){var le=ge[0]-ne[0]*K.k,Ae=ge[1]-ne[1]*K.k;return le===K.x&&Ae===K.y?K:new De(K.k,le,Ae)}function _(K){return[(+K[0][0]+ +K[1][0])/2,(+K[0][1]+ +K[1][1])/2]}function L(K,ge,ne,le){K.on("start.zoom",function(){Y(this,arguments).event(le).start()}).on("interrupt.zoom end.zoom",function(){Y(this,arguments).event(le).end()}).tween("zoom",function(){var Ae=this,Ve=arguments,fe=Y(Ae,Ve).event(le),Ze=e.apply(Ae,Ve),_e=ne==null?_(Ze):typeof ne=="function"?ne.apply(Ae,Ve):ne,ut=Math.max(Ze[1][0]-Ze[0][0],Ze[1][1]-Ze[0][1]),st=Ae.__zoom,re=typeof ge=="function"?ge.apply(Ae,Ve):ge,ee=u(st.invert(_e).concat(ut/st.k),re.invert(_e).concat(ut/re.k));return function(N){if(N===1)N=re;else{var H=ee(N),ae=ut/H[2];N=new De(ae,_e[0]-H[0]*ae,_e[1]-H[1]*ae)}fe.zoom(null,N)}})}function Y(K,ge,ne){return!ne&&K.__zooming||new I(K,ge)}function I(K,ge){this.that=K,this.args=ge,this.active=0,this.sourceEvent=null,this.extent=e.apply(K,ge),this.taps=0}I.prototype={event:function(K){return K&&(this.sourceEvent=K),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(K,ge){return this.mouse&&K!=="mouse"&&(this.mouse[1]=ge.invert(this.mouse[0])),this.touch0&&K!=="touch"&&(this.touch0[1]=ge.invert(this.touch0[0])),this.touch1&&K!=="touch"&&(this.touch1[1]=ge.invert(this.touch1[0])),this.that.__zoom=ge,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(K){var ge=we(this.that).datum();f.call(K,this.that,new Xc(K,{sourceEvent:this.sourceEvent,target:R,type:K,transform:this.that.__zoom,dispatch:f}),ge)}};function Le(K,...ge){if(!n.apply(this,arguments))return;var ne=Y(this,ge).event(K),le=this.__zoom,Ae=Math.max(l[0],Math.min(l[1],le.k*Math.pow(2,o.apply(this,arguments)))),Ve=Ne(K);if(ne.wheel)(ne.mouse[0][0]!==Ve[0]||ne.mouse[0][1]!==Ve[1])&&(ne.mouse[1]=le.invert(ne.mouse[0]=Ve)),clearTimeout(ne.wheel);else{if(le.k===Ae)return;ne.mouse=[Ve,le.invert(Ve)],Lt(this),ne.start()}vt(K),ne.wheel=setTimeout(fe,b),ne.zoom("mouse",r(J($(le,Ae),ne.mouse[0],ne.mouse[1]),ne.extent,a));function fe(){ne.wheel=null,ne.end()}}function oe(K,...ge){if(m||!n.apply(this,arguments))return;var ne=K.currentTarget,le=Y(this,ge,!0).event(K),Ae=we(K.view).on("mousemove.zoom",_e,!0).on("mouseup.zoom",ut,!0),Ve=Ne(K,ne),fe=K.clientX,Ze=K.clientY;Ui(K.view),$n(K),le.mouse=[Ve,this.__zoom.invert(Ve)],Lt(this),le.start();function _e(st){if(vt(st),!le.moved){var re=st.clientX-fe,ee=st.clientY-Ze;le.moved=re*re+ee*ee>k}le.event(st).zoom("mouse",r(J(le.that.__zoom,le.mouse[0]=Ne(st,ne),le.mouse[1]),le.extent,a))}function ut(st){Ae.on("mousemove.zoom mouseup.zoom",null),Zi(st.view,le.moved),vt(st),le.event(st).end()}}function G(K,...ge){if(n.apply(this,arguments)){var ne=this.__zoom,le=Ne(K.changedTouches?K.changedTouches[0]:K,this),Ae=ne.invert(le),Ve=ne.k*(K.shiftKey?.5:2),fe=r(J($(ne,Ve),le,Ae),e.apply(this,ge),a);vt(K),c>0?we(this).transition().duration(c).call(L,fe,le,K):we(this).call(R.transform,fe,le,K)}}function Z(K,...ge){if(n.apply(this,arguments)){var ne=K.touches,le=ne.length,Ae=Y(this,ge,K.changedTouches.length===le).event(K),Ve,fe,Ze,_e;for($n(K),fe=0;fe<le;++fe)Ze=ne[fe],_e=Ne(Ze,this),_e=[_e,this.__zoom.invert(_e),Ze.identifier],Ae.touch0?!Ae.touch1&&Ae.touch0[2]!==_e[2]&&(Ae.touch1=_e,Ae.taps=0):(Ae.touch0=_e,Ve=!0,Ae.taps=1+!!d);d&&(d=clearTimeout(d)),Ve&&(Ae.taps<2&&(g=_e[0],d=setTimeout(function(){d=null},v)),Lt(this),Ae.start())}}function Ee(K,...ge){if(this.__zooming){var ne=Y(this,ge).event(K),le=K.changedTouches,Ae=le.length,Ve,fe,Ze,_e;for(vt(K),Ve=0;Ve<Ae;++Ve)fe=le[Ve],Ze=Ne(fe,this),ne.touch0&&ne.touch0[2]===fe.identifier?ne.touch0[0]=Ze:ne.touch1&&ne.touch1[2]===fe.identifier&&(ne.touch1[0]=Ze);if(fe=ne.that.__zoom,ne.touch1){var ut=ne.touch0[0],st=ne.touch0[1],re=ne.touch1[0],ee=ne.touch1[1],N=(N=re[0]-ut[0])*N+(N=re[1]-ut[1])*N,H=(H=ee[0]-st[0])*H+(H=ee[1]-st[1])*H;fe=$(fe,Math.sqrt(N/H)),Ze=[(ut[0]+re[0])/2,(ut[1]+re[1])/2],_e=[(st[0]+ee[0])/2,(st[1]+ee[1])/2]}else if(ne.touch0)Ze=ne.touch0[0],_e=ne.touch0[1];else return;ne.zoom("touch",r(J(fe,Ze,_e),ne.extent,a))}}function We(K,...ge){if(this.__zooming){var ne=Y(this,ge).event(K),le=K.changedTouches,Ae=le.length,Ve,fe;for($n(K),m&&clearTimeout(m),m=setTimeout(function(){m=null},v),Ve=0;Ve<Ae;++Ve)fe=le[Ve],ne.touch0&&ne.touch0[2]===fe.identifier?delete ne.touch0:ne.touch1&&ne.touch1[2]===fe.identifier&&delete ne.touch1;if(ne.touch1&&!ne.touch0&&(ne.touch0=ne.touch1,delete ne.touch1),ne.touch0)ne.touch0[1]=this.__zoom.invert(ne.touch0[0]);else if(ne.end(),ne.taps===2&&(fe=Ne(fe,this),Math.hypot(g[0]-fe[0],g[1]-fe[1])<A)){var Ze=we(this).on("dblclick.zoom");Ze&&Ze.apply(this,arguments)}}}return R.wheelDelta=function(K){return arguments.length?(o=typeof K=="function"?K:zt(+K),R):o},R.filter=function(K){return arguments.length?(n=typeof K=="function"?K:zt(!!K),R):n},R.touchable=function(K){return arguments.length?(s=typeof K=="function"?K:zt(!!K),R):s},R.extent=function(K){return arguments.length?(e=typeof K=="function"?K:zt([[+K[0][0],+K[0][1]],[+K[1][0],+K[1][1]]]),R):e},R.scaleExtent=function(K){return arguments.length?(l[0]=+K[0],l[1]=+K[1],R):[l[0],l[1]]},R.translateExtent=function(K){return arguments.length?(a[0][0]=+K[0][0],a[1][0]=+K[1][0],a[0][1]=+K[0][1],a[1][1]=+K[1][1],R):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},R.constrain=function(K){return arguments.length?(r=K,R):r},R.duration=function(K){return arguments.length?(c=+K,R):c},R.interpolate=function(K){return arguments.length?(u=K,R):u},R.on=function(){var K=f.on.apply(f,arguments);return K===f?R:K},R.clickDistance=function(K){return arguments.length?(k=(K=+K)*K,R):Math.sqrt(k)},R.tapDistance=function(K){return arguments.length?(A=+K,R):A},R}const kn=.1;function Fe(){}const Qc={zoomIn:Fe,zoomOut:Fe,zoomTo:Fe,fitView:Fe,setCenter:Fe,fitBounds:Fe,project:n=>n,setTransform:Fe,getTransform:()=>({x:0,y:0,zoom:1}),initialized:!1},Jc=(n,e)=>{const r=n,o=toRef(r,"nodes"),s=toRef(r,"d3Zoom"),l=toRef(r,"d3Selection"),a=toRef(r,"dimensions"),c=toRef(r,"translateExtent"),u=toRef(r,"minZoom"),f=toRef(r,"maxZoom"),d=toRef(r,"viewport"),g=toRef(r,"snapToGrid"),m=toRef(r,"snapGrid"),v=toRef(r,"hooks"),b=e,k=toRef(b,"getNodes"),A=ref(!1);v.value.nodesInitialized.on(()=>{A.value=!0});const R=computed(()=>!!s.value&&!!l.value&&!!a.value.width&&!!a.value.height&&A.value);function $(_,L){l.value&&s.value&&s.value.scaleBy(On(l.value,L),_)}function J(_,L,Y,I){const{x:Le,y:oe}=ro({x:-_,y:-L},c.value),G=ht.translate(-Le,-oe).scale(Y);l.value&&s.value&&s.value.transform(On(l.value,I),G)}return computed(()=>R.value?{initialized:!0,zoomIn:_=>{$(1.2,_==null?void 0:_.duration)},zoomOut:_=>{$(1/1.2,_==null?void 0:_.duration)},zoomTo:(_,L)=>{l.value&&s.value&&s.value.scaleTo(On(l.value,L==null?void 0:L.duration),_)},setTransform:(_,L)=>{J(_.x,_.y,_.zoom,L==null?void 0:L.duration)},getTransform:()=>({x:d.value.x,y:d.value.y,zoom:d.value.zoom}),fitView:(_={padding:kn,includeHiddenNodes:!1,duration:0})=>{if(!o.value.length)return;const L=(_.includeHiddenNodes?o.value:k.value).filter(G=>{var Z;const Ee=G.initialized&&G.dimensions.width&&G.dimensions.height;let We=!0;return(Z=_.nodes)!=null&&Z.length&&(We=_.nodes.includes(G.id)),Ee&&We}),Y=lo(L),{x:I,y:Le,zoom:oe}=Yt(Y,a.value.width,a.value.height,_.minZoom??u.value,_.maxZoom??f.value,_.padding??kn,_.offset);J(I,Le,oe,_==null?void 0:_.duration)},setCenter:(_,L,Y)=>{const I=typeof(Y==null?void 0:Y.zoom)<"u"?Y.zoom:f.value,Le=a.value.width/2-_*I,oe=a.value.height/2-L*I;J(Le,oe,I,Y==null?void 0:Y.duration)},fitBounds:(_,L={padding:kn})=>{const{x:Y,y:I,zoom:Le}=Yt(_,a.value.width,a.value.height,u.value,f.value,L.padding);J(Y,I,Le,L==null?void 0:L.duration)},project:_=>so(_,d.value,g.value,m.value)}:Qc)};function On(n,e=0){return n.transition().duration(e)}function In(n,e){if(e){const r=n.position.x+n.dimensions.width-e.dimensions.width,o=n.position.y+n.dimensions.height-e.dimensions.height;if(r>0||o>0||n.position.x<0||n.position.y<0){let s={};if(ze(e.style)?s={...e.style(e)}:e.style&&(s={...e.style}),s.width=s.width??`${e.dimensions.width}px`,s.height=s.height??`${e.dimensions.height}px`,r>0)if(Pe(s.width)){const l=Number(s.width.replace("px",""));s.width=`${l+r}px`}else s.width+=r;if(o>0)if(Pe(s.height)){const l=Number(s.height.replace("px",""));s.height=`${l+o}px`}else s.height+=o;if(n.position.x<0){const l=Math.abs(n.position.x);if(e.position.x=e.position.x-l,Pe(s.width)){const a=Number(s.width.replace("px",""));s.width=`${a+l}px`}else s.width+=l;n.position.x=0}if(n.position.y<0){const l=Math.abs(n.position.y);if(e.position.y=e.position.y-l,Pe(s.height)){const a=Number(s.height.replace("px",""));s.height=`${a+l}px`}else s.height+=l;n.position.y=0}e.dimensions.width=Number(s.width.toString().replace("px","")),e.dimensions.height=Number(s.height.toString().replace("px","")),ze(e.style)?e.style=l=>{const a=e.style;return{...a(l),...s}}:e.style={...e.style,...s}}}}function en(n,e){n.filter(o=>o.type==="add"||o.type==="remove").forEach(o=>{if(o.type==="add")e.findIndex(s=>s.id===o.item.id)===-1&&e.push(o.item);else if(o.type==="remove"){const s=e.findIndex(l=>l.id===o.id);s!==-1&&e.splice(s,1)}});const r=e.map(o=>o.id);return e.forEach(o=>{var s,l;const a=n.filter(c=>c.id===o.id);for(const c of a)switch(c.type){case"select":o.selected=c.selected;break;case"position":if(et(o)&&(typeof c.position<"u"&&(o.position=c.position),typeof c.dragging<"u"&&(o.dragging=c.dragging),o.expandParent&&o.parentNode)){const u=e[r.indexOf(o.parentNode)];u&&et(u)&&In(o,u)}break;case"dimensions":if(et(o)){if(typeof c.dimensions<"u"&&(o.dimensions=c.dimensions),typeof c.updateStyle<"u"&&(o.style={...o.style||{},width:`${(s=c.dimensions)==null?void 0:s.width}px`,height:`${(l=c.dimensions)==null?void 0:l.height}px`}),typeof c.resizing<"u"&&(o.resizing=c.resizing),o.expandParent&&o.parentNode){const u=e[r.indexOf(o.parentNode)];u&&et(u)&&(u.initialized?In(o,u):nextTick(()=>{In(o,u)}))}o.initialized||(o.initialized=!0)}break}}),e}function Ie(n,e){return{id:n,type:"select",selected:e}}function li(n){return{item:n,type:"add"}}function Tn(n){return{id:n,type:"remove"}}function Pn(n,e){return n.reduce((r,o)=>{let s=e.includes(o.id);de(o.selectable)&&!o.selectable&&(s=!1);const l=et(o)?"changedNodes":"changedEdges";return!o.selected&&s?r[l].push(Ie(o.id,!0)):o.selected&&!s&&r[l].push(Ie(o.id,!1)),r},{changedNodes:[],changedEdges:[]})}function ed(n,e,r,o){let s=!1;const l=Jc(n,e),a=N=>{const H=N??r.value??[];n.hooks.updateNodeInternals.trigger(H)},c=N=>{if(N)return n.nodes&&!r.value.length?n.nodes.find(H=>H.id===N):n.nodes[r.value.indexOf(N)]},u=N=>{if(N)return n.edges&&!o.value.length?n.edges.find(H=>H.id===N):n.edges[o.value.indexOf(N)]},f=(N,H,ae)=>{const Ce=[];N.forEach(ye=>{var E,M;const q={id:ye.id,type:"position",dragging:ae,from:ye.from};if(H&&(q.position=ye.position,ye.parentNode)){const te=c(ye.parentNode);q.position={x:q.position.x-(((E=te==null?void 0:te.computedPosition)==null?void 0:E.x)??0),y:q.position.y-(((M=te==null?void 0:te.computedPosition)==null?void 0:M.y)??0)}}Ce.push(q)}),Ce!=null&&Ce.length&&n.hooks.nodesChange.trigger(Ce)},d=N=>{var H;if(!n.vueFlowRef)return;const ae=n.vueFlowRef.querySelector(".vue-flow__transformationpane");if(!ae)return;let Ce;if((H=n.__experimentalFeatures)!=null&&H.nestedFlow){let E=[ae],M=ae,q;for(;!q&&M;)M=M.parentElement,q=M==null?void 0:M.classList.contains("vue-flow__transformationpane"),q&&(E=[M,...E]);E.forEach(te=>{const ue=window.getComputedStyle(te),{m22:Ge}=new window.DOMMatrixReadOnly(ue.transform);Ce?Ce*=Ge:Ce=Ge})}else{const E=window.getComputedStyle(ae),{m22:M}=new window.DOMMatrixReadOnly(E.transform);Ce=M}const ye=N.reduce((E,M)=>{const q=c(M.id);if(q){const te=nn(M.nodeElement);te.width&&te.height&&(q.dimensions.width!==te.width||q.dimensions.height!==te.height||M.forceUpdate)&&(q.handleBounds.source=Ro(".source",M.nodeElement,Ce),q.handleBounds.target=Ro(".target",M.nodeElement,Ce),q.dimensions=te,q.initialized=!0,E.push({id:q.id,type:"dimensions",dimensions:te}))}return E},[]);n.fitViewOnInit&&!s&&(pe(()=>l.value.initialized).toBe(!0).then(()=>{l.value.fitView()}),s=!0),ye.length&&n.hooks.nodesChange.trigger(ye)},g=(N,H)=>{const ae=N.map(E=>E.id);let Ce,ye=[];if(n.multiSelectionActive)Ce=ae.map(E=>Ie(E,H));else{const E=Pn([...n.nodes,...n.edges],ae);Ce=E.changedNodes,ye=E.changedEdges}Ce.length&&n.hooks.nodesChange.trigger(Ce),ye.length&&n.hooks.edgesChange.trigger(ye)},m=(N,H)=>{const ae=N.map(E=>E.id);let Ce=[],ye;if(n.multiSelectionActive)ye=ae.map(E=>Ie(E,H));else{const E=Pn([...n.nodes,...n.edges],ae);Ce=E.changedNodes,ye=E.changedEdges}Ce.length&&n.hooks.nodesChange.trigger(Ce),ye.length&&n.hooks.edgesChange.trigger(ye)},v=(N,H)=>{const ae=N.filter(xt).map(M=>M.id),Ce=N.filter($e).map(M=>M.id);let{changedNodes:ye,changedEdges:E}=Pn([...n.nodes,...n.edges],[...ae,...Ce]);n.multiSelectionActive&&(ye=ae.map(M=>Ie(M,H)),E=Ce.map(M=>Ie(M,H))),ye.length&&n.hooks.nodesChange.trigger(ye),E.length&&n.hooks.edgesChange.trigger(E)},b=N=>{g(N,!0)},k=N=>{m(N,!0)},A=N=>{v(N,!0)},R=N=>{if(!N.length)return g(N,!1);const H=N.map(ae=>ae.id).map(ae=>Ie(ae,!1));H.length&&n.hooks.nodesChange.trigger(H)},$=N=>{if(!N.length)return m(N,!1);const H=N.map(ae=>ae.id).map(ae=>Ie(ae,!1));H.length&&n.hooks.edgesChange.trigger(H)},J=N=>{if(!N||!N.length)return v([],!1);const{changedNodes:H,changedEdges:ae}=N.reduce((Ce,ye)=>{const E=Ie(ye.id,!1);return xt(ye)?Ce.changedNodes.push(E):Ce.changedEdges.push(E),Ce},{changedNodes:[],changedEdges:[]});H.length&&n.hooks.nodesChange.trigger(H),ae.length&&n.hooks.edgesChange.trigger(ae)},_=N=>{var H;(H=n.d3Zoom)==null||H.scaleExtent([N,n.maxZoom]),n.minZoom=N},L=N=>{var H;(H=n.d3Zoom)==null||H.scaleExtent([n.minZoom,N]),n.maxZoom=N},Y=N=>{var H;(H=n.d3Zoom)==null||H.translateExtent(N),n.translateExtent=N},I=N=>{n.nodeExtent=N,a(r.value)},Le=N=>{n.nodesDraggable=N,n.nodesConnectable=N,n.elementsSelectable=N},oe=N=>{const H=N instanceof Function?N(n.nodes):N;!n.initialized&&!H.length||(n.nodes=Io(H,n.nodes,c,n.hooks.error.trigger))},G=N=>{const H=N instanceof Function?N(n.edges):N;if(!n.initialized&&!H.length)return;const ae=n.isValidConnection?H.filter(Ce=>n.isValidConnection(Ce,{edges:n.edges,sourceNode:c(Ce.source),targetNode:c(Ce.target)})):H;n.edges=ae.reduce((Ce,ye)=>{const E=c(ye.source),M=c(ye.target),q=!E||typeof E>"u",te=!M||typeof M>"u";if(q&&te?n.hooks.error.trigger(new ve(he.EDGE_SOURCE_TARGET_MISSING,ye.id,ye.source,ye.target)):(q&&n.hooks.error.trigger(new ve(he.EDGE_SOURCE_MISSING,ye.id,ye.source)),te&&n.hooks.error.trigger(new ve(he.EDGE_TARGET_MISSING,ye.id,ye.target))),q||te)return Ce;const ue=u(ye.id);return Ce.push({...ao(ye,Object.assign({},ue,n.defaultEdgeOptions)),sourceNode:E,targetNode:M}),Ce},[])},Z=N=>{const H=N instanceof Function?N([...n.nodes,...n.edges]):N;!n.initialized&&!H.length||(oe(H.filter(xt)),G(H.filter($e)))},Ee=N=>{const H=N instanceof Function?N(n.nodes):N,ae=Io(H,n.nodes,c,n.hooks.error.trigger).map(li);ae.length&&n.hooks.nodesChange.trigger(ae)},We=N=>{const H=N instanceof Function?N(n.edges):N,ae=(n.isValidConnection?H.filter(Ce=>n.isValidConnection(Ce,{edges:n.edges,sourceNode:c(Ce.source),targetNode:c(Ce.target)})):H).reduce((Ce,ye)=>{const E=ga({...ye,...n.defaultEdgeOptions},n.edges,n.hooks.error.trigger);if(E){const M=c(E.source),q=c(E.target),te=!M||typeof M>"u",ue=!q||typeof q>"u";if(te&&ue?n.hooks.error.trigger(new ve(he.EDGE_SOURCE_TARGET_MISSING,E.id,E.source,E.target)):(te&&n.hooks.error.trigger(new ve(he.EDGE_SOURCE_MISSING,E.id,E.source)),ue&&n.hooks.error.trigger(new ve(he.EDGE_TARGET_MISSING,E.id,E.target))),te||ue)return Ce;Ce.push(li({...E,sourceNode:M,targetNode:q}))}return Ce},[]);ae.length&&n.hooks.edgesChange.trigger(ae)},K=(N,H=!0)=>{const ae=N instanceof Function?N(n.nodes):N,Ce=[],ye=[];ae.forEach(E=>{const M=typeof E=="string"?c(E):E;if(!(de(M.deletable)&&!M.deletable)&&(Ce.push(Tn(M.id)),H)){const q=rn([M],n.edges).filter(te=>de(te.deletable)?te.deletable:!0);ye.push(...q.map(te=>Tn(te.id)))}}),ye.length&&n.hooks.edgesChange.trigger(ye),Ce.length&&n.hooks.nodesChange.trigger(Ce)},ge=N=>{const H=N instanceof Function?N(n.edges):N,ae=[];H.forEach(Ce=>{const ye=typeof Ce=="string"?u(Ce):Ce;de(ye.deletable)&&!ye.deletable||ae.push(Tn(typeof Ce=="string"?Ce:Ce.id))}),n.hooks.edgesChange.trigger(ae)},ne=(N,H,ae=!0)=>va(N,H,n.edges,u,ae,n.hooks.error.trigger),le=N=>en(N,n.nodes),Ae=N=>en(N,n.edges),Ve=(N,H,ae,Ce=!1)=>{Ce?n.connectionClickStartHandle=N:n.connectionStartHandle=N,n.connectionEndHandle=null,n.connectionStatus=null,H&&(n.connectionPosition=H)},fe=(N,H=null,ae=null)=>{n.connectionStartHandle&&(n.connectionPosition=N,n.connectionEndHandle=H,n.connectionStatus=ae)},Ze=(N,H)=>{n.connectionPosition={x:NaN,y:NaN},n.connectionStatus=null,H?n.connectionClickStartHandle=null:n.connectionStartHandle=null},_e=N=>{const H=ca(N),ae=H?null:c(N.id);return!H&&!ae?[null,null,H]:[H?N:ko(ae),ae,H]},ut=(N,H=!0,ae)=>{const[Ce,ye,E]=_e(N);return Ce?(ae||n.nodes).filter(M=>{if(!E&&(M.id===ye.id||!M.computedPosition))return!1;const q=ko(M),te=Ln(q,Ce);return H&&te>0||te>=Number(N.width)*Number(N.height)}):[]},st=(N,H,ae=!0)=>{const[Ce]=_e(N);if(!Ce)return!1;const ye=Ln(Ce,H);return ae&&ye>0||ye>=Number(N.width)*Number(N.height)},re=(N,H)=>{const{viewport:ae,dimensions:Ce,d3Zoom:ye,d3Selection:E,translateExtent:M}=n;if(!ye||!E||!N.x&&!N.y)return;const q=ht.translate(ae.x+N.x,ae.y+N.y).scale(ae.zoom),te=[[0,0],[Ce.width,Ce.height]],ue=ye.constrain()(q,te,M);H==null||H(ue),ye.transform(E,ue)},ee=N=>{const H=N instanceof Function?N(n):N,ae=["modelValue","nodes","edges","maxZoom","minZoom","translateExtent","nodeExtent","hooks"],Ce=H.modelValue||H.nodes||H.edges?[]:void 0;Ce&&(H.modelValue&&Ce.push(...H.modelValue),H.nodes&&Ce.push(...H.nodes),H.edges&&Ce.push(...H.edges),Z(Ce));const ye=()=>{typeof H.maxZoom<"u"&&L(H.maxZoom),typeof H.minZoom<"u"&&_(H.minZoom),typeof H.translateExtent<"u"&&Y(H.translateExtent),typeof H.nodeExtent<"u"&&I(H.nodeExtent)};Object.keys(H).forEach(E=>{const M=H[E];!ae.includes(E)&&de(M)&&(n[E]=M)}),n.d3Zoom?ye():pe(()=>n.d3Zoom).not.toBeUndefined().then(ye),n.initialized||(n.initialized=!0)};return{updateNodePositions:f,updateNodeDimensions:d,setElements:Z,setNodes:oe,setEdges:G,addNodes:Ee,addEdges:We,removeNodes:K,removeEdges:ge,findNode:c,findEdge:u,updateEdge:ne,applyEdgeChanges:Ae,applyNodeChanges:le,addSelectedElements:A,addSelectedNodes:b,addSelectedEdges:k,setMinZoom:_,setMaxZoom:L,setTranslateExtent:Y,setNodeExtent:I,removeSelectedElements:J,removeSelectedNodes:R,removeSelectedEdges:$,startConnection:Ve,updateConnection:fe,endConnection:Ze,setInteractive:Le,setState:ee,getIntersectingNodes:ut,isNodeIntersecting:st,panBy:re,fitView:async(N={padding:.1})=>{await pe(()=>l.value.initialized).toBe(!0),l.value.fitView(N)},zoomIn:async N=>{await pe(()=>l.value.initialized).toBe(!0),l.value.zoomIn(N)},zoomOut:async N=>{await pe(()=>l.value.initialized).toBe(!0),l.value.zoomOut(N)},zoomTo:async(N,H)=>{await pe(()=>l.value.initialized).toBe(!0),l.value.zoomTo(N,H)},setTransform:async(N,H)=>{await pe(()=>l.value.initialized).toBe(!0),l.value.setTransform(N,H)},getTransform:()=>l.value.getTransform(),setCenter:async(N,H,ae)=>{await pe(()=>l.value.initialized).toBe(!0),l.value.setCenter(N,H,ae)},fitBounds:async(N,H)=>{await pe(()=>l.value.initialized).toBe(!0),l.value.fitBounds(N,H)},project:N=>l.value.project(N),toObject:()=>JSON.parse(JSON.stringify({nodes:n.nodes.map(N=>{const{computedPosition:H,handleBounds:ae,selected:Ce,dimensions:ye,isParent:E,resizing:M,dragging:q,initialized:te,...ue}=N;return ue}),edges:n.edges.map(N=>{const{selected:H,sourceNode:ae,targetNode:Ce,...ye}=N;return ye}),position:[n.viewport.x,n.viewport.y],zoom:n.viewport.zoom})),updateNodeInternals:a,$reset:()=>{n.edges=[],n.nodes=[],ee(or())},$destroy:()=>{}}}class tt{constructor(){this.currentId=0,this.flows=new Map}static getInstance(){return tt.instance||(tt.instance=new tt),tt.instance}set(e,r){return this.flows.set(e,r)}get(e){return this.flows.get(e)}remove(e){return this.flows.delete(e)}create(e,r){const o=or(r),s=reactive(o),l=computed(()=>s.nodes.map(m=>m.id)),a=computed(()=>s.edges.map(m=>m.id)),c=su(s,l,a),u=ed(s,c,l,a),f={};Object.entries(s.hooks).forEach(([m,v])=>{const b=`on${m.charAt(0).toUpperCase()+m.slice(1)}`;f[b]=v.on});const d={};Object.entries(s.hooks).forEach(([m,v])=>{d[m]=v.trigger}),u.setState(s);const g={...f,...c,...u,...toRefs(s),emits:d,id:e,$destroy:()=>{this.remove(e)}};return this.set(e,g),g}getId(){return`vue-flow-${this.currentId++}`}}const ce=n=>{const e=tt.getInstance(),r=getCurrentScope(),o=n==null?void 0:n.id,s=(r==null?void 0:r.vueFlowId)||o;let l,a=!1;if(r){const c=inject(To,null);typeof c<"u"&&c!==null&&(l=c)}if(l||s&&(l=e.get(s)),!l||l&&o&&o!==l.id){const c=o??e.getId();l=e.create(c,n),r&&(a=!0)}else n&&l.setState(n);return r&&(provide(To,l),r.vueFlowId=l.id,a&&Mt(()=>{if(l){const c=e.get(l.id);c?c.$destroy():wt(`No store instance found for id ${l.id} in storage.`)}})),l};function td(n,e,r){const o=effectScope();return o.run(()=>{[()=>{o.run(()=>{let s,l,a=!!(r.nodes.value.length||r.edges.value.length);s=Je([n.modelValue,()=>{var c,u;return(u=(c=n.modelValue)==null?void 0:c.value)==null?void 0:u.length}],([c])=>{c&&Array.isArray(c)&&(l==null||l.pause(),r.setElements(c),!l&&!a&&c.length?a=!0:l==null||l.resume())}),l=Je([r.nodes,r.edges,()=>r.edges.value.length,()=>r.nodes.value.length],([c,u])=>{var f;(f=n.modelValue)!=null&&f.value&&Array.isArray(n.modelValue.value)&&(s==null||s.pause(),n.modelValue.value=[...c,...u],nextTick(()=>{s==null||s.resume()}))},{immediate:a}),onScopeDispose(()=>{s==null||s.stop(),l==null||l.stop()})})},()=>{o.run(()=>{let s,l,a=!!r.nodes.value.length;s=Je([n.nodes,()=>{var c,u;return(u=(c=n.nodes)==null?void 0:c.value)==null?void 0:u.length}],([c])=>{c&&Array.isArray(c)&&(l==null||l.pause(),r.setNodes(c),!l&&!a&&c.length?a=!0:l==null||l.resume())}),l=Je([r.nodes,()=>r.nodes.value.length],([c])=>{var u;(u=n.nodes)!=null&&u.value&&Array.isArray(n.nodes.value)&&(s==null||s.pause(),n.nodes.value=[...c],nextTick(()=>{s==null||s.resume()}))},{immediate:a}),onScopeDispose(()=>{s==null||s.stop(),l==null||l.stop()})})},()=>{o.run(()=>{let s,l,a=!!r.edges.value.length;s=Je([n.edges,()=>{var c,u;return(u=(c=n.edges)==null?void 0:c.value)==null?void 0:u.length}],([c])=>{c&&Array.isArray(c)&&(l==null||l.pause(),r.setEdges(c),!l&&!a&&c.length?a=!0:l==null||l.resume())}),l=Je([r.edges,()=>r.edges.value.length],([c])=>{var u;(u=n.edges)!=null&&u.value&&Array.isArray(n.edges.value)&&(s==null||s.pause(),n.edges.value=[...c],nextTick(()=>{s==null||s.resume()}))},{immediate:a}),onScopeDispose(()=>{s==null||s.stop(),l==null||l.stop()})})},()=>{o.run(()=>{watch(()=>e.minZoom,()=>{e.minZoom&&de(e.minZoom)&&r.setMinZoom(e.minZoom)})})},()=>{o.run(()=>{watch(()=>e.maxZoom,()=>{e.maxZoom&&de(e.maxZoom)&&r.setMaxZoom(e.maxZoom)})})},()=>{o.run(()=>{watch(()=>e.translateExtent,()=>{e.translateExtent&&de(e.translateExtent)&&r.setTranslateExtent(e.translateExtent)})})},()=>{o.run(()=>{watch(()=>e.nodeExtent,()=>{e.nodeExtent&&de(e.nodeExtent)&&r.setNodeExtent(e.nodeExtent)})})},()=>{o.run(()=>{watch(()=>e.applyDefault,()=>{de(e.applyDefault)&&(r.applyDefault.value=e.applyDefault)}),watch(r.applyDefault,(s,l,a)=>{r.applyDefault.value?(r.onNodesChange(r.applyNodeChanges),r.onEdgesChange(r.applyEdgeChanges)):(r.hooks.value.nodesChange.off(r.applyNodeChanges),r.hooks.value.edgesChange.off(r.applyEdgeChanges)),a(()=>{r.hooks.value.nodesChange.off(r.applyNodeChanges),r.hooks.value.edgesChange.off(r.applyEdgeChanges)})},{immediate:!0})})},()=>{o.run(()=>{const s=async l=>{let a=l;ze(e.autoConnect)&&(a=await e.autoConnect(l)),a!==!1&&r.addEdges([a])};watch(()=>e.autoConnect,()=>{de(e.autoConnect)&&(r.autoConnect.value=e.autoConnect)}),watch(r.autoConnect,(l,a,c)=>{l?r.onConnect(s):r.hooks.value.connect.off(s),c(()=>{r.hooks.value.connect.off(s)})},{immediate:!0})})},()=>{const s=["id","modelValue","translateExtent","nodeExtent","edges","nodes","maxZoom","minZoom","applyDefault","autoConnect"];Object.keys(e).forEach(l=>{if(!s.includes(l)){const a=toRef(e,l),c=r[l];o.run(()=>{watch(a,u=>{de(u)&&(c.value=u)},{flush:"pre"})})}})}].forEach(s=>s())}),()=>o.stop()}function ui(n,e){return{x:n.clientX-e.left,y:n.clientY-e.top}}const nd={name:"Pane",compatConfig:{MODE:3}},od=defineComponent({...nd,props:{isSelecting:{type:Boolean}},setup(n){const{id:e,vueFlowRef:r,getNodes:o,getEdges:s,viewport:l,emits:a,userSelectionActive:c,removeSelectedElements:u,panOnDrag:f,userSelectionRect:d,elementsSelectable:g,nodesSelectionActive:m,addSelectedElements:v,getSelectedEdges:b,getSelectedNodes:k,removeNodes:A,removeEdges:R,selectionMode:$,deleteKeyCode:J,multiSelectionKeyCode:_,multiSelectionActive:L}=ce(),Y=ref(null),I=ref(0),Le=ref(0),oe=ref(),G=computed(()=>g.value&&(n.isSelecting||c.value));_t(J,fe=>{if(!fe)return;const Ze=o.value.reduce((_e,ut)=>((!ut.selected&&ut.parentNode&&_e.find(st=>st.id===ut.parentNode)||ut.selected)&&_e.push(ut),_e),[]);(Ze||b.value)&&(b.value.length>0&&R(b.value),Ze.length>0&&A(Ze),m.value=!1,u())}),_t(_,fe=>{L.value=fe});function Z(){c.value=!1,d.value=null,I.value=0,Le.value=0}function Ee(fe){fe.target!==Y.value||G.value||(a.paneClick(fe),u(),m.value=!1)}function We(fe){var Ze;if(fe.target===Y.value){if(Array.isArray(f.value)&&(Ze=f.value)!=null&&Ze.includes(2)){fe.preventDefault();return}a.paneContextMenu(fe)}}function K(fe){fe.target===Y.value&&a.paneScroll(fe)}function ge(fe){if(oe.value=r.value.getBoundingClientRect(),!G.value||!g||!n.isSelecting||fe.button!==0||fe.target!==Y.value||!oe.value)return;const{x:Ze,y:_e}=ui(fe,oe.value);u(),d.value={width:0,height:0,startX:Ze,startY:_e,x:Ze,y:_e},c.value=!0,a.selectionStart(fe)}function ne(fe){if(!n.isSelecting||!oe.value||!d.value)return;if(!G.value)return a.paneMouseMove(fe);c.value||(c.value=!0),m.value&&(m.value=!1);const Ze=ui(fe,oe.value),_e=d.value.startX??0,ut=d.value.startY??0,st={...d.value,x:Ze.x<_e?Ze.x:_e,y:Ze.y<ut?Ze.y:ut,width:Math.abs(Ze.x-_e),height:Math.abs(Ze.y-ut)},re=Ei(o.value,d.value,l.value,$.value===uo.Partial),ee=rn(re,s.value);I.value=re.length,Le.value=ee.length,d.value=st,v([...re,...ee])}function le(fe){G.value&&fe.button===0&&(!c.value&&d.value&&fe.target===Y.value&&Ee(fe),m.value=I.value>0,Z(),a.selectionEnd(fe))}function Ae(fe){var Ze;if(!G.value)return a.paneMouseLeave(fe);c.value&&(m.value=I.value>0,(Ze=a.selectionEnd)==null||Ze.call(a,fe)),Z()}function Ve(fe){G.value||a.paneMouseEnter(fe)}return(fe,Ze)=>(openBlock(),createElementBlock("div",{ref_key:"container",ref:Y,key:`pane-${unref(e)}`,class:normalizeClass(["vue-flow__pane vue-flow__container",{selection:n.isSelecting}]),onClick:Ee,onContextmenu:We,onWheelPassive:K,onMouseenter:Ve,onMousedown:ge,onMousemove:ne,onMouseup:le,onMouseleave:Ae},[renderSlot(fe.$slots,"default"),unref(c)&&unref(d)?(openBlock(),createBlock(ou,{key:0})):createCommentVNode("",!0),unref(m)&&unref(k).length?(openBlock(),createBlock(tu,{key:1})):createCommentVNode("",!0)],34))}}),id={class:"vue-flow__nodes vue-flow__container"},rd={name:"Nodes",compatConfig:{MODE:3}},ad=defineComponent({...rd,setup(n){const e=inject(an),r=ce(),o=toRef(r,"nodesDraggable"),s=toRef(r,"nodesFocusable"),l=toRef(r,"elementsSelectable"),a=toRef(r,"nodesConnectable"),c=toRef(r,"getNodes"),u=toRef(r,"getNodesInitialized"),f=toRef(r,"getNodeTypes"),d=toRef(r,"updateNodeDimensions"),g=toRef(r,"emits");let m=ref();pe(()=>c.value.length>0&&u.value.length===c.value.length).toBe(!0).then(()=>{nextTick(()=>{g.value.nodesInitialized(u.value)})}),onMounted(()=>{m.value=new ResizeObserver($=>{const J=$.map(_=>({id:_.target.getAttribute("data-id"),nodeElement:_.target,forceUpdate:!0}));d.value(J)})}),onBeforeUnmount(()=>{var $;return($=m.value)==null?void 0:$.disconnect()});function v($){return typeof $>"u"?o.value:$}function b($){return typeof $>"u"?l.value:$}function k($){return typeof $>"u"?a.value:$}function A($){return typeof $>"u"?s.value:$}function R($,J){const _=$||"default";let L=J??f.value[_];const Y=getCurrentInstance();if(typeof L=="string"&&Y){const Le=Object.keys(Y.appContext.components);Le&&Le.includes(_)&&(L=resolveComponent(_,!1))}return typeof L!="string"?L:(e==null?void 0:e[`node-${_}`])||(g.value.error(new ve(he.NODE_TYPE_MISSING,L)),!1)}return($,J)=>(openBlock(),createElementBlock("div",id,[unref(m)?(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(unref(c),_=>(openBlock(),createBlock(unref($l),{id:_.id,key:_.id,"resize-observer":unref(m),type:R(_.type,_.template),name:_.type||"default",draggable:v(_.draggable),selectable:b(_.selectable),connectable:k(_.connectable),focusable:A(_.focusable),node:_},null,8,["id","resize-observer","type","name","draggable","selectable","connectable","focusable","node"]))),128)):createCommentVNode("",!0)]))}}),sd=["id","markerWidth","markerHeight","markerUnits","orient"],ld=["stroke","stroke-width","fill"],ud=["stroke","stroke-width"],cd={name:"MarkerType",compatConfig:{MODE:3}},dd=defineComponent({...cd,props:{id:null,type:null,color:{default:"none"},width:{default:12.5},height:{default:12.5},markerUnits:{default:"strokeWidth"},orient:{default:"auto-start-reverse"},strokeWidth:{default:1}},setup(n){return(e,r)=>(openBlock(),createElementBlock("marker",{id:n.id,class:"vue-flow__arrowhead",viewBox:"-10 -10 20 20",refX:"0",refY:"0",markerWidth:`${n.width}`,markerHeight:`${n.height}`,markerUnits:n.markerUnits,orient:n.orient},[n.type===unref(Fn).ArrowClosed?(openBlock(),createElementBlock("polyline",{key:0,stroke:n.color,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":n.strokeWidth,fill:n.color,points:"-5,-4 0,0 -5,4 -5,-4"},null,8,ld)):createCommentVNode("",!0),n.type===unref(Fn).Arrow?(openBlock(),createElementBlock("polyline",{key:1,stroke:n.color,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":n.strokeWidth,fill:"none",points:"-5,-4 0,0 -5,4"},null,8,ud)):createCommentVNode("",!0)],8,sd))}}),fd={name:"MarkerDefinitions",compatConfig:{MODE:3}},hd=defineComponent({...fd,setup(n){const e=ce(),r=toRef(e,"id"),o=toRef(e,"edges"),s=toRef(e,"connectionLineOptions"),l=toRef(e,"defaultMarkerColor"),a=computed(()=>{const c=[],u=[],f=d=>{if(d){const g=Xe(d,r.value);c.includes(g)||(typeof d=="object"?u.push({...d,id:g,color:d.color||l.value}):u.push({id:g,color:l.value,type:d}),c.push(g))}};return[s.value.markerEnd,s.value.markerStart].forEach(f),o.value.reduce((d,g)=>([g.markerStart,g.markerEnd].forEach(f),d.sort((m,v)=>m.id.localeCompare(v.id))),u),u});return(c,u)=>(openBlock(),createElementBlock("defs",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(a),f=>(openBlock(),createBlock(dd,{id:f.id,key:f.id,type:f.type,color:f.color,width:f.width,height:f.height,markerUnits:f.markerUnits,"stroke-width":f.strokeWidth,orient:f.orient},null,8,["id","type","color","width","height","markerUnits","stroke-width","orient"]))),128))]))}}),gd={key:0,class:"vue-flow__edges vue-flow__connectionline vue-flow__container"},vd={name:"Edges",compatConfig:{MODE:3}},md=defineComponent({...vd,setup(n){const e=inject(an),r=ce(),o=toRef(r,"connectionStartHandle"),s=toRef(r,"nodesConnectable"),l=toRef(r,"edgesUpdatable"),a=toRef(r,"edgesFocusable"),c=toRef(r,"elementsSelectable"),u=toRef(r,"getSelectedNodes"),f=toRef(r,"findNode"),d=toRef(r,"getEdges"),g=toRef(r,"getNodesInitialized"),m=toRef(r,"getEdgeTypes"),v=toRef(r,"elevateEdgesOnSelect"),b=toRef(r,"dimensions"),k=toRef(r,"emits"),A=wn(()=>{var I;return(I=o.value)==null?void 0:I.nodeId},()=>{var I;return(I=o.value)!=null&&I.nodeId?f.value(o.value.nodeId):!1}),R=wn(()=>{var I;return(I=o.value)==null?void 0:I.nodeId},()=>{var I,Le;return!!(A.value&&(typeof A.value.connectable>"u"?s.value:A.value.connectable)&&(I=o.value)!=null&&I.nodeId&&(Le=o.value)!=null&&Le.type)}),$=wn([()=>d.value.map(I=>I.zIndex),()=>v.value?[u.value.length]:[0],()=>v.value?g.value.map(I=>I.computedPosition.z):[]],()=>_a(d.value,f.value,v.value));function J(I){return typeof I>"u"?c.value:I}function _(I){return typeof I>"u"?l.value:I}function L(I){return typeof I>"u"?a.value:I}function Y(I,Le){const oe=I||"default";let G=Le??m.value[oe];const Z=getCurrentInstance();if(typeof G=="string"&&Z){const We=Object.keys(Z.appContext.components);We&&We.includes(oe)&&(G=resolveComponent(oe,!1))}return G&&typeof G!="string"?G:(e==null?void 0:e[`edge-${oe}`])||(k.value.error(new ve(he.EDGE_TYPE_MISSING,G)),!1)}return(I,Le)=>unref(b).width&&unref(b).height?(openBlock(),createElementBlock(Fragment,{key:0},[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref($),oe=>(openBlock(),createElementBlock("svg",{key:oe.level,class:"vue-flow__edges vue-flow__container",style:normalizeStyle(`z-index: ${oe.level}`)},[oe.isMaxLevel?(openBlock(),createBlock(hd,{key:0})):createCommentVNode("",!0),createBaseVNode("g",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(oe.edges,G=>(openBlock(),createBlock(unref(Ul),{id:G.id,key:G.id,edge:G,type:Y(G.type,G.template),name:G.type||"default",selectable:J(G.selectable),updatable:_(G.updatable),focusable:L(G.focusable)},null,8,["id","edge","type","name","selectable","updatable","focusable"]))),128))])],4))),128)),unref(R)&&unref(A)?(openBlock(),createElementBlock("svg",gd,[createVNode(Ql,{"source-node":unref(A)},null,8,["source-node"])])):createCommentVNode("",!0)],64)):createCommentVNode("",!0)}}),pd=createBaseVNode("div",{class:"vue-flow__edge-labels"},null,-1),yd={name:"Transform",compatConfig:{MODE:3}},xd=defineComponent({...yd,setup(n){const{id:e,viewport:r,emits:o,d3Zoom:s,d3Selection:l,dimensions:a,...c}=ce(),u=ref(!to);return pe(()=>s.value&&l.value&&a.value.width>0&&a.value.height>0).toBeTruthy().then(()=>{o.paneReady({id:e,viewport:r,emits:o,d3Zoom:s,d3Selection:l,dimensions:a,...c}),setTimeout(()=>{u.value=!0},0)}),(f,d)=>(openBlock(),createElementBlock("div",{key:`transform-${unref(e)}`,class:"vue-flow__transformationpane vue-flow__container",style:normalizeStyle({transform:`translate(${unref(r).x}px,${unref(r).y}px) scale(${unref(r).zoom})`,opacity:unref(u)?void 0:0})},[createVNode(md),pd,createVNode(ad),renderSlot(f.$slots,"default")],4))}}),_d={name:"Viewport",compatConfig:{MODE:3}},wd=defineComponent({..._d,setup(n){const e=ce(),r=toRef(e,"id"),o=toRef(e,"minZoom"),s=toRef(e,"maxZoom"),l=toRef(e,"defaultViewport"),a=toRef(e,"translateExtent"),c=toRef(e,"dimensions"),u=toRef(e,"zoomActivationKeyCode"),f=toRef(e,"selectionKeyCode"),d=toRef(e,"panActivationKeyCode"),g=toRef(e,"panOnScroll"),m=toRef(e,"panOnScrollMode"),v=toRef(e,"panOnScrollSpeed"),b=toRef(e,"panOnDrag"),k=toRef(e,"zoomOnDoubleClick"),A=toRef(e,"zoomOnPinch"),R=toRef(e,"zoomOnScroll"),$=toRef(e,"preventScrolling"),J=toRef(e,"noWheelClassName"),_=toRef(e,"noPanClassName"),L=toRef(e,"setState"),Y=toRef(e,"emits"),I=toRef(e,"connectionStartHandle"),Le=toRef(e,"userSelectionActive"),oe=toRef(e,"paneDragging"),G=ref();let Z=ref(!1),Ee=ref(!1),We=ref(!1),K=ref(0);const ge=_t(d.value),ne=computed(()=>!Z.value&&b.value&&ge.value),le=computed(()=>f.value!==!0&&Z.value||f.value===!0&&ne.value!==!0);let Ae=ref({x:0,y:0,zoom:0});onMounted(()=>{ea(G,_e);const st=io();oo(st,"resize",_e)}),onMounted(()=>{const st=G.value,re=st.getBoundingClientRect(),ee=jc().scaleExtent([o.value,s.value]).translateExtent(a.value),N=we(st).call(ee),H=N.on("wheel.zoom"),ae=ht.translate(l.value.x??0,l.value.y??0).scale(ct(l.value.zoom??1,o.value,s.value)),Ce=[[0,0],[re.width,re.height]],ye=ee.constrain()(ae,Ce,a.value);ee.transform(N,ye),L.value({d3Zoom:ee,d3Selection:N,d3ZoomHandler:H,viewport:{x:ye.x,y:ye.y,zoom:ye.k},viewportRef:st}),_t(f.value,M=>{Z.value=M});const E=_t(u.value);watchEffect(()=>{Z.value&&Le.value&&!Ee.value?ee.on("zoom",null):!Z.value&&!Le.value&&ee.on("zoom",M=>{L.value({viewport:{x:M.transform.x,y:M.transform.y,zoom:M.transform.k}});const q=Ze(M.transform);We.value=Ve(b.value,K.value??0),Y.value.viewportChange(q),Y.value.move({event:M,flowTransform:q})})}),ee.on("start",M=>{var q;if(!M.sourceEvent)return null;K.value=M.sourceEvent.button,Ee.value=!0;const te=Ze(M.transform);((q=M.sourceEvent)==null?void 0:q.type)==="mousedown"&&L.value({paneDragging:!0}),Ae.value=te,Y.value.viewportChangeStart(te),Y.value.moveStart({event:M,flowTransform:te})}),ee.on("end",M=>{if(!M.sourceEvent)return null;if(Ee.value=!1,L.value({paneDragging:!1}),Ve(b.value,K.value??0)&&!We.value&&Y.value.paneContextMenu(M.sourceEvent),We.value=!1,fe(Ae.value,M.transform)){const q=Ze(M.transform);Ae.value=q,Y.value.viewportChangeEnd(q),Y.value.moveEnd({event:M,flowTransform:q})}}),watchEffect(()=>{g.value&&!E.value&&!Le.value?N.on("wheel.zoom",M=>{if(ut(M,J.value))return!1;M.preventDefault(),M.stopImmediatePropagation();const q=N.property("__zoom").k||1;if(M.ctrlKey&&A.value){const lt=Ne(M),qe=-M.deltaY*(M.deltaMode===1?.05:M.deltaMode?1:.002)*10,nt=q*2**qe;ee.scaleTo(N,nt,lt);return}const te=M.deltaMode===1?20:1,ue=m.value===Xt.Vertical?0:M.deltaX*te,Ge=m.value===Xt.Horizontal?0:M.deltaY*te;ee.translateBy(N,-(ue/q)*v.value,-(Ge/q)*v.value)},{passive:!1}):typeof H<"u"&&N.on("wheel.zoom",function(M,q){if(!$.value||ut(M,J.value))return null;M.preventDefault(),H.call(this,M,q)},{passive:!1})}),ee.filter(M=>{var q,te;const ue=E.value||R.value,Ge=A.value&&M.ctrlKey;if(M.button===1&&M.type==="mousedown"&&((q=M.target)!=null&&q.closest(".vue-flow__node")||(te=M.target)!=null&&te.closest(".vue-flow__edge")))return!0;if(!b.value&&!ue&&!g.value&&!k.value&&!A.value||Le.value||!k.value&&M.type==="dblclick"||ut(M,J.value)&&M.type==="wheel"||ut(M,_.value)&&M.type!=="wheel"||!A.value&&M.ctrlKey&&M.type==="wheel"||!ue&&!g.value&&!Ge&&M.type==="wheel"||!b.value&&(M.type==="mousedown"||M.type==="touchstart")||Array.isArray(b.value)&&!b.value.includes(M.button)&&(M.type==="mousedown"||M.type==="touchstart"))return!1;const lt=Array.isArray(b.value)&&b.value.includes(M.button)||!M.button||M.button<=1;return(!M.ctrlKey||M.type==="wheel")&&lt})});function Ve(st,re){return re===2&&Array.isArray(st)&&st.includes(2)}function fe(st,re){return st.x!==re.x&&!isNaN(re.x)||st.y!==re.y&&!isNaN(re.y)||st.zoom!==re.k&&!isNaN(re.k)}function Ze(st){return{x:st.x,y:st.y,zoom:st.k}}function _e(){if(!G.value)return;const{width:st,height:re}=nn(G.value);(st===0||re===0)&&Y.value.error(new ve(he.MISSING_VIEWPORT_DIMENSIONS)),c.value.width=st||500,c.value.height=re||500}function ut(st,re){return st.target.closest(`.${re}`)}return(st,re)=>(openBlock(),createElementBlock(Fragment,null,[(openBlock(),createElementBlock("div",{ref_key:"viewportEl",ref:G,key:`viewport-${unref(r)}`,class:"vue-flow__viewport vue-flow__container"},[createVNode(od,{"is-selecting":unref(le),class:normalizeClass({connecting:!!unref(I),dragging:unref(oe),draggable:!!unref(b)})},{default:withCtx(()=>[createVNode(xd,null,{default:withCtx(()=>[renderSlot(st.$slots,"zoom-pane")]),_:3})]),_:3},8,["is-selecting","class"])])),renderSlot(st.$slots,"default")],64))}}),bd=["id"],Ed=["id"],Sd=["id"],Nd={name:"A11yDescriptions",compatConfig:{MODE:3}},Cd=defineComponent({...Nd,setup(n){const{id:e,disableKeyboardA11y:r,ariaLiveMessage:o}=ce(),s={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"};return(l,a)=>(openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{id:`${unref(Wi)}-${unref(e)}`,style:{display:"none"}}," Press enter or space to select a node. "+toDisplayString(unref(r)?"":"You can then use the arrow keys to move the node around.")+" You can then use the arrow keys to move the node around, press delete to remove it and press escape to cancel. ",9,bd),createBaseVNode("div",{id:`${unref(qi)}-${unref(e)}`,style:{display:"none"}}," Press enter or space to select an edge. You can then press delete to remove it or press escape to cancel. ",8,Ed),unref(r)?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:0,id:`${unref(Sl)}-${unref(e)}`,"aria-live":"assertive","aria-atomic":"true",style:s},toDisplayString(unref(o)),9,Sd))],64))}}),Md={name:"VueFlow",compatConfig:{MODE:3}},Rd=defineComponent({...Md,props:{id:null,modelValue:null,nodes:null,edges:null,edgeTypes:null,nodeTypes:null,connectionMode:null,connectionLineType:null,connectionLineStyle:{default:void 0},connectionLineOptions:{default:void 0},connectionRadius:null,isValidConnection:{type:[Function,null],default:void 0},deleteKeyCode:null,selectionKeyCode:null,multiSelectionKeyCode:null,zoomActivationKeyCode:null,panActivationKeyCode:null,snapToGrid:{type:Boolean,default:void 0},snapGrid:null,onlyRenderVisibleElements:{type:Boolean,default:void 0},edgesUpdatable:{type:[Boolean,String],default:void 0},nodesDraggable:{type:Boolean,default:void 0},nodesConnectable:{type:Boolean,default:void 0},elementsSelectable:{type:Boolean,default:void 0},selectNodesOnDrag:{type:Boolean,default:void 0},panOnDrag:{type:[Boolean,Array],default:void 0},minZoom:null,maxZoom:null,defaultViewport:null,translateExtent:null,nodeExtent:null,defaultMarkerColor:null,zoomOnScroll:{type:Boolean,default:void 0},zoomOnPinch:{type:Boolean,default:void 0},panOnScroll:{type:Boolean,default:void 0},panOnScrollSpeed:null,panOnScrollMode:null,zoomOnDoubleClick:{type:Boolean,default:void 0},preventScrolling:{type:Boolean,default:void 0},selectionMode:null,edgeUpdaterRadius:null,fitViewOnInit:{type:Boolean,default:void 0},connectOnClick:{type:Boolean,default:void 0},applyDefault:{type:Boolean,default:void 0},autoConnect:{type:[Boolean,Function],default:void 0},noDragClassName:null,noWheelClassName:null,noPanClassName:null,defaultEdgeOptions:null,elevateEdgesOnSelect:{type:Boolean,default:void 0},elevateNodesOnSelect:{type:Boolean,default:void 0},disableKeyboardA11y:{type:Boolean,default:void 0},edgesFocusable:{type:Boolean,default:void 0},nodesFocusable:{type:Boolean,default:void 0},autoPanOnConnect:{type:Boolean,default:void 0},autoPanOnNodeDrag:{type:Boolean,default:void 0},__experimentalFeatures:null},emits:["nodesChange","edgesChange","nodeDoubleClick","nodeClick","nodeMouseEnter","nodeMouseMove","nodeMouseLeave","nodeContextMenu","nodeDragStart","nodeDrag","nodeDragStop","nodesInitialized","miniMapNodeClick","miniMapNodeDoubleClick","miniMapNodeMouseEnter","miniMapNodeMouseMove","miniMapNodeMouseLeave","connect","connectStart","connectEnd","clickConnectStart","clickConnectEnd","moveStart","move","moveEnd","selectionDragStart","selectionDrag","selectionDragStop","selectionContextMenu","selectionStart","selectionEnd","viewportChangeStart","viewportChange","viewportChangeEnd","paneReady","paneScroll","paneClick","paneContextMenu","paneMouseEnter","paneMouseMove","paneMouseLeave","edgeContextMenu","edgeMouseEnter","edgeMouseMove","edgeMouseLeave","edgeDoubleClick","edgeClick","edgeUpdateStart","edgeUpdate","edgeUpdateEnd","updateNodeInternals","error","update:modelValue","update:nodes","update:edges"],setup(n,{expose:e,emit:r}){const o=n,s=yt(o,"modelValue",r),l=yt(o,"nodes",r),a=yt(o,"edges",r),{vueFlowRef:c,hooks:u,getNodeTypes:f,getEdgeTypes:d,...g}=ce(o),m=td({modelValue:s,nodes:l,edges:a},o,{vueFlowRef:c,hooks:u,getNodeTypes:f,getEdgeTypes:d,...g});la(r,u);const v=ref();return provide(an,useSlots()),onUnmounted(()=>{m()}),onMounted(()=>{c.value=v.value}),e({vueFlowRef:c,hooks:u,getNodeTypes:f,getEdgeTypes:d,...g}),(b,k)=>(openBlock(),createElementBlock("div",{ref_key:"el",ref:v,class:"vue-flow"},[createVNode(wd,null,{nodes:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(Object.keys(unref(f)),A=>renderSlot(b.$slots,`node-${A}`)),256))]),edges:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(Object.keys(unref(d)),A=>renderSlot(b.$slots,`edge-${A}`)),256))]),"connection-name":withCtx(()=>[renderSlot(b.$slots,"connection-line")]),"zoom-pane":withCtx(()=>[renderSlot(b.$slots,"zoom-pane")]),default:withCtx(()=>[renderSlot(b.$slots,"default")]),_:3}),createVNode(Cd)],512))}}),Sidebar_vue_vue_type_style_index_0_scoped_e3355825_lang="",_export_sfc=(n,e)=>{const r=n.__vccOpts||n;for(const[o,s]of e)r[o]=s;return r},_withScopeId=n=>(pushScopeId("data-v-e3355825"),n=n(),popScopeId(),n),_hoisted_1$2=_withScopeId(()=>createBaseVNode("div",{class:"description"},"You can drag these nodes to the pane.",-1)),_hoisted_2$1={class:"nodes"},_sfc_main$2={__name:"Sidebar",setup(n){function e(r,o){r.dataTransfer&&(r.dataTransfer.setData("application/vueflow",o),r.dataTransfer.effectAllowed="move")}return(r,o)=>(openBlock(),createElementBlock("aside",null,[_hoisted_1$2,createBaseVNode("div",_hoisted_2$1,[createBaseVNode("div",{class:"vue-flow__node-input",draggable:!0,onDragstart:o[0]||(o[0]=s=>e(s,"input"))}," Input Node ",32),createBaseVNode("div",{class:"vue-flow__node-default",draggable:!0,onDragstart:o[1]||(o[1]=s=>e(s,"default"))}," Default Node ",32),createBaseVNode("div",{class:"vue-flow__node-output",draggable:!0,onDragstart:o[2]||(o[2]=s=>e(s,"output"))}," Output Node ",32)])]))}},Sidebar=_export_sfc(_sfc_main$2,[["__scopeId","data-v-e3355825"]]),VueFlow_vue_vue_type_style_index_0_lang="",_hoisted_1$1={class:"updatenode__controls"},_hoisted_2={key:0},_hoisted_3=createBaseVNode("label",{class:"updatenode__bglabel"},"background:",-1),_hoisted_4={key:1},_hoisted_5=createBaseVNode("label",{class:"updatenode__bglabel"},"storke:",-1),_hoisted_6={key:2},_hoisted_7=createBaseVNode("label",{class:"updatenode__bglabel"},"labelBgStyle:",-1),_hoisted_8={key:3},_hoisted_9=createBaseVNode("label",{class:"updatenode__bglabel"},"type:",-1),_hoisted_10=createBaseVNode("option",{value:"default"},"default",-1),_hoisted_11=createBaseVNode("option",{value:"smoothstep"},"smoothstep",-1),_hoisted_12=createBaseVNode("option",{value:"step"},"step",-1),_hoisted_13=[_hoisted_10,_hoisted_11,_hoisted_12],_hoisted_14={class:"updatenode__checkboxwrapper"},_hoisted_15=createBaseVNode("label",null,"hidden:",-1),_hoisted_16={key:4,class:"updatenode__checkboxwrapper"},_hoisted_17=createBaseVNode("label",null,"animated:",-1),_sfc_main$1={__name:"VueFlow",props:["modelValue"],emits:["update:modelValue"],setup(n,{emit:e}){const r=n;let o=0;function s(){return`dnd${o++}`}const l=computed({get(){return r.modelValue},set(G){if(G!==l.value){const Z=G.map(We=>({id:We.id,type:We.type,label:We.label,position:We.position,style:We.style,class:We.Class,hidden:We.hidden,animated:We.animated,source:We.source,target:We.target,labelBgStyle:We.labelBgStyle})),Ee=JSON.stringify(Z,null,2).replace(/"(\w+)"\s*:/g,"$1:").replace(/["]/g,"'");e("update:modelValue",Ee),G.map(We=>{var K,ge,ne;We.id===Y&&(L.bg=(K=We.style)==null?void 0:K.background,L.stroke=(ge=We.style)==null?void 0:ge.stroke,L.type=We.type,L.labelBgStyle.fill=(ne=We.labelBgStyle)==null?void 0:ne.fill,L.label=We.label,L.hidden=We.hidden)})}}}),{onPaneReady:a,findNode:c,onNodeDragStop:u,onConnect:f,onEdgeUpdate:d,updateEdge:g,addEdges:m,addNodes:v,getSelectedElements:b,getElements:k,project:A,vueFlowRef:R,getEdgeTypes:$}=ce({});a(({fitView:G})=>{G(),setTimeout(()=>{G()},100)}),u(G=>{const Z=G.node;l.value=l.value.map(Ee=>(Ee.id===Z.id&&(Ee.position={x:Math.round(Z.position.x),y:Math.round(Z.position.y)}),Ee))});function J(G){G.preventDefault(),G.dataTransfer&&(G.dataTransfer.dropEffect="move")}function _(G){var ne;const Z=(ne=G.dataTransfer)==null?void 0:ne.getData("application/vueflow"),{left:Ee,top:We}=R.value.getBoundingClientRect(),K=A({x:G.clientX-Ee,y:G.clientY-We}),ge={id:s(),type:Z,position:K,label:`${Z} node`};v([ge]),nextTick(()=>{const le=c(ge.id),Ae=watch(()=>le.dimensions,Ve=>{Ve.width>0&&Ve.height>0&&(le.position={x:le.position.x-le.dimensions.width/2,y:le.position.y-le.dimensions.height/2},Ae())},{deep:!0,flush:"post"})})}f(G=>m([G])),d(({edge:G,connection:Z})=>g(G,Z));const L=reactive({bg:null,stroke:null,type:null,labelBgStyle:{fill:null},label:null,hidden:null});let Y="1",I=!1;onMounted(()=>{k.value.map(Z=>{Z.id===Y&&(Y.slice(0,1)==="e"||Y.slice(0,1)==="v"?I=!0:I=!1,L.label=Z.label?Z.label:"",L.hidden=Z.hidden,Z.style&&(L.bg=Z.style.backgroundColor),I&&(Z.labelBgStyle&&(L.labelBgStyle.fill=Z.labelBgStyle.fill?Z.labelBgStyle.fill:""),L.animated=Z.animated?Z.animated:!1,L.type=Z.type?Z.type:"default",Z.style&&(L.stroke=Z.style.stroke?Z.style.stroke:"")))})});function Le(){const G=b.value[0];G&&(Y=G.id,Y.slice(0,1)==="e"||Y.slice(0,1)==="v"?I=!0:I=!1,console.log(G),L.label=G.label?G.label:"",L.hidden=G.hidden,L.bg=G.style?G.style.backgroundColor:"",I&&(L.labelBgStyle.fill=G.labelBgStyle?G.labelBgStyle.fill:"",L.animated=G.animated?G.animated:!1,L.type=G.type?G.type:"default",L.stroke=G.style?G.style.stroke:""))}function oe(G){l.value=l.value.map(Z=>(Z.id===Y&&(G==="label"&&(Z.label=L.label!==""?L.label:""),G==="bg"&&(Z.style={backgroundColor:L.bg}),G==="hidden"&&(Z.hidden=L.hidden),I&&(G==="stroke"&&(Z.style={stroke:L.stroke}),G==="labelBgStyle"&&(Z.labelBgStyle={fill:L.labelBgStyle.fill}),G==="animated"&&(Z.animated=L.animated),G==="type"&&(Z.type=L.type))),Z))}return(G,Z)=>(openBlock(),createElementBlock("div",{class:"dndflow",onDrop:_,onClick:Le},[createVNode(Sidebar),createVNode(unref(Rd),{modelValue:unref(l),"onUpdate:modelValue":Z[14]||(Z[14]=Ee=>isRef(l)?l.value=Ee:null),"only-render-visible-elements":!0,class:"basicflow","edges-updatable":!0,"zoom-on-double-click":!1,"fit-view-on-init":"","default-viewport":{zoom:1.5},"min-zoom":.2,"max-zoom":4,onDragover:J},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1$1,[createBaseVNode("div",null,[withDirectives(createBaseVNode("input",{"onUpdate:modelValue":Z[0]||(Z[0]=Ee=>L.label=Ee),onInput:Z[1]||(Z[1]=Ee=>oe("label")),placeholder:"label"},null,544),[[vModelText,L.label]])]),unref(I)?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_2,[_hoisted_3,withDirectives(createBaseVNode("input",{"onUpdate:modelValue":Z[2]||(Z[2]=Ee=>L.bg=Ee),type:"color",onInput:Z[3]||(Z[3]=Ee=>oe("bg"))},null,544),[[vModelText,L.bg]])])),unref(I)?(openBlock(),createElementBlock("div",_hoisted_4,[_hoisted_5,withDirectives(createBaseVNode("input",{"onUpdate:modelValue":Z[4]||(Z[4]=Ee=>L.stroke=Ee),type:"color",onInput:Z[5]||(Z[5]=Ee=>oe("stroke"))},null,544),[[vModelText,L.stroke]])])):createCommentVNode("",!0),unref(I)&&L.labelBgStyle?(openBlock(),createElementBlock("div",_hoisted_6,[_hoisted_7,withDirectives(createBaseVNode("input",{"onUpdate:modelValue":Z[6]||(Z[6]=Ee=>L.labelBgStyle.fill=Ee),type:"color",onInput:Z[7]||(Z[7]=Ee=>oe("labelBgStyle"))},null,544),[[vModelText,L.labelBgStyle.fill]])])):createCommentVNode("",!0),unref(I)?(openBlock(),createElementBlock("div",_hoisted_8,[_hoisted_9,withDirectives(createBaseVNode("select",{"onUpdate:modelValue":Z[8]||(Z[8]=Ee=>L.type=Ee),onChange:Z[9]||(Z[9]=Ee=>oe("type"))},_hoisted_13,544),[[vModelSelect,L.type]])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_14,[_hoisted_15,withDirectives(createBaseVNode("input",{"onUpdate:modelValue":Z[10]||(Z[10]=Ee=>L.hidden=Ee),type:"checkbox",onChange:Z[11]||(Z[11]=Ee=>oe("hidden"))},null,544),[[vModelCheckbox,L.hidden]])]),unref(I)?(openBlock(),createElementBlock("div",_hoisted_16,[_hoisted_17,withDirectives(createBaseVNode("input",{"onUpdate:modelValue":Z[12]||(Z[12]=Ee=>L.animated=Ee),type:"checkbox",onChange:Z[13]||(Z[13]=Ee=>oe("animated"))},null,544),[[vModelCheckbox,L.animated]])])):createCommentVNode("",!0)])]),_:1},8,["modelValue","default-viewport","min-zoom"])],32))}},HomeView_vue_vue_type_style_index_0_lang="",_sfc_main={name:"HomeView",components:{VueFlow:_sfc_main$1,Codemirror:T},setup(){const extensions=[json(),oneDark],view=shallowRef(),handleReady=n=>{view.value=n.view},code=ref(`[
  {
    id: '1',
    type: 'input',
    label: 'Node 1',
    position: {
      x: 250,
      y: 1
    },
    class: 'light'
  },
  {
    id: '2',
    type: 'output',
    label: 'Node 2',
    position: {
      x: 100,
      y: 100
    },
    class: 'light'
  },
  {
    id: '3',
    label: 'Node 3',
    position: {
      x: 400,
      y: 100
    },
    class: 'light'
  },
  {
    id: '4',
    label: 'Node 4',
    position: {
      x: 150,
      y: 200
    },
    class: 'light'
  },
  {
    id: '5',
    type: 'output',
    label: 'Node 5',
    position: {
      x: 300,
      y: 300
    },
    class: 'light'
  },
  {
    id: 'e1-2',
    source: '1',
    target: '2',
    animated: true
  },
  {
    id: 'e1-3',
    label: 'edge with arrowhead',
    source: '1',
    target: '3'
  },
  {
    id: 'e4-5',
    type: 'step',
    label: 'step-edge',
    source: '4',
    target: '5',
    style: {
      stroke: '#ffa500'
    },
    labelBgStyle: {
      fill: '#ffa500'
    }
  },
  {
    id: 'e3-4',
    type: 'smoothstep',
    label: 'smoothstep-edge',
    source: '3',
    target: '4'
  }
]
`),permision=ref(!0),codeObj=computed({get(){return eval(code.value)},set(n){permision.value&&n!==code.value&&(code.value=n)}});return{code,codeObj,extensions,handleReady,permision,log:console.log}}},_hoisted_1={class:"wrapper"};function _sfc_render(n,e,r,o,s,l){const a=resolveComponent("Codemirror"),c=resolveComponent("VueFlow");return openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("div",null,[createVNode(a,{modelValue:o.code,"onUpdate:modelValue":e[0]||(e[0]=u=>o.code=u),placeholder:"Code goes here...",style:{height:"100%"},autofocus:!0,"indent-with-tab":!0,"tab-size":2,extensions:o.extensions,onReady:o.handleReady,onFocus:e[1]||(e[1]=u=>{o.permision=!1}),onBlur:e[2]||(e[2]=u=>{o.permision=!0})},null,8,["modelValue","extensions","onReady"])]),createBaseVNode("div",null,[createVNode(c,{modelValue:o.codeObj,"onUpdate:modelValue":e[3]||(e[3]=u=>o.codeObj=u)},null,8,["modelValue"])])])}const HomeView=_export_sfc(_sfc_main,[["render",_sfc_render]]),router=createRouter({history:createWebHistory("/mermaid/"),routes:[{path:"/",name:"home",component:HomeView}]}),main="",app=createApp(_sfc_main$3),pinia=createPinia();pinia.use(src_default);app.use(pinia);app.use(router);app.use(W,{autofocus:!0,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"Code goes here...",extensions:[basicSetup]});app.mount("#app");
