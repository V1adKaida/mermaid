(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}})();function makeMap(n,e){const r=Object.create(null),o=n.split(",");for(let s=0;s<o.length;s++)r[o[s]]=!0;return e?s=>!!r[s.toLowerCase()]:s=>!!r[s]}function normalizeStyle(n){if(isArray$1(n)){const e={};for(let r=0;r<n.length;r++){const o=n[r],s=isString(o)?parseStringStyle(o):normalizeStyle(o);if(s)for(const l in s)e[l]=s[l]}return e}else{if(isString(n))return n;if(isObject$1(n))return n}}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*.*?\*\//gs;function parseStringStyle(n){const e={};return n.replace(styleCommentRE,"").split(listDelimiterRE).forEach(r=>{if(r){const o=r.split(propertyDelimiterRE);o.length>1&&(e[o[0].trim()]=o[1].trim())}}),e}function normalizeClass(n){let e="";if(isString(n))e=n;else if(isArray$1(n))for(let r=0;r<n.length;r++){const o=normalizeClass(n[r]);o&&(e+=o+" ")}else if(isObject$1(n))for(const r in n)n[r]&&(e+=r+" ");return e.trim()}function normalizeProps(n){if(!n)return null;let{class:e,style:r}=n;return e&&!isString(e)&&(n.class=normalizeClass(e)),r&&(n.style=normalizeStyle(r)),n}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(n){return!!n||n===""}function looseCompareArrays(n,e){if(n.length!==e.length)return!1;let r=!0;for(let o=0;r&&o<n.length;o++)r=looseEqual(n[o],e[o]);return r}function looseEqual(n,e){if(n===e)return!0;let r=isDate(n),o=isDate(e);if(r||o)return r&&o?n.getTime()===e.getTime():!1;if(r=isSymbol(n),o=isSymbol(e),r||o)return n===e;if(r=isArray$1(n),o=isArray$1(e),r||o)return r&&o?looseCompareArrays(n,e):!1;if(r=isObject$1(n),o=isObject$1(e),r||o){if(!r||!o)return!1;const s=Object.keys(n).length,l=Object.keys(e).length;if(s!==l)return!1;for(const c in n){const u=n.hasOwnProperty(c),f=e.hasOwnProperty(c);if(u&&!f||!u&&f||!looseEqual(n[c],e[c]))return!1}}return String(n)===String(e)}function looseIndexOf(n,e){return n.findIndex(r=>looseEqual(r,e))}const toDisplayString=n=>isString(n)?n:n==null?"":isArray$1(n)||isObject$1(n)&&(n.toString===objectToString||!isFunction(n.toString))?JSON.stringify(n,replacer,2):String(n),replacer=(n,e)=>e&&e.__v_isRef?replacer(n,e.value):isMap(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[o,s])=>(r[`${o} =>`]=s,r),{})}:isSet(e)?{[`Set(${e.size})`]:[...e.values()]}:isObject$1(e)&&!isArray$1(e)&&!isPlainObject(e)?String(e):e,EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,onRE=/^on[^a-z]/,isOn=n=>onRE.test(n),isModelListener=n=>n.startsWith("onUpdate:"),extend$1=Object.assign,remove$1=(n,e)=>{const r=n.indexOf(e);r>-1&&n.splice(r,1)},hasOwnProperty$1=Object.prototype.hasOwnProperty,hasOwn=(n,e)=>hasOwnProperty$1.call(n,e),isArray$1=Array.isArray,isMap=n=>toTypeString(n)==="[object Map]",isSet=n=>toTypeString(n)==="[object Set]",isDate=n=>toTypeString(n)==="[object Date]",isFunction=n=>typeof n=="function",isString=n=>typeof n=="string",isSymbol=n=>typeof n=="symbol",isObject$1=n=>n!==null&&typeof n=="object",isPromise=n=>isObject$1(n)&&isFunction(n.then)&&isFunction(n.catch),objectToString=Object.prototype.toString,toTypeString=n=>objectToString.call(n),toRawType=n=>toTypeString(n).slice(8,-1),isPlainObject=n=>toTypeString(n)==="[object Object]",isIntegerKey=n=>isString(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=n=>{const e=Object.create(null);return r=>e[r]||(e[r]=n(r))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(n=>n.replace(camelizeRE,(e,r)=>r?r.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(n=>n.replace(hyphenateRE,"-$1").toLowerCase()),capitalize=cacheStringFunction(n=>n.charAt(0).toUpperCase()+n.slice(1)),toHandlerKey=cacheStringFunction(n=>n?`on${capitalize(n)}`:""),hasChanged=(n,e)=>!Object.is(n,e),invokeArrayFns=(n,e)=>{for(let r=0;r<n.length;r++)n[r](e)},def=(n,e,r)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value:r})},looseToNumber=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let activeEffectScope;class EffectScope{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=activeEffectScope,!e&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const r=activeEffectScope;try{return activeEffectScope=this,e()}finally{activeEffectScope=r}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(e){if(this._active){let r,o;for(r=0,o=this.effects.length;r<o;r++)this.effects[r].stop();for(r=0,o=this.cleanups.length;r<o;r++)this.cleanups[r]();if(this.scopes)for(r=0,o=this.scopes.length;r<o;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function effectScope(n){return new EffectScope(n)}function recordEffectScope(n,e=activeEffectScope){e&&e.active&&e.effects.push(n)}function getCurrentScope(){return activeEffectScope}function onScopeDispose(n){activeEffectScope&&activeEffectScope.cleanups.push(n)}const createDep=n=>{const e=new Set(n);return e.w=0,e.n=0,e},wasTracked=n=>(n.w&trackOpBit)>0,newTracked=n=>(n.n&trackOpBit)>0,initDepMarkers=({deps:n})=>{if(n.length)for(let e=0;e<n.length;e++)n[e].w|=trackOpBit},finalizeDepMarkers=n=>{const{deps:e}=n;if(e.length){let r=0;for(let o=0;o<e.length;o++){const s=e[o];wasTracked(s)&&!newTracked(s)?s.delete(n):e[r++]=s,s.w&=~trackOpBit,s.n&=~trackOpBit}e.length=r}},targetMap=new WeakMap;let effectTrackDepth=0,trackOpBit=1;const maxMarkerBits=30;let activeEffect;const ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol("");class ReactiveEffect{constructor(e,r=null,o){this.fn=e,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,recordEffectScope(this,o)}run(){if(!this.active)return this.fn();let e=activeEffect,r=shouldTrack;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=activeEffect,activeEffect=this,shouldTrack=!0,trackOpBit=1<<++effectTrackDepth,effectTrackDepth<=maxMarkerBits?initDepMarkers(this):cleanupEffect(this),this.fn()}finally{effectTrackDepth<=maxMarkerBits&&finalizeDepMarkers(this),trackOpBit=1<<--effectTrackDepth,activeEffect=this.parent,shouldTrack=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){activeEffect===this?this.deferStop=!0:this.active&&(cleanupEffect(this),this.onStop&&this.onStop(),this.active=!1)}}function cleanupEffect(n){const{deps:e}=n;if(e.length){for(let r=0;r<e.length;r++)e[r].delete(n);e.length=0}}let shouldTrack=!0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const n=trackStack.pop();shouldTrack=n===void 0?!0:n}function track(n,e,r){if(shouldTrack&&activeEffect){let o=targetMap.get(n);o||targetMap.set(n,o=new Map);let s=o.get(r);s||o.set(r,s=createDep()),trackEffects(s)}}function trackEffects(n,e){let r=!1;effectTrackDepth<=maxMarkerBits?newTracked(n)||(n.n|=trackOpBit,r=!wasTracked(n)):r=!n.has(activeEffect),r&&(n.add(activeEffect),activeEffect.deps.push(n))}function trigger(n,e,r,o,s,l){const c=targetMap.get(n);if(!c)return;let u=[];if(e==="clear")u=[...c.values()];else if(r==="length"&&isArray$1(n)){const f=Number(o);c.forEach((d,g)=>{(g==="length"||g>=f)&&u.push(d)})}else switch(r!==void 0&&u.push(c.get(r)),e){case"add":isArray$1(n)?isIntegerKey(r)&&u.push(c.get("length")):(u.push(c.get(ITERATE_KEY)),isMap(n)&&u.push(c.get(MAP_KEY_ITERATE_KEY)));break;case"delete":isArray$1(n)||(u.push(c.get(ITERATE_KEY)),isMap(n)&&u.push(c.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap(n)&&u.push(c.get(ITERATE_KEY));break}if(u.length===1)u[0]&&triggerEffects(u[0]);else{const f=[];for(const d of u)d&&f.push(...d);triggerEffects(createDep(f))}}function triggerEffects(n,e){const r=isArray$1(n)?n:[...n];for(const o of r)o.computed&&triggerEffect(o);for(const o of r)o.computed||triggerEffect(o)}function triggerEffect(n,e){(n!==activeEffect||n.allowRecurse)&&(n.scheduler?n.scheduler():n.run())}function getDepFromReactive(n,e){var r;return(r=targetMap.get(n))===null||r===void 0?void 0:r.get(e)}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(isSymbol)),get$1=createGetter(),shallowGet=createGetter(!1,!0),readonlyGet=createGetter(!0),arrayInstrumentations=createArrayInstrumentations();function createArrayInstrumentations(){const n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...r){const o=toRaw(this);for(let l=0,c=this.length;l<c;l++)track(o,"get",l+"");const s=o[e](...r);return s===-1||s===!1?o[e](...r.map(toRaw)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...r){pauseTracking();const o=toRaw(this)[e].apply(this,r);return resetTracking(),o}}),n}function hasOwnProperty(n){const e=toRaw(this);return track(e,"has",n),e.hasOwnProperty(n)}function createGetter(n=!1,e=!1){return function(o,s,l){if(s==="__v_isReactive")return!n;if(s==="__v_isReadonly")return n;if(s==="__v_isShallow")return e;if(s==="__v_raw"&&l===(n?e?shallowReadonlyMap:readonlyMap:e?shallowReactiveMap:reactiveMap).get(o))return o;const c=isArray$1(o);if(!n){if(c&&hasOwn(arrayInstrumentations,s))return Reflect.get(arrayInstrumentations,s,l);if(s==="hasOwnProperty")return hasOwnProperty}const u=Reflect.get(o,s,l);return(isSymbol(s)?builtInSymbols.has(s):isNonTrackableKeys(s))||(n||track(o,"get",s),e)?u:isRef(u)?c&&isIntegerKey(s)?u:u.value:isObject$1(u)?n?readonly(u):reactive(u):u}}const set$1=createSetter(),shallowSet=createSetter(!0);function createSetter(n=!1){return function(r,o,s,l){let c=r[o];if(isReadonly(c)&&isRef(c)&&!isRef(s))return!1;if(!n&&(!isShallow(s)&&!isReadonly(s)&&(c=toRaw(c),s=toRaw(s)),!isArray$1(r)&&isRef(c)&&!isRef(s)))return c.value=s,!0;const u=isArray$1(r)&&isIntegerKey(o)?Number(o)<r.length:hasOwn(r,o),f=Reflect.set(r,o,s,l);return r===toRaw(l)&&(u?hasChanged(s,c)&&trigger(r,"set",o,s):trigger(r,"add",o,s)),f}}function deleteProperty(n,e){const r=hasOwn(n,e);n[e];const o=Reflect.deleteProperty(n,e);return o&&r&&trigger(n,"delete",e,void 0),o}function has$1(n,e){const r=Reflect.has(n,e);return(!isSymbol(e)||!builtInSymbols.has(e))&&track(n,"has",e),r}function ownKeys(n){return track(n,"iterate",isArray$1(n)?"length":ITERATE_KEY),Reflect.ownKeys(n)}const mutableHandlers={get:get$1,set:set$1,deleteProperty,has:has$1,ownKeys},readonlyHandlers={get:readonlyGet,set(n,e){return!0},deleteProperty(n,e){return!0}},shallowReactiveHandlers=extend$1({},mutableHandlers,{get:shallowGet,set:shallowSet}),toShallow=n=>n,getProto=n=>Reflect.getPrototypeOf(n);function get$2(n,e,r=!1,o=!1){n=n.__v_raw;const s=toRaw(n),l=toRaw(e);r||(e!==l&&track(s,"get",e),track(s,"get",l));const{has:c}=getProto(s),u=o?toShallow:r?toReadonly:toReactive;if(c.call(s,e))return u(n.get(e));if(c.call(s,l))return u(n.get(l));n!==s&&n.get(e)}function has(n,e=!1){const r=this.__v_raw,o=toRaw(r),s=toRaw(n);return e||(n!==s&&track(o,"has",n),track(o,"has",s)),n===s?r.has(n):r.has(n)||r.has(s)}function size(n,e=!1){return n=n.__v_raw,!e&&track(toRaw(n),"iterate",ITERATE_KEY),Reflect.get(n,"size",n)}function add$1(n){n=toRaw(n);const e=toRaw(this);return getProto(e).has.call(e,n)||(e.add(n),trigger(e,"add",n,n)),this}function set$2(n,e){e=toRaw(e);const r=toRaw(this),{has:o,get:s}=getProto(r);let l=o.call(r,n);l||(n=toRaw(n),l=o.call(r,n));const c=s.call(r,n);return r.set(n,e),l?hasChanged(e,c)&&trigger(r,"set",n,e):trigger(r,"add",n,e),this}function deleteEntry(n){const e=toRaw(this),{has:r,get:o}=getProto(e);let s=r.call(e,n);s||(n=toRaw(n),s=r.call(e,n)),o&&o.call(e,n);const l=e.delete(n);return s&&trigger(e,"delete",n,void 0),l}function clear(){const n=toRaw(this),e=n.size!==0,r=n.clear();return e&&trigger(n,"clear",void 0,void 0),r}function createForEach(n,e){return function(o,s){const l=this,c=l.__v_raw,u=toRaw(c),f=e?toShallow:n?toReadonly:toReactive;return!n&&track(u,"iterate",ITERATE_KEY),c.forEach((d,g)=>o.call(s,f(d),f(g),l))}}function createIterableMethod(n,e,r){return function(...o){const s=this.__v_raw,l=toRaw(s),c=isMap(l),u=n==="entries"||n===Symbol.iterator&&c,f=n==="keys"&&c,d=s[n](...o),g=r?toShallow:e?toReadonly:toReactive;return!e&&track(l,"iterate",f?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:m,done:v}=d.next();return v?{value:m,done:v}:{value:u?[g(m[0]),g(m[1])]:g(m),done:v}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(n){return function(...e){return n==="delete"?!1:this}}function createInstrumentations(){const n={get(l){return get$2(this,l)},get size(){return size(this)},has,add:add$1,set:set$2,delete:deleteEntry,clear,forEach:createForEach(!1,!1)},e={get(l){return get$2(this,l,!1,!0)},get size(){return size(this)},has,add:add$1,set:set$2,delete:deleteEntry,clear,forEach:createForEach(!1,!0)},r={get(l){return get$2(this,l,!0)},get size(){return size(this,!0)},has(l){return has.call(this,l,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},o={get(l){return get$2(this,l,!0,!0)},get size(){return size(this,!0)},has(l){return has.call(this,l,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(l=>{n[l]=createIterableMethod(l,!1,!1),r[l]=createIterableMethod(l,!0,!1),e[l]=createIterableMethod(l,!1,!0),o[l]=createIterableMethod(l,!0,!0)}),[n,r,e,o]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(n,e){const r=e?n?shallowReadonlyInstrumentations:shallowInstrumentations:n?readonlyInstrumentations:mutableInstrumentations;return(o,s,l)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?o:Reflect.get(hasOwn(r,s)&&s in o?r:o,s,l)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(n){return n.__v_skip||!Object.isExtensible(n)?0:targetTypeMap(toRawType(n))}function reactive(n){return isReadonly(n)?n:createReactiveObject(n,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(n){return createReactiveObject(n,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(n){return createReactiveObject(n,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function createReactiveObject(n,e,r,o,s){if(!isObject$1(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const l=s.get(n);if(l)return l;const c=getTargetType(n);if(c===0)return n;const u=new Proxy(n,c===2?o:r);return s.set(n,u),u}function isReactive(n){return isReadonly(n)?isReactive(n.__v_raw):!!(n&&n.__v_isReactive)}function isReadonly(n){return!!(n&&n.__v_isReadonly)}function isShallow(n){return!!(n&&n.__v_isShallow)}function isProxy(n){return isReactive(n)||isReadonly(n)}function toRaw(n){const e=n&&n.__v_raw;return e?toRaw(e):n}function markRaw(n){return def(n,"__v_skip",!0),n}const toReactive=n=>isObject$1(n)?reactive(n):n,toReadonly=n=>isObject$1(n)?readonly(n):n;function trackRefValue(n){shouldTrack&&activeEffect&&(n=toRaw(n),trackEffects(n.dep||(n.dep=createDep())))}function triggerRefValue(n,e){n=toRaw(n);const r=n.dep;r&&triggerEffects(r)}function isRef(n){return!!(n&&n.__v_isRef===!0)}function ref(n){return createRef(n,!1)}function shallowRef(n){return createRef(n,!0)}function createRef(n,e){return isRef(n)?n:new RefImpl(n,e)}class RefImpl{constructor(e,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?e:toRaw(e),this._value=r?e:toReactive(e)}get value(){return trackRefValue(this),this._value}set value(e){const r=this.__v_isShallow||isShallow(e)||isReadonly(e);e=r?e:toRaw(e),hasChanged(e,this._rawValue)&&(this._rawValue=e,this._value=r?e:toReactive(e),triggerRefValue(this))}}function unref(n){return isRef(n)?n.value:n}const shallowUnwrapHandlers={get:(n,e,r)=>unref(Reflect.get(n,e,r)),set:(n,e,r,o)=>{const s=n[e];return isRef(s)&&!isRef(r)?(s.value=r,!0):Reflect.set(n,e,r,o)}};function proxyRefs(n){return isReactive(n)?n:new Proxy(n,shallowUnwrapHandlers)}class CustomRefImpl{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:r,set:o}=e(()=>trackRefValue(this),()=>triggerRefValue(this));this._get=r,this._set=o}get value(){return this._get()}set value(e){this._set(e)}}function customRef(n){return new CustomRefImpl(n)}function toRefs(n){const e=isArray$1(n)?new Array(n.length):{};for(const r in n)e[r]=toRef(n,r);return e}class ObjectRefImpl{constructor(e,r,o){this._object=e,this._key=r,this._defaultValue=o,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return getDepFromReactive(toRaw(this._object),this._key)}}function toRef(n,e,r){const o=n[e];return isRef(o)?o:new ObjectRefImpl(n,e,r)}var _a$1$1;class ComputedRefImpl{constructor(e,r,o,s){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[_a$1$1]=!1,this._dirty=!0,this.effect=new ReactiveEffect(e,()=>{this._dirty||(this._dirty=!0,triggerRefValue(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=o}get value(){const e=toRaw(this);return trackRefValue(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}_a$1$1="__v_isReadonly";function computed$1(n,e,r=!1){let o,s;const l=isFunction(n);return l?(o=n,s=NOOP):(o=n.get,s=n.set),new ComputedRefImpl(o,s,l||!s,r)}function warn(n,...e){}function callWithErrorHandling(n,e,r,o){let s;try{s=o?n(...o):n()}catch(l){handleError(l,e,r)}return s}function callWithAsyncErrorHandling(n,e,r,o){if(isFunction(n)){const l=callWithErrorHandling(n,e,r,o);return l&&isPromise(l)&&l.catch(c=>{handleError(c,e,r)}),l}const s=[];for(let l=0;l<n.length;l++)s.push(callWithAsyncErrorHandling(n[l],e,r,o));return s}function handleError(n,e,r,o=!0){const s=e?e.vnode:null;if(e){let l=e.parent;const c=e.proxy,u=r;for(;l;){const d=l.ec;if(d){for(let g=0;g<d.length;g++)if(d[g](n,c,u)===!1)return}l=l.parent}const f=e.appContext.config.errorHandler;if(f){callWithErrorHandling(f,null,10,[n,c,u]);return}}logError(n,r,s,o)}function logError(n,e,r,o=!0){console.error(n)}let isFlushing=!1,isFlushPending=!1;const queue=[];let flushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(n){const e=currentFlushPromise||resolvedPromise;return n?e.then(this?n.bind(this):n):e}function findInsertionIndex(n){let e=flushIndex+1,r=queue.length;for(;e<r;){const o=e+r>>>1;getId(queue[o])<n?e=o+1:r=o}return e}function queueJob(n){(!queue.length||!queue.includes(n,isFlushing&&n.allowRecurse?flushIndex+1:flushIndex))&&(n.id==null?queue.push(n):queue.splice(findInsertionIndex(n.id),0,n),queueFlush())}function queueFlush(){!isFlushing&&!isFlushPending&&(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function invalidateJob(n){const e=queue.indexOf(n);e>flushIndex&&queue.splice(e,1)}function queuePostFlushCb(n){isArray$1(n)?pendingPostFlushCbs.push(...n):(!activePostFlushCbs||!activePostFlushCbs.includes(n,n.allowRecurse?postFlushIndex+1:postFlushIndex))&&pendingPostFlushCbs.push(n),queueFlush()}function flushPreFlushCbs(n,e=isFlushing?flushIndex+1:0){for(;e<queue.length;e++){const r=queue[e];r&&r.pre&&(queue.splice(e,1),e--,r())}}function flushPostFlushCbs(n){if(pendingPostFlushCbs.length){const e=[...new Set(pendingPostFlushCbs)];if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...e);return}for(activePostFlushCbs=e,activePostFlushCbs.sort((r,o)=>getId(r)-getId(o)),postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++)activePostFlushCbs[postFlushIndex]();activePostFlushCbs=null,postFlushIndex=0}}const getId=n=>n.id==null?1/0:n.id,comparator=(n,e)=>{const r=getId(n)-getId(e);if(r===0){if(n.pre&&!e.pre)return-1;if(e.pre&&!n.pre)return 1}return r};function flushJobs(n){isFlushPending=!1,isFlushing=!0,queue.sort(comparator);const e=NOOP;try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const r=queue[flushIndex];r&&r.active!==!1&&callWithErrorHandling(r,null,14)}}finally{flushIndex=0,queue.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}function emit(n,e,...r){if(n.isUnmounted)return;const o=n.vnode.props||EMPTY_OBJ;let s=r;const l=e.startsWith("update:"),c=l&&e.slice(7);if(c&&c in o){const g=`${c==="modelValue"?"model":c}Modifiers`,{number:m,trim:v}=o[g]||EMPTY_OBJ;v&&(s=r.map(b=>isString(b)?b.trim():b)),m&&(s=r.map(looseToNumber))}let u,f=o[u=toHandlerKey(e)]||o[u=toHandlerKey(camelize(e))];!f&&l&&(f=o[u=toHandlerKey(hyphenate(e))]),f&&callWithAsyncErrorHandling(f,n,6,s);const d=o[u+"Once"];if(d){if(!n.emitted)n.emitted={};else if(n.emitted[u])return;n.emitted[u]=!0,callWithAsyncErrorHandling(d,n,6,s)}}function normalizeEmitsOptions(n,e,r=!1){const o=e.emitsCache,s=o.get(n);if(s!==void 0)return s;const l=n.emits;let c={},u=!1;if(!isFunction(n)){const f=d=>{const g=normalizeEmitsOptions(d,e,!0);g&&(u=!0,extend$1(c,g))};!r&&e.mixins.length&&e.mixins.forEach(f),n.extends&&f(n.extends),n.mixins&&n.mixins.forEach(f)}return!l&&!u?(isObject$1(n)&&o.set(n,null),null):(isArray$1(l)?l.forEach(f=>c[f]=null):extend$1(c,l),isObject$1(n)&&o.set(n,c),c)}function isEmitListener(n,e){return!n||!isOn(e)?!1:(e=e.slice(2).replace(/Once$/,""),hasOwn(n,e[0].toLowerCase()+e.slice(1))||hasOwn(n,hyphenate(e))||hasOwn(n,e))}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(n){const e=currentRenderingInstance;return currentRenderingInstance=n,currentScopeId=n&&n.type.__scopeId||null,e}function pushScopeId(n){currentScopeId=n}function popScopeId(){currentScopeId=null}function withCtx(n,e=currentRenderingInstance,r){if(!e||n._n)return n;const o=(...s)=>{o._d&&setBlockTracking(-1);const l=setCurrentRenderingInstance(e);let c;try{c=n(...s)}finally{setCurrentRenderingInstance(l),o._d&&setBlockTracking(1)}return c};return o._n=!0,o._c=!0,o._d=!0,o}function markAttrsAccessed(){}function renderComponentRoot(n){const{type:e,vnode:r,proxy:o,withProxy:s,props:l,propsOptions:[c],slots:u,attrs:f,emit:d,render:g,renderCache:m,data:v,setupState:b,ctx:k,inheritAttrs:R}=n;let I,$;const Y=setCurrentRenderingInstance(n);try{if(r.shapeFlag&4){const G=s||o;I=normalizeVNode(g.call(G,G,m,l,b,v,k)),$=f}else{const G=e;I=normalizeVNode(G.length>1?G(l,{attrs:f,slots:u,emit:d}):G(l,null)),$=e.props?f:getFunctionalFallthrough(f)}}catch(G){blockStack.length=0,handleError(G,n,1),I=createVNode(Comment)}let oe=I;if($&&R!==!1){const G=Object.keys($),{shapeFlag:q}=oe;G.length&&q&7&&(c&&G.some(isModelListener)&&($=filterModelListeners($,c)),oe=cloneVNode(oe,$))}return r.dirs&&(oe=cloneVNode(oe),oe.dirs=oe.dirs?oe.dirs.concat(r.dirs):r.dirs),r.transition&&(oe.transition=r.transition),I=oe,setCurrentRenderingInstance(Y),I}const getFunctionalFallthrough=n=>{let e;for(const r in n)(r==="class"||r==="style"||isOn(r))&&((e||(e={}))[r]=n[r]);return e},filterModelListeners=(n,e)=>{const r={};for(const o in n)(!isModelListener(o)||!(o.slice(9)in e))&&(r[o]=n[o]);return r};function shouldUpdateComponent(n,e,r){const{props:o,children:s,component:l}=n,{props:c,children:u,patchFlag:f}=e,d=l.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&f>=0){if(f&1024)return!0;if(f&16)return o?hasPropsChanged(o,c,d):!!c;if(f&8){const g=e.dynamicProps;for(let m=0;m<g.length;m++){const v=g[m];if(c[v]!==o[v]&&!isEmitListener(d,v))return!0}}}else return(s||u)&&(!u||!u.$stable)?!0:o===c?!1:o?c?hasPropsChanged(o,c,d):!0:!!c;return!1}function hasPropsChanged(n,e,r){const o=Object.keys(e);if(o.length!==Object.keys(n).length)return!0;for(let s=0;s<o.length;s++){const l=o[s];if(e[l]!==n[l]&&!isEmitListener(r,l))return!0}return!1}function updateHOCHostEl({vnode:n,parent:e},r){for(;e&&e.subTree===n;)(n=e.vnode).el=r,e=e.parent}const isSuspense=n=>n.__isSuspense;function queueEffectWithSuspense(n,e){e&&e.pendingBranch?isArray$1(n)?e.effects.push(...n):e.effects.push(n):queuePostFlushCb(n)}function provide(n,e){if(currentInstance){let r=currentInstance.provides;const o=currentInstance.parent&&currentInstance.parent.provides;o===r&&(r=currentInstance.provides=Object.create(o)),r[n]=e}}function inject(n,e,r=!1){const o=currentInstance||currentRenderingInstance;if(o){const s=o.parent==null?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides;if(s&&n in s)return s[n];if(arguments.length>1)return r&&isFunction(e)?e.call(o.proxy):e}}function watchEffect(n,e){return doWatch(n,null,e)}const INITIAL_WATCHER_VALUE={};function watch(n,e,r){return doWatch(n,e,r)}function doWatch(n,e,{immediate:r,deep:o,flush:s,onTrack:l,onTrigger:c}=EMPTY_OBJ){const u=getCurrentScope()===(currentInstance==null?void 0:currentInstance.scope)?currentInstance:null;let f,d=!1,g=!1;if(isRef(n)?(f=()=>n.value,d=isShallow(n)):isReactive(n)?(f=()=>n,o=!0):isArray$1(n)?(g=!0,d=n.some(oe=>isReactive(oe)||isShallow(oe)),f=()=>n.map(oe=>{if(isRef(oe))return oe.value;if(isReactive(oe))return traverse(oe);if(isFunction(oe))return callWithErrorHandling(oe,u,2)})):isFunction(n)?e?f=()=>callWithErrorHandling(n,u,2):f=()=>{if(!(u&&u.isUnmounted))return m&&m(),callWithAsyncErrorHandling(n,u,3,[v])}:f=NOOP,e&&o){const oe=f;f=()=>traverse(oe())}let m,v=oe=>{m=$.onStop=()=>{callWithErrorHandling(oe,u,4)}},b;if(isInSSRComponentSetup)if(v=NOOP,e?r&&callWithAsyncErrorHandling(e,u,3,[f(),g?[]:void 0,v]):f(),s==="sync"){const oe=useSSRContext();b=oe.__watcherHandles||(oe.__watcherHandles=[])}else return NOOP;let k=g?new Array(n.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const R=()=>{if($.active)if(e){const oe=$.run();(o||d||(g?oe.some((G,q)=>hasChanged(G,k[q])):hasChanged(oe,k)))&&(m&&m(),callWithAsyncErrorHandling(e,u,3,[oe,k===INITIAL_WATCHER_VALUE?void 0:g&&k[0]===INITIAL_WATCHER_VALUE?[]:k,v]),k=oe)}else $.run()};R.allowRecurse=!!e;let I;s==="sync"?I=R:s==="post"?I=()=>queuePostRenderEffect(R,u&&u.suspense):(R.pre=!0,u&&(R.id=u.uid),I=()=>queueJob(R));const $=new ReactiveEffect(f,I);e?r?R():k=$.run():s==="post"?queuePostRenderEffect($.run.bind($),u&&u.suspense):$.run();const Y=()=>{$.stop(),u&&u.scope&&remove$1(u.scope.effects,$)};return b&&b.push(Y),Y}function instanceWatch(n,e,r){const o=this.proxy,s=isString(n)?n.includes(".")?createPathGetter(o,n):()=>o[n]:n.bind(o,o);let l;isFunction(e)?l=e:(l=e.handler,r=e);const c=currentInstance;setCurrentInstance(this);const u=doWatch(s,l.bind(o),r);return c?setCurrentInstance(c):unsetCurrentInstance(),u}function createPathGetter(n,e){const r=e.split(".");return()=>{let o=n;for(let s=0;s<r.length&&o;s++)o=o[r[s]];return o}}function traverse(n,e){if(!isObject$1(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),isRef(n))traverse(n.value,e);else if(isArray$1(n))for(let r=0;r<n.length;r++)traverse(n[r],e);else if(isSet(n)||isMap(n))n.forEach(r=>{traverse(r,e)});else if(isPlainObject(n))for(const r in n)traverse(n[r],e);return n}function defineComponent(n){return isFunction(n)?{setup:n,name:n.name}:n}const isAsyncWrapper=n=>!!n.type.__asyncLoader,isKeepAlive=n=>n.type.__isKeepAlive;function onActivated(n,e){registerKeepAliveHook(n,"a",e)}function onDeactivated(n,e){registerKeepAliveHook(n,"da",e)}function registerKeepAliveHook(n,e,r=currentInstance){const o=n.__wdc||(n.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(injectHook(e,o,r),r){let s=r.parent;for(;s&&s.parent;)isKeepAlive(s.parent.vnode)&&injectToKeepAliveRoot(o,e,r,s),s=s.parent}}function injectToKeepAliveRoot(n,e,r,o){const s=injectHook(e,n,o,!0);onUnmounted(()=>{remove$1(o[e],s)},r)}function injectHook(n,e,r=currentInstance,o=!1){if(r){const s=r[n]||(r[n]=[]),l=e.__weh||(e.__weh=(...c)=>{if(r.isUnmounted)return;pauseTracking(),setCurrentInstance(r);const u=callWithAsyncErrorHandling(e,r,n,c);return unsetCurrentInstance(),resetTracking(),u});return o?s.unshift(l):s.push(l),l}}const createHook=n=>(e,r=currentInstance)=>(!isInSSRComponentSetup||n==="sp")&&injectHook(n,(...o)=>e(...o),r),onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(n,e=currentInstance){injectHook("ec",n,e)}function withDirectives(n,e){const r=currentRenderingInstance;if(r===null)return n;const o=getExposeProxy(r)||r.proxy,s=n.dirs||(n.dirs=[]);for(let l=0;l<e.length;l++){let[c,u,f,d=EMPTY_OBJ]=e[l];c&&(isFunction(c)&&(c={mounted:c,updated:c}),c.deep&&traverse(u),s.push({dir:c,instance:o,value:u,oldValue:void 0,arg:f,modifiers:d}))}return n}function invokeDirectiveHook(n,e,r,o){const s=n.dirs,l=e&&e.dirs;for(let c=0;c<s.length;c++){const u=s[c];l&&(u.oldValue=l[c].value);let f=u.dir[o];f&&(pauseTracking(),callWithAsyncErrorHandling(f,r,8,[n.el,u,n,e]),resetTracking())}}const COMPONENTS="components";function resolveComponent(n,e){return resolveAsset(COMPONENTS,n,!0,e)||n}const NULL_DYNAMIC_COMPONENT=Symbol();function resolveDynamicComponent(n){return isString(n)?resolveAsset(COMPONENTS,n,!1)||n:n||NULL_DYNAMIC_COMPONENT}function resolveAsset(n,e,r=!0,o=!1){const s=currentRenderingInstance||currentInstance;if(s){const l=s.type;if(n===COMPONENTS){const u=getComponentName(l,!1);if(u&&(u===e||u===camelize(e)||u===capitalize(camelize(e))))return l}const c=resolve(s[n]||l[n],e)||resolve(s.appContext[n],e);return!c&&o?l:c}}function resolve(n,e){return n&&(n[e]||n[camelize(e)]||n[capitalize(camelize(e))])}function renderList(n,e,r,o){let s;const l=r&&r[o];if(isArray$1(n)||isString(n)){s=new Array(n.length);for(let c=0,u=n.length;c<u;c++)s[c]=e(n[c],c,void 0,l&&l[c])}else if(typeof n=="number"){s=new Array(n);for(let c=0;c<n;c++)s[c]=e(c+1,c,void 0,l&&l[c])}else if(isObject$1(n))if(n[Symbol.iterator])s=Array.from(n,(c,u)=>e(c,u,void 0,l&&l[u]));else{const c=Object.keys(n);s=new Array(c.length);for(let u=0,f=c.length;u<f;u++){const d=c[u];s[u]=e(n[d],d,u,l&&l[u])}}else s=[];return r&&(r[o]=s),s}function renderSlot(n,e,r={},o,s){if(currentRenderingInstance.isCE||currentRenderingInstance.parent&&isAsyncWrapper(currentRenderingInstance.parent)&&currentRenderingInstance.parent.isCE)return e!=="default"&&(r.name=e),createVNode("slot",r,o&&o());let l=n[e];l&&l._c&&(l._d=!1),openBlock();const c=l&&ensureValidVNode(l(r)),u=createBlock(Fragment,{key:r.key||c&&c.key||`_${e}`},c||(o?o():[]),c&&n._===1?64:-2);return!s&&u.scopeId&&(u.slotScopeIds=[u.scopeId+"-s"]),l&&l._c&&(l._d=!0),u}function ensureValidVNode(n){return n.some(e=>isVNode(e)?!(e.type===Comment||e.type===Fragment&&!ensureValidVNode(e.children)):!0)?n:null}const getPublicInstance=n=>n?isStatefulComponent(n)?getExposeProxy(n)||n.proxy:getPublicInstance(n.parent):null,publicPropertiesMap=extend$1(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>getPublicInstance(n.parent),$root:n=>getPublicInstance(n.root),$emit:n=>n.emit,$options:n=>resolveMergedOptions(n),$forceUpdate:n=>n.f||(n.f=()=>queueJob(n.update)),$nextTick:n=>n.n||(n.n=nextTick.bind(n.proxy)),$watch:n=>instanceWatch.bind(n)}),hasSetupBinding=(n,e)=>n!==EMPTY_OBJ&&!n.__isScriptSetup&&hasOwn(n,e),PublicInstanceProxyHandlers={get({_:n},e){const{ctx:r,setupState:o,data:s,props:l,accessCache:c,type:u,appContext:f}=n;let d;if(e[0]!=="$"){const b=c[e];if(b!==void 0)switch(b){case 1:return o[e];case 2:return s[e];case 4:return r[e];case 3:return l[e]}else{if(hasSetupBinding(o,e))return c[e]=1,o[e];if(s!==EMPTY_OBJ&&hasOwn(s,e))return c[e]=2,s[e];if((d=n.propsOptions[0])&&hasOwn(d,e))return c[e]=3,l[e];if(r!==EMPTY_OBJ&&hasOwn(r,e))return c[e]=4,r[e];shouldCacheAccess&&(c[e]=0)}}const g=publicPropertiesMap[e];let m,v;if(g)return e==="$attrs"&&track(n,"get",e),g(n);if((m=u.__cssModules)&&(m=m[e]))return m;if(r!==EMPTY_OBJ&&hasOwn(r,e))return c[e]=4,r[e];if(v=f.config.globalProperties,hasOwn(v,e))return v[e]},set({_:n},e,r){const{data:o,setupState:s,ctx:l}=n;return hasSetupBinding(s,e)?(s[e]=r,!0):o!==EMPTY_OBJ&&hasOwn(o,e)?(o[e]=r,!0):hasOwn(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(l[e]=r,!0)},has({_:{data:n,setupState:e,accessCache:r,ctx:o,appContext:s,propsOptions:l}},c){let u;return!!r[c]||n!==EMPTY_OBJ&&hasOwn(n,c)||hasSetupBinding(e,c)||(u=l[0])&&hasOwn(u,c)||hasOwn(o,c)||hasOwn(publicPropertiesMap,c)||hasOwn(s.config.globalProperties,c)},defineProperty(n,e,r){return r.get!=null?n._.accessCache[e]=0:hasOwn(r,"value")&&this.set(n,e,r.value,null),Reflect.defineProperty(n,e,r)}};let shouldCacheAccess=!0;function applyOptions(n){const e=resolveMergedOptions(n),r=n.proxy,o=n.ctx;shouldCacheAccess=!1,e.beforeCreate&&callHook(e.beforeCreate,n,"bc");const{data:s,computed:l,methods:c,watch:u,provide:f,inject:d,created:g,beforeMount:m,mounted:v,beforeUpdate:b,updated:k,activated:R,deactivated:I,beforeDestroy:$,beforeUnmount:Y,destroyed:oe,unmounted:G,render:q,renderTracked:ne,renderTriggered:K,errorCaptured:qe,serverPrefetch:ge,expose:Z,inheritAttrs:re,components:He,directives:st,filters:ee}=e;if(d&&resolveInjections(d,o,null,n.appContext.config.unwrapInjectedRef),c)for(const ye in c){const We=c[ye];isFunction(We)&&(o[ye]=We.bind(r))}if(s){const ye=s.call(r,r);isObject$1(ye)&&(n.data=reactive(ye))}if(shouldCacheAccess=!0,l)for(const ye in l){const We=l[ye],Ze=isFunction(We)?We.bind(r,r):isFunction(We.get)?We.get.bind(r,r):NOOP,Ae=!isFunction(We)&&isFunction(We.set)?We.set.bind(r):NOOP,Bt=computed({get:Ze,set:Ae});Object.defineProperty(o,ye,{enumerable:!0,configurable:!0,get:()=>Bt.value,set:Ge=>Bt.value=Ge})}if(u)for(const ye in u)createWatcher(u[ye],o,r,ye);if(f){const ye=isFunction(f)?f.call(r):f;Reflect.ownKeys(ye).forEach(We=>{provide(We,ye[We])})}g&&callHook(g,n,"c");function ue(ye,We){isArray$1(We)?We.forEach(Ze=>ye(Ze.bind(r))):We&&ye(We.bind(r))}if(ue(onBeforeMount,m),ue(onMounted,v),ue(onBeforeUpdate,b),ue(onUpdated,k),ue(onActivated,R),ue(onDeactivated,I),ue(onErrorCaptured,qe),ue(onRenderTracked,ne),ue(onRenderTriggered,K),ue(onBeforeUnmount,Y),ue(onUnmounted,G),ue(onServerPrefetch,ge),isArray$1(Z))if(Z.length){const ye=n.exposed||(n.exposed={});Z.forEach(We=>{Object.defineProperty(ye,We,{get:()=>r[We],set:Ze=>r[We]=Ze})})}else n.exposed||(n.exposed={});q&&n.render===NOOP&&(n.render=q),re!=null&&(n.inheritAttrs=re),He&&(n.components=He),st&&(n.directives=st)}function resolveInjections(n,e,r=NOOP,o=!1){isArray$1(n)&&(n=normalizeInject(n));for(const s in n){const l=n[s];let c;isObject$1(l)?"default"in l?c=inject(l.from||s,l.default,!0):c=inject(l.from||s):c=inject(l),isRef(c)&&o?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>c.value,set:u=>c.value=u}):e[s]=c}}function callHook(n,e,r){callWithAsyncErrorHandling(isArray$1(n)?n.map(o=>o.bind(e.proxy)):n.bind(e.proxy),e,r)}function createWatcher(n,e,r,o){const s=o.includes(".")?createPathGetter(r,o):()=>r[o];if(isString(n)){const l=e[n];isFunction(l)&&watch(s,l)}else if(isFunction(n))watch(s,n.bind(r));else if(isObject$1(n))if(isArray$1(n))n.forEach(l=>createWatcher(l,e,r,o));else{const l=isFunction(n.handler)?n.handler.bind(r):e[n.handler];isFunction(l)&&watch(s,l,n)}}function resolveMergedOptions(n){const e=n.type,{mixins:r,extends:o}=e,{mixins:s,optionsCache:l,config:{optionMergeStrategies:c}}=n.appContext,u=l.get(e);let f;return u?f=u:!s.length&&!r&&!o?f=e:(f={},s.length&&s.forEach(d=>mergeOptions$1(f,d,c,!0)),mergeOptions$1(f,e,c)),isObject$1(e)&&l.set(e,f),f}function mergeOptions$1(n,e,r,o=!1){const{mixins:s,extends:l}=e;l&&mergeOptions$1(n,l,r,!0),s&&s.forEach(c=>mergeOptions$1(n,c,r,!0));for(const c in e)if(!(o&&c==="expose")){const u=internalOptionMergeStrats[c]||r&&r[c];n[c]=u?u(n[c],e[c]):e[c]}return n}const internalOptionMergeStrats={data:mergeDataFn,props:mergeObjectOptions,emits:mergeObjectOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(n,e){return e?n?function(){return extend$1(isFunction(n)?n.call(this,this):n,isFunction(e)?e.call(this,this):e)}:e:n}function mergeInject(n,e){return mergeObjectOptions(normalizeInject(n),normalizeInject(e))}function normalizeInject(n){if(isArray$1(n)){const e={};for(let r=0;r<n.length;r++)e[n[r]]=n[r];return e}return n}function mergeAsArray(n,e){return n?[...new Set([].concat(n,e))]:e}function mergeObjectOptions(n,e){return n?extend$1(extend$1(Object.create(null),n),e):e}function mergeWatchOptions(n,e){if(!n)return e;if(!e)return n;const r=extend$1(Object.create(null),n);for(const o in e)r[o]=mergeAsArray(n[o],e[o]);return r}function initProps(n,e,r,o=!1){const s={},l={};def(l,InternalObjectKey,1),n.propsDefaults=Object.create(null),setFullProps(n,e,s,l);for(const c in n.propsOptions[0])c in s||(s[c]=void 0);r?n.props=o?s:shallowReactive(s):n.type.props?n.props=s:n.props=l,n.attrs=l}function updateProps(n,e,r,o){const{props:s,attrs:l,vnode:{patchFlag:c}}=n,u=toRaw(s),[f]=n.propsOptions;let d=!1;if((o||c>0)&&!(c&16)){if(c&8){const g=n.vnode.dynamicProps;for(let m=0;m<g.length;m++){let v=g[m];if(isEmitListener(n.emitsOptions,v))continue;const b=e[v];if(f)if(hasOwn(l,v))b!==l[v]&&(l[v]=b,d=!0);else{const k=camelize(v);s[k]=resolvePropValue(f,u,k,b,n,!1)}else b!==l[v]&&(l[v]=b,d=!0)}}}else{setFullProps(n,e,s,l)&&(d=!0);let g;for(const m in u)(!e||!hasOwn(e,m)&&((g=hyphenate(m))===m||!hasOwn(e,g)))&&(f?r&&(r[m]!==void 0||r[g]!==void 0)&&(s[m]=resolvePropValue(f,u,m,void 0,n,!0)):delete s[m]);if(l!==u)for(const m in l)(!e||!hasOwn(e,m))&&(delete l[m],d=!0)}d&&trigger(n,"set","$attrs")}function setFullProps(n,e,r,o){const[s,l]=n.propsOptions;let c=!1,u;if(e)for(let f in e){if(isReservedProp(f))continue;const d=e[f];let g;s&&hasOwn(s,g=camelize(f))?!l||!l.includes(g)?r[g]=d:(u||(u={}))[g]=d:isEmitListener(n.emitsOptions,f)||(!(f in o)||d!==o[f])&&(o[f]=d,c=!0)}if(l){const f=toRaw(r),d=u||EMPTY_OBJ;for(let g=0;g<l.length;g++){const m=l[g];r[m]=resolvePropValue(s,f,m,d[m],n,!hasOwn(d,m))}}return c}function resolvePropValue(n,e,r,o,s,l){const c=n[r];if(c!=null){const u=hasOwn(c,"default");if(u&&o===void 0){const f=c.default;if(c.type!==Function&&isFunction(f)){const{propsDefaults:d}=s;r in d?o=d[r]:(setCurrentInstance(s),o=d[r]=f.call(null,e),unsetCurrentInstance())}else o=f}c[0]&&(l&&!u?o=!1:c[1]&&(o===""||o===hyphenate(r))&&(o=!0))}return o}function normalizePropsOptions(n,e,r=!1){const o=e.propsCache,s=o.get(n);if(s)return s;const l=n.props,c={},u=[];let f=!1;if(!isFunction(n)){const g=m=>{f=!0;const[v,b]=normalizePropsOptions(m,e,!0);extend$1(c,v),b&&u.push(...b)};!r&&e.mixins.length&&e.mixins.forEach(g),n.extends&&g(n.extends),n.mixins&&n.mixins.forEach(g)}if(!l&&!f)return isObject$1(n)&&o.set(n,EMPTY_ARR),EMPTY_ARR;if(isArray$1(l))for(let g=0;g<l.length;g++){const m=camelize(l[g]);validatePropName(m)&&(c[m]=EMPTY_OBJ)}else if(l)for(const g in l){const m=camelize(g);if(validatePropName(m)){const v=l[g],b=c[m]=isArray$1(v)||isFunction(v)?{type:v}:Object.assign({},v);if(b){const k=getTypeIndex(Boolean,b.type),R=getTypeIndex(String,b.type);b[0]=k>-1,b[1]=R<0||k<R,(k>-1||hasOwn(b,"default"))&&u.push(m)}}}const d=[c,u];return isObject$1(n)&&o.set(n,d),d}function validatePropName(n){return n[0]!=="$"}function getType(n){const e=n&&n.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:n===null?"null":""}function isSameType(n,e){return getType(n)===getType(e)}function getTypeIndex(n,e){return isArray$1(e)?e.findIndex(r=>isSameType(r,n)):isFunction(e)&&isSameType(e,n)?0:-1}const isInternalKey=n=>n[0]==="_"||n==="$stable",normalizeSlotValue=n=>isArray$1(n)?n.map(normalizeVNode):[normalizeVNode(n)],normalizeSlot$1=(n,e,r)=>{if(e._n)return e;const o=withCtx((...s)=>normalizeSlotValue(e(...s)),r);return o._c=!1,o},normalizeObjectSlots=(n,e,r)=>{const o=n._ctx;for(const s in n){if(isInternalKey(s))continue;const l=n[s];if(isFunction(l))e[s]=normalizeSlot$1(s,l,o);else if(l!=null){const c=normalizeSlotValue(l);e[s]=()=>c}}},normalizeVNodeSlots=(n,e)=>{const r=normalizeSlotValue(e);n.slots.default=()=>r},initSlots=(n,e)=>{if(n.vnode.shapeFlag&32){const r=e._;r?(n.slots=toRaw(e),def(e,"_",r)):normalizeObjectSlots(e,n.slots={})}else n.slots={},e&&normalizeVNodeSlots(n,e);def(n.slots,InternalObjectKey,1)},updateSlots=(n,e,r)=>{const{vnode:o,slots:s}=n;let l=!0,c=EMPTY_OBJ;if(o.shapeFlag&32){const u=e._;u?r&&u===1?l=!1:(extend$1(s,e),!r&&u===1&&delete s._):(l=!e.$stable,normalizeObjectSlots(e,s)),c=e}else e&&(normalizeVNodeSlots(n,e),c={default:1});if(l)for(const u in s)!isInternalKey(u)&&!(u in c)&&delete s[u]};function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(n,e){return function(o,s=null){isFunction(o)||(o=Object.assign({},o)),s!=null&&!isObject$1(s)&&(s=null);const l=createAppContext(),c=new Set;let u=!1;const f=l.app={_uid:uid$1++,_component:o,_props:s,_container:null,_context:l,_instance:null,version,get config(){return l.config},set config(d){},use(d,...g){return c.has(d)||(d&&isFunction(d.install)?(c.add(d),d.install(f,...g)):isFunction(d)&&(c.add(d),d(f,...g))),f},mixin(d){return l.mixins.includes(d)||l.mixins.push(d),f},component(d,g){return g?(l.components[d]=g,f):l.components[d]},directive(d,g){return g?(l.directives[d]=g,f):l.directives[d]},mount(d,g,m){if(!u){const v=createVNode(o,s);return v.appContext=l,g&&e?e(v,d):n(v,d,m),u=!0,f._container=d,d.__vue_app__=f,getExposeProxy(v.component)||v.component.proxy}},unmount(){u&&(n(null,f._container),delete f._container.__vue_app__)},provide(d,g){return l.provides[d]=g,f}};return f}}function setRef(n,e,r,o,s=!1){if(isArray$1(n)){n.forEach((v,b)=>setRef(v,e&&(isArray$1(e)?e[b]:e),r,o,s));return}if(isAsyncWrapper(o)&&!s)return;const l=o.shapeFlag&4?getExposeProxy(o.component)||o.component.proxy:o.el,c=s?null:l,{i:u,r:f}=n,d=e&&e.r,g=u.refs===EMPTY_OBJ?u.refs={}:u.refs,m=u.setupState;if(d!=null&&d!==f&&(isString(d)?(g[d]=null,hasOwn(m,d)&&(m[d]=null)):isRef(d)&&(d.value=null)),isFunction(f))callWithErrorHandling(f,u,12,[c,g]);else{const v=isString(f),b=isRef(f);if(v||b){const k=()=>{if(n.f){const R=v?hasOwn(m,f)?m[f]:g[f]:f.value;s?isArray$1(R)&&remove$1(R,l):isArray$1(R)?R.includes(l)||R.push(l):v?(g[f]=[l],hasOwn(m,f)&&(m[f]=g[f])):(f.value=[l],n.k&&(g[n.k]=f.value))}else v?(g[f]=c,hasOwn(m,f)&&(m[f]=c)):b&&(f.value=c,n.k&&(g[n.k]=c))};c?(k.id=-1,queuePostRenderEffect(k,r)):k()}}}const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(n){return baseCreateRenderer(n)}function baseCreateRenderer(n,e){const r=getGlobalThis();r.__VUE__=!0;const{insert:o,remove:s,patchProp:l,createElement:c,createText:u,createComment:f,setText:d,setElementText:g,parentNode:m,nextSibling:v,setScopeId:b=NOOP,insertStaticContent:k}=n,R=(N,_,te,ae=null,Ee=null,lt=null,Bn=!1,ut=null,tn=!!_.dynamicChildren)=>{if(N===_)return;N&&!isSameVNodeType(N,_)&&(ae=H(N),Ge(N,Ee,lt,!0),N=null),_.patchFlag===-2&&(tn=!1,_.dynamicChildren=null);const{type:nt,ref:ci,shapeFlag:zn}=_;switch(nt){case Text$1:I(N,_,te,ae);break;case Comment:$(N,_,te,ae);break;case Static:N==null&&Y(_,te,ae,Bn);break;case Fragment:He(N,_,te,ae,Ee,lt,Bn,ut,tn);break;default:zn&1?q(N,_,te,ae,Ee,lt,Bn,ut,tn):zn&6?st(N,_,te,ae,Ee,lt,Bn,ut,tn):(zn&64||zn&128)&&nt.process(N,_,te,ae,Ee,lt,Bn,ut,tn,Ce)}ci!=null&&Ee&&setRef(ci,N&&N.ref,lt,_||N,!_)},I=(N,_,te,ae)=>{if(N==null)o(_.el=u(_.children),te,ae);else{const Ee=_.el=N.el;_.children!==N.children&&d(Ee,_.children)}},$=(N,_,te,ae)=>{N==null?o(_.el=f(_.children||""),te,ae):_.el=N.el},Y=(N,_,te,ae)=>{[N.el,N.anchor]=k(N.children,_,te,ae,N.el,N.anchor)},oe=({el:N,anchor:_},te,ae)=>{let Ee;for(;N&&N!==_;)Ee=v(N),o(N,te,ae),N=Ee;o(_,te,ae)},G=({el:N,anchor:_})=>{let te;for(;N&&N!==_;)te=v(N),s(N),N=te;s(_)},q=(N,_,te,ae,Ee,lt,Bn,ut,tn)=>{Bn=Bn||_.type==="svg",N==null?ne(_,te,ae,Ee,lt,Bn,ut,tn):ge(N,_,Ee,lt,Bn,ut,tn)},ne=(N,_,te,ae,Ee,lt,Bn,ut)=>{let tn,nt;const{type:ci,props:zn,shapeFlag:hi,transition:fi,dirs:di}=N;if(tn=N.el=c(N.type,lt,zn&&zn.is,zn),hi&8?g(tn,N.children):hi&16&&qe(N.children,tn,null,ae,Ee,lt&&ci!=="foreignObject",Bn,ut),di&&invokeDirectiveHook(N,null,ae,"created"),K(tn,N,N.scopeId,Bn,ae),zn){for(const gi in zn)gi!=="value"&&!isReservedProp(gi)&&l(tn,gi,null,zn[gi],lt,N.children,ae,Ee,le);"value"in zn&&l(tn,"value",null,zn.value),(nt=zn.onVnodeBeforeMount)&&invokeVNodeHook(nt,ae,N)}di&&invokeDirectiveHook(N,null,ae,"beforeMount");const xi=(!Ee||Ee&&!Ee.pendingBranch)&&fi&&!fi.persisted;xi&&fi.beforeEnter(tn),o(tn,_,te),((nt=zn&&zn.onVnodeMounted)||xi||di)&&queuePostRenderEffect(()=>{nt&&invokeVNodeHook(nt,ae,N),xi&&fi.enter(tn),di&&invokeDirectiveHook(N,null,ae,"mounted")},Ee)},K=(N,_,te,ae,Ee)=>{if(te&&b(N,te),ae)for(let lt=0;lt<ae.length;lt++)b(N,ae[lt]);if(Ee){let lt=Ee.subTree;if(_===lt){const Bn=Ee.vnode;K(N,Bn,Bn.scopeId,Bn.slotScopeIds,Ee.parent)}}},qe=(N,_,te,ae,Ee,lt,Bn,ut,tn=0)=>{for(let nt=tn;nt<N.length;nt++){const ci=N[nt]=ut?cloneIfMounted(N[nt]):normalizeVNode(N[nt]);R(null,ci,_,te,ae,Ee,lt,Bn,ut)}},ge=(N,_,te,ae,Ee,lt,Bn)=>{const ut=_.el=N.el;let{patchFlag:tn,dynamicChildren:nt,dirs:ci}=_;tn|=N.patchFlag&16;const zn=N.props||EMPTY_OBJ,hi=_.props||EMPTY_OBJ;let fi;te&&toggleRecurse(te,!1),(fi=hi.onVnodeBeforeUpdate)&&invokeVNodeHook(fi,te,_,N),ci&&invokeDirectiveHook(_,N,te,"beforeUpdate"),te&&toggleRecurse(te,!0);const di=Ee&&_.type!=="foreignObject";if(nt?Z(N.dynamicChildren,nt,ut,te,ae,di,lt):Bn||We(N,_,ut,null,te,ae,di,lt,!1),tn>0){if(tn&16)re(ut,_,zn,hi,te,ae,Ee);else if(tn&2&&zn.class!==hi.class&&l(ut,"class",null,hi.class,Ee),tn&4&&l(ut,"style",zn.style,hi.style,Ee),tn&8){const xi=_.dynamicProps;for(let gi=0;gi<xi.length;gi++){const pr=xi[gi],br=zn[pr],Sr=hi[pr];(Sr!==br||pr==="value")&&l(ut,pr,br,Sr,Ee,N.children,te,ae,le)}}tn&1&&N.children!==_.children&&g(ut,_.children)}else!Bn&&nt==null&&re(ut,_,zn,hi,te,ae,Ee);((fi=hi.onVnodeUpdated)||ci)&&queuePostRenderEffect(()=>{fi&&invokeVNodeHook(fi,te,_,N),ci&&invokeDirectiveHook(_,N,te,"updated")},ae)},Z=(N,_,te,ae,Ee,lt,Bn)=>{for(let ut=0;ut<_.length;ut++){const tn=N[ut],nt=_[ut],ci=tn.el&&(tn.type===Fragment||!isSameVNodeType(tn,nt)||tn.shapeFlag&70)?m(tn.el):te;R(tn,nt,ci,null,ae,Ee,lt,Bn,!0)}},re=(N,_,te,ae,Ee,lt,Bn)=>{if(te!==ae){if(te!==EMPTY_OBJ)for(const ut in te)!isReservedProp(ut)&&!(ut in ae)&&l(N,ut,te[ut],null,Bn,_.children,Ee,lt,le);for(const ut in ae){if(isReservedProp(ut))continue;const tn=ae[ut],nt=te[ut];tn!==nt&&ut!=="value"&&l(N,ut,nt,tn,Bn,_.children,Ee,lt,le)}"value"in ae&&l(N,"value",te.value,ae.value)}},He=(N,_,te,ae,Ee,lt,Bn,ut,tn)=>{const nt=_.el=N?N.el:u(""),ci=_.anchor=N?N.anchor:u("");let{patchFlag:zn,dynamicChildren:hi,slotScopeIds:fi}=_;fi&&(ut=ut?ut.concat(fi):fi),N==null?(o(nt,te,ae),o(ci,te,ae),qe(_.children,te,ci,Ee,lt,Bn,ut,tn)):zn>0&&zn&64&&hi&&N.dynamicChildren?(Z(N.dynamicChildren,hi,te,Ee,lt,Bn,ut),(_.key!=null||Ee&&_===Ee.subTree)&&traverseStaticChildren(N,_,!0)):We(N,_,te,ci,Ee,lt,Bn,ut,tn)},st=(N,_,te,ae,Ee,lt,Bn,ut,tn)=>{_.slotScopeIds=ut,N==null?_.shapeFlag&512?Ee.ctx.activate(_,te,ae,Bn,tn):ee(_,te,ae,Ee,lt,Bn,tn):_e(N,_,tn)},ee=(N,_,te,ae,Ee,lt,Bn)=>{const ut=N.component=createComponentInstance(N,ae,Ee);if(isKeepAlive(N)&&(ut.ctx.renderer=Ce),setupComponent(ut),ut.asyncDep){if(Ee&&Ee.registerDep(ut,ue),!N.el){const tn=ut.subTree=createVNode(Comment);$(null,tn,_,te)}return}ue(ut,N,_,te,Ee,lt,Bn)},_e=(N,_,te)=>{const ae=_.component=N.component;if(shouldUpdateComponent(N,_,te))if(ae.asyncDep&&!ae.asyncResolved){ye(ae,_,te);return}else ae.next=_,invalidateJob(ae.update),ae.update();else _.el=N.el,ae.vnode=_},ue=(N,_,te,ae,Ee,lt,Bn)=>{const ut=()=>{if(N.isMounted){let{next:ci,bu:zn,u:hi,parent:fi,vnode:di}=N,xi=ci,gi;toggleRecurse(N,!1),ci?(ci.el=di.el,ye(N,ci,Bn)):ci=di,zn&&invokeArrayFns(zn),(gi=ci.props&&ci.props.onVnodeBeforeUpdate)&&invokeVNodeHook(gi,fi,ci,di),toggleRecurse(N,!0);const pr=renderComponentRoot(N),br=N.subTree;N.subTree=pr,R(br,pr,m(br.el),H(br),N,Ee,lt),ci.el=pr.el,xi===null&&updateHOCHostEl(N,pr.el),hi&&queuePostRenderEffect(hi,Ee),(gi=ci.props&&ci.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(gi,fi,ci,di),Ee)}else{let ci;const{el:zn,props:hi}=_,{bm:fi,m:di,parent:xi}=N,gi=isAsyncWrapper(_);if(toggleRecurse(N,!1),fi&&invokeArrayFns(fi),!gi&&(ci=hi&&hi.onVnodeBeforeMount)&&invokeVNodeHook(ci,xi,_),toggleRecurse(N,!0),zn&&Le){const pr=()=>{N.subTree=renderComponentRoot(N),Le(zn,N.subTree,N,Ee,null)};gi?_.type.__asyncLoader().then(()=>!N.isUnmounted&&pr()):pr()}else{const pr=N.subTree=renderComponentRoot(N);R(null,pr,te,ae,N,Ee,lt),_.el=pr.el}if(di&&queuePostRenderEffect(di,Ee),!gi&&(ci=hi&&hi.onVnodeMounted)){const pr=_;queuePostRenderEffect(()=>invokeVNodeHook(ci,xi,pr),Ee)}(_.shapeFlag&256||xi&&isAsyncWrapper(xi.vnode)&&xi.vnode.shapeFlag&256)&&N.a&&queuePostRenderEffect(N.a,Ee),N.isMounted=!0,_=te=ae=null}},tn=N.effect=new ReactiveEffect(ut,()=>queueJob(nt),N.scope),nt=N.update=()=>tn.run();nt.id=N.uid,toggleRecurse(N,!0),nt()},ye=(N,_,te)=>{_.component=N;const ae=N.vnode.props;N.vnode=_,N.next=null,updateProps(N,_.props,ae,te),updateSlots(N,_.children,te),pauseTracking(),flushPreFlushCbs(),resetTracking()},We=(N,_,te,ae,Ee,lt,Bn,ut,tn=!1)=>{const nt=N&&N.children,ci=N?N.shapeFlag:0,zn=_.children,{patchFlag:hi,shapeFlag:fi}=_;if(hi>0){if(hi&128){Ae(nt,zn,te,ae,Ee,lt,Bn,ut,tn);return}else if(hi&256){Ze(nt,zn,te,ae,Ee,lt,Bn,ut,tn);return}}fi&8?(ci&16&&le(nt,Ee,lt),zn!==nt&&g(te,zn)):ci&16?fi&16?Ae(nt,zn,te,ae,Ee,lt,Bn,ut,tn):le(nt,Ee,lt,!0):(ci&8&&g(te,""),fi&16&&qe(zn,te,ae,Ee,lt,Bn,ut,tn))},Ze=(N,_,te,ae,Ee,lt,Bn,ut,tn)=>{N=N||EMPTY_ARR,_=_||EMPTY_ARR;const nt=N.length,ci=_.length,zn=Math.min(nt,ci);let hi;for(hi=0;hi<zn;hi++){const fi=_[hi]=tn?cloneIfMounted(_[hi]):normalizeVNode(_[hi]);R(N[hi],fi,te,null,Ee,lt,Bn,ut,tn)}nt>ci?le(N,Ee,lt,!0,!1,zn):qe(_,te,ae,Ee,lt,Bn,ut,tn,zn)},Ae=(N,_,te,ae,Ee,lt,Bn,ut,tn)=>{let nt=0;const ci=_.length;let zn=N.length-1,hi=ci-1;for(;nt<=zn&&nt<=hi;){const fi=N[nt],di=_[nt]=tn?cloneIfMounted(_[nt]):normalizeVNode(_[nt]);if(isSameVNodeType(fi,di))R(fi,di,te,null,Ee,lt,Bn,ut,tn);else break;nt++}for(;nt<=zn&&nt<=hi;){const fi=N[zn],di=_[hi]=tn?cloneIfMounted(_[hi]):normalizeVNode(_[hi]);if(isSameVNodeType(fi,di))R(fi,di,te,null,Ee,lt,Bn,ut,tn);else break;zn--,hi--}if(nt>zn){if(nt<=hi){const fi=hi+1,di=fi<ci?_[fi].el:ae;for(;nt<=hi;)R(null,_[nt]=tn?cloneIfMounted(_[nt]):normalizeVNode(_[nt]),te,di,Ee,lt,Bn,ut,tn),nt++}}else if(nt>hi)for(;nt<=zn;)Ge(N[nt],Ee,lt,!0),nt++;else{const fi=nt,di=nt,xi=new Map;for(nt=di;nt<=hi;nt++){const yr=_[nt]=tn?cloneIfMounted(_[nt]):normalizeVNode(_[nt]);yr.key!=null&&xi.set(yr.key,nt)}let gi,pr=0;const br=hi-di+1;let Sr=!1,kr=0;const xr=new Array(br);for(nt=0;nt<br;nt++)xr[nt]=0;for(nt=fi;nt<=zn;nt++){const yr=N[nt];if(pr>=br){Ge(yr,Ee,lt,!0);continue}let wr;if(yr.key!=null)wr=xi.get(yr.key);else for(gi=di;gi<=hi;gi++)if(xr[gi-di]===0&&isSameVNodeType(yr,_[gi])){wr=gi;break}wr===void 0?Ge(yr,Ee,lt,!0):(xr[wr-di]=nt+1,wr>=kr?kr=wr:Sr=!0,R(yr,_[wr],te,null,Ee,lt,Bn,ut,tn),pr++)}const Cr=Sr?getSequence(xr):EMPTY_ARR;for(gi=Cr.length-1,nt=br-1;nt>=0;nt--){const yr=di+nt,wr=_[yr],Er=yr+1<ci?_[yr+1].el:ae;xr[nt]===0?R(null,wr,te,Er,Ee,lt,Bn,ut,tn):Sr&&(gi<0||nt!==Cr[gi]?Bt(wr,te,Er,2):gi--)}}},Bt=(N,_,te,ae,Ee=null)=>{const{el:lt,type:Bn,transition:ut,children:tn,shapeFlag:nt}=N;if(nt&6){Bt(N.component.subTree,_,te,ae);return}if(nt&128){N.suspense.move(_,te,ae);return}if(nt&64){Bn.move(N,_,te,Ce);return}if(Bn===Fragment){o(lt,_,te);for(let zn=0;zn<tn.length;zn++)Bt(tn[zn],_,te,ae);o(N.anchor,_,te);return}if(Bn===Static){oe(N,_,te);return}if(ae!==2&&nt&1&&ut)if(ae===0)ut.beforeEnter(lt),o(lt,_,te),queuePostRenderEffect(()=>ut.enter(lt),Ee);else{const{leave:zn,delayLeave:hi,afterLeave:fi}=ut,di=()=>o(lt,_,te),xi=()=>{zn(lt,()=>{di(),fi&&fi()})};hi?hi(lt,di,xi):xi()}else o(lt,_,te)},Ge=(N,_,te,ae=!1,Ee=!1)=>{const{type:lt,props:Bn,ref:ut,children:tn,dynamicChildren:nt,shapeFlag:ci,patchFlag:zn,dirs:hi}=N;if(ut!=null&&setRef(ut,null,te,N,!0),ci&256){_.ctx.deactivate(N);return}const fi=ci&1&&hi,di=!isAsyncWrapper(N);let xi;if(di&&(xi=Bn&&Bn.onVnodeBeforeUnmount)&&invokeVNodeHook(xi,_,N),ci&6)fe(N.component,te,ae);else{if(ci&128){N.suspense.unmount(te,ae);return}fi&&invokeDirectiveHook(N,null,_,"beforeUnmount"),ci&64?N.type.remove(N,_,te,Ee,Ce,ae):nt&&(lt!==Fragment||zn>0&&zn&64)?le(nt,_,te,!1,!0):(lt===Fragment&&zn&384||!Ee&&ci&16)&&le(tn,_,te),ae&&Dn(N)}(di&&(xi=Bn&&Bn.onVnodeUnmounted)||fi)&&queuePostRenderEffect(()=>{xi&&invokeVNodeHook(xi,_,N),fi&&invokeDirectiveHook(N,null,_,"unmounted")},te)},Dn=N=>{const{type:_,el:te,anchor:ae,transition:Ee}=N;if(_===Fragment){An(te,ae);return}if(_===Static){G(N);return}const lt=()=>{s(te),Ee&&!Ee.persisted&&Ee.afterLeave&&Ee.afterLeave()};if(N.shapeFlag&1&&Ee&&!Ee.persisted){const{leave:Bn,delayLeave:ut}=Ee,tn=()=>Bn(te,lt);ut?ut(N.el,lt,tn):tn()}else lt()},An=(N,_)=>{let te;for(;N!==_;)te=v(N),s(N),N=te;s(_)},fe=(N,_,te)=>{const{bum:ae,scope:Ee,update:lt,subTree:Bn,um:ut}=N;ae&&invokeArrayFns(ae),Ee.stop(),lt&&(lt.active=!1,Ge(Bn,N,_,te)),ut&&queuePostRenderEffect(ut,_),queuePostRenderEffect(()=>{N.isUnmounted=!0},_),_&&_.pendingBranch&&!_.isUnmounted&&N.asyncDep&&!N.asyncResolved&&N.suspenseId===_.pendingId&&(_.deps--,_.deps===0&&_.resolve())},le=(N,_,te,ae=!1,Ee=!1,lt=0)=>{for(let Bn=lt;Bn<N.length;Bn++)Ge(N[Bn],_,te,ae,Ee)},H=N=>N.shapeFlag&6?H(N.component.subTree):N.shapeFlag&128?N.suspense.next():v(N.anchor||N.el),J=(N,_,te)=>{N==null?_._vnode&&Ge(_._vnode,null,null,!0):R(_._vnode||null,N,_,null,null,null,te),flushPreFlushCbs(),flushPostFlushCbs(),_._vnode=N},Ce={p:R,um:Ge,m:Bt,r:Dn,mt:ee,mc:qe,pc:We,pbc:Z,n:H,o:n};let Ve,Le;return e&&([Ve,Le]=e(Ce)),{render:J,hydrate:Ve,createApp:createAppAPI(J,Ve)}}function toggleRecurse({effect:n,update:e},r){n.allowRecurse=e.allowRecurse=r}function traverseStaticChildren(n,e,r=!1){const o=n.children,s=e.children;if(isArray$1(o)&&isArray$1(s))for(let l=0;l<o.length;l++){const c=o[l];let u=s[l];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=s[l]=cloneIfMounted(s[l]),u.el=c.el),r||traverseStaticChildren(c,u)),u.type===Text$1&&(u.el=c.el)}}function getSequence(n){const e=n.slice(),r=[0];let o,s,l,c,u;const f=n.length;for(o=0;o<f;o++){const d=n[o];if(d!==0){if(s=r[r.length-1],n[s]<d){e[o]=s,r.push(o);continue}for(l=0,c=r.length-1;l<c;)u=l+c>>1,n[r[u]]<d?l=u+1:c=u;d<n[r[l]]&&(l>0&&(e[o]=r[l-1]),r[l]=o)}}for(l=r.length,c=r[l-1];l-- >0;)r[l]=c,c=e[c];return r}const isTeleport=n=>n.__isTeleport,Fragment=Symbol(void 0),Text$1=Symbol(void 0),Comment=Symbol(void 0),Static=Symbol(void 0),blockStack=[];let currentBlock=null;function openBlock(n=!1){blockStack.push(currentBlock=n?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(n){isBlockTreeEnabled+=n}function setupBlock(n){return n.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(n),n}function createElementBlock(n,e,r,o,s,l){return setupBlock(createBaseVNode(n,e,r,o,s,l,!0))}function createBlock(n,e,r,o,s){return setupBlock(createVNode(n,e,r,o,s,!0))}function isVNode(n){return n?n.__v_isVNode===!0:!1}function isSameVNodeType(n,e){return n.type===e.type&&n.key===e.key}const InternalObjectKey="__vInternal",normalizeKey=({key:n})=>n??null,normalizeRef=({ref:n,ref_key:e,ref_for:r})=>n!=null?isString(n)||isRef(n)||isFunction(n)?{i:currentRenderingInstance,r:n,k:e,f:!!r}:n:null;function createBaseVNode(n,e=null,r=null,o=0,s=null,l=n===Fragment?0:1,c=!1,u=!1){const f={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&normalizeKey(e),ref:e&&normalizeRef(e),scopeId:currentScopeId,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:l,patchFlag:o,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return u?(normalizeChildren(f,r),l&128&&n.normalize(f)):r&&(f.shapeFlag|=isString(r)?8:16),isBlockTreeEnabled>0&&!c&&currentBlock&&(f.patchFlag>0||l&6)&&f.patchFlag!==32&&currentBlock.push(f),f}const createVNode=_createVNode;function _createVNode(n,e=null,r=null,o=0,s=null,l=!1){if((!n||n===NULL_DYNAMIC_COMPONENT)&&(n=Comment),isVNode(n)){const u=cloneVNode(n,e,!0);return r&&normalizeChildren(u,r),isBlockTreeEnabled>0&&!l&&currentBlock&&(u.shapeFlag&6?currentBlock[currentBlock.indexOf(n)]=u:currentBlock.push(u)),u.patchFlag|=-2,u}if(isClassComponent(n)&&(n=n.__vccOpts),e){e=guardReactiveProps(e);let{class:u,style:f}=e;u&&!isString(u)&&(e.class=normalizeClass(u)),isObject$1(f)&&(isProxy(f)&&!isArray$1(f)&&(f=extend$1({},f)),e.style=normalizeStyle(f))}const c=isString(n)?1:isSuspense(n)?128:isTeleport(n)?64:isObject$1(n)?4:isFunction(n)?2:0;return createBaseVNode(n,e,r,o,s,c,l,!0)}function guardReactiveProps(n){return n?isProxy(n)||InternalObjectKey in n?extend$1({},n):n:null}function cloneVNode(n,e,r=!1){const{props:o,ref:s,patchFlag:l,children:c}=n,u=e?mergeProps(o||{},e):o;return{__v_isVNode:!0,__v_skip:!0,type:n.type,props:u,key:u&&normalizeKey(u),ref:e&&e.ref?r&&s?isArray$1(s)?s.concat(normalizeRef(e)):[s,normalizeRef(e)]:normalizeRef(e):s,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:c,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Fragment?l===-1?16:l|16:l,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:n.transition,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&cloneVNode(n.ssContent),ssFallback:n.ssFallback&&cloneVNode(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce}}function createTextVNode(n=" ",e=0){return createVNode(Text$1,null,n,e)}function createCommentVNode(n="",e=!1){return e?(openBlock(),createBlock(Comment,null,n)):createVNode(Comment,null,n)}function normalizeVNode(n){return n==null||typeof n=="boolean"?createVNode(Comment):isArray$1(n)?createVNode(Fragment,null,n.slice()):typeof n=="object"?cloneIfMounted(n):createVNode(Text$1,null,String(n))}function cloneIfMounted(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:cloneVNode(n)}function normalizeChildren(n,e){let r=0;const{shapeFlag:o}=n;if(e==null)e=null;else if(isArray$1(e))r=16;else if(typeof e=="object")if(o&65){const s=e.default;s&&(s._c&&(s._d=!1),normalizeChildren(n,s()),s._c&&(s._d=!0));return}else{r=32;const s=e._;!s&&!(InternalObjectKey in e)?e._ctx=currentRenderingInstance:s===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else isFunction(e)?(e={default:e,_ctx:currentRenderingInstance},r=32):(e=String(e),o&64?(r=16,e=[createTextVNode(e)]):r=8);n.children=e,n.shapeFlag|=r}function mergeProps(...n){const e={};for(let r=0;r<n.length;r++){const o=n[r];for(const s in o)if(s==="class")e.class!==o.class&&(e.class=normalizeClass([e.class,o.class]));else if(s==="style")e.style=normalizeStyle([e.style,o.style]);else if(isOn(s)){const l=e[s],c=o[s];c&&l!==c&&!(isArray$1(l)&&l.includes(c))&&(e[s]=l?[].concat(l,c):c)}else s!==""&&(e[s]=o[s])}return e}function invokeVNodeHook(n,e,r,o=null){callWithAsyncErrorHandling(n,e,7,[r,o])}const emptyAppContext=createAppContext();let uid=0;function createComponentInstance(n,e,r){const o=n.type,s=(e?e.appContext:n.appContext)||emptyAppContext,l={uid:uid++,vnode:n,type:o,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(o,s),emitsOptions:normalizeEmitsOptions(o,s),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:o.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return l.ctx={_:l},l.root=e?e.root:l,l.emit=emit.bind(null,l),n.ce&&n.ce(l),l}let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance,setCurrentInstance=n=>{currentInstance=n,n.scope.on()},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),currentInstance=null};function isStatefulComponent(n){return n.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(n,e=!1){isInSSRComponentSetup=e;const{props:r,children:o}=n.vnode,s=isStatefulComponent(n);initProps(n,r,s,e),initSlots(n,o);const l=s?setupStatefulComponent(n,e):void 0;return isInSSRComponentSetup=!1,l}function setupStatefulComponent(n,e){const r=n.type;n.accessCache=Object.create(null),n.proxy=markRaw(new Proxy(n.ctx,PublicInstanceProxyHandlers));const{setup:o}=r;if(o){const s=n.setupContext=o.length>1?createSetupContext(n):null;setCurrentInstance(n),pauseTracking();const l=callWithErrorHandling(o,n,0,[n.props,s]);if(resetTracking(),unsetCurrentInstance(),isPromise(l)){if(l.then(unsetCurrentInstance,unsetCurrentInstance),e)return l.then(c=>{handleSetupResult(n,c,e)}).catch(c=>{handleError(c,n,0)});n.asyncDep=l}else handleSetupResult(n,l,e)}else finishComponentSetup(n,e)}function handleSetupResult(n,e,r){isFunction(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:isObject$1(e)&&(n.setupState=proxyRefs(e)),finishComponentSetup(n,r)}let compile;function finishComponentSetup(n,e,r){const o=n.type;if(!n.render){if(!e&&compile&&!o.render){const s=o.template||resolveMergedOptions(n).template;if(s){const{isCustomElement:l,compilerOptions:c}=n.appContext.config,{delimiters:u,compilerOptions:f}=o,d=extend$1(extend$1({isCustomElement:l,delimiters:u},c),f);o.render=compile(s,d)}}n.render=o.render||NOOP}setCurrentInstance(n),pauseTracking(),applyOptions(n),resetTracking(),unsetCurrentInstance()}function createAttrsProxy(n){return new Proxy(n.attrs,{get(e,r){return track(n,"get","$attrs"),e[r]}})}function createSetupContext(n){const e=o=>{n.exposed=o||{}};let r;return{get attrs(){return r||(r=createAttrsProxy(n))},slots:n.slots,emit:n.emit,expose:e}}function getExposeProxy(n){if(n.exposed)return n.exposeProxy||(n.exposeProxy=new Proxy(proxyRefs(markRaw(n.exposed)),{get(e,r){if(r in e)return e[r];if(r in publicPropertiesMap)return publicPropertiesMap[r](n)},has(e,r){return r in e||r in publicPropertiesMap}}))}function getComponentName(n,e=!0){return isFunction(n)?n.displayName||n.name:n.name||e&&n.__name}function isClassComponent(n){return isFunction(n)&&"__vccOpts"in n}const computed=(n,e)=>computed$1(n,e,isInSSRComponentSetup);function useSlots(){return getContext().slots}function getContext(){const n=getCurrentInstance();return n.setupContext||(n.setupContext=createSetupContext(n))}function h$1(n,e,r){const o=arguments.length;return o===2?isObject$1(e)&&!isArray$1(e)?isVNode(e)?createVNode(n,null,[e]):createVNode(n,e):createVNode(n,null,e):(o>3?r=Array.prototype.slice.call(arguments,2):o===3&&isVNode(r)&&(r=[r]),createVNode(n,e,r))}const ssrContextKey=Symbol(""),useSSRContext=()=>inject(ssrContextKey),version="3.2.47",svgNS="http://www.w3.org/2000/svg",doc$1=typeof document<"u"?document:null,templateContainer=doc$1&&doc$1.createElement("template"),nodeOps={insert:(n,e,r)=>{e.insertBefore(n,r||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,r,o)=>{const s=e?doc$1.createElementNS(svgNS,n):doc$1.createElement(n,r?{is:r}:void 0);return n==="select"&&o&&o.multiple!=null&&s.setAttribute("multiple",o.multiple),s},createText:n=>doc$1.createTextNode(n),createComment:n=>doc$1.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>doc$1.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,r,o,s,l){const c=r?r.previousSibling:e.lastChild;if(s&&(s===l||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),r),!(s===l||!(s=s.nextSibling)););else{templateContainer.innerHTML=o?`<svg>${n}</svg>`:n;const u=templateContainer.content;if(o){const f=u.firstChild;for(;f.firstChild;)u.appendChild(f.firstChild);u.removeChild(f)}e.insertBefore(u,r)}return[c?c.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}};function patchClass(n,e,r){const o=n._vtc;o&&(e=(e?[e,...o]:[...o]).join(" ")),e==null?n.removeAttribute("class"):r?n.setAttribute("class",e):n.className=e}function patchStyle(n,e,r){const o=n.style,s=isString(r);if(r&&!s){if(e&&!isString(e))for(const l in e)r[l]==null&&setStyle(o,l,"");for(const l in r)setStyle(o,l,r[l])}else{const l=o.display;s?e!==r&&(o.cssText=r):e&&n.removeAttribute("style"),"_vod"in n&&(o.display=l)}}const importantRE=/\s*!important$/;function setStyle(n,e,r){if(isArray$1(r))r.forEach(o=>setStyle(n,e,o));else if(r==null&&(r=""),e.startsWith("--"))n.setProperty(e,r);else{const o=autoPrefix(n,e);importantRE.test(r)?n.setProperty(hyphenate(o),r.replace(importantRE,""),"important"):n[o]=r}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(n,e){const r=prefixCache[e];if(r)return r;let o=camelize(e);if(o!=="filter"&&o in n)return prefixCache[e]=o;o=capitalize(o);for(let s=0;s<prefixes.length;s++){const l=prefixes[s]+o;if(l in n)return prefixCache[e]=l}return e}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(n,e,r,o,s){if(o&&e.startsWith("xlink:"))r==null?n.removeAttributeNS(xlinkNS,e.slice(6,e.length)):n.setAttributeNS(xlinkNS,e,r);else{const l=isSpecialBooleanAttr(e);r==null||l&&!includeBooleanAttr(r)?n.removeAttribute(e):n.setAttribute(e,l?"":r)}}function patchDOMProp(n,e,r,o,s,l,c){if(e==="innerHTML"||e==="textContent"){o&&c(o,s,l),n[e]=r??"";return}if(e==="value"&&n.tagName!=="PROGRESS"&&!n.tagName.includes("-")){n._value=r;const f=r??"";(n.value!==f||n.tagName==="OPTION")&&(n.value=f),r==null&&n.removeAttribute(e);return}let u=!1;if(r===""||r==null){const f=typeof n[e];f==="boolean"?r=includeBooleanAttr(r):r==null&&f==="string"?(r="",u=!0):f==="number"&&(r=0,u=!0)}try{n[e]=r}catch{}u&&n.removeAttribute(e)}function addEventListener(n,e,r,o){n.addEventListener(e,r,o)}function removeEventListener(n,e,r,o){n.removeEventListener(e,r,o)}function patchEvent(n,e,r,o,s=null){const l=n._vei||(n._vei={}),c=l[e];if(o&&c)c.value=o;else{const[u,f]=parseName(e);if(o){const d=l[e]=createInvoker(o,s);addEventListener(n,u,d,f)}else c&&(removeEventListener(n,u,c,f),l[e]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(n){let e;if(optionsModifierRE.test(n)){e={};let o;for(;o=n.match(optionsModifierRE);)n=n.slice(0,n.length-o[0].length),e[o[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):hyphenate(n.slice(2)),e]}let cachedNow=0;const p=Promise.resolve(),getNow=()=>cachedNow||(p.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(n,e){const r=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=r.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(o,r.value),e,5,[o])};return r.value=n,r.attached=getNow(),r}function patchStopImmediatePropagation(n,e){if(isArray$1(e)){const r=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{r.call(n),n._stopped=!0},e.map(o=>s=>!s._stopped&&o&&o(s))}else return e}const nativeOnRE=/^on[a-z]/,patchProp=(n,e,r,o,s=!1,l,c,u,f)=>{e==="class"?patchClass(n,o,s):e==="style"?patchStyle(n,r,o):isOn(e)?isModelListener(e)||patchEvent(n,e,r,o,c):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):shouldSetAsProp(n,e,o,s))?patchDOMProp(n,e,o,l,c,u,f):(e==="true-value"?n._trueValue=o:e==="false-value"&&(n._falseValue=o),patchAttr(n,e,o,s))};function shouldSetAsProp(n,e,r,o){return o?!!(e==="innerHTML"||e==="textContent"||e in n&&nativeOnRE.test(e)&&isFunction(r)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA"||nativeOnRE.test(e)&&isString(r)?!1:e in n}const getModelAssigner=n=>{const e=n.props["onUpdate:modelValue"]||!1;return isArray$1(e)?r=>invokeArrayFns(e,r):e};function onCompositionStart(n){n.target.composing=!0}function onCompositionEnd(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const vModelText={created(n,{modifiers:{lazy:e,trim:r,number:o}},s){n._assign=getModelAssigner(s);const l=o||s.props&&s.props.type==="number";addEventListener(n,e?"change":"input",c=>{if(c.target.composing)return;let u=n.value;r&&(u=u.trim()),l&&(u=looseToNumber(u)),n._assign(u)}),r&&addEventListener(n,"change",()=>{n.value=n.value.trim()}),e||(addEventListener(n,"compositionstart",onCompositionStart),addEventListener(n,"compositionend",onCompositionEnd),addEventListener(n,"change",onCompositionEnd))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,modifiers:{lazy:r,trim:o,number:s}},l){if(n._assign=getModelAssigner(l),n.composing||document.activeElement===n&&n.type!=="range"&&(r||o&&n.value.trim()===e||(s||n.type==="number")&&looseToNumber(n.value)===e))return;const c=e??"";n.value!==c&&(n.value=c)}},vModelCheckbox={deep:!0,created(n,e,r){n._assign=getModelAssigner(r),addEventListener(n,"change",()=>{const o=n._modelValue,s=getValue(n),l=n.checked,c=n._assign;if(isArray$1(o)){const u=looseIndexOf(o,s),f=u!==-1;if(l&&!f)c(o.concat(s));else if(!l&&f){const d=[...o];d.splice(u,1),c(d)}}else if(isSet(o)){const u=new Set(o);l?u.add(s):u.delete(s),c(u)}else c(getCheckboxValue(n,l))})},mounted:setChecked,beforeUpdate(n,e,r){n._assign=getModelAssigner(r),setChecked(n,e,r)}};function setChecked(n,{value:e,oldValue:r},o){n._modelValue=e,isArray$1(e)?n.checked=looseIndexOf(e,o.props.value)>-1:isSet(e)?n.checked=e.has(o.props.value):e!==r&&(n.checked=looseEqual(e,getCheckboxValue(n,!0)))}const vModelSelect={deep:!0,created(n,{value:e,modifiers:{number:r}},o){const s=isSet(e);addEventListener(n,"change",()=>{const l=Array.prototype.filter.call(n.options,c=>c.selected).map(c=>r?looseToNumber(getValue(c)):getValue(c));n._assign(n.multiple?s?new Set(l):l:l[0])}),n._assign=getModelAssigner(o)},mounted(n,{value:e}){setSelected(n,e)},beforeUpdate(n,e,r){n._assign=getModelAssigner(r)},updated(n,{value:e}){setSelected(n,e)}};function setSelected(n,e){const r=n.multiple;if(!(r&&!isArray$1(e)&&!isSet(e))){for(let o=0,s=n.options.length;o<s;o++){const l=n.options[o],c=getValue(l);if(r)isArray$1(e)?l.selected=looseIndexOf(e,c)>-1:l.selected=e.has(c);else if(looseEqual(getValue(l),e)){n.selectedIndex!==o&&(n.selectedIndex=o);return}}!r&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function getValue(n){return"_value"in n?n._value:n.value}function getCheckboxValue(n,e){const r=e?"_trueValue":"_falseValue";return r in n?n[r]:e}const rendererOptions=extend$1({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const createApp=(...n)=>{const e=ensureRenderer().createApp(...n),{mount:r}=e;return e.mount=o=>{const s=normalizeContainer(o);if(!s)return;const l=e._component;!isFunction(l)&&!l.render&&!l.template&&(l.template=s.innerHTML),s.innerHTML="";const c=r(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),c},e};function normalizeContainer(n){return isString(n)?document.querySelector(n):n}var isVue2=!1;/*!
  * pinia v2.0.35
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const piniaSymbol=Symbol();var MutationType;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(MutationType||(MutationType={}));function createPinia(){const n=effectScope(!0),e=n.run(()=>ref({}));let r=[],o=[];const s=markRaw({install(l){s._a=l,l.provide(piniaSymbol,s),l.config.globalProperties.$pinia=s,o.forEach(c=>r.push(c)),o=[]},use(l){return!this._a&&!isVue2?o.push(l):r.push(l),this},_p:r,_a:null,_e:n,_s:new Map,state:e});return s}function isObject(n){return typeof n=="object"&&n!==null}function normalizeOptions(n,e){return n=isObject(n)?n:Object.create(null),new Proxy(n,{get(r,o,s){return o==="key"?Reflect.get(r,o,s):Reflect.get(r,o,s)||Reflect.get(e,o,s)}})}function get(n,e){return e.reduce((r,o)=>r==null?void 0:r[o],n)}function set(n,e,r){return e.slice(0,-1).reduce((o,s)=>/^(__proto__)$/.test(s)?{}:o[s]=o[s]||{},n)[e[e.length-1]]=r,n}function pick(n,e){return e.reduce((r,o)=>{const s=o.split(".");return set(r,s,get(n,s))},{})}function hydrateStore(n,{storage:e,serializer:r,key:o,debug:s}){try{const l=e==null?void 0:e.getItem(o);l&&n.$patch(r==null?void 0:r.deserialize(l))}catch(l){s&&console.error(l)}}function persistState(n,{storage:e,serializer:r,key:o,paths:s,debug:l}){try{const c=Array.isArray(s)?pick(n,s):n;e.setItem(o,r.serialize(c))}catch(c){l&&console.error(c)}}function createPersistedState(n={}){return e=>{const{auto:r=!1}=n,{options:{persist:o=r},store:s}=e;if(!o)return;const l=(Array.isArray(o)?o.map(c=>normalizeOptions(c,n)):[normalizeOptions(o,n)]).map(({storage:c=localStorage,beforeRestore:u=null,afterRestore:f=null,serializer:d={serialize:JSON.stringify,deserialize:JSON.parse},key:g=s.$id,paths:m=null,debug:v=!1})=>{var b;return{storage:c,beforeRestore:u,afterRestore:f,serializer:d,key:((b=n.key)!=null?b:k=>k)(g),paths:m,debug:v}});s.$persist=()=>{l.forEach(c=>{persistState(s.$state,c)})},s.$hydrate=({runHooks:c=!0}={})=>{l.forEach(u=>{const{beforeRestore:f,afterRestore:d}=u;c&&(f==null||f(e)),hydrateStore(s,u),c&&(d==null||d(e))})},l.forEach(c=>{const{beforeRestore:u,afterRestore:f}=c;u==null||u(e),hydrateStore(s,c),f==null||f(e),s.$subscribe((d,g)=>{persistState(g,c)},{detached:!0})})}}var src_default=createPersistedState();class Text{constructor(){}lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,r,o){let s=[];return this.decompose(0,e,s,2),o.length&&o.decompose(0,o.length,s,3),this.decompose(r,this.length,s,1),TextNode.from(s,this.length-(r-e)+o.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,r=this.length){let o=[];return this.decompose(e,r,o,0),TextNode.from(o,r-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let r=this.scanIdentical(e,1),o=this.length-this.scanIdentical(e,-1),s=new RawTextCursor(this),l=new RawTextCursor(e);for(let c=r,u=r;;){if(s.next(c),l.next(c),c=0,s.lineBreak!=l.lineBreak||s.done!=l.done||s.value!=l.value)return!1;if(u+=s.value.length,s.done||u>=o)return!0}}iter(e=1){return new RawTextCursor(this,e)}iterRange(e,r=this.length){return new PartialTextCursor(this,e,r)}iterLines(e,r){let o;if(e==null)o=this.iter();else{r==null&&(r=this.lines+1);let s=this.line(e).from;o=this.iterRange(s,Math.max(s,r==this.lines+1?this.length:r<=1?0:this.line(r-1).to))}return new LineCursor(o)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Text.empty:e.length<=32?new TextLeaf(e):TextNode.from(TextLeaf.split(e,[]))}}class TextLeaf extends Text{constructor(e,r=textLength(e)){super(),this.text=e,this.length=r}get lines(){return this.text.length}get children(){return null}lineInner(e,r,o,s){for(let l=0;;l++){let c=this.text[l],u=s+c.length;if((r?o:u)>=e)return new Line(s,u,o,c);s=u+1,o++}}decompose(e,r,o,s){let l=e<=0&&r>=this.length?this:new TextLeaf(sliceText(this.text,e,r),Math.min(r,this.length)-Math.max(0,e));if(s&1){let c=o.pop(),u=appendText(l.text,c.text.slice(),0,l.length);if(u.length<=32)o.push(new TextLeaf(u,c.length+l.length));else{let f=u.length>>1;o.push(new TextLeaf(u.slice(0,f)),new TextLeaf(u.slice(f)))}}else o.push(l)}replace(e,r,o){if(!(o instanceof TextLeaf))return super.replace(e,r,o);let s=appendText(this.text,appendText(o.text,sliceText(this.text,0,e)),r),l=this.length+o.length-(r-e);return s.length<=32?new TextLeaf(s,l):TextNode.from(TextLeaf.split(s,[]),l)}sliceString(e,r=this.length,o=`
`){let s="";for(let l=0,c=0;l<=r&&c<this.text.length;c++){let u=this.text[c],f=l+u.length;l>e&&c&&(s+=o),e<f&&r>l&&(s+=u.slice(Math.max(0,e-l),r-l)),l=f+1}return s}flatten(e){for(let r of this.text)e.push(r)}scanIdentical(){return 0}static split(e,r){let o=[],s=-1;for(let l of e)o.push(l),s+=l.length+1,o.length==32&&(r.push(new TextLeaf(o,s)),o=[],s=-1);return s>-1&&r.push(new TextLeaf(o,s)),r}}class TextNode extends Text{constructor(e,r){super(),this.children=e,this.length=r,this.lines=0;for(let o of e)this.lines+=o.lines}lineInner(e,r,o,s){for(let l=0;;l++){let c=this.children[l],u=s+c.length,f=o+c.lines-1;if((r?f:u)>=e)return c.lineInner(e,r,o,s);s=u+1,o=f+1}}decompose(e,r,o,s){for(let l=0,c=0;c<=r&&l<this.children.length;l++){let u=this.children[l],f=c+u.length;if(e<=f&&r>=c){let d=s&((c<=e?1:0)|(f>=r?2:0));c>=e&&f<=r&&!d?o.push(u):u.decompose(e-c,r-c,o,d)}c=f+1}}replace(e,r,o){if(o.lines<this.lines)for(let s=0,l=0;s<this.children.length;s++){let c=this.children[s],u=l+c.length;if(e>=l&&r<=u){let f=c.replace(e-l,r-l,o),d=this.lines-c.lines+f.lines;if(f.lines<d>>5-1&&f.lines>d>>5+1){let g=this.children.slice();return g[s]=f,new TextNode(g,this.length-(r-e)+o.length)}return super.replace(l,u,f)}l=u+1}return super.replace(e,r,o)}sliceString(e,r=this.length,o=`
`){let s="";for(let l=0,c=0;l<this.children.length&&c<=r;l++){let u=this.children[l],f=c+u.length;c>e&&l&&(s+=o),e<f&&r>c&&(s+=u.sliceString(e-c,r-c,o)),c=f+1}return s}flatten(e){for(let r of this.children)r.flatten(e)}scanIdentical(e,r){if(!(e instanceof TextNode))return 0;let o=0,[s,l,c,u]=r>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;s+=r,l+=r){if(s==c||l==u)return o;let f=this.children[s],d=e.children[l];if(f!=d)return o+f.scanIdentical(d,r);o+=f.length+1}}static from(e,r=e.reduce((o,s)=>o+s.length+1,-1)){let o=0;for(let b of e)o+=b.lines;if(o<32){let b=[];for(let k of e)k.flatten(b);return new TextLeaf(b,r)}let s=Math.max(32,o>>5),l=s<<1,c=s>>1,u=[],f=0,d=-1,g=[];function m(b){let k;if(b.lines>l&&b instanceof TextNode)for(let R of b.children)m(R);else b.lines>c&&(f>c||!f)?(v(),u.push(b)):b instanceof TextLeaf&&f&&(k=g[g.length-1])instanceof TextLeaf&&b.lines+k.lines<=32?(f+=b.lines,d+=b.length+1,g[g.length-1]=new TextLeaf(k.text.concat(b.text),k.length+1+b.length)):(f+b.lines>s&&v(),f+=b.lines,d+=b.length+1,g.push(b))}function v(){f!=0&&(u.push(g.length==1?g[0]:TextNode.from(g,d)),d=-1,f=g.length=0)}for(let b of e)m(b);return v(),u.length==1?u[0]:new TextNode(u,r)}}Text.empty=new TextLeaf([""],0);function textLength(n){let e=-1;for(let r of n)e+=r.length+1;return e}function appendText(n,e,r=0,o=1e9){for(let s=0,l=0,c=!0;l<n.length&&s<=o;l++){let u=n[l],f=s+u.length;f>=r&&(f>o&&(u=u.slice(0,o-s)),s<r&&(u=u.slice(r-s)),c?(e[e.length-1]+=u,c=!1):e.push(u)),s=f+1}return e}function sliceText(n,e,r){return appendText(n,[""],e,r)}class RawTextCursor{constructor(e,r=1){this.dir=r,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[r>0?1:(e instanceof TextLeaf?e.text.length:e.children.length)<<1]}nextInner(e,r){for(this.done=this.lineBreak=!1;;){let o=this.nodes.length-1,s=this.nodes[o],l=this.offsets[o],c=l>>1,u=s instanceof TextLeaf?s.text.length:s.children.length;if(c==(r>0?u:0)){if(o==0)return this.done=!0,this.value="",this;r>0&&this.offsets[o-1]++,this.nodes.pop(),this.offsets.pop()}else if((l&1)==(r>0?0:1)){if(this.offsets[o]+=r,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(s instanceof TextLeaf){let f=s.text[c+(r<0?-1:0)];if(this.offsets[o]+=r,f.length>Math.max(0,e))return this.value=e==0?f:r>0?f.slice(e):f.slice(0,f.length-e),this;e-=f.length}else{let f=s.children[c+(r<0?-1:0)];e>f.length?(e-=f.length,this.offsets[o]+=r):(r<0&&this.offsets[o]--,this.nodes.push(f),this.offsets.push(r>0?1:(f instanceof TextLeaf?f.text.length:f.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class PartialTextCursor{constructor(e,r,o){this.value="",this.done=!1,this.cursor=new RawTextCursor(e,r>o?-1:1),this.pos=r>o?e.length:0,this.from=Math.min(r,o),this.to=Math.max(r,o)}nextInner(e,r){if(r<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,r<0?this.pos-this.to:this.from-this.pos);let o=r<0?this.pos-this.from:this.to-this.pos;e>o&&(e=o),o-=e;let{value:s}=this.cursor.next(e);return this.pos+=(s.length+e)*r,this.value=s.length<=o?s:r<0?s.slice(s.length-o):s.slice(0,o),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class LineCursor{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:r,lineBreak:o,value:s}=this.inner.next(e);return r?(this.done=!0,this.value=""):o?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Text.prototype[Symbol.iterator]=function(){return this.iter()},RawTextCursor.prototype[Symbol.iterator]=PartialTextCursor.prototype[Symbol.iterator]=LineCursor.prototype[Symbol.iterator]=function(){return this});class Line{constructor(e,r,o,s){this.from=e,this.to=r,this.number=o,this.text=s}get length(){return this.to-this.from}}let extend="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(n=>n?parseInt(n,36):1);for(let n=1;n<extend.length;n++)extend[n]+=extend[n-1];function isExtendingChar(n){for(let e=1;e<extend.length;e+=2)if(extend[e]>n)return extend[e-1]<=n;return!1}function isRegionalIndicator(n){return n>=127462&&n<=127487}const ZWJ=8205;function findClusterBreak(n,e,r=!0,o=!0){return(r?nextClusterBreak:prevClusterBreak)(n,e,o)}function nextClusterBreak(n,e,r){if(e==n.length)return e;e&&surrogateLow(n.charCodeAt(e))&&surrogateHigh(n.charCodeAt(e-1))&&e--;let o=codePointAt(n,e);for(e+=codePointSize(o);e<n.length;){let s=codePointAt(n,e);if(o==ZWJ||s==ZWJ||r&&isExtendingChar(s))e+=codePointSize(s),o=s;else if(isRegionalIndicator(s)){let l=0,c=e-2;for(;c>=0&&isRegionalIndicator(codePointAt(n,c));)l++,c-=2;if(l%2==0)break;e+=2}else break}return e}function prevClusterBreak(n,e,r){for(;e>0;){let o=nextClusterBreak(n,e-2,r);if(o<e)return o;e--}return 0}function surrogateLow(n){return n>=56320&&n<57344}function surrogateHigh(n){return n>=55296&&n<56320}function codePointAt(n,e){let r=n.charCodeAt(e);if(!surrogateHigh(r)||e+1==n.length)return r;let o=n.charCodeAt(e+1);return surrogateLow(o)?(r-55296<<10)+(o-56320)+65536:r}function fromCodePoint(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function codePointSize(n){return n<65536?1:2}const DefaultSplit=/\r\n?|\n/;var MapMode=function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n}(MapMode||(MapMode={}));class ChangeDesc{constructor(e){this.sections=e}get length(){let e=0;for(let r=0;r<this.sections.length;r+=2)e+=this.sections[r];return e}get newLength(){let e=0;for(let r=0;r<this.sections.length;r+=2){let o=this.sections[r+1];e+=o<0?this.sections[r]:o}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let r=0,o=0,s=0;r<this.sections.length;){let l=this.sections[r++],c=this.sections[r++];c<0?(e(o,s,l),s+=l):s+=c,o+=l}}iterChangedRanges(e,r=!1){iterChanges(this,e,r)}get invertedDesc(){let e=[];for(let r=0;r<this.sections.length;){let o=this.sections[r++],s=this.sections[r++];s<0?e.push(o,s):e.push(s,o)}return new ChangeDesc(e)}composeDesc(e){return this.empty?e:e.empty?this:composeSets(this,e)}mapDesc(e,r=!1){return e.empty?this:mapSet(this,e,r)}mapPos(e,r=-1,o=MapMode.Simple){let s=0,l=0;for(let c=0;c<this.sections.length;){let u=this.sections[c++],f=this.sections[c++],d=s+u;if(f<0){if(d>e)return l+(e-s);l+=u}else{if(o!=MapMode.Simple&&d>=e&&(o==MapMode.TrackDel&&s<e&&d>e||o==MapMode.TrackBefore&&s<e||o==MapMode.TrackAfter&&d>e))return null;if(d>e||d==e&&r<0&&!u)return e==s||r<0?l:l+f;l+=f}s=d}if(e>s)throw new RangeError(`Position ${e} is out of range for changeset of length ${s}`);return l}touchesRange(e,r=e){for(let o=0,s=0;o<this.sections.length&&s<=r;){let l=this.sections[o++],c=this.sections[o++],u=s+l;if(c>=0&&s<=r&&u>=e)return s<e&&u>r?"cover":!0;s=u}return!1}toString(){let e="";for(let r=0;r<this.sections.length;){let o=this.sections[r++],s=this.sections[r++];e+=(e?" ":"")+o+(s>=0?":"+s:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(r=>typeof r!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ChangeDesc(e)}static create(e){return new ChangeDesc(e)}}class ChangeSet extends ChangeDesc{constructor(e,r){super(e),this.inserted=r}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return iterChanges(this,(r,o,s,l,c)=>e=e.replace(s,s+(o-r),c),!1),e}mapDesc(e,r=!1){return mapSet(this,e,r,!0)}invert(e){let r=this.sections.slice(),o=[];for(let s=0,l=0;s<r.length;s+=2){let c=r[s],u=r[s+1];if(u>=0){r[s]=u,r[s+1]=c;let f=s>>1;for(;o.length<f;)o.push(Text.empty);o.push(c?e.slice(l,l+c):Text.empty)}l+=c}return new ChangeSet(r,o)}compose(e){return this.empty?e:e.empty?this:composeSets(this,e,!0)}map(e,r=!1){return e.empty?this:mapSet(this,e,r,!0)}iterChanges(e,r=!1){iterChanges(this,e,r)}get desc(){return ChangeDesc.create(this.sections)}filter(e){let r=[],o=[],s=[],l=new SectionIter(this);e:for(let c=0,u=0;;){let f=c==e.length?1e9:e[c++];for(;u<f||u==f&&l.len==0;){if(l.done)break e;let g=Math.min(l.len,f-u);addSection(s,g,-1);let m=l.ins==-1?-1:l.off==0?l.ins:0;addSection(r,g,m),m>0&&addInsert(o,r,l.text),l.forward(g),u+=g}let d=e[c++];for(;u<d;){if(l.done)break e;let g=Math.min(l.len,d-u);addSection(r,g,-1),addSection(s,g,l.ins==-1?-1:l.off==0?l.ins:0),l.forward(g),u+=g}}return{changes:new ChangeSet(r,o),filtered:ChangeDesc.create(s)}}toJSON(){let e=[];for(let r=0;r<this.sections.length;r+=2){let o=this.sections[r],s=this.sections[r+1];s<0?e.push(o):s==0?e.push([o]):e.push([o].concat(this.inserted[r>>1].toJSON()))}return e}static of(e,r,o){let s=[],l=[],c=0,u=null;function f(g=!1){if(!g&&!s.length)return;c<r&&addSection(s,r-c,-1);let m=new ChangeSet(s,l);u=u?u.compose(m.map(u)):m,s=[],l=[],c=0}function d(g){if(Array.isArray(g))for(let m of g)d(m);else if(g instanceof ChangeSet){if(g.length!=r)throw new RangeError(`Mismatched change set length (got ${g.length}, expected ${r})`);f(),u=u?u.compose(g.map(u)):g}else{let{from:m,to:v=m,insert:b}=g;if(m>v||m<0||v>r)throw new RangeError(`Invalid change range ${m} to ${v} (in doc of length ${r})`);let k=b?typeof b=="string"?Text.of(b.split(o||DefaultSplit)):b:Text.empty,R=k.length;if(m==v&&R==0)return;m<c&&f(),m>c&&addSection(s,m-c,-1),addSection(s,v-m,R),addInsert(l,s,k),c=v}}return d(e),f(!u),u}static empty(e){return new ChangeSet(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let r=[],o=[];for(let s=0;s<e.length;s++){let l=e[s];if(typeof l=="number")r.push(l,-1);else{if(!Array.isArray(l)||typeof l[0]!="number"||l.some((c,u)=>u&&typeof c!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(l.length==1)r.push(l[0],0);else{for(;o.length<s;)o.push(Text.empty);o[s]=Text.of(l.slice(1)),r.push(l[0],o[s].length)}}}return new ChangeSet(r,o)}static createSet(e,r){return new ChangeSet(e,r)}}function addSection(n,e,r,o=!1){if(e==0&&r<=0)return;let s=n.length-2;s>=0&&r<=0&&r==n[s+1]?n[s]+=e:e==0&&n[s]==0?n[s+1]+=r:o?(n[s]+=e,n[s+1]+=r):n.push(e,r)}function addInsert(n,e,r){if(r.length==0)return;let o=e.length-2>>1;if(o<n.length)n[n.length-1]=n[n.length-1].append(r);else{for(;n.length<o;)n.push(Text.empty);n.push(r)}}function iterChanges(n,e,r){let o=n.inserted;for(let s=0,l=0,c=0;c<n.sections.length;){let u=n.sections[c++],f=n.sections[c++];if(f<0)s+=u,l+=u;else{let d=s,g=l,m=Text.empty;for(;d+=u,g+=f,f&&o&&(m=m.append(o[c-2>>1])),!(r||c==n.sections.length||n.sections[c+1]<0);)u=n.sections[c++],f=n.sections[c++];e(s,d,l,g,m),s=d,l=g}}}function mapSet(n,e,r,o=!1){let s=[],l=o?[]:null,c=new SectionIter(n),u=new SectionIter(e);for(let f=-1;;)if(c.ins==-1&&u.ins==-1){let d=Math.min(c.len,u.len);addSection(s,d,-1),c.forward(d),u.forward(d)}else if(u.ins>=0&&(c.ins<0||f==c.i||c.off==0&&(u.len<c.len||u.len==c.len&&!r))){let d=u.len;for(addSection(s,u.ins,-1);d;){let g=Math.min(c.len,d);c.ins>=0&&f<c.i&&c.len<=g&&(addSection(s,0,c.ins),l&&addInsert(l,s,c.text),f=c.i),c.forward(g),d-=g}u.next()}else if(c.ins>=0){let d=0,g=c.len;for(;g;)if(u.ins==-1){let m=Math.min(g,u.len);d+=m,g-=m,u.forward(m)}else if(u.ins==0&&u.len<g)g-=u.len,u.next();else break;addSection(s,d,f<c.i?c.ins:0),l&&f<c.i&&addInsert(l,s,c.text),f=c.i,c.forward(c.len-g)}else{if(c.done&&u.done)return l?ChangeSet.createSet(s,l):ChangeDesc.create(s);throw new Error("Mismatched change set lengths")}}function composeSets(n,e,r=!1){let o=[],s=r?[]:null,l=new SectionIter(n),c=new SectionIter(e);for(let u=!1;;){if(l.done&&c.done)return s?ChangeSet.createSet(o,s):ChangeDesc.create(o);if(l.ins==0)addSection(o,l.len,0,u),l.next();else if(c.len==0&&!c.done)addSection(o,0,c.ins,u),s&&addInsert(s,o,c.text),c.next();else{if(l.done||c.done)throw new Error("Mismatched change set lengths");{let f=Math.min(l.len2,c.len),d=o.length;if(l.ins==-1){let g=c.ins==-1?-1:c.off?0:c.ins;addSection(o,f,g,u),s&&g&&addInsert(s,o,c.text)}else c.ins==-1?(addSection(o,l.off?0:l.len,f,u),s&&addInsert(s,o,l.textBit(f))):(addSection(o,l.off?0:l.len,c.off?0:c.ins,u),s&&!c.off&&addInsert(s,o,c.text));u=(l.ins>f||c.ins>=0&&c.len>f)&&(u||o.length>d),l.forward2(f),c.forward(f)}}}}class SectionIter{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,r=this.i-2>>1;return r>=e.length?Text.empty:e[r]}textBit(e){let{inserted:r}=this.set,o=this.i-2>>1;return o>=r.length&&!e?Text.empty:r[o].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class SelectionRange{constructor(e,r,o){this.from=e,this.to=r,this.flags=o}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let e=this.flags&3;return e==3?null:e}get goalColumn(){let e=this.flags>>5;return e==33554431?void 0:e}map(e,r=-1){let o,s;return this.empty?o=s=e.mapPos(this.from,r):(o=e.mapPos(this.from,1),s=e.mapPos(this.to,-1)),o==this.from&&s==this.to?this:new SelectionRange(o,s,this.flags)}extend(e,r=e){if(e<=this.anchor&&r>=this.anchor)return EditorSelection.range(e,r);let o=Math.abs(e-this.anchor)>Math.abs(r-this.anchor)?e:r;return EditorSelection.range(this.anchor,o)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return EditorSelection.range(e.anchor,e.head)}static create(e,r,o){return new SelectionRange(e,r,o)}}class EditorSelection{constructor(e,r){this.ranges=e,this.mainIndex=r}map(e,r=-1){return e.empty?this:EditorSelection.create(this.ranges.map(o=>o.map(e,r)),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let r=0;r<this.ranges.length;r++)if(!this.ranges[r].eq(e.ranges[r]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new EditorSelection([this.main],0)}addRange(e,r=!0){return EditorSelection.create([e].concat(this.ranges),r?0:this.mainIndex+1)}replaceRange(e,r=this.mainIndex){let o=this.ranges.slice();return o[r]=e,EditorSelection.create(o,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new EditorSelection(e.ranges.map(r=>SelectionRange.fromJSON(r)),e.main)}static single(e,r=e){return new EditorSelection([EditorSelection.range(e,r)],0)}static create(e,r=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let o=0,s=0;s<e.length;s++){let l=e[s];if(l.empty?l.from<=o:l.from<o)return EditorSelection.normalized(e.slice(),r);o=l.to}return new EditorSelection(e,r)}static cursor(e,r=0,o,s){return SelectionRange.create(e,e,(r==0?0:r<0?4:8)|(o==null?3:Math.min(2,o))|(s??33554431)<<5)}static range(e,r,o,s){let l=(o??33554431)<<5|(s==null?3:Math.min(2,s));return r<e?SelectionRange.create(r,e,24|l):SelectionRange.create(e,r,(r>e?4:0)|l)}static normalized(e,r=0){let o=e[r];e.sort((s,l)=>s.from-l.from),r=e.indexOf(o);for(let s=1;s<e.length;s++){let l=e[s],c=e[s-1];if(l.empty?l.from<=c.to:l.from<c.to){let u=c.from,f=Math.max(l.to,c.to);s<=r&&r--,e.splice(--s,2,l.anchor>l.head?EditorSelection.range(f,u):EditorSelection.range(u,f))}}return new EditorSelection(e,r)}}function checkSelection(n,e){for(let r of n.ranges)if(r.to>e)throw new RangeError("Selection points outside of document")}let nextID=0;class Facet{constructor(e,r,o,s,l){this.combine=e,this.compareInput=r,this.compare=o,this.isStatic=s,this.id=nextID++,this.default=e([]),this.extensions=typeof l=="function"?l(this):l}static define(e={}){return new Facet(e.combine||(r=>r),e.compareInput||((r,o)=>r===o),e.compare||(e.combine?(r,o)=>r===o:sameArray$1),!!e.static,e.enables)}of(e){return new FacetProvider([],this,0,e)}compute(e,r){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(e,this,1,r)}computeN(e,r){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(e,this,2,r)}from(e,r){return r||(r=o=>o),this.compute([e],o=>r(o.field(e)))}}function sameArray$1(n,e){return n==e||n.length==e.length&&n.every((r,o)=>r===e[o])}class FacetProvider{constructor(e,r,o,s){this.dependencies=e,this.facet=r,this.type=o,this.value=s,this.id=nextID++}dynamicSlot(e){var r;let o=this.value,s=this.facet.compareInput,l=this.id,c=e[l]>>1,u=this.type==2,f=!1,d=!1,g=[];for(let m of this.dependencies)m=="doc"?f=!0:m=="selection"?d=!0:((r=e[m.id])!==null&&r!==void 0?r:1)&1||g.push(e[m.id]);return{create(m){return m.values[c]=o(m),1},update(m,v){if(f&&v.docChanged||d&&(v.docChanged||v.selection)||ensureAll(m,g)){let b=o(m);if(u?!compareArray(b,m.values[c],s):!s(b,m.values[c]))return m.values[c]=b,1}return 0},reconfigure:(m,v)=>{let b,k=v.config.address[l];if(k!=null){let R=getAddr(v,k);if(this.dependencies.every(I=>I instanceof Facet?v.facet(I)===m.facet(I):I instanceof StateField?v.field(I,!1)==m.field(I,!1):!0)||(u?compareArray(b=o(m),R,s):s(b=o(m),R)))return m.values[c]=R,0}else b=o(m);return m.values[c]=b,1}}}}function compareArray(n,e,r){if(n.length!=e.length)return!1;for(let o=0;o<n.length;o++)if(!r(n[o],e[o]))return!1;return!0}function ensureAll(n,e){let r=!1;for(let o of e)ensureAddr(n,o)&1&&(r=!0);return r}function dynamicFacetSlot(n,e,r){let o=r.map(f=>n[f.id]),s=r.map(f=>f.type),l=o.filter(f=>!(f&1)),c=n[e.id]>>1;function u(f){let d=[];for(let g=0;g<o.length;g++){let m=getAddr(f,o[g]);if(s[g]==2)for(let v of m)d.push(v);else d.push(m)}return e.combine(d)}return{create(f){for(let d of o)ensureAddr(f,d);return f.values[c]=u(f),1},update(f,d){if(!ensureAll(f,l))return 0;let g=u(f);return e.compare(g,f.values[c])?0:(f.values[c]=g,1)},reconfigure(f,d){let g=ensureAll(f,o),m=d.config.facets[e.id],v=d.facet(e);if(m&&!g&&sameArray$1(r,m))return f.values[c]=v,0;let b=u(f);return e.compare(b,v)?(f.values[c]=v,0):(f.values[c]=b,1)}}}const initField=Facet.define({static:!0});class StateField{constructor(e,r,o,s,l){this.id=e,this.createF=r,this.updateF=o,this.compareF=s,this.spec=l,this.provides=void 0}static define(e){let r=new StateField(nextID++,e.create,e.update,e.compare||((o,s)=>o===s),e);return e.provide&&(r.provides=e.provide(r)),r}create(e){let r=e.facet(initField).find(o=>o.field==this);return((r==null?void 0:r.create)||this.createF)(e)}slot(e){let r=e[this.id]>>1;return{create:o=>(o.values[r]=this.create(o),1),update:(o,s)=>{let l=o.values[r],c=this.updateF(l,s);return this.compareF(l,c)?0:(o.values[r]=c,1)},reconfigure:(o,s)=>s.config.address[this.id]!=null?(o.values[r]=s.field(this),0):(o.values[r]=this.create(o),1)}}init(e){return[this,initField.of({field:this,create:e})]}get extension(){return this}}const Prec_={lowest:4,low:3,default:2,high:1,highest:0};function prec(n){return e=>new PrecExtension(e,n)}const Prec={highest:prec(Prec_.highest),high:prec(Prec_.high),default:prec(Prec_.default),low:prec(Prec_.low),lowest:prec(Prec_.lowest)};class PrecExtension{constructor(e,r){this.inner=e,this.prec=r}}class Compartment{of(e){return new CompartmentInstance(this,e)}reconfigure(e){return Compartment.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class CompartmentInstance{constructor(e,r){this.compartment=e,this.inner=r}}class Configuration{constructor(e,r,o,s,l,c){for(this.base=e,this.compartments=r,this.dynamicSlots=o,this.address=s,this.staticValues=l,this.facets=c,this.statusTemplate=[];this.statusTemplate.length<o.length;)this.statusTemplate.push(0)}staticFacet(e){let r=this.address[e.id];return r==null?e.default:this.staticValues[r>>1]}static resolve(e,r,o){let s=[],l=Object.create(null),c=new Map;for(let v of flatten(e,r,c))v instanceof StateField?s.push(v):(l[v.facet.id]||(l[v.facet.id]=[])).push(v);let u=Object.create(null),f=[],d=[];for(let v of s)u[v.id]=d.length<<1,d.push(b=>v.slot(b));let g=o==null?void 0:o.config.facets;for(let v in l){let b=l[v],k=b[0].facet,R=g&&g[v]||[];if(b.every(I=>I.type==0))if(u[k.id]=f.length<<1|1,sameArray$1(R,b))f.push(o.facet(k));else{let I=k.combine(b.map($=>$.value));f.push(o&&k.compare(I,o.facet(k))?o.facet(k):I)}else{for(let I of b)I.type==0?(u[I.id]=f.length<<1|1,f.push(I.value)):(u[I.id]=d.length<<1,d.push($=>I.dynamicSlot($)));u[k.id]=d.length<<1,d.push(I=>dynamicFacetSlot(I,k,b))}}let m=d.map(v=>v(u));return new Configuration(e,c,m,u,f,l)}}function flatten(n,e,r){let o=[[],[],[],[],[]],s=new Map;function l(c,u){let f=s.get(c);if(f!=null){if(f<=u)return;let d=o[f].indexOf(c);d>-1&&o[f].splice(d,1),c instanceof CompartmentInstance&&r.delete(c.compartment)}if(s.set(c,u),Array.isArray(c))for(let d of c)l(d,u);else if(c instanceof CompartmentInstance){if(r.has(c.compartment))throw new RangeError("Duplicate use of compartment in extensions");let d=e.get(c.compartment)||c.inner;r.set(c.compartment,d),l(d,u)}else if(c instanceof PrecExtension)l(c.inner,c.prec);else if(c instanceof StateField)o[u].push(c),c.provides&&l(c.provides,u);else if(c instanceof FacetProvider)o[u].push(c),c.facet.extensions&&l(c.facet.extensions,Prec_.default);else{let d=c.extension;if(!d)throw new Error(`Unrecognized extension value in extension set (${c}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);l(d,u)}}return l(n,Prec_.default),o.reduce((c,u)=>c.concat(u))}function ensureAddr(n,e){if(e&1)return 2;let r=e>>1,o=n.status[r];if(o==4)throw new Error("Cyclic dependency between fields and/or facets");if(o&2)return o;n.status[r]=4;let s=n.computeSlot(n,n.config.dynamicSlots[r]);return n.status[r]=2|s}function getAddr(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const languageData=Facet.define(),allowMultipleSelections=Facet.define({combine:n=>n.some(e=>e),static:!0}),lineSeparator=Facet.define({combine:n=>n.length?n[0]:void 0,static:!0}),changeFilter=Facet.define(),transactionFilter=Facet.define(),transactionExtender=Facet.define(),readOnly=Facet.define({combine:n=>n.length?n[0]:!1});class Annotation{constructor(e,r){this.type=e,this.value=r}static define(){return new AnnotationType}}class AnnotationType{of(e){return new Annotation(this,e)}}class StateEffectType{constructor(e){this.map=e}of(e){return new StateEffect(this,e)}}class StateEffect{constructor(e,r){this.type=e,this.value=r}map(e){let r=this.type.map(this.value,e);return r===void 0?void 0:r==this.value?this:new StateEffect(this.type,r)}is(e){return this.type==e}static define(e={}){return new StateEffectType(e.map||(r=>r))}static mapEffects(e,r){if(!e.length)return e;let o=[];for(let s of e){let l=s.map(r);l&&o.push(l)}return o}}StateEffect.reconfigure=StateEffect.define();StateEffect.appendConfig=StateEffect.define();class Transaction{constructor(e,r,o,s,l,c){this.startState=e,this.changes=r,this.selection=o,this.effects=s,this.annotations=l,this.scrollIntoView=c,this._doc=null,this._state=null,o&&checkSelection(o,r.newLength),l.some(u=>u.type==Transaction.time)||(this.annotations=l.concat(Transaction.time.of(Date.now())))}static create(e,r,o,s,l,c){return new Transaction(e,r,o,s,l,c)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let r of this.annotations)if(r.type==e)return r.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let r=this.annotation(Transaction.userEvent);return!!(r&&(r==e||r.length>e.length&&r.slice(0,e.length)==e&&r[e.length]=="."))}}Transaction.time=Annotation.define();Transaction.userEvent=Annotation.define();Transaction.addToHistory=Annotation.define();Transaction.remote=Annotation.define();function joinRanges(n,e){let r=[];for(let o=0,s=0;;){let l,c;if(o<n.length&&(s==e.length||e[s]>=n[o]))l=n[o++],c=n[o++];else if(s<e.length)l=e[s++],c=e[s++];else return r;!r.length||r[r.length-1]<l?r.push(l,c):r[r.length-1]<c&&(r[r.length-1]=c)}}function mergeTransaction(n,e,r){var o;let s,l,c;return r?(s=e.changes,l=ChangeSet.empty(e.changes.length),c=n.changes.compose(e.changes)):(s=e.changes.map(n.changes),l=n.changes.mapDesc(e.changes,!0),c=n.changes.compose(s)),{changes:c,selection:e.selection?e.selection.map(l):(o=n.selection)===null||o===void 0?void 0:o.map(s),effects:StateEffect.mapEffects(n.effects,s).concat(StateEffect.mapEffects(e.effects,l)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function resolveTransactionInner(n,e,r){let o=e.selection,s=asArray$1(e.annotations);return e.userEvent&&(s=s.concat(Transaction.userEvent.of(e.userEvent))),{changes:e.changes instanceof ChangeSet?e.changes:ChangeSet.of(e.changes||[],r,n.facet(lineSeparator)),selection:o&&(o instanceof EditorSelection?o:EditorSelection.single(o.anchor,o.head)),effects:asArray$1(e.effects),annotations:s,scrollIntoView:!!e.scrollIntoView}}function resolveTransaction(n,e,r){let o=resolveTransactionInner(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(r=!1);for(let l=1;l<e.length;l++){e[l].filter===!1&&(r=!1);let c=!!e[l].sequential;o=mergeTransaction(o,resolveTransactionInner(n,e[l],c?o.changes.newLength:n.doc.length),c)}let s=Transaction.create(n,o.changes,o.selection,o.effects,o.annotations,o.scrollIntoView);return extendTransaction(r?filterTransaction(s):s)}function filterTransaction(n){let e=n.startState,r=!0;for(let s of e.facet(changeFilter)){let l=s(n);if(l===!1){r=!1;break}Array.isArray(l)&&(r=r===!0?l:joinRanges(r,l))}if(r!==!0){let s,l;if(r===!1)l=n.changes.invertedDesc,s=ChangeSet.empty(e.doc.length);else{let c=n.changes.filter(r);s=c.changes,l=c.filtered.mapDesc(c.changes).invertedDesc}n=Transaction.create(e,s,n.selection&&n.selection.map(l),StateEffect.mapEffects(n.effects,l),n.annotations,n.scrollIntoView)}let o=e.facet(transactionFilter);for(let s=o.length-1;s>=0;s--){let l=o[s](n);l instanceof Transaction?n=l:Array.isArray(l)&&l.length==1&&l[0]instanceof Transaction?n=l[0]:n=resolveTransaction(e,asArray$1(l),!1)}return n}function extendTransaction(n){let e=n.startState,r=e.facet(transactionExtender),o=n;for(let s=r.length-1;s>=0;s--){let l=r[s](n);l&&Object.keys(l).length&&(o=mergeTransaction(o,resolveTransactionInner(e,l,n.changes.newLength),!0))}return o==n?n:Transaction.create(e,n.changes,n.selection,o.effects,o.annotations,o.scrollIntoView)}const none$2=[];function asArray$1(n){return n==null?none$2:Array.isArray(n)?n:[n]}var CharCategory=function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n}(CharCategory||(CharCategory={}));const nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let wordChar;try{wordChar=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function hasWordChar(n){if(wordChar)return wordChar.test(n);for(let e=0;e<n.length;e++){let r=n[e];if(/\w/.test(r)||r>""&&(r.toUpperCase()!=r.toLowerCase()||nonASCIISingleCaseWordChar.test(r)))return!0}return!1}function makeCategorizer(n){return e=>{if(!/\S/.test(e))return CharCategory.Space;if(hasWordChar(e))return CharCategory.Word;for(let r=0;r<n.length;r++)if(e.indexOf(n[r])>-1)return CharCategory.Word;return CharCategory.Other}}class EditorState{constructor(e,r,o,s,l,c){this.config=e,this.doc=r,this.selection=o,this.values=s,this.status=e.statusTemplate.slice(),this.computeSlot=l,c&&(c._state=this);for(let u=0;u<this.config.dynamicSlots.length;u++)ensureAddr(this,u<<1);this.computeSlot=null}field(e,r=!0){let o=this.config.address[e.id];if(o==null){if(r)throw new RangeError("Field is not present in this state");return}return ensureAddr(this,o),getAddr(this,o)}update(...e){return resolveTransaction(this,e,!0)}applyTransaction(e){let r=this.config,{base:o,compartments:s}=r;for(let c of e.effects)c.is(Compartment.reconfigure)?(r&&(s=new Map,r.compartments.forEach((u,f)=>s.set(f,u)),r=null),s.set(c.value.compartment,c.value.extension)):c.is(StateEffect.reconfigure)?(r=null,o=c.value):c.is(StateEffect.appendConfig)&&(r=null,o=asArray$1(o).concat(c.value));let l;r?l=e.startState.values.slice():(r=Configuration.resolve(o,s,this),l=new EditorState(r,this.doc,this.selection,r.dynamicSlots.map(()=>null),(u,f)=>f.reconfigure(u,this),null).values),new EditorState(r,e.newDoc,e.newSelection,l,(c,u)=>u.update(c,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:e},range:EditorSelection.cursor(r.from+e.length)}))}changeByRange(e){let r=this.selection,o=e(r.ranges[0]),s=this.changes(o.changes),l=[o.range],c=asArray$1(o.effects);for(let u=1;u<r.ranges.length;u++){let f=e(r.ranges[u]),d=this.changes(f.changes),g=d.map(s);for(let v=0;v<u;v++)l[v]=l[v].map(g);let m=s.mapDesc(d,!0);l.push(f.range.map(m)),s=s.compose(g),c=StateEffect.mapEffects(c,g).concat(StateEffect.mapEffects(asArray$1(f.effects),m))}return{changes:s,selection:EditorSelection.create(l,r.mainIndex),effects:c}}changes(e=[]){return e instanceof ChangeSet?e:ChangeSet.of(e,this.doc.length,this.facet(EditorState.lineSeparator))}toText(e){return Text.of(e.split(this.facet(EditorState.lineSeparator)||DefaultSplit))}sliceDoc(e=0,r=this.doc.length){return this.doc.sliceString(e,r,this.lineBreak)}facet(e){let r=this.config.address[e.id];return r==null?e.default:(ensureAddr(this,r),getAddr(this,r))}toJSON(e){let r={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let o in e){let s=e[o];s instanceof StateField&&this.config.address[s.id]!=null&&(r[o]=s.spec.toJSON(this.field(e[o]),this))}return r}static fromJSON(e,r={},o){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(o){for(let l in o)if(Object.prototype.hasOwnProperty.call(e,l)){let c=o[l],u=e[l];s.push(c.init(f=>c.spec.fromJSON(u,f)))}}return EditorState.create({doc:e.doc,selection:EditorSelection.fromJSON(e.selection),extensions:r.extensions?s.concat([r.extensions]):s})}static create(e={}){let r=Configuration.resolve(e.extensions||[],new Map),o=e.doc instanceof Text?e.doc:Text.of((e.doc||"").split(r.staticFacet(EditorState.lineSeparator)||DefaultSplit)),s=e.selection?e.selection instanceof EditorSelection?e.selection:EditorSelection.single(e.selection.anchor,e.selection.head):EditorSelection.single(0);return checkSelection(s,o.length),r.staticFacet(allowMultipleSelections)||(s=s.asSingle()),new EditorState(r,o,s,r.dynamicSlots.map(()=>null),(l,c)=>c.create(l),null)}get tabSize(){return this.facet(EditorState.tabSize)}get lineBreak(){return this.facet(EditorState.lineSeparator)||`
`}get readOnly(){return this.facet(readOnly)}phrase(e,...r){for(let o of this.facet(EditorState.phrases))if(Object.prototype.hasOwnProperty.call(o,e)){e=o[e];break}return r.length&&(e=e.replace(/\$(\$|\d*)/g,(o,s)=>{if(s=="$")return"$";let l=+(s||1);return!l||l>r.length?o:r[l-1]})),e}languageDataAt(e,r,o=-1){let s=[];for(let l of this.facet(languageData))for(let c of l(this,r,o))Object.prototype.hasOwnProperty.call(c,e)&&s.push(c[e]);return s}charCategorizer(e){return makeCategorizer(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:r,from:o,length:s}=this.doc.lineAt(e),l=this.charCategorizer(e),c=e-o,u=e-o;for(;c>0;){let f=findClusterBreak(r,c,!1);if(l(r.slice(f,c))!=CharCategory.Word)break;c=f}for(;u<s;){let f=findClusterBreak(r,u);if(l(r.slice(u,f))!=CharCategory.Word)break;u=f}return c==u?null:EditorSelection.range(c+o,u+o)}}EditorState.allowMultipleSelections=allowMultipleSelections;EditorState.tabSize=Facet.define({combine:n=>n.length?n[0]:4});EditorState.lineSeparator=lineSeparator;EditorState.readOnly=readOnly;EditorState.phrases=Facet.define({compare(n,e){let r=Object.keys(n),o=Object.keys(e);return r.length==o.length&&r.every(s=>n[s]==e[s])}});EditorState.languageData=languageData;EditorState.changeFilter=changeFilter;EditorState.transactionFilter=transactionFilter;EditorState.transactionExtender=transactionExtender;Compartment.reconfigure=StateEffect.define();function combineConfig(n,e,r={}){let o={};for(let s of n)for(let l of Object.keys(s)){let c=s[l],u=o[l];if(u===void 0)o[l]=c;else if(!(u===c||c===void 0))if(Object.hasOwnProperty.call(r,l))o[l]=r[l](u,c);else throw new Error("Config merge conflict for field "+l)}for(let s in e)o[s]===void 0&&(o[s]=e[s]);return o}class RangeValue{eq(e){return this==e}range(e,r=e){return Range$1.create(e,r,this)}}RangeValue.prototype.startSide=RangeValue.prototype.endSide=0;RangeValue.prototype.point=!1;RangeValue.prototype.mapMode=MapMode.TrackDel;let Range$1=class Mr{constructor(e,r,o){this.from=e,this.to=r,this.value=o}static create(e,r,o){return new Mr(e,r,o)}};function cmpRange(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class Chunk{constructor(e,r,o,s){this.from=e,this.to=r,this.value=o,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(e,r,o,s=0){let l=o?this.to:this.from;for(let c=s,u=l.length;;){if(c==u)return c;let f=c+u>>1,d=l[f]-e||(o?this.value[f].endSide:this.value[f].startSide)-r;if(f==c)return d>=0?c:u;d>=0?u=f:c=f+1}}between(e,r,o,s){for(let l=this.findIndex(r,-1e9,!0),c=this.findIndex(o,1e9,!1,l);l<c;l++)if(s(this.from[l]+e,this.to[l]+e,this.value[l])===!1)return!1}map(e,r){let o=[],s=[],l=[],c=-1,u=-1;for(let f=0;f<this.value.length;f++){let d=this.value[f],g=this.from[f]+e,m=this.to[f]+e,v,b;if(g==m){let k=r.mapPos(g,d.startSide,d.mapMode);if(k==null||(v=b=k,d.startSide!=d.endSide&&(b=r.mapPos(g,d.endSide),b<v)))continue}else if(v=r.mapPos(g,d.startSide),b=r.mapPos(m,d.endSide),v>b||v==b&&d.startSide>0&&d.endSide<=0)continue;(b-v||d.endSide-d.startSide)<0||(c<0&&(c=v),d.point&&(u=Math.max(u,b-v)),o.push(d),s.push(v-c),l.push(b-c))}return{mapped:o.length?new Chunk(s,l,o,u):null,pos:c}}}class RangeSet{constructor(e,r,o,s){this.chunkPos=e,this.chunk=r,this.nextLayer=o,this.maxPoint=s}static create(e,r,o,s){return new RangeSet(e,r,o,s)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let r of this.chunk)e+=r.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:r=[],sort:o=!1,filterFrom:s=0,filterTo:l=this.length}=e,c=e.filter;if(r.length==0&&!c)return this;if(o&&(r=r.slice().sort(cmpRange)),this.isEmpty)return r.length?RangeSet.of(r):this;let u=new LayerCursor(this,null,-1).goto(0),f=0,d=[],g=new RangeSetBuilder;for(;u.value||f<r.length;)if(f<r.length&&(u.from-r[f].from||u.startSide-r[f].value.startSide)>=0){let m=r[f++];g.addInner(m.from,m.to,m.value)||d.push(m)}else u.rangeIndex==1&&u.chunkIndex<this.chunk.length&&(f==r.length||this.chunkEnd(u.chunkIndex)<r[f].from)&&(!c||s>this.chunkEnd(u.chunkIndex)||l<this.chunkPos[u.chunkIndex])&&g.addChunk(this.chunkPos[u.chunkIndex],this.chunk[u.chunkIndex])?u.nextChunk():((!c||s>u.to||l<u.from||c(u.from,u.to,u.value))&&(g.addInner(u.from,u.to,u.value)||d.push(Range$1.create(u.from,u.to,u.value))),u.next());return g.finishInner(this.nextLayer.isEmpty&&!d.length?RangeSet.empty:this.nextLayer.update({add:d,filter:c,filterFrom:s,filterTo:l}))}map(e){if(e.empty||this.isEmpty)return this;let r=[],o=[],s=-1;for(let c=0;c<this.chunk.length;c++){let u=this.chunkPos[c],f=this.chunk[c],d=e.touchesRange(u,u+f.length);if(d===!1)s=Math.max(s,f.maxPoint),r.push(f),o.push(e.mapPos(u));else if(d===!0){let{mapped:g,pos:m}=f.map(u,e);g&&(s=Math.max(s,g.maxPoint),r.push(g),o.push(m))}}let l=this.nextLayer.map(e);return r.length==0?l:new RangeSet(o,r,l||RangeSet.empty,s)}between(e,r,o){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let l=this.chunkPos[s],c=this.chunk[s];if(r>=l&&e<=l+c.length&&c.between(l,e-l,r-l,o)===!1)return}this.nextLayer.between(e,r,o)}}iter(e=0){return HeapCursor.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,r=0){return HeapCursor.from(e).goto(r)}static compare(e,r,o,s,l=-1){let c=e.filter(m=>m.maxPoint>0||!m.isEmpty&&m.maxPoint>=l),u=r.filter(m=>m.maxPoint>0||!m.isEmpty&&m.maxPoint>=l),f=findSharedChunks(c,u,o),d=new SpanCursor(c,f,l),g=new SpanCursor(u,f,l);o.iterGaps((m,v,b)=>compare(d,m,g,v,b,s)),o.empty&&o.length==0&&compare(d,0,g,0,0,s)}static eq(e,r,o=0,s){s==null&&(s=1e9-1);let l=e.filter(g=>!g.isEmpty&&r.indexOf(g)<0),c=r.filter(g=>!g.isEmpty&&e.indexOf(g)<0);if(l.length!=c.length)return!1;if(!l.length)return!0;let u=findSharedChunks(l,c),f=new SpanCursor(l,u,0).goto(o),d=new SpanCursor(c,u,0).goto(o);for(;;){if(f.to!=d.to||!sameValues(f.active,d.active)||f.point&&(!d.point||!f.point.eq(d.point)))return!1;if(f.to>s)return!0;f.next(),d.next()}}static spans(e,r,o,s,l=-1){let c=new SpanCursor(e,null,l).goto(r),u=r,f=c.openStart;for(;;){let d=Math.min(c.to,o);if(c.point){let g=c.activeForPoint(c.to),m=c.pointFrom<r?g.length+1:Math.min(g.length,f);s.point(u,d,c.point,g,m,c.pointRank),f=Math.min(c.openEnd(d),g.length)}else d>u&&(s.span(u,d,c.active,f),f=c.openEnd(d));if(c.to>o)return f+(c.point&&c.to>o?1:0);u=c.to,c.next()}}static of(e,r=!1){let o=new RangeSetBuilder;for(let s of e instanceof Range$1?[e]:r?lazySort(e):e)o.add(s.from,s.to,s.value);return o.finish()}}RangeSet.empty=new RangeSet([],[],null,-1);function lazySort(n){if(n.length>1)for(let e=n[0],r=1;r<n.length;r++){let o=n[r];if(cmpRange(e,o)>0)return n.slice().sort(cmpRange);e=o}return n}RangeSet.empty.nextLayer=RangeSet.empty;class RangeSetBuilder{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(e){this.chunks.push(new Chunk(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}add(e,r,o){this.addInner(e,r,o)||(this.nextLayer||(this.nextLayer=new RangeSetBuilder)).add(e,r,o)}addInner(e,r,o){let s=e-this.lastTo||o.startSide-this.last.endSide;if(s<=0&&(e-this.lastFrom||o.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(r-this.chunkStart),this.last=o,this.lastFrom=e,this.lastTo=r,this.value.push(o),o.point&&(this.maxPoint=Math.max(this.maxPoint,r-e)),!0)}addChunk(e,r){if((e-this.lastTo||r.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,r.maxPoint),this.chunks.push(r),this.chunkPos.push(e);let o=r.value.length-1;return this.last=r.value[o],this.lastFrom=r.from[o]+e,this.lastTo=r.to[o]+e,!0}finish(){return this.finishInner(RangeSet.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let r=RangeSet.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,r}}function findSharedChunks(n,e,r){let o=new Map;for(let l of n)for(let c=0;c<l.chunk.length;c++)l.chunk[c].maxPoint<=0&&o.set(l.chunk[c],l.chunkPos[c]);let s=new Set;for(let l of e)for(let c=0;c<l.chunk.length;c++){let u=o.get(l.chunk[c]);u!=null&&(r?r.mapPos(u):u)==l.chunkPos[c]&&!(r!=null&&r.touchesRange(u,u+l.chunk[c].length))&&s.add(l.chunk[c])}return s}class LayerCursor{constructor(e,r,o,s=0){this.layer=e,this.skip=r,this.minPoint=o,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,r=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,r,!1),this}gotoInner(e,r,o){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<e||s.maxPoint<this.minPoint))break;this.chunkIndex++,o=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],r,!0);(!o||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(e,r){(this.to-e||this.endSide-r)<0&&this.gotoInner(e,r,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],r=this.layer.chunk[this.chunkIndex],o=e+r.from[this.rangeIndex];if(this.from=o,this.to=e+r.to[this.rangeIndex],this.value=r.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class HeapCursor{constructor(e){this.heap=e}static from(e,r=null,o=-1){let s=[];for(let l=0;l<e.length;l++)for(let c=e[l];!c.isEmpty;c=c.nextLayer)c.maxPoint>=o&&s.push(new LayerCursor(c,r,o,l));return s.length==1?s[0]:new HeapCursor(s)}get startSide(){return this.value?this.value.startSide:0}goto(e,r=-1e9){for(let o of this.heap)o.goto(e,r);for(let o=this.heap.length>>1;o>=0;o--)heapBubble(this.heap,o);return this.next(),this}forward(e,r){for(let o of this.heap)o.forward(e,r);for(let o=this.heap.length>>1;o>=0;o--)heapBubble(this.heap,o);(this.to-e||this.value.endSide-r)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),heapBubble(this.heap,0)}}}function heapBubble(n,e){for(let r=n[e];;){let o=(e<<1)+1;if(o>=n.length)break;let s=n[o];if(o+1<n.length&&s.compare(n[o+1])>=0&&(s=n[o+1],o++),r.compare(s)<0)break;n[o]=r,n[e]=s,e=o}}class SpanCursor{constructor(e,r,o){this.minPoint=o,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=HeapCursor.from(e,r,o)}goto(e,r=-1e9){return this.cursor.goto(e,r),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=r,this.openStart=-1,this.next(),this}forward(e,r){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-r)<0;)this.removeActive(this.minActive);this.cursor.forward(e,r)}removeActive(e){remove(this.active,e),remove(this.activeTo,e),remove(this.activeRank,e),this.minActive=findMinIndex(this.active,this.activeTo)}addActive(e){let r=0,{value:o,to:s,rank:l}=this.cursor;for(;r<this.activeRank.length&&this.activeRank[r]<=l;)r++;insert(this.active,r,o),insert(this.activeTo,r,s),insert(this.activeRank,r,l),e&&insert(e,r,this.cursor.from),this.minActive=findMinIndex(this.active,this.activeTo)}next(){let e=this.to,r=this.point;this.point=null;let o=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),o&&remove(o,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let l=this.cursor.value;if(!l.point)this.addActive(o),this.cursor.next();else if(r&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=l,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=l.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(o){this.openStart=0;for(let s=o.length-1;s>=0&&o[s]<e;s--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let r=[];for(let o=this.active.length-1;o>=0&&!(this.activeRank[o]<this.pointRank);o--)(this.activeTo[o]>e||this.activeTo[o]==e&&this.active[o].endSide>=this.point.endSide)&&r.push(this.active[o]);return r.reverse()}openEnd(e){let r=0;for(let o=this.activeTo.length-1;o>=0&&this.activeTo[o]>e;o--)r++;return r}}function compare(n,e,r,o,s,l){n.goto(e),r.goto(o);let c=o+s,u=o,f=o-e;for(;;){let d=n.to+f-r.to||n.endSide-r.endSide,g=d<0?n.to+f:r.to,m=Math.min(g,c);if(n.point||r.point?n.point&&r.point&&(n.point==r.point||n.point.eq(r.point))&&sameValues(n.activeForPoint(n.to+f),r.activeForPoint(r.to))||l.comparePoint(u,m,n.point,r.point):m>u&&!sameValues(n.active,r.active)&&l.compareRange(u,m,n.active,r.active),g>c)break;u=g,d<=0&&n.next(),d>=0&&r.next()}}function sameValues(n,e){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(n[r]!=e[r]&&!n[r].eq(e[r]))return!1;return!0}function remove(n,e){for(let r=e,o=n.length-1;r<o;r++)n[r]=n[r+1];n.pop()}function insert(n,e,r){for(let o=n.length-1;o>=e;o--)n[o+1]=n[o];n[e]=r}function findMinIndex(n,e){let r=-1,o=1e9;for(let s=0;s<e.length;s++)(e[s]-o||n[s].endSide-n[r].endSide)<0&&(r=s,o=e[s]);return r}function countColumn(n,e,r=n.length){let o=0;for(let s=0;s<r;)n.charCodeAt(s)==9?(o+=e-o%e,s++):(o++,s=findClusterBreak(n,s));return o}function findColumn(n,e,r,o){for(let s=0,l=0;;){if(l>=e)return s;if(s==n.length)break;l+=n.charCodeAt(s)==9?r-l%r:1,s=findClusterBreak(n,s)}return o===!0?-1:n.length}const C$2="",COUNT=typeof Symbol>"u"?"__"+C$2:Symbol.for(C$2),SET=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),top=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class StyleModule{constructor(e,r){this.rules=[];let{finish:o}=r||{};function s(c){return/^@/.test(c)?[c]:c.split(/,\s*/)}function l(c,u,f,d){let g=[],m=/^@(\w+)\b/.exec(c[0]),v=m&&m[1]=="keyframes";if(m&&u==null)return f.push(c[0]+";");for(let b in u){let k=u[b];if(/&/.test(b))l(b.split(/,\s*/).map(R=>c.map(I=>R.replace(/&/,I))).reduce((R,I)=>R.concat(I)),k,f);else if(k&&typeof k=="object"){if(!m)throw new RangeError("The value of a property ("+b+") should be a primitive value.");l(s(b),k,g,v)}else k!=null&&g.push(b.replace(/_.*/,"").replace(/[A-Z]/g,R=>"-"+R.toLowerCase())+": "+k+";")}(g.length||v)&&f.push((o&&!m&&!d?c.map(o):c).join(", ")+" {"+g.join(" ")+"}")}for(let c in e)l(s(c),e[c],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=top[COUNT]||1;return top[COUNT]=e+1,C$2+e.toString(36)}static mount(e,r){(e[SET]||new StyleSet(e)).mount(Array.isArray(r)?r:[r])}}let adoptedSet=new Map;class StyleSet{constructor(e){let r=e.ownerDocument||e,o=r.defaultView;if(!e.head&&e.adoptedStyleSheets&&o.CSSStyleSheet){let s=adoptedSet.get(r);if(s)return e.adoptedStyleSheets=[s.sheet,...e.adoptedStyleSheets],e[SET]=s;this.sheet=new o.CSSStyleSheet,e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets],adoptedSet.set(r,this)}else{this.styleTag=r.createElement("style");let s=e.head||e;s.insertBefore(this.styleTag,s.firstChild)}this.modules=[],e[SET]=this}mount(e){let r=this.sheet,o=0,s=0;for(let l=0;l<e.length;l++){let c=e[l],u=this.modules.indexOf(c);if(u<s&&u>-1&&(this.modules.splice(u,1),s--,u=-1),u==-1){if(this.modules.splice(s++,0,c),r)for(let f=0;f<c.rules.length;f++)r.insertRule(c.rules[f],o++)}else{for(;s<u;)o+=this.modules[s++].rules.length;o+=c.rules.length,s++}}if(!r){let l="";for(let c=0;c<this.modules.length;c++)l+=this.modules[c].getRules()+`
`;this.styleTag.textContent=l}}}var base={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shift={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},chrome$1=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent),mac=typeof navigator<"u"&&/Mac/.test(navigator.platform),ie$1=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),brokenModifierNames=mac||chrome$1&&+chrome$1[1]<57;for(var i=0;i<10;i++)base[48+i]=base[96+i]=String(i);for(var i=1;i<=24;i++)base[i+111]="F"+i;for(var i=65;i<=90;i++)base[i]=String.fromCharCode(i+32),shift[i]=String.fromCharCode(i);for(var code in base)shift.hasOwnProperty(code)||(shift[code]=base[code]);function keyName(n){var e=brokenModifierNames&&(n.ctrlKey||n.altKey||n.metaKey)||ie$1&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",r=!e&&n.key||(n.shiftKey?shift:base)[n.keyCode]||n.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}function getSelection(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function contains(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function deepActiveElement(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function hasSelection(n,e){if(!e.anchorNode)return!1;try{return contains(n,e.anchorNode)}catch{return!1}}function clientRectsFor(n){return n.nodeType==3?textRange(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function isEquivalentPosition(n,e,r,o){return r?scanFor(n,e,r,o,-1)||scanFor(n,e,r,o,1):!1}function domIndex(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function scanFor(n,e,r,o,s){for(;;){if(n==r&&e==o)return!0;if(e==(s<0?0:maxOffset(n))){if(n.nodeName=="DIV")return!1;let l=n.parentNode;if(!l||l.nodeType!=1)return!1;e=domIndex(n)+(s<0?0:1),n=l}else if(n.nodeType==1){if(n=n.childNodes[e+(s<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=s<0?maxOffset(n):0}else return!1}}function maxOffset(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}const Rect0={left:0,right:0,top:0,bottom:0};function flattenRect(n,e){let r=e?n.left:n.right;return{left:r,right:r,top:n.top,bottom:n.bottom}}function windowRect(n){return{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function scrollRectIntoView(n,e,r,o,s,l,c,u){let f=n.ownerDocument,d=f.defaultView||window;for(let g=n;g;)if(g.nodeType==1){let m,v=g==f.body;if(v)m=windowRect(d);else{if(g.scrollHeight<=g.clientHeight&&g.scrollWidth<=g.clientWidth){g=g.assignedSlot||g.parentNode;continue}let R=g.getBoundingClientRect();m={left:R.left,right:R.left+g.clientWidth,top:R.top,bottom:R.top+g.clientHeight}}let b=0,k=0;if(s=="nearest")e.top<m.top?(k=-(m.top-e.top+c),r>0&&e.bottom>m.bottom+k&&(k=e.bottom-m.bottom+k+c)):e.bottom>m.bottom&&(k=e.bottom-m.bottom+c,r<0&&e.top-k<m.top&&(k=-(m.top+k-e.top+c)));else{let R=e.bottom-e.top,I=m.bottom-m.top;k=(s=="center"&&R<=I?e.top+R/2-I/2:s=="start"||s=="center"&&r<0?e.top-c:e.bottom-I+c)-m.top}if(o=="nearest"?e.left<m.left?(b=-(m.left-e.left+l),r>0&&e.right>m.right+b&&(b=e.right-m.right+b+l)):e.right>m.right&&(b=e.right-m.right+l,r<0&&e.left<m.left+b&&(b=-(m.left+b-e.left+l))):b=(o=="center"?e.left+(e.right-e.left)/2-(m.right-m.left)/2:o=="start"==u?e.left-l:e.right-(m.right-m.left)+l)-m.left,b||k)if(v)d.scrollBy(b,k);else{let R=0,I=0;if(k){let $=g.scrollTop;g.scrollTop+=k,I=g.scrollTop-$}if(b){let $=g.scrollLeft;g.scrollLeft+=b,R=g.scrollLeft-$}e={left:e.left-R,top:e.top-I,right:e.right-R,bottom:e.bottom-I},R&&Math.abs(R-b)<1&&(o="nearest"),I&&Math.abs(I-k)<1&&(s="nearest")}if(v)break;g=g.assignedSlot||g.parentNode}else if(g.nodeType==11)g=g.host;else break}function scrollableParent(n){let e=n.ownerDocument;for(let r=n.parentNode;r&&r!=e.body;)if(r.nodeType==1){if(r.scrollHeight>r.clientHeight||r.scrollWidth>r.clientWidth)return r;r=r.assignedSlot||r.parentNode}else if(r.nodeType==11)r=r.host;else break;return null}class DOMSelectionState{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){this.set(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)}set(e,r,o,s){this.anchorNode=e,this.anchorOffset=r,this.focusNode=o,this.focusOffset=s}}let preventScrollSupported=null;function focusPreventScroll(n){if(n.setActive)return n.setActive();if(preventScrollSupported)return n.focus(preventScrollSupported);let e=[];for(let r=n;r&&(e.push(r,r.scrollTop,r.scrollLeft),r!=r.ownerDocument);r=r.parentNode);if(n.focus(preventScrollSupported==null?{get preventScroll(){return preventScrollSupported={preventScroll:!0},!0}}:void 0),!preventScrollSupported){preventScrollSupported=!1;for(let r=0;r<e.length;){let o=e[r++],s=e[r++],l=e[r++];o.scrollTop!=s&&(o.scrollTop=s),o.scrollLeft!=l&&(o.scrollLeft=l)}}}let scratchRange;function textRange(n,e,r=e){let o=scratchRange||(scratchRange=document.createRange());return o.setEnd(n,r),o.setStart(n,e),o}function dispatchKey(n,e,r){let o={key:e,code:e,keyCode:r,which:r,cancelable:!0},s=new KeyboardEvent("keydown",o);s.synthetic=!0,n.dispatchEvent(s);let l=new KeyboardEvent("keyup",o);return l.synthetic=!0,n.dispatchEvent(l),s.defaultPrevented||l.defaultPrevented}function getRoot(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function clearAttributes(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function atElementStart(n,e){let r=e.focusNode,o=e.focusOffset;if(!r||e.anchorNode!=r||e.anchorOffset!=o)return!1;for(;;)if(o){if(r.nodeType!=1)return!1;let s=r.childNodes[o-1];s.contentEditable=="false"?o--:(r=s,o=maxOffset(r))}else{if(r==n)return!0;o=domIndex(r),r=r.parentNode}}class DOMPos{constructor(e,r,o=!0){this.node=e,this.offset=r,this.precise=o}static before(e,r){return new DOMPos(e.parentNode,domIndex(e),r)}static after(e,r){return new DOMPos(e.parentNode,domIndex(e)+1,r)}}const noChildren=[];class ContentView{constructor(){this.parent=null,this.dom=null,this.dirty=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let r=this.posAtStart;for(let o of this.children){if(o==e)return r;r+=o.length+o.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}coordsAt(e,r){return null}sync(e,r){if(this.dirty&2){let o=this.dom,s=null,l;for(let c of this.children){if(c.dirty){if(!c.dom&&(l=s?s.nextSibling:o.firstChild)){let u=ContentView.get(l);(!u||!u.parent&&u.canReuseDOM(c))&&c.reuseDOM(l)}c.sync(e,r),c.dirty=0}if(l=s?s.nextSibling:o.firstChild,r&&!r.written&&r.node==o&&l!=c.dom&&(r.written=!0),c.dom.parentNode==o)for(;l&&l!=c.dom;)l=rm$1(l);else o.insertBefore(c.dom,l);s=c.dom}for(l=s?s.nextSibling:o.firstChild,l&&r&&r.node==o&&(r.written=!0);l;)l=rm$1(l)}else if(this.dirty&1)for(let o of this.children)o.dirty&&(o.sync(e,r),o.dirty=0)}reuseDOM(e){}localPosFromDOM(e,r){let o;if(e==this.dom)o=this.dom.childNodes[r];else{let s=maxOffset(e)==0?0:r==0?-1:1;for(;;){let l=e.parentNode;if(l==this.dom)break;s==0&&l.firstChild!=l.lastChild&&(e==l.firstChild?s=-1:s=1),e=l}s<0?o=e:o=e.nextSibling}if(o==this.dom.firstChild)return 0;for(;o&&!ContentView.get(o);)o=o.nextSibling;if(!o)return this.length;for(let s=0,l=0;;s++){let c=this.children[s];if(c.dom==o)return l;l+=c.length+c.breakAfter}}domBoundsAround(e,r,o=0){let s=-1,l=-1,c=-1,u=-1;for(let f=0,d=o,g=o;f<this.children.length;f++){let m=this.children[f],v=d+m.length;if(d<e&&v>r)return m.domBoundsAround(e,r,d);if(v>=e&&s==-1&&(s=f,l=d),d>r&&m.dom.parentNode==this.dom){c=f,u=g;break}g=v,d=v+m.breakAfter}return{from:l,to:u<0?o+this.length:u,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:c<this.children.length&&c>=0?this.children[c].dom:null}}markDirty(e=!1){this.dirty|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let r=this.parent;r;r=r.parent){if(e&&(r.dirty|=2),r.dirty&1)return;r.dirty|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let r=e.parent;if(!r)return e;e=r}}replaceChildren(e,r,o=noChildren){this.markDirty();for(let s=e;s<r;s++){let l=this.children[s];l.parent==this&&l.destroy()}this.children.splice(e,r-e,...o);for(let s=0;s<o.length;s++)o[s].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new ChildCursor(this.children,e,this.children.length)}childPos(e,r=1){return this.childCursor().findPos(e,r)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,r,o,s,l,c){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor}getSide(){return 0}destroy(){this.parent=null}}ContentView.prototype.breakAfter=0;function rm$1(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class ChildCursor{constructor(e,r,o){this.children=e,this.pos=r,this.i=o,this.off=0}findPos(e,r=1){for(;;){if(e>this.pos||e==this.pos&&(r>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let o=this.children[--this.i];this.pos-=o.length+o.breakAfter}}}function replaceRange(n,e,r,o,s,l,c,u,f){let{children:d}=n,g=d.length?d[e]:null,m=l.length?l[l.length-1]:null,v=m?m.breakAfter:c;if(!(e==o&&g&&!c&&!v&&l.length<2&&g.merge(r,s,l.length?m:null,r==0,u,f))){if(o<d.length){let b=d[o];b&&s<b.length?(e==o&&(b=b.split(s),s=0),!v&&m&&b.merge(0,s,m,!0,0,f)?l[l.length-1]=b:(s&&b.merge(0,s,null,!1,0,f),l.push(b))):b!=null&&b.breakAfter&&(m?m.breakAfter=1:c=1),o++}for(g&&(g.breakAfter=c,r>0&&(!c&&l.length&&g.merge(r,g.length,l[0],!1,u,0)?g.breakAfter=l.shift().breakAfter:(r<g.length||g.children.length&&g.children[g.children.length-1].length==0)&&g.merge(r,g.length,null,!1,u,0),e++));e<o&&l.length;)if(d[o-1].become(l[l.length-1]))o--,l.pop(),f=l.length?0:u;else if(d[e].become(l[0]))e++,l.shift(),u=l.length?0:f;else break;!l.length&&e&&o<d.length&&!d[e-1].breakAfter&&d[o].merge(0,0,d[e-1],!1,u,f)&&e--,(e<o||l.length)&&n.replaceChildren(e,o,l)}}function mergeChildrenInto(n,e,r,o,s,l){let c=n.childCursor(),{i:u,off:f}=c.findPos(r,1),{i:d,off:g}=c.findPos(e,-1),m=e-r;for(let v of o)m+=v.length;n.length+=m,replaceRange(n,d,g,u,f,o,0,s,l)}let nav=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},doc=typeof document<"u"?document:{documentElement:{style:{}}};const ie_edge=/Edge\/(\d+)/.exec(nav.userAgent),ie_upto10=/MSIE \d/.test(nav.userAgent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nav.userAgent),ie=!!(ie_upto10||ie_11up||ie_edge),gecko=!ie&&/gecko\/(\d+)/i.test(nav.userAgent),chrome=!ie&&/Chrome\/(\d+)/.exec(nav.userAgent),webkit="webkitFontSmoothing"in doc.documentElement.style,safari=!ie&&/Apple Computer/.test(nav.vendor),ios=safari&&(/Mobile\/\w+/.test(nav.userAgent)||nav.maxTouchPoints>2);var browser={mac:ios||/Mac/.test(nav.platform),windows:/Win/.test(nav.platform),linux:/Linux|X11/.test(nav.platform),ie,ie_version:ie_upto10?doc.documentMode||6:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko,gecko_version:gecko?+(/Firefox\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,chrome:!!chrome,chrome_version:chrome?+chrome[1]:0,ios,android:/Android\b/.test(nav.userAgent),webkit,safari,webkit_version:webkit?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:doc.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const MaxJoinLen=256;class TextView extends ContentView{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,r){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(r&&r.node==this.dom&&(r.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,r,o){return o&&(!(o instanceof TextView)||this.length-(r-e)+o.length>MaxJoinLen)?!1:(this.text=this.text.slice(0,e)+(o?o.text:"")+this.text.slice(r),this.markDirty(),!0)}split(e){let r=new TextView(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),r}localPosFromDOM(e,r){return e==this.dom?r:r?this.text.length:0}domAtPos(e){return new DOMPos(this.dom,e)}domBoundsAround(e,r,o){return{from:o,to:o+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,r){return textCoords(this.dom,e,r)}}class MarkView extends ContentView{constructor(e,r=[],o=0){super(),this.mark=e,this.children=r,this.length=o;for(let s of r)s.setParent(this)}setAttrs(e){if(clearAttributes(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let r in this.mark.attrs)e.setAttribute(r,this.mark.attrs[r]);return e}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6)}sync(e,r){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,r)}merge(e,r,o,s,l,c){return o&&(!(o instanceof MarkView&&o.mark.eq(this.mark))||e&&l<=0||r<this.length&&c<=0)?!1:(mergeChildrenInto(this,e,r,o?o.children:[],l-1,c-1),this.markDirty(),!0)}split(e){let r=[],o=0,s=-1,l=0;for(let u of this.children){let f=o+u.length;f>e&&r.push(o<e?u.split(e-o):u),s<0&&o>=e&&(s=l),o=f,l++}let c=this.length-e;return this.length=e,s>-1&&(this.children.length=s,this.markDirty()),new MarkView(this.mark,r,c)}domAtPos(e){return inlineDOMAtPos(this,e)}coordsAt(e,r){return coordsInChildren(this,e,r)}}function textCoords(n,e,r){let o=n.nodeValue.length;e>o&&(e=o);let s=e,l=e,c=0;e==0&&r<0||e==o&&r>=0?browser.chrome||browser.gecko||(e?(s--,c=1):l<o&&(l++,c=-1)):r<0?s--:l<o&&l++;let u=textRange(n,s,l).getClientRects();if(!u.length)return Rect0;let f=u[(c?c<0:r>=0)?0:u.length-1];return browser.safari&&!c&&f.width==0&&(f=Array.prototype.find.call(u,d=>d.width)||f),c?flattenRect(f,c<0):f||null}class WidgetView extends ContentView{constructor(e,r,o){super(),this.widget=e,this.length=r,this.side=o,this.prevWidget=null}static create(e,r,o){return new(e.customView||WidgetView)(e,r,o)}split(e){let r=WidgetView.create(this.widget,this.length-e,this.side);return this.length-=e,r}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,r,o,s,l,c){return o&&(!(o instanceof WidgetView)||!this.widget.compare(o.widget)||e>0&&l<=0||r<this.length&&c<=0)?!1:(this.length=e+(o?o.length:0)+(this.length-r),!0)}become(e){return e.length==this.length&&e instanceof WidgetView&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Text.empty;let e=this;for(;e.parent;)e=e.parent;let{view:r}=e,o=r&&r.state.doc,s=this.posAtStart;return o?o.slice(s,s+this.length):Text.empty}domAtPos(e){return(this.length?e==0:this.side>0)?DOMPos.before(this.dom):DOMPos.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,r){let o=this.dom.getClientRects(),s=null;if(!o.length)return Rect0;for(let l=e>0?o.length-1:0;s=o[l],!(e>0?l==0:l==o.length-1||s.top<s.bottom);l+=e>0?-1:1);return this.length?s:flattenRect(s,this.side>0)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class CompositionView extends WidgetView{domAtPos(e){let{topView:r,text:o}=this.widget;return r?scanCompositionTree(e,0,r,o,(s,l)=>s.domAtPos(l),s=>new DOMPos(o,Math.min(s,o.nodeValue.length))):new DOMPos(o,Math.min(e,o.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(e,r){let{topView:o,text:s}=this.widget;return o?posFromDOMInCompositionTree(e,r,o,s):Math.min(r,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(e,r){let{topView:o,text:s}=this.widget;return o?scanCompositionTree(e,r,o,s,(l,c,u)=>l.coordsAt(c,u),(l,c)=>textCoords(s,l,c)):textCoords(s,e,r)}destroy(){var e;super.destroy(),(e=this.widget.topView)===null||e===void 0||e.destroy()}get isEditable(){return!0}canReuseDOM(){return!0}}function scanCompositionTree(n,e,r,o,s,l){if(r instanceof MarkView){for(let c=r.dom.firstChild;c;c=c.nextSibling){let u=ContentView.get(c);if(!u)return l(n,e);let f=contains(c,o),d=u.length+(f?o.nodeValue.length:0);if(n<d||n==d&&u.getSide()<=0)return f?scanCompositionTree(n,e,u,o,s,l):s(u,n,e);n-=d}return s(r,r.length,-1)}else return r.dom==o?l(n,e):s(r,n,e)}function posFromDOMInCompositionTree(n,e,r,o){if(r instanceof MarkView){let s=0;for(let l of r.children){let c=contains(l.dom,o);if(contains(l.dom,n))return s+(c?posFromDOMInCompositionTree(n,e,l,o):l.localPosFromDOM(n,e));s+=c?o.nodeValue.length:l.length}}else if(r.dom==o)return Math.min(e,o.nodeValue.length);return r.localPosFromDOM(n,e)}class WidgetBufferView extends ContentView{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof WidgetBufferView&&e.side==this.side}split(){return new WidgetBufferView(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?DOMPos.before(this.dom):DOMPos.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){let r=this.dom.getBoundingClientRect(),o=inlineSiblingRect(this,this.side>0?-1:1);return o&&o.top<r.bottom&&o.bottom>r.top?{left:r.left,right:r.right,top:o.top,bottom:o.bottom}:r}get overrideDOMText(){return Text.empty}get isHidden(){return!0}}TextView.prototype.children=WidgetView.prototype.children=WidgetBufferView.prototype.children=noChildren;function inlineSiblingRect(n,e){let r=n.parent,o=r?r.children.indexOf(n):-1;for(;r&&o>=0;)if(e<0?o>0:o<r.children.length){let s=r.children[o+e];if(s instanceof TextView){let l=s.coordsAt(e<0?s.length:0,e);if(l)return l}o+=e}else if(r instanceof MarkView&&r.parent)o=r.parent.children.indexOf(r)+(e<0?0:1),r=r.parent;else{let s=r.dom.lastChild;if(s&&s.nodeName=="BR")return s.getClientRects()[0];break}}function inlineDOMAtPos(n,e){let r=n.dom,{children:o}=n,s=0;for(let l=0;s<o.length;s++){let c=o[s],u=l+c.length;if(!(u==l&&c.getSide()<=0)){if(e>l&&e<u&&c.dom.parentNode==r)return c.domAtPos(e-l);if(e<=l)break;l=u}}for(let l=s;l>0;l--){let c=o[l-1];if(c.dom.parentNode==r)return c.domAtPos(c.length)}for(let l=s;l<o.length;l++){let c=o[l];if(c.dom.parentNode==r)return c.domAtPos(0)}return new DOMPos(r,0)}function joinInlineInto(n,e,r){let o,{children:s}=n;r>0&&e instanceof MarkView&&s.length&&(o=s[s.length-1])instanceof MarkView&&o.mark.eq(e.mark)?joinInlineInto(o,e.children[0],r-1):(s.push(e),e.setParent(n)),n.length+=e.length}function coordsInChildren(n,e,r){let o=null,s=-1,l=null,c=-1;function u(d,g){for(let m=0,v=0;m<d.children.length&&v<=g;m++){let b=d.children[m],k=v+b.length;k>=g&&(b.children.length?u(b,g-v):(!l||l instanceof WidgetBufferView&&r>0)&&(k>g||v==k&&b.getSide()>0)?(l=b,c=g-v):(v<g||v==k&&b.getSide()<0)&&(o=b,s=g-v)),v=k}}u(n,e);let f=(r<0?o:l)||o||l;return f?f.coordsAt(Math.max(0,f==o?s:c),r):fallbackRect(n)}function fallbackRect(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let r=clientRectsFor(e);return r[r.length-1]||null}function combineAttrs(n,e){for(let r in n)r=="class"&&e.class?e.class+=" "+n.class:r=="style"&&e.style?e.style+=";"+n.style:e[r]=n[r];return e}function attrsEq(n,e){if(n==e)return!0;if(!n||!e)return!1;let r=Object.keys(n),o=Object.keys(e);if(r.length!=o.length)return!1;for(let s of r)if(o.indexOf(s)==-1||n[s]!==e[s])return!1;return!0}function updateAttrs(n,e,r){let o=null;if(e)for(let s in e)r&&s in r||n.removeAttribute(o=s);if(r)for(let s in r)e&&e[s]==r[s]||n.setAttribute(o=s,r[s]);return!!o}class WidgetType{eq(e){return!1}updateDOM(e,r){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}ignoreEvent(e){return!0}get customView(){return null}get isHidden(){return!1}destroy(e){}}var BlockType=function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n}(BlockType||(BlockType={}));class Decoration extends RangeValue{constructor(e,r,o,s){super(),this.startSide=e,this.endSide=r,this.widget=o,this.spec=s}get heightRelevant(){return!1}static mark(e){return new MarkDecoration(e)}static widget(e){let r=e.side||0,o=!!e.block;return r+=o?r>0?3e8:-4e8:r>0?1e8:-1e8,new PointDecoration(e,r,r,o,e.widget||null,!1)}static replace(e){let r=!!e.block,o,s;if(e.isBlockGap)o=-5e8,s=4e8;else{let{start:l,end:c}=getInclusive(e,r);o=(l?r?-3e8:-1:5e8)-1,s=(c?r?2e8:1:-6e8)+1}return new PointDecoration(e,o,s,r,e.widget||null,!0)}static line(e){return new LineDecoration(e)}static set(e,r=!1){return RangeSet.of(e,r)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Decoration.none=RangeSet.empty;class MarkDecoration extends Decoration{constructor(e){let{start:r,end:o}=getInclusive(e);super(r?-1:5e8,o?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){return this==e||e instanceof MarkDecoration&&this.tagName==e.tagName&&this.class==e.class&&attrsEq(this.attrs,e.attrs)}range(e,r=e){if(e>=r)throw new RangeError("Mark decorations may not be empty");return super.range(e,r)}}MarkDecoration.prototype.point=!1;class LineDecoration extends Decoration{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof LineDecoration&&this.spec.class==e.spec.class&&attrsEq(this.spec.attributes,e.spec.attributes)}range(e,r=e){if(r!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,r)}}LineDecoration.prototype.mapMode=MapMode.TrackBefore;LineDecoration.prototype.point=!0;class PointDecoration extends Decoration{constructor(e,r,o,s,l,c){super(r,o,l,e),this.block=s,this.isReplace=c,this.mapMode=s?r<=0?MapMode.TrackBefore:MapMode.TrackAfter:MapMode.TrackDel}get type(){return this.startSide<this.endSide?BlockType.WidgetRange:this.startSide<=0?BlockType.WidgetBefore:BlockType.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof PointDecoration&&widgetsEq(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,r=e){if(this.isReplace&&(e>r||e==r&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&r!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,r)}}PointDecoration.prototype.point=!0;function getInclusive(n,e=!1){let{inclusiveStart:r,inclusiveEnd:o}=n;return r==null&&(r=n.inclusive),o==null&&(o=n.inclusive),{start:r??e,end:o??e}}function widgetsEq(n,e){return n==e||!!(n&&e&&n.compare(e))}function addRange(n,e,r,o=0){let s=r.length-1;s>=0&&r[s]+o>=n?r[s]=Math.max(r[s],e):r.push(n,e)}class LineView extends ContentView{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,r,o,s,l,c){if(o){if(!(o instanceof LineView))return!1;this.dom||o.transferDOM(this)}return s&&this.setDeco(o?o.attrs:null),mergeChildrenInto(this,e,r,o?o.children:[],l,c),!0}split(e){let r=new LineView;if(r.breakAfter=this.breakAfter,this.length==0)return r;let{i:o,off:s}=this.childPos(e);s&&(r.append(this.children[o].split(s),0),this.children[o].merge(s,this.children[o].length,null,!1,0,0),o++);for(let l=o;l<this.children.length;l++)r.append(this.children[l],0);for(;o>0&&this.children[o-1].length==0;)this.children[--o].destroy();return this.children.length=o,this.markDirty(),this.length=e,r}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){attrsEq(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,r){joinInlineInto(this,e,r)}addLineDeco(e){let r=e.spec.attributes,o=e.spec.class;r&&(this.attrs=combineAttrs(r,this.attrs||{})),o&&(this.attrs=combineAttrs({class:o},this.attrs||{}))}domAtPos(e){return inlineDOMAtPos(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.dirty|=6)}sync(e,r){var o;this.dom?this.dirty&4&&(clearAttributes(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(updateAttrs(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,r);let s=this.dom.lastChild;for(;s&&ContentView.get(s)instanceof MarkView;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((o=ContentView.get(s))===null||o===void 0?void 0:o.isEditable)==!1&&(!browser.ios||!this.children.some(l=>l instanceof TextView))){let l=document.createElement("BR");l.cmIgnore=!0,this.dom.appendChild(l)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,r;for(let o of this.children){if(!(o instanceof TextView)||/[^ -~]/.test(o.text))return null;let s=clientRectsFor(o.dom);if(s.length!=1)return null;e+=s[0].width,r=s[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:r}:null}coordsAt(e,r){let o=coordsInChildren(this,e,r);if(!this.children.length&&o&&this.parent){let{heightOracle:s}=this.parent.view.viewState,l=o.bottom-o.top;if(Math.abs(l-s.lineHeight)<2&&s.textHeight<l){let c=(l-s.textHeight)/2;return{top:o.top+c,bottom:o.bottom-c,left:o.left,right:o.left}}}return o}become(e){return!1}get type(){return BlockType.Text}static find(e,r){for(let o=0,s=0;o<e.children.length;o++){let l=e.children[o],c=s+l.length;if(c>=r){if(l instanceof LineView)return l;if(c>r)break}s=c+l.breakAfter}return null}}class BlockWidgetView extends ContentView{constructor(e,r,o){super(),this.widget=e,this.length=r,this.type=o,this.breakAfter=0,this.prevWidget=null}merge(e,r,o,s,l,c){return o&&(!(o instanceof BlockWidgetView)||!this.widget.compare(o.widget)||e>0&&l<=0||r<this.length&&c<=0)?!1:(this.length=e+(o?o.length:0)+(this.length-r),!0)}domAtPos(e){return e==0?DOMPos.before(this.dom):DOMPos.after(this.dom,e==this.length)}split(e){let r=this.length-e;this.length=e;let o=new BlockWidgetView(this.widget,r,this.type);return o.breakAfter=this.breakAfter,o}get children(){return noChildren}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Text.empty}domBoundsAround(){return null}become(e){return e instanceof BlockWidgetView&&e.type==this.type&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class ContentBuilder{constructor(e,r,o,s){this.doc=e,this.pos=r,this.end=o,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=r}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof BlockWidgetView&&e.type==BlockType.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new LineView),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(wrapMarks(new WidgetBufferView(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine()}buildText(e,r,o){for(;e>0;){if(this.textOff==this.text.length){let{value:l,lineBreak:c,done:u}=this.cursor.next(this.skip);if(this.skip=0,u)throw new Error("Ran out of text content when drawing inline views");if(c){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=l,this.textOff=0}let s=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(r.slice(r.length-o)),this.getLine().append(wrapMarks(new TextView(this.text.slice(this.textOff,this.textOff+s)),r),o),this.atCursorPos=!0,this.textOff+=s,e-=s,o=0}}span(e,r,o,s){this.buildText(r-e,o,s),this.pos=r,this.openStart<0&&(this.openStart=s)}point(e,r,o,s,l,c){if(this.disallowBlockEffectsFor[c]&&o instanceof PointDecoration){if(o.block)throw new RangeError("Block decorations may not be specified via plugins");if(r>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let u=r-e;if(o instanceof PointDecoration)if(o.block){let{type:f}=o;f==BlockType.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new BlockWidgetView(o.widget||new NullWidget("div"),u,f))}else{let f=WidgetView.create(o.widget||new NullWidget("span"),u,u?0:o.startSide),d=this.atCursorPos&&!f.isEditable&&l<=s.length&&(e<r||o.startSide>0),g=!f.isEditable&&(e<r||l>s.length||o.startSide<=0),m=this.getLine();this.pendingBuffer==2&&!d&&!f.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),d&&(m.append(wrapMarks(new WidgetBufferView(1),s),l),l=s.length+Math.max(0,l-s.length)),m.append(wrapMarks(f,s),l),this.atCursorPos=g,this.pendingBuffer=g?e<r||l>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(o);u&&(this.textOff+u<=this.text.length?this.textOff+=u:(this.skip+=u-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=r),this.openStart<0&&(this.openStart=l)}static build(e,r,o,s,l){let c=new ContentBuilder(e,r,o,l);return c.openEnd=RangeSet.spans(s,r,o,c),c.openStart<0&&(c.openStart=c.openEnd),c.finish(c.openEnd),c}}function wrapMarks(n,e){for(let r of e)n=new MarkView(r,[n],n.length);return n}class NullWidget extends WidgetType{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}const clickAddsSelectionRange=Facet.define(),dragMovesSelection$1=Facet.define(),mouseSelectionStyle=Facet.define(),exceptionSink=Facet.define(),updateListener=Facet.define(),inputHandler$1=Facet.define(),focusChangeEffect=Facet.define(),perLineTextDirection=Facet.define({combine:n=>n.some(e=>e)}),nativeSelectionHidden=Facet.define({combine:n=>n.some(e=>e)});class ScrollTarget{constructor(e,r="nearest",o="nearest",s=5,l=5){this.range=e,this.y=r,this.x=o,this.yMargin=s,this.xMargin=l}map(e){return e.empty?this:new ScrollTarget(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const scrollIntoView$1=StateEffect.define({map:(n,e)=>n.map(e)});function logException(n,e,r){let o=n.facet(exceptionSink);o.length?o[0](e):window.onerror?window.onerror(String(e),r,void 0,void 0,e):r?console.error(r+":",e):console.error(e)}const editable=Facet.define({combine:n=>n.length?n[0]:!0});let nextPluginID=0;const viewPlugin=Facet.define();class ViewPlugin{constructor(e,r,o,s){this.id=e,this.create=r,this.domEventHandlers=o,this.extension=s(this)}static define(e,r){const{eventHandlers:o,provide:s,decorations:l}=r||{};return new ViewPlugin(nextPluginID++,e,o,c=>{let u=[viewPlugin.of(c)];return l&&u.push(decorations.of(f=>{let d=f.plugin(c);return d?l(d):Decoration.none})),s&&u.push(s(c)),u})}static fromClass(e,r){return ViewPlugin.define(o=>new e(o),r)}}class PluginInstance{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let r=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(r)}catch(o){if(logException(r.state,o,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(r){logException(e.state,r,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var r;if(!((r=this.value)===null||r===void 0)&&r.destroy)try{this.value.destroy()}catch(o){logException(e.state,o,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const editorAttributes=Facet.define(),contentAttributes=Facet.define(),decorations=Facet.define(),atomicRanges=Facet.define(),scrollMargins=Facet.define(),styleModule=Facet.define();class ChangedRange{constructor(e,r,o,s){this.fromA=e,this.toA=r,this.fromB=o,this.toB=s}join(e){return new ChangedRange(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let r=e.length,o=this;for(;r>0;r--){let s=e[r-1];if(!(s.fromA>o.toA)){if(s.toA<o.fromA)break;o=o.join(s),e.splice(r-1,1)}}return e.splice(r,0,o),e}static extendWithRanges(e,r){if(r.length==0)return e;let o=[];for(let s=0,l=0,c=0,u=0;;s++){let f=s==e.length?null:e[s],d=c-u,g=f?f.fromB:1e9;for(;l<r.length&&r[l]<g;){let m=r[l],v=r[l+1],b=Math.max(u,m),k=Math.min(g,v);if(b<=k&&new ChangedRange(b+d,k+d,b,k).addToSet(o),v>g)break;l+=2}if(!f)return o;new ChangedRange(f.fromA,f.toA,f.fromB,f.toB).addToSet(o),c=f.toA,u=f.toB}}}class ViewUpdate{constructor(e,r,o){this.view=e,this.state=r,this.transactions=o,this.flags=0,this.startState=e.state,this.changes=ChangeSet.empty(this.startState.doc.length);for(let l of o)this.changes=this.changes.compose(l.changes);let s=[];this.changes.iterChangedRanges((l,c,u,f)=>s.push(new ChangedRange(l,c,u,f))),this.changedRanges=s}static create(e,r,o){return new ViewUpdate(e,r,o)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var Direction=function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n}(Direction||(Direction={}));const LTR=Direction.LTR,RTL=Direction.RTL;function dec(n){let e=[];for(let r=0;r<n.length;r++)e.push(1<<+n[r]);return e}const LowTypes=dec("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ArabicTypes=dec("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Brackets=Object.create(null),BracketStack=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),r=n.charCodeAt(1);Brackets[e]=r,Brackets[r]=-e}function charType(n){return n<=247?LowTypes[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?ArabicTypes[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8203?256:64336<=n&&n<=65023?4:n==8204?256:1}const BidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class BidiSpan{constructor(e,r,o){this.from=e,this.to=r,this.level=o}get dir(){return this.level%2?RTL:LTR}side(e,r){return this.dir==r==e?this.to:this.from}static find(e,r,o,s){let l=-1;for(let c=0;c<e.length;c++){let u=e[c];if(u.from<=r&&u.to>=r){if(u.level==o)return c;(l<0||(s!=0?s<0?u.from<r:u.to>r:e[l].level>u.level))&&(l=c)}}if(l<0)throw new RangeError("Index out of range");return l}}const types=[];function computeOrder(n,e){let r=n.length,o=e==LTR?1:2,s=e==LTR?2:1;if(!n||o==1&&!BidiRE.test(n))return trivialOrder(r);for(let c=0,u=o,f=o;c<r;c++){let d=charType(n.charCodeAt(c));d==512?d=u:d==8&&f==4&&(d=16),types[c]=d==4?2:d,d&7&&(f=d),u=d}for(let c=0,u=o,f=o;c<r;c++){let d=types[c];if(d==128)c<r-1&&u==types[c+1]&&u&24?d=types[c]=u:types[c]=256;else if(d==64){let g=c+1;for(;g<r&&types[g]==64;)g++;let m=c&&u==8||g<r&&types[g]==8?f==1?1:8:256;for(let v=c;v<g;v++)types[v]=m;c=g-1}else d==8&&f==1&&(types[c]=1);u=d,d&7&&(f=d)}for(let c=0,u=0,f=0,d,g,m;c<r;c++)if(g=Brackets[d=n.charCodeAt(c)])if(g<0){for(let v=u-3;v>=0;v-=3)if(BracketStack[v+1]==-g){let b=BracketStack[v+2],k=b&2?o:b&4?b&1?s:o:0;k&&(types[c]=types[BracketStack[v]]=k),u=v;break}}else{if(BracketStack.length==189)break;BracketStack[u++]=c,BracketStack[u++]=d,BracketStack[u++]=f}else if((m=types[c])==2||m==1){let v=m==o;f=v?0:1;for(let b=u-3;b>=0;b-=3){let k=BracketStack[b+2];if(k&2)break;if(v)BracketStack[b+2]|=2;else{if(k&4)break;BracketStack[b+2]|=4}}}for(let c=0;c<r;c++)if(types[c]==256){let u=c+1;for(;u<r&&types[u]==256;)u++;let f=(c?types[c-1]:o)==1,d=(u<r?types[u]:o)==1,g=f==d?f?1:2:o;for(let m=c;m<u;m++)types[m]=g;c=u-1}let l=[];if(o==1)for(let c=0;c<r;){let u=c,f=types[c++]!=1;for(;c<r&&f==(types[c]!=1);)c++;if(f)for(let d=c;d>u;){let g=d,m=types[--d]!=2;for(;d>u&&m==(types[d-1]!=2);)d--;l.push(new BidiSpan(d,g,m?2:1))}else l.push(new BidiSpan(u,c,0))}else for(let c=0;c<r;){let u=c,f=types[c++]==2;for(;c<r&&f==(types[c]==2);)c++;l.push(new BidiSpan(u,c,f?1:2))}return l}function trivialOrder(n){return[new BidiSpan(0,n,0)]}let movedOver="";function moveVisually(n,e,r,o,s){var l;let c=o.head-n.from,u=-1;if(c==0){if(!s||!n.length)return null;e[0].level!=r&&(c=e[0].side(!1,r),u=0)}else if(c==n.length){if(s)return null;let v=e[e.length-1];v.level!=r&&(c=v.side(!0,r),u=e.length-1)}u<0&&(u=BidiSpan.find(e,c,(l=o.bidiLevel)!==null&&l!==void 0?l:-1,o.assoc));let f=e[u];c==f.side(s,r)&&(f=e[u+=s?1:-1],c=f.side(!s,r));let d=s==(f.dir==r),g=findClusterBreak(n.text,c,d);if(movedOver=n.text.slice(Math.min(c,g),Math.max(c,g)),g!=f.side(s,r))return EditorSelection.cursor(g+n.from,d?-1:1,f.level);let m=u==(s?e.length-1:0)?null:e[u+(s?1:-1)];return!m&&f.level!=r?EditorSelection.cursor(s?n.to:n.from,s?-1:1,r):m&&m.level<f.level?EditorSelection.cursor(m.side(!s,r)+n.from,s?1:-1,m.level):EditorSelection.cursor(g+n.from,s?-1:1,f.level)}const LineBreakPlaceholder="";class DOMReader{constructor(e,r){this.points=e,this.text="",this.lineSeparator=r.facet(EditorState.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=LineBreakPlaceholder}readRange(e,r){if(!e)return this;let o=e.parentNode;for(let s=e;;){this.findPointBefore(o,s),this.readNode(s);let l=s.nextSibling;if(l==r)break;let c=ContentView.get(s),u=ContentView.get(l);(c&&u?c.breakAfter:(c?c.breakAfter:isBlockElement(s))||isBlockElement(l)&&(s.nodeName!="BR"||s.cmIgnore))&&this.lineBreak(),s=l}return this.findPointBefore(o,r),this}readTextNode(e){let r=e.nodeValue;for(let o of this.points)o.node==e&&(o.pos=this.text.length+Math.min(o.offset,r.length));for(let o=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let l=-1,c=1,u;if(this.lineSeparator?(l=r.indexOf(this.lineSeparator,o),c=this.lineSeparator.length):(u=s.exec(r))&&(l=u.index,c=u[0].length),this.append(r.slice(o,l<0?r.length:l)),l<0)break;if(this.lineBreak(),c>1)for(let f of this.points)f.node==e&&f.pos>this.text.length&&(f.pos-=c-1);o=l+c}}readNode(e){if(e.cmIgnore)return;let r=ContentView.get(e),o=r&&r.overrideDOMText;if(o!=null){this.findPointInside(e,o.length);for(let s=o.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,r){for(let o of this.points)o.node==e&&e.childNodes[o.offset]==r&&(o.pos=this.text.length)}findPointInside(e,r){for(let o of this.points)(e.nodeType==3?o.node==e:e.contains(o.node))&&(o.pos=this.text.length+Math.min(r,o.offset))}}function isBlockElement(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}class DOMPoint{constructor(e,r){this.node=e,this.offset=r,this.pos=-1}}class DocView extends ContentView{constructor(e){super(),this.view=e,this.compositionDeco=Decoration.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new LineView],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ChangedRange(0,0,0,e.state.doc.length)],0)}get length(){return this.view.state.doc.length}update(e){let r=e.changedRanges;this.minWidth>0&&r.length&&(r.every(({fromA:c,toA:u})=>u<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=Decoration.none:(e.transactions.length||this.dirty)&&(this.compositionDeco=computeCompositionDeco(this.view,e.changes)),(browser.ie||browser.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,s=this.updateDeco(),l=findChangedDeco(o,s,e.changes);return r=ChangedRange.extendWithRanges(r,l),this.dirty==0&&r.length==0?!1:(this.updateInner(r,e.startState.doc.length),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,r){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,r);let{observer:o}=this.view;o.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let l=browser.chrome||browser.ios?{node:o.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,l),this.dirty=0,l&&(l.written||o.selectionRange.focusNode!=l.node)&&(this.forceSelection=!0),this.dom.style.height=""});let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let l of this.children)l instanceof BlockWidgetView&&l.widget instanceof BlockGapWidget&&s.push(l.dom);o.updateGaps(s)}updateChildren(e,r){let o=this.childCursor(r);for(let s=e.length-1;;s--){let l=s>=0?e[s]:null;if(!l)break;let{fromA:c,toA:u,fromB:f,toB:d}=l,{content:g,breakAtStart:m,openStart:v,openEnd:b}=ContentBuilder.build(this.view.state.doc,f,d,this.decorations,this.dynamicDecorationMap),{i:k,off:R}=o.findPos(u,1),{i:I,off:$}=o.findPos(c,-1);replaceRange(this,I,$,k,R,g,m,v,b)}}updateSelection(e=!1,r=!1){if((e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange(),!(r||this.mayControlSelection()))return;let o=this.forceSelection;this.forceSelection=!1;let s=this.view.state.selection.main,l=this.domAtPos(s.anchor),c=s.empty?l:this.domAtPos(s.head);if(browser.gecko&&s.empty&&!this.compositionDeco.size&&betweenUneditable(l)){let f=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(f,l.node.childNodes[l.offset]||null)),l=c=new DOMPos(f,0),o=!0}let u=this.view.observer.selectionRange;(o||!u.focusNode||!isEquivalentPosition(l.node,l.offset,u.anchorNode,u.anchorOffset)||!isEquivalentPosition(c.node,c.offset,u.focusNode,u.focusOffset))&&(this.view.observer.ignore(()=>{browser.android&&browser.chrome&&this.dom.contains(u.focusNode)&&inUneditable(u.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let f=getSelection(this.view.root);if(f)if(s.empty){if(browser.gecko){let d=nextToUneditable(l.node,l.offset);if(d&&d!=3){let g=nearbyTextNode(l.node,l.offset,d==1?1:-1);g&&(l=new DOMPos(g,d==1?0:g.nodeValue.length))}}f.collapse(l.node,l.offset),s.bidiLevel!=null&&u.cursorBidiLevel!=null&&(u.cursorBidiLevel=s.bidiLevel)}else if(f.extend){f.collapse(l.node,l.offset);try{f.extend(c.node,c.offset)}catch{}}else{let d=document.createRange();s.anchor>s.head&&([l,c]=[c,l]),d.setEnd(c.node,c.offset),d.setStart(l.node,l.offset),f.removeAllRanges(),f.addRange(d)}}),this.view.observer.setSelectionRange(l,c)),this.impreciseAnchor=l.precise?null:new DOMPos(u.anchorNode,u.anchorOffset),this.impreciseHead=c.precise?null:new DOMPos(u.focusNode,u.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let{view:e}=this,r=e.state.selection.main,o=getSelection(e.root),{anchorNode:s,anchorOffset:l}=e.observer.selectionRange;if(!o||!r.empty||!r.assoc||!o.modify)return;let c=LineView.find(this,r.head);if(!c)return;let u=c.posAtStart;if(r.head==u||r.head==u+c.length)return;let f=this.coordsAt(r.head,-1),d=this.coordsAt(r.head,1);if(!f||!d||f.bottom>d.top)return;let g=this.domAtPos(r.head+r.assoc);o.collapse(g.node,g.offset),o.modify("move",r.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let m=e.observer.selectionRange;e.docView.posFromDOM(m.anchorNode,m.anchorOffset)!=r.from&&o.collapse(s,l)}mayControlSelection(){let e=this.view.root.activeElement;return e==this.dom||hasSelection(this.dom,this.view.observer.selectionRange)&&!(e&&this.dom.contains(e))}nearest(e){for(let r=e;r;){let o=ContentView.get(r);if(o&&o.rootView==this)return o;r=r.parentNode}return null}posFromDOM(e,r){let o=this.nearest(e);if(!o)throw new RangeError("Trying to find position for a DOM position outside of the document");return o.localPosFromDOM(e,r)+o.posAtStart}domAtPos(e){let{i:r,off:o}=this.childCursor().findPos(e,-1);for(;r<this.children.length-1;){let s=this.children[r];if(o<s.length||s instanceof LineView)break;r++,o=0}return this.children[r].domAtPos(o)}coordsAt(e,r){for(let o=this.length,s=this.children.length-1;;s--){let l=this.children[s],c=o-l.breakAfter-l.length;if(e>c||e==c&&l.type!=BlockType.WidgetBefore&&l.type!=BlockType.WidgetAfter&&(!s||r==2||this.children[s-1].breakAfter||this.children[s-1].type==BlockType.WidgetBefore&&r>-2))return l.coordsAt(e-c,r);o=c}}measureVisibleLineHeights(e){let r=[],{from:o,to:s}=e,l=this.view.contentDOM.clientWidth,c=l>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,u=-1,f=this.view.textDirection==Direction.LTR;for(let d=0,g=0;g<this.children.length;g++){let m=this.children[g],v=d+m.length;if(v>s)break;if(d>=o){let b=m.dom.getBoundingClientRect();if(r.push(b.height),c){let k=m.dom.lastChild,R=k?clientRectsFor(k):[];if(R.length){let I=R[R.length-1],$=f?I.right-b.left:b.right-I.left;$>u&&(u=$,this.minWidth=l,this.minWidthFrom=d,this.minWidthTo=v)}}}d=v+m.breakAfter}return r}textDirectionAt(e){let{i:r}=this.childPos(e,1);return getComputedStyle(this.children[r].dom).direction=="rtl"?Direction.RTL:Direction.LTR}measureTextSize(){for(let l of this.children)if(l instanceof LineView){let c=l.measureTextSize();if(c)return c}let e=document.createElement("div"),r,o,s;return e.className="cm-line",e.style.width="99999px",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let l=clientRectsFor(e.firstChild)[0];r=e.getBoundingClientRect().height,o=l?l.width/27:7,s=l?l.height:r,e.remove()}),{lineHeight:r,charWidth:o,textHeight:s}}childCursor(e=this.length){let r=this.children.length;return r&&(e-=this.children[--r].length),new ChildCursor(this.children,e,r)}computeBlockGapDeco(){let e=[],r=this.view.viewState;for(let o=0,s=0;;s++){let l=s==r.viewports.length?null:r.viewports[s],c=l?l.from-1:this.length;if(c>o){let u=r.lineBlockAt(c).bottom-r.lineBlockAt(o).top;e.push(Decoration.replace({widget:new BlockGapWidget(u),block:!0,inclusive:!0,isBlockGap:!0}).range(o,c))}if(!l)break;o=l.to+1}return Decoration.set(e)}updateDeco(){let e=this.view.state.facet(decorations).map((r,o)=>(this.dynamicDecorationMap[o]=typeof r=="function")?r(this.view):r);for(let r=e.length;r<e.length+3;r++)this.dynamicDecorationMap[r]=!1;return this.decorations=[...e,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:r}=e,o=this.coordsAt(r.head,r.empty?r.assoc:r.head>r.anchor?-1:1),s;if(!o)return;!r.empty&&(s=this.coordsAt(r.anchor,r.anchor>r.head?-1:1))&&(o={left:Math.min(o.left,s.left),top:Math.min(o.top,s.top),right:Math.max(o.right,s.right),bottom:Math.max(o.bottom,s.bottom)});let l=0,c=0,u=0,f=0;for(let g of this.view.state.facet(scrollMargins).map(m=>m(this.view)))if(g){let{left:m,right:v,top:b,bottom:k}=g;m!=null&&(l=Math.max(l,m)),v!=null&&(c=Math.max(c,v)),b!=null&&(u=Math.max(u,b)),k!=null&&(f=Math.max(f,k))}let d={left:o.left-l,top:o.top-u,right:o.right+c,bottom:o.bottom+f};scrollRectIntoView(this.view.scrollDOM,d,r.head<r.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==Direction.LTR)}}function betweenUneditable(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}class BlockGapWidget extends WidgetType{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function compositionSurroundingNode(n){let e=n.observer.selectionRange,r=e.focusNode&&nearbyTextNode(e.focusNode,e.focusOffset,0);if(!r)return null;let o=n.docView.nearest(r);if(!o)return null;if(o instanceof LineView){let s=r;for(;s.parentNode!=o.dom;)s=s.parentNode;let l=s.previousSibling;for(;l&&!ContentView.get(l);)l=l.previousSibling;let c=l?ContentView.get(l).posAtEnd:o.posAtStart;return{from:c,to:c,node:s,text:r}}else{for(;;){let{parent:l}=o;if(!l)return null;if(l instanceof LineView)break;o=l}let s=o.posAtStart;return{from:s,to:s+o.length,node:o.dom,text:r}}}function computeCompositionDeco(n,e){let r=compositionSurroundingNode(n);if(!r)return Decoration.none;let{from:o,to:s,node:l,text:c}=r,u=e.mapPos(o,1),f=Math.max(u,e.mapPos(s,-1)),{state:d}=n,g=l.nodeType==3?l.nodeValue:new DOMReader([],d).readRange(l.firstChild,null).text;if(f-u<g.length)if(d.doc.sliceString(u,Math.min(d.doc.length,u+g.length),LineBreakPlaceholder)==g)f=u+g.length;else if(d.doc.sliceString(Math.max(0,f-g.length),f,LineBreakPlaceholder)==g)u=f-g.length;else return Decoration.none;else if(d.doc.sliceString(u,f,LineBreakPlaceholder)!=g)return Decoration.none;let m=ContentView.get(l);return m instanceof CompositionView?m=m.widget.topView:m&&(m.parent=null),Decoration.set(Decoration.replace({widget:new CompositionWidget(l,c,m),inclusive:!0}).range(u,f))}class CompositionWidget extends WidgetType{constructor(e,r,o){super(),this.top=e,this.text=r,this.topView=o}eq(e){return this.top==e.top&&this.text==e.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return CompositionView}}function nearbyTextNode(n,e,r){if(r<=0)for(let o=n,s=e;;){if(o.nodeType==3)return o;if(o.nodeType==1&&s>0)o=o.childNodes[s-1],s=maxOffset(o);else break}if(r>=0)for(let o=n,s=e;;){if(o.nodeType==3)return o;if(o.nodeType==1&&s<o.childNodes.length&&r>=0)o=o.childNodes[s],s=0;else break}return null}function nextToUneditable(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}class DecorationComparator$1{constructor(){this.changes=[]}compareRange(e,r){addRange(e,r,this.changes)}comparePoint(e,r){addRange(e,r,this.changes)}}function findChangedDeco(n,e,r){let o=new DecorationComparator$1;return RangeSet.compare(n,e,r,o),o.changes}function inUneditable(n,e){for(let r=n;r&&r!=e;r=r.assignedSlot||r.parentNode)if(r.nodeType==1&&r.contentEditable=="false")return!0;return!1}function groupAt(n,e,r=1){let o=n.charCategorizer(e),s=n.doc.lineAt(e),l=e-s.from;if(s.length==0)return EditorSelection.cursor(e);l==0?r=1:l==s.length&&(r=-1);let c=l,u=l;r<0?c=findClusterBreak(s.text,l,!1):u=findClusterBreak(s.text,l);let f=o(s.text.slice(c,u));for(;c>0;){let d=findClusterBreak(s.text,c,!1);if(o(s.text.slice(d,c))!=f)break;c=d}for(;u<s.length;){let d=findClusterBreak(s.text,u);if(o(s.text.slice(u,d))!=f)break;u=d}return EditorSelection.range(c+s.from,u+s.from)}function getdx(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function getdy(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function yOverlap(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function upTop(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function upBot(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function domPosAtCoords(n,e,r){let o,s,l,c,u=!1,f,d,g,m;for(let k=n.firstChild;k;k=k.nextSibling){let R=clientRectsFor(k);for(let I=0;I<R.length;I++){let $=R[I];s&&yOverlap(s,$)&&($=upTop(upBot($,s.bottom),s.top));let Y=getdx(e,$),oe=getdy(r,$);if(Y==0&&oe==0)return k.nodeType==3?domPosInText(k,e,r):domPosAtCoords(k,e,r);if(!o||c>oe||c==oe&&l>Y){o=k,s=$,l=Y,c=oe;let G=oe?r<$.top?-1:1:Y?e<$.left?-1:1:0;u=!G||(G>0?I<R.length-1:I>0)}Y==0?r>$.bottom&&(!g||g.bottom<$.bottom)?(f=k,g=$):r<$.top&&(!m||m.top>$.top)&&(d=k,m=$):g&&yOverlap(g,$)?g=upBot(g,$.bottom):m&&yOverlap(m,$)&&(m=upTop(m,$.top))}}if(g&&g.bottom>=r?(o=f,s=g):m&&m.top<=r&&(o=d,s=m),!o)return{node:n,offset:0};let v=Math.max(s.left,Math.min(s.right,e));if(o.nodeType==3)return domPosInText(o,v,r);if(u&&o.contentEditable!="false")return domPosAtCoords(o,v,r);let b=Array.prototype.indexOf.call(n.childNodes,o)+(e>=(s.left+s.right)/2?1:0);return{node:n,offset:b}}function domPosInText(n,e,r){let o=n.nodeValue.length,s=-1,l=1e9,c=0;for(let u=0;u<o;u++){let f=textRange(n,u,u+1).getClientRects();for(let d=0;d<f.length;d++){let g=f[d];if(g.top==g.bottom)continue;c||(c=e-g.left);let m=(g.top>r?g.top-r:r-g.bottom)-1;if(g.left-1<=e&&g.right+1>=e&&m<l){let v=e>=(g.left+g.right)/2,b=v;if((browser.chrome||browser.gecko)&&textRange(n,u).getBoundingClientRect().left==g.right&&(b=!v),m<=0)return{node:n,offset:u+(b?1:0)};s=u+(b?1:0),l=m}}}return{node:n,offset:s>-1?s:c>0?n.nodeValue.length:0}}function posAtCoords(n,e,r,o=-1){var s,l;let c=n.contentDOM.getBoundingClientRect(),u=c.top+n.viewState.paddingTop,f,{docHeight:d}=n.viewState,{x:g,y:m}=e,v=m-u;if(v<0)return 0;if(v>d)return n.state.doc.length;for(let G=n.defaultLineHeight/2,q=!1;f=n.elementAtHeight(v),f.type!=BlockType.Text;)for(;v=o>0?f.bottom+G:f.top-G,!(v>=0&&v<=d);){if(q)return r?null:0;q=!0,o=-o}m=u+v;let b=f.from;if(b<n.viewport.from)return n.viewport.from==0?0:r?null:posAtCoordsImprecise(n,c,f,g,m);if(b>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:r?null:posAtCoordsImprecise(n,c,f,g,m);let k=n.dom.ownerDocument,R=n.root.elementFromPoint?n.root:k,I=R.elementFromPoint(g,m);I&&!n.contentDOM.contains(I)&&(I=null),I||(g=Math.max(c.left+1,Math.min(c.right-1,g)),I=R.elementFromPoint(g,m),I&&!n.contentDOM.contains(I)&&(I=null));let $,Y=-1;if(I&&((s=n.docView.nearest(I))===null||s===void 0?void 0:s.isEditable)!=!1){if(k.caretPositionFromPoint){let G=k.caretPositionFromPoint(g,m);G&&({offsetNode:$,offset:Y}=G)}else if(k.caretRangeFromPoint){let G=k.caretRangeFromPoint(g,m);G&&({startContainer:$,startOffset:Y}=G,(!n.contentDOM.contains($)||browser.safari&&isSuspiciousSafariCaretResult($,Y,g)||browser.chrome&&isSuspiciousChromeCaretResult($,Y,g))&&($=void 0))}}if(!$||!n.docView.dom.contains($)){let G=LineView.find(n.docView,b);if(!G)return v>f.top+f.height/2?f.to:f.from;({node:$,offset:Y}=domPosAtCoords(G.dom,g,m))}let oe=n.docView.nearest($);if(!oe)return null;if(oe.isWidget&&((l=oe.dom)===null||l===void 0?void 0:l.nodeType)==1){let G=oe.dom.getBoundingClientRect();return e.y<G.top||e.y<=G.bottom&&e.x<=(G.left+G.right)/2?oe.posAtStart:oe.posAtEnd}else return oe.localPosFromDOM($,Y)+oe.posAtStart}function posAtCoordsImprecise(n,e,r,o,s){let l=Math.round((o-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&r.height>n.defaultLineHeight*1.5){let u=Math.floor((s-r.top)/n.defaultLineHeight);l+=u*n.viewState.heightOracle.lineLength}let c=n.state.sliceDoc(r.from,r.to);return r.from+findColumn(c,l,n.state.tabSize)}function isSuspiciousSafariCaretResult(n,e,r){let o;if(n.nodeType!=3||e!=(o=n.nodeValue.length))return!1;for(let s=n.nextSibling;s;s=s.nextSibling)if(s.nodeType!=1||s.nodeName!="BR")return!1;return textRange(n,o-1,o).getBoundingClientRect().left>r}function isSuspiciousChromeCaretResult(n,e,r){if(e!=0)return!1;for(let s=n;;){let l=s.parentNode;if(!l||l.nodeType!=1||l.firstChild!=s)return!1;if(l.classList.contains("cm-line"))break;s=l}let o=n.nodeType==1?n.getBoundingClientRect():textRange(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect();return r-o.left>5}function moveToLineBoundary(n,e,r,o){let s=n.state.doc.lineAt(e.head),l=!o||!n.lineWrapping?null:n.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(l){let f=n.dom.getBoundingClientRect(),d=n.textDirectionAt(s.from),g=n.posAtCoords({x:r==(d==Direction.LTR)?f.right-1:f.left+1,y:(l.top+l.bottom)/2});if(g!=null)return EditorSelection.cursor(g,r?-1:1)}let c=LineView.find(n.docView,e.head),u=c?r?c.posAtEnd:c.posAtStart:r?s.to:s.from;return EditorSelection.cursor(u,r?-1:1)}function moveByChar(n,e,r,o){let s=n.state.doc.lineAt(e.head),l=n.bidiSpans(s),c=n.textDirectionAt(s.from);for(let u=e,f=null;;){let d=moveVisually(s,l,c,u,r),g=movedOver;if(!d){if(s.number==(r?n.state.doc.lines:1))return u;g=`
`,s=n.state.doc.line(s.number+(r?1:-1)),l=n.bidiSpans(s),d=EditorSelection.cursor(r?s.from:s.to)}if(f){if(!f(g))return u}else{if(!o)return d;f=o(g)}u=d}}function byGroup(n,e,r){let o=n.state.charCategorizer(e),s=o(r);return l=>{let c=o(l);return s==CharCategory.Space&&(s=c),s==c}}function moveVertically(n,e,r,o){let s=e.head,l=r?1:-1;if(s==(r?n.state.doc.length:0))return EditorSelection.cursor(s,e.assoc);let c=e.goalColumn,u,f=n.contentDOM.getBoundingClientRect(),d=n.coordsAtPos(s),g=n.documentTop;if(d)c==null&&(c=d.left-f.left),u=l<0?d.top:d.bottom;else{let b=n.viewState.lineBlockAt(s);c==null&&(c=Math.min(f.right-f.left,n.defaultCharacterWidth*(s-b.from))),u=(l<0?b.top:b.bottom)+g}let m=f.left+c,v=o??n.defaultLineHeight>>1;for(let b=0;;b+=10){let k=u+(v+b)*l,R=posAtCoords(n,{x:m,y:k},!1,l);if(k<f.top||k>f.bottom||(l<0?R<s:R>s))return EditorSelection.cursor(R,e.assoc,void 0,c)}}function skipAtoms(n,e,r){let o=n.state.facet(atomicRanges).map(s=>s(n));for(;;){let s=!1;for(let l of o)l.between(r.from-1,r.from+1,(c,u,f)=>{r.from>c&&r.from<u&&(r=e.head>r.from?EditorSelection.cursor(c,1):EditorSelection.cursor(u,-1),s=!0)});if(!s)return r}}class InputState{constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null;let r=(o,s)=>{this.ignoreDuringComposition(s)||s.type=="keydown"&&this.keydown(e,s)||(this.mustFlushObserver(s)&&e.observer.forceFlush(),this.runCustomHandlers(s.type,e,s)?s.preventDefault():o(e,s))};for(let o in handlers){let s=handlers[o];e.contentDOM.addEventListener(o,l=>{eventBelongsToEditor(e,l)&&r(s,l)},handlerOptions[o]),this.registeredEvents.push(o)}e.scrollDOM.addEventListener("mousedown",o=>{if(o.target==e.scrollDOM&&o.clientY>e.contentDOM.getBoundingClientRect().bottom&&(r(handlers.mousedown,o),!o.defaultPrevented&&o.button==2)){let s=e.contentDOM.style.minHeight;e.contentDOM.style.minHeight="100%",setTimeout(()=>e.contentDOM.style.minHeight=s,200)}}),browser.chrome&&browser.chrome_version==102&&e.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?e.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,e.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=e.hasFocus,browser.safari&&e.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}ensureHandlers(e,r){var o;let s;this.customHandlers=[];for(let l of r)if(s=(o=l.update(e).spec)===null||o===void 0?void 0:o.domEventHandlers){this.customHandlers.push({plugin:l.value,handlers:s});for(let c in s)this.registeredEvents.indexOf(c)<0&&c!="scroll"&&(this.registeredEvents.push(c),e.contentDOM.addEventListener(c,u=>{eventBelongsToEditor(e,u)&&this.runCustomHandlers(c,e,u)&&u.preventDefault()}))}}runCustomHandlers(e,r,o){for(let s of this.customHandlers){let l=s.handlers[e];if(l)try{if(l.call(s.plugin,o,r)||o.defaultPrevented)return!0}catch(c){logException(r.state,c)}}return!1}runScrollHandlers(e,r){this.lastScrollTop=e.scrollDOM.scrollTop,this.lastScrollLeft=e.scrollDOM.scrollLeft;for(let o of this.customHandlers){let s=o.handlers.scroll;if(s)try{s.call(o.plugin,r,e)}catch(l){logException(e.state,l)}}}keydown(e,r){if(this.lastKeyCode=r.keyCode,this.lastKeyTime=Date.now(),r.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(browser.android&&browser.chrome&&!r.synthetic&&(r.keyCode==13||r.keyCode==8))return e.observer.delayAndroidKey(r.key,r.keyCode),!0;let o;return browser.ios&&!r.synthetic&&!r.altKey&&!r.metaKey&&((o=PendingKeys.find(s=>s.keyCode==r.keyCode))&&!r.ctrlKey||EmacsyPendingKeys.indexOf(r.key)>-1&&r.ctrlKey&&!r.shiftKey)?(this.pendingIOSKey=o||r,setTimeout(()=>this.flushIOSKey(e),250),!0):!1}flushIOSKey(e){let r=this.pendingIOSKey;return r?(this.pendingIOSKey=void 0,dispatchKey(e.contentDOM,r.key,r.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:browser.safari&&!browser.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}mustFlushObserver(e){return e.type=="keydown"&&e.keyCode!=229}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const PendingKeys=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],EmacsyPendingKeys="dthko",modifierCodes=[16,17,18,20,91,92,224,225],dragScrollMargin=6;function dragScrollSpeed(n){return Math.max(0,n)*.7+8}class MouseSelection{constructor(e,r,o,s){this.view=e,this.style=o,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=r,this.scrollParent=scrollableParent(e.contentDOM);let l=e.contentDOM.ownerDocument;l.addEventListener("mousemove",this.move=this.move.bind(this)),l.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=r.shiftKey,this.multiple=e.state.facet(EditorState.allowMultipleSelections)&&addsSelectionRange(e,r),this.dragMove=dragMovesSelection(e,r),this.dragging=isInPrimarySelection(e,r)&&getClickType(r)==1?null:!1}start(e){this.dragging===!1&&(e.preventDefault(),this.select(e))}move(e){var r;if(e.buttons==0)return this.destroy();if(this.dragging!==!1)return;this.select(this.lastEvent=e);let o=0,s=0,l=((r=this.scrollParent)===null||r===void 0?void 0:r.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight};e.clientX<=l.left+dragScrollMargin?o=-dragScrollSpeed(l.left-e.clientX):e.clientX>=l.right-dragScrollMargin&&(o=dragScrollSpeed(e.clientX-l.right)),e.clientY<=l.top+dragScrollMargin?s=-dragScrollSpeed(l.top-e.clientY):e.clientY>=l.bottom-dragScrollMargin&&(s=dragScrollSpeed(e.clientY-l.bottom)),this.setScrollSpeed(o,s)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}setScrollSpeed(e,r){this.scrollSpeed={x:e,y:r},e||r?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}select(e){let r=this.style.get(e,this.extend,this.multiple);(this.mustSelect||!r.eq(this.view.state.selection)||r.main.assoc!=this.view.state.selection.main.assoc)&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function addsSelectionRange(n,e){let r=n.state.facet(clickAddsSelectionRange);return r.length?r[0](e):browser.mac?e.metaKey:e.ctrlKey}function dragMovesSelection(n,e){let r=n.state.facet(dragMovesSelection$1);return r.length?r[0](e):browser.mac?!e.altKey:!e.ctrlKey}function isInPrimarySelection(n,e){let{main:r}=n.state.selection;if(r.empty)return!1;let o=getSelection(n.root);if(!o||o.rangeCount==0)return!0;let s=o.getRangeAt(0).getClientRects();for(let l=0;l<s.length;l++){let c=s[l];if(c.left<=e.clientX&&c.right>=e.clientX&&c.top<=e.clientY&&c.bottom>=e.clientY)return!0}return!1}function eventBelongsToEditor(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r=e.target,o;r!=n.contentDOM;r=r.parentNode)if(!r||r.nodeType==11||(o=ContentView.get(r))&&o.ignoreEvent(e))return!1;return!0}const handlers=Object.create(null),handlerOptions=Object.create(null),brokenClipboardAPI=browser.ie&&browser.ie_version<15||browser.ios&&browser.webkit_version<604;function capturePaste(n){let e=n.dom.parentNode;if(!e)return;let r=e.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{n.focus(),r.remove(),doPaste(n,r.value)},50)}function doPaste(n,e){let{state:r}=n,o,s=1,l=r.toText(e),c=l.lines==r.selection.ranges.length;if(lastLinewiseCopy!=null&&r.selection.ranges.every(f=>f.empty)&&lastLinewiseCopy==l.toString()){let f=-1;o=r.changeByRange(d=>{let g=r.doc.lineAt(d.from);if(g.from==f)return{range:d};f=g.from;let m=r.toText((c?l.line(s++).text:e)+r.lineBreak);return{changes:{from:g.from,insert:m},range:EditorSelection.cursor(d.from+m.length)}})}else c?o=r.changeByRange(f=>{let d=l.line(s++);return{changes:{from:f.from,to:f.to,insert:d.text},range:EditorSelection.cursor(f.from+d.length)}}):o=r.replaceSelection(l);n.dispatch(o,{userEvent:"input.paste",scrollIntoView:!0})}handlers.keydown=(n,e)=>{n.inputState.setSelectionOrigin("select"),e.keyCode==27?n.inputState.lastEscPress=Date.now():modifierCodes.indexOf(e.keyCode)<0&&(n.inputState.lastEscPress=0)};handlers.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};handlers.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};handlerOptions.touchstart=handlerOptions.touchmove={passive:!0};handlers.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return;let r=null;for(let o of n.state.facet(mouseSelectionStyle))if(r=o(n,e),r)break;if(!r&&e.button==0&&(r=basicMouseSelection(n,e)),r){let o=n.root.activeElement!=n.contentDOM;n.inputState.startMouseSelection(new MouseSelection(n,e,r,o)),o&&n.observer.ignore(()=>focusPreventScroll(n.contentDOM)),n.inputState.mouseSelection&&n.inputState.mouseSelection.start(e)}};function rangeForClick(n,e,r,o){if(o==1)return EditorSelection.cursor(e,r);if(o==2)return groupAt(n.state,e,r);{let s=LineView.find(n.docView,e),l=n.state.doc.lineAt(s?s.posAtEnd:e),c=s?s.posAtStart:l.from,u=s?s.posAtEnd:l.to;return u<n.state.doc.length&&u==l.to&&u++,EditorSelection.range(c,u)}}let insideY=(n,e)=>n>=e.top&&n<=e.bottom,inside=(n,e,r)=>insideY(e,r)&&n>=r.left&&n<=r.right;function findPositionSide(n,e,r,o){let s=LineView.find(n.docView,e);if(!s)return 1;let l=e-s.posAtStart;if(l==0)return 1;if(l==s.length)return-1;let c=s.coordsAt(l,-1);if(c&&inside(r,o,c))return-1;let u=s.coordsAt(l,1);return u&&inside(r,o,u)?1:c&&insideY(o,c)?-1:1}function queryPos(n,e){let r=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:r,bias:findPositionSide(n,r,e.clientX,e.clientY)}}const BadMouseDetail=browser.ie&&browser.ie_version<=11;let lastMouseDown=null,lastMouseDownCount=0,lastMouseDownTime=0;function getClickType(n){if(!BadMouseDetail)return n.detail;let e=lastMouseDown,r=lastMouseDownTime;return lastMouseDown=n,lastMouseDownTime=Date.now(),lastMouseDownCount=!e||r>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(lastMouseDownCount+1)%3:1}function basicMouseSelection(n,e){let r=queryPos(n,e),o=getClickType(e),s=n.state.selection;return{update(l){l.docChanged&&(r.pos=l.changes.mapPos(r.pos),s=s.map(l.changes))},get(l,c,u){let f=queryPos(n,l),d,g=rangeForClick(n,f.pos,f.bias,o);if(r.pos!=f.pos&&!c){let m=rangeForClick(n,r.pos,r.bias,o),v=Math.min(m.from,g.from),b=Math.max(m.to,g.to);g=v<g.from?EditorSelection.range(v,b):EditorSelection.range(b,v)}return c?s.replaceRange(s.main.extend(g.from,g.to)):u&&o==1&&s.ranges.length>1&&(d=removeRangeAround(s,f.pos))?d:u?s.addRange(g):EditorSelection.create([g])}}}function removeRangeAround(n,e){for(let r=0;r<n.ranges.length;r++){let{from:o,to:s}=n.ranges[r];if(o<=e&&s>=e)return EditorSelection.create(n.ranges.slice(0,r).concat(n.ranges.slice(r+1)),n.mainIndex==r?0:n.mainIndex-(n.mainIndex>r?1:0))}return null}handlers.dragstart=(n,e)=>{let{selection:{main:r}}=n.state,{mouseSelection:o}=n.inputState;o&&(o.dragging=r),e.dataTransfer&&(e.dataTransfer.setData("Text",n.state.sliceDoc(r.from,r.to)),e.dataTransfer.effectAllowed="copyMove")};function dropText(n,e,r,o){if(!r)return;let s=n.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:l}=n.inputState,c=o&&l&&l.dragging&&l.dragMove?{from:l.dragging.from,to:l.dragging.to}:null,u={from:s,insert:r},f=n.state.changes(c?[c,u]:u);n.focus(),n.dispatch({changes:f,selection:{anchor:f.mapPos(s,-1),head:f.mapPos(s,1)},userEvent:c?"move.drop":"input.drop"})}handlers.drop=(n,e)=>{if(!e.dataTransfer)return;if(n.state.readOnly)return e.preventDefault();let r=e.dataTransfer.files;if(r&&r.length){e.preventDefault();let o=Array(r.length),s=0,l=()=>{++s==r.length&&dropText(n,e,o.filter(c=>c!=null).join(n.state.lineBreak),!1)};for(let c=0;c<r.length;c++){let u=new FileReader;u.onerror=l,u.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(u.result)||(o[c]=u.result),l()},u.readAsText(r[c])}}else dropText(n,e,e.dataTransfer.getData("Text"),!0)};handlers.paste=(n,e)=>{if(n.state.readOnly)return e.preventDefault();n.observer.flush();let r=brokenClipboardAPI?null:e.clipboardData;r?(doPaste(n,r.getData("text/plain")||r.getData("text/uri-text")),e.preventDefault()):capturePaste(n)};function captureCopy(n,e){let r=n.dom.parentNode;if(!r)return;let o=r.appendChild(document.createElement("textarea"));o.style.cssText="position: fixed; left: -10000px; top: 10px",o.value=e,o.focus(),o.selectionEnd=e.length,o.selectionStart=0,setTimeout(()=>{o.remove(),n.focus()},50)}function copiedRange(n){let e=[],r=[],o=!1;for(let s of n.selection.ranges)s.empty||(e.push(n.sliceDoc(s.from,s.to)),r.push(s));if(!e.length){let s=-1;for(let{from:l}of n.selection.ranges){let c=n.doc.lineAt(l);c.number>s&&(e.push(c.text),r.push({from:c.from,to:Math.min(n.doc.length,c.to+1)})),s=c.number}o=!0}return{text:e.join(n.lineBreak),ranges:r,linewise:o}}let lastLinewiseCopy=null;handlers.copy=handlers.cut=(n,e)=>{let{text:r,ranges:o,linewise:s}=copiedRange(n.state);if(!r&&!s)return;lastLinewiseCopy=s?r:null;let l=brokenClipboardAPI?null:e.clipboardData;l?(e.preventDefault(),l.clearData(),l.setData("text/plain",r)):captureCopy(n,r),e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:o,scrollIntoView:!0,userEvent:"delete.cut"})};const isFocusChange=Annotation.define();function focusChangeTransaction(n,e){let r=[];for(let o of n.facet(focusChangeEffect)){let s=o(n,e);s&&r.push(s)}return r?n.update({effects:r,annotations:isFocusChange.of(!0)}):null}function updateForFocusChange(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let r=focusChangeTransaction(n.state,e);r?n.dispatch(r):n.update([])}},10)}handlers.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),updateForFocusChange(n)};handlers.blur=n=>{n.observer.clearSelectionRange(),updateForFocusChange(n)};handlers.compositionstart=handlers.compositionupdate=n=>{n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0)};handlers.compositionend=n=>{n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,browser.chrome&&browser.android&&n.observer.flushSoon(),setTimeout(()=>{n.inputState.composing<0&&n.docView.compositionDeco.size&&n.update([])},50)};handlers.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};handlers.beforeinput=(n,e)=>{var r;let o;if(browser.chrome&&browser.android&&(o=PendingKeys.find(s=>s.inputType==e.inputType))&&(n.observer.delayAndroidKey(o.key,o.keyCode),o.key=="Backspace"||o.key=="Delete")){let s=((r=window.visualViewport)===null||r===void 0?void 0:r.height)||0;setTimeout(()=>{var l;(((l=window.visualViewport)===null||l===void 0?void 0:l.height)||0)>s+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}};const wrappingWhiteSpace=["pre-wrap","normal","pre-line","break-spaces"];class HeightOracle{constructor(e){this.lineWrapping=e,this.doc=Text.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,r){let o=this.doc.lineAt(r).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(o+=Math.max(0,Math.ceil((r-e-o*this.lineLength*.5)/this.lineLength))),this.lineHeight*o}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return wrappingWhiteSpace.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let r=!1;for(let o=0;o<e.length;o++){let s=e[o];s<0?o++:this.heightSamples[Math.floor(s*10)]||(r=!0,this.heightSamples[Math.floor(s*10)]=!0)}return r}refresh(e,r,o,s,l,c){let u=wrappingWhiteSpace.indexOf(e)>-1,f=Math.round(r)!=Math.round(this.lineHeight)||this.lineWrapping!=u;if(this.lineWrapping=u,this.lineHeight=r,this.charWidth=o,this.textHeight=s,this.lineLength=l,f){this.heightSamples={};for(let d=0;d<c.length;d++){let g=c[d];g<0?d++:this.heightSamples[Math.floor(g*10)]=!0}}return f}}class MeasuredHeights{constructor(e,r){this.from=e,this.heights=r,this.index=0}get more(){return this.index<this.heights.length}}class BlockInfo{constructor(e,r,o,s,l){this.from=e,this.length=r,this.top=o,this.height=s,this.type=l}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(e){let r=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(e.type)?e.type:[e]);return new BlockInfo(this.from,this.length+e.length,this.top,this.height+e.height,r)}}var QueryType$1=function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n}(QueryType$1||(QueryType$1={}));const Epsilon=.001;class HeightMap{constructor(e,r,o=2){this.length=e,this.height=r,this.flags=o}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,r){this.height!=r&&(Math.abs(this.height-r)>Epsilon&&(e.heightChanged=!0),this.height=r)}replace(e,r,o){return HeightMap.of(o)}decomposeLeft(e,r){r.push(this)}decomposeRight(e,r){r.push(this)}applyChanges(e,r,o,s){let l=this,c=o.doc;for(let u=s.length-1;u>=0;u--){let{fromA:f,toA:d,fromB:g,toB:m}=s[u],v=l.lineAt(f,QueryType$1.ByPosNoHeight,o.setDoc(r),0,0),b=v.to>=d?v:l.lineAt(d,QueryType$1.ByPosNoHeight,o,0,0);for(m+=b.to-d,d=b.to;u>0&&v.from<=s[u-1].toA;)f=s[u-1].fromA,g=s[u-1].fromB,u--,f<v.from&&(v=l.lineAt(f,QueryType$1.ByPosNoHeight,o,0,0));g+=v.from-f,f=v.from;let k=NodeBuilder.build(o.setDoc(c),e,g,m);l=l.replace(f,d,k)}return l.updateHeight(o,0)}static empty(){return new HeightMapText(0,0)}static of(e){if(e.length==1)return e[0];let r=0,o=e.length,s=0,l=0;for(;;)if(r==o)if(s>l*2){let u=e[r-1];u.break?e.splice(--r,1,u.left,null,u.right):e.splice(--r,1,u.left,u.right),o+=1+u.break,s-=u.size}else if(l>s*2){let u=e[o];u.break?e.splice(o,1,u.left,null,u.right):e.splice(o,1,u.left,u.right),o+=2+u.break,l-=u.size}else break;else if(s<l){let u=e[r++];u&&(s+=u.size)}else{let u=e[--o];u&&(l+=u.size)}let c=0;return e[r-1]==null?(c=1,r--):e[r]==null&&(c=1,o++),new HeightMapBranch(HeightMap.of(e.slice(0,r)),c,HeightMap.of(e.slice(o)))}}HeightMap.prototype.size=1;class HeightMapBlock extends HeightMap{constructor(e,r,o){super(e,r),this.type=o}blockAt(e,r,o,s){return new BlockInfo(s,this.length,o,this.height,this.type)}lineAt(e,r,o,s,l){return this.blockAt(0,o,s,l)}forEachLine(e,r,o,s,l,c){e<=l+this.length&&r>=l&&c(this.blockAt(0,o,s,l))}updateHeight(e,r=0,o=!1,s){return s&&s.from<=r&&s.more&&this.setHeight(e,s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class HeightMapText extends HeightMapBlock{constructor(e,r){super(e,r,BlockType.Text),this.collapsed=0,this.widgetHeight=0}replace(e,r,o){let s=o[0];return o.length==1&&(s instanceof HeightMapText||s instanceof HeightMapGap&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof HeightMapGap?s=new HeightMapText(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):HeightMap.of(o)}updateHeight(e,r=0,o=!1,s){return s&&s.from<=r&&s.more?this.setHeight(e,s.heights[s.index++]):(o||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class HeightMapGap extends HeightMap{constructor(e){super(e,0)}heightMetrics(e,r){let o=e.doc.lineAt(r).number,s=e.doc.lineAt(r+this.length).number,l=s-o+1,c,u=0;if(e.lineWrapping){let f=Math.min(this.height,e.lineHeight*l);c=f/l,u=(this.height-f)/(this.length-l-1)}else c=this.height/l;return{firstLine:o,lastLine:s,perLine:c,perChar:u}}blockAt(e,r,o,s){let{firstLine:l,lastLine:c,perLine:u,perChar:f}=this.heightMetrics(r,s);if(r.lineWrapping){let d=s+Math.round(Math.max(0,Math.min(1,(e-o)/this.height))*this.length),g=r.doc.lineAt(d),m=u+g.length*f,v=Math.max(o,e-m/2);return new BlockInfo(g.from,g.length,v,m,BlockType.Text)}else{let d=Math.max(0,Math.min(c-l,Math.floor((e-o)/u))),{from:g,length:m}=r.doc.line(l+d);return new BlockInfo(g,m,o+u*d,u,BlockType.Text)}}lineAt(e,r,o,s,l){if(r==QueryType$1.ByHeight)return this.blockAt(e,o,s,l);if(r==QueryType$1.ByPosNoHeight){let{from:b,to:k}=o.doc.lineAt(e);return new BlockInfo(b,k-b,0,0,BlockType.Text)}let{firstLine:c,perLine:u,perChar:f}=this.heightMetrics(o,l),d=o.doc.lineAt(e),g=u+d.length*f,m=d.number-c,v=s+u*m+f*(d.from-l-m);return new BlockInfo(d.from,d.length,Math.max(s,Math.min(v,s+this.height-g)),g,BlockType.Text)}forEachLine(e,r,o,s,l,c){e=Math.max(e,l),r=Math.min(r,l+this.length);let{firstLine:u,perLine:f,perChar:d}=this.heightMetrics(o,l);for(let g=e,m=s;g<=r;){let v=o.doc.lineAt(g);if(g==e){let k=v.number-u;m+=f*k+d*(e-l-k)}let b=f+d*v.length;c(new BlockInfo(v.from,v.length,m,b,BlockType.Text)),m+=b,g=v.to+1}}replace(e,r,o){let s=this.length-r;if(s>0){let l=o[o.length-1];l instanceof HeightMapGap?o[o.length-1]=new HeightMapGap(l.length+s):o.push(null,new HeightMapGap(s-1))}if(e>0){let l=o[0];l instanceof HeightMapGap?o[0]=new HeightMapGap(e+l.length):o.unshift(new HeightMapGap(e-1),null)}return HeightMap.of(o)}decomposeLeft(e,r){r.push(new HeightMapGap(e-1),null)}decomposeRight(e,r){r.push(null,new HeightMapGap(this.length-e-1))}updateHeight(e,r=0,o=!1,s){let l=r+this.length;if(s&&s.from<=r+this.length&&s.more){let c=[],u=Math.max(r,s.from),f=-1;for(s.from>r&&c.push(new HeightMapGap(s.from-r-1).updateHeight(e,r));u<=l&&s.more;){let g=e.doc.lineAt(u).length;c.length&&c.push(null);let m=s.heights[s.index++];f==-1?f=m:Math.abs(m-f)>=Epsilon&&(f=-2);let v=new HeightMapText(g,m);v.outdated=!1,c.push(v),u+=g+1}u<=l&&c.push(null,new HeightMapGap(l-u).updateHeight(e,u));let d=HeightMap.of(c);return(f<0||Math.abs(d.height-this.height)>=Epsilon||Math.abs(f-this.heightMetrics(e,r).perLine)>=Epsilon)&&(e.heightChanged=!0),d}else(o||this.outdated)&&(this.setHeight(e,e.heightForGap(r,r+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class HeightMapBranch extends HeightMap{constructor(e,r,o){super(e.length+r+o.length,e.height+o.height,r|(e.outdated||o.outdated?2:0)),this.left=e,this.right=o,this.size=e.size+o.size}get break(){return this.flags&1}blockAt(e,r,o,s){let l=o+this.left.height;return e<l?this.left.blockAt(e,r,o,s):this.right.blockAt(e,r,l,s+this.left.length+this.break)}lineAt(e,r,o,s,l){let c=s+this.left.height,u=l+this.left.length+this.break,f=r==QueryType$1.ByHeight?e<c:e<u,d=f?this.left.lineAt(e,r,o,s,l):this.right.lineAt(e,r,o,c,u);if(this.break||(f?d.to<u:d.from>u))return d;let g=r==QueryType$1.ByPosNoHeight?QueryType$1.ByPosNoHeight:QueryType$1.ByPos;return f?d.join(this.right.lineAt(u,g,o,c,u)):this.left.lineAt(u,g,o,s,l).join(d)}forEachLine(e,r,o,s,l,c){let u=s+this.left.height,f=l+this.left.length+this.break;if(this.break)e<f&&this.left.forEachLine(e,r,o,s,l,c),r>=f&&this.right.forEachLine(e,r,o,u,f,c);else{let d=this.lineAt(f,QueryType$1.ByPos,o,s,l);e<d.from&&this.left.forEachLine(e,d.from-1,o,s,l,c),d.to>=e&&d.from<=r&&c(d),r>d.to&&this.right.forEachLine(d.to+1,r,o,u,f,c)}}replace(e,r,o){let s=this.left.length+this.break;if(r<s)return this.balanced(this.left.replace(e,r,o),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,r-s,o));let l=[];e>0&&this.decomposeLeft(e,l);let c=l.length;for(let u of o)l.push(u);if(e>0&&mergeGaps(l,c-1),r<this.length){let u=l.length;this.decomposeRight(r,l),mergeGaps(l,u)}return HeightMap.of(l)}decomposeLeft(e,r){let o=this.left.length;if(e<=o)return this.left.decomposeLeft(e,r);r.push(this.left),this.break&&(o++,e>=o&&r.push(null)),e>o&&this.right.decomposeLeft(e-o,r)}decomposeRight(e,r){let o=this.left.length,s=o+this.break;if(e>=s)return this.right.decomposeRight(e-s,r);e<o&&this.left.decomposeRight(e,r),this.break&&e<s&&r.push(null),r.push(this.right)}balanced(e,r){return e.size>2*r.size||r.size>2*e.size?HeightMap.of(this.break?[e,null,r]:[e,r]):(this.left=e,this.right=r,this.height=e.height+r.height,this.outdated=e.outdated||r.outdated,this.size=e.size+r.size,this.length=e.length+this.break+r.length,this)}updateHeight(e,r=0,o=!1,s){let{left:l,right:c}=this,u=r+l.length+this.break,f=null;return s&&s.from<=r+l.length&&s.more?f=l=l.updateHeight(e,r,o,s):l.updateHeight(e,r,o),s&&s.from<=u+c.length&&s.more?f=c=c.updateHeight(e,u,o,s):c.updateHeight(e,u,o),f?this.balanced(l,c):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function mergeGaps(n,e){let r,o;n[e]==null&&(r=n[e-1])instanceof HeightMapGap&&(o=n[e+1])instanceof HeightMapGap&&n.splice(e-1,3,new HeightMapGap(r.length+1+o.length))}const relevantWidgetHeight=5;class NodeBuilder{constructor(e,r){this.pos=e,this.oracle=r,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,r){if(this.lineStart>-1){let o=Math.min(r,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof HeightMapText?s.length+=o-this.pos:(o>this.pos||!this.isCovered)&&this.nodes.push(new HeightMapText(o-this.pos,-1)),this.writtenTo=o,r>o&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=r}point(e,r,o){if(e<r||o.heightRelevant){let s=o.widget?o.widget.estimatedHeight:0;s<0&&(s=this.oracle.lineHeight);let l=r-e;o.block?this.addBlock(new HeightMapBlock(l,s,o.type)):(l||s>=relevantWidgetHeight)&&this.addLineDeco(s,l)}else r>e&&this.span(e,r);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:r}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=r,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new HeightMapText(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,r){let o=new HeightMapGap(r-e);return this.oracle.doc.lineAt(e).to==r&&(o.flags|=4),o}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof HeightMapText)return e;let r=new HeightMapText(0,-1);return this.nodes.push(r),r}addBlock(e){this.enterLine(),e.type==BlockType.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,e.type!=BlockType.WidgetBefore&&(this.covering=e)}addLineDeco(e,r){let o=this.ensureLine();o.length+=r,o.collapsed+=r,o.widgetHeight=Math.max(o.widgetHeight,e),this.writtenTo=this.pos=this.pos+r}finish(e){let r=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(r instanceof HeightMapText)&&!this.isCovered?this.nodes.push(new HeightMapText(0,-1)):(this.writtenTo<this.pos||r==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let o=e;for(let s of this.nodes)s instanceof HeightMapText&&s.updateHeight(this.oracle,o),o+=s?s.length:1;return this.nodes}static build(e,r,o,s){let l=new NodeBuilder(o,e);return RangeSet.spans(r,o,s,l,0),l.finish(o)}}function heightRelevantDecoChanges(n,e,r){let o=new DecorationComparator;return RangeSet.compare(n,e,r,o,0),o.changes}class DecorationComparator{constructor(){this.changes=[]}compareRange(){}comparePoint(e,r,o,s){(e<r||o&&o.heightRelevant||s&&s.heightRelevant)&&addRange(e,r,this.changes,5)}}function visiblePixelRange(n,e){let r=n.getBoundingClientRect(),o=n.ownerDocument,s=o.defaultView||window,l=Math.max(0,r.left),c=Math.min(s.innerWidth,r.right),u=Math.max(0,r.top),f=Math.min(s.innerHeight,r.bottom);for(let d=n.parentNode;d&&d!=o.body;)if(d.nodeType==1){let g=d,m=window.getComputedStyle(g);if((g.scrollHeight>g.clientHeight||g.scrollWidth>g.clientWidth)&&m.overflow!="visible"){let v=g.getBoundingClientRect();l=Math.max(l,v.left),c=Math.min(c,v.right),u=Math.max(u,v.top),f=d==n.parentNode?v.bottom:Math.min(f,v.bottom)}d=m.position=="absolute"||m.position=="fixed"?g.offsetParent:g.parentNode}else if(d.nodeType==11)d=d.host;else break;return{left:l-r.left,right:Math.max(l,c)-r.left,top:u-(r.top+e),bottom:Math.max(u,f)-(r.top+e)}}function fullPixelRange(n,e){let r=n.getBoundingClientRect();return{left:0,right:r.right-r.left,top:e,bottom:r.bottom-(r.top+e)}}class LineGap{constructor(e,r,o){this.from=e,this.to=r,this.size=o}static same(e,r){if(e.length!=r.length)return!1;for(let o=0;o<e.length;o++){let s=e[o],l=r[o];if(s.from!=l.from||s.to!=l.to||s.size!=l.size)return!1}return!0}draw(e){return Decoration.replace({widget:new LineGapWidget(this.size,e)}).range(this.from,this.to)}}class LineGapWidget extends WidgetType{constructor(e,r){super(),this.size=e,this.vertical=r}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class ViewState{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scaler=IdScaler,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Direction.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let r=e.facet(contentAttributes).some(o=>typeof o!="function"&&o.class=="cm-lineWrapping");this.heightOracle=new HeightOracle(r),this.stateDeco=e.facet(decorations).filter(o=>typeof o!="function"),this.heightMap=HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle.setDoc(e.doc),[new ChangedRange(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Decoration.set(this.lineGaps.map(o=>o.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:r}=this.state.selection;for(let o=0;o<=1;o++){let s=o?r.head:r.anchor;if(!e.some(({from:l,to:c})=>s>=l&&s<=c)){let{from:l,to:c}=this.lineBlockAt(s);e.push(new Viewport(l,c))}}this.viewports=e.sort((o,s)=>o.from-s.from),this.scaler=this.heightMap.height<=7e6?IdScaler:new BigScaler(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:scaleBlock(e,this.scaler))})}update(e,r=null){this.state=e.state;let o=this.stateDeco;this.stateDeco=this.state.facet(decorations).filter(d=>typeof d!="function");let s=e.changedRanges,l=ChangedRange.extendWithRanges(s,heightRelevantDecoChanges(o,this.stateDeco,e?e.changes:ChangeSet.empty(this.state.doc.length))),c=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),l),this.heightMap.height!=c&&(e.flags|=2);let u=l.length?this.mapViewport(this.viewport,e.changes):this.viewport;(r&&(r.range.head<u.from||r.range.head>u.to)||!this.viewportIsAppropriate(u))&&(u=this.getViewport(0,r));let f=!e.changes.empty||e.flags&2||u.from!=this.viewport.from||u.to!=this.viewport.to;this.viewport=u,this.updateForViewport(),f&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),r&&(this.scrollTarget=r),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(nativeSelectionHidden)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let r=e.contentDOM,o=window.getComputedStyle(r),s=this.heightOracle,l=o.whiteSpace;this.defaultTextDirection=o.direction=="rtl"?Direction.RTL:Direction.LTR;let c=this.heightOracle.mustRefreshForWrapping(l),u=r.getBoundingClientRect(),f=c||this.mustMeasureContent||this.contentDOMHeight!=u.height;this.contentDOMHeight=u.height,this.mustMeasureContent=!1;let d=0,g=0,m=parseInt(o.paddingTop)||0,v=parseInt(o.paddingBottom)||0;(this.paddingTop!=m||this.paddingBottom!=v)&&(this.paddingTop=m,this.paddingBottom=v,d|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(f=!0),this.editorWidth=e.scrollDOM.clientWidth,d|=8);let b=(this.printing?fullPixelRange:visiblePixelRange)(r,this.paddingTop),k=b.top-this.pixelViewport.top,R=b.bottom-this.pixelViewport.bottom;this.pixelViewport=b;let I=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(I!=this.inView&&(this.inView=I,I&&(f=!0)),!this.inView&&!this.scrollTarget)return 0;let $=u.width;if((this.contentDOMWidth!=$||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=u.width,this.editorHeight=e.scrollDOM.clientHeight,d|=8),f){let oe=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(oe)&&(c=!0),c||s.lineWrapping&&Math.abs($-this.contentDOMWidth)>s.charWidth){let{lineHeight:G,charWidth:q,textHeight:ne}=e.docView.measureTextSize();c=G>0&&s.refresh(l,G,q,ne,$/q,oe),c&&(e.docView.minWidth=0,d|=8)}k>0&&R>0?g=Math.max(k,R):k<0&&R<0&&(g=Math.min(k,R)),s.heightChanged=!1;for(let G of this.viewports){let q=G.from==this.viewport.from?oe:e.docView.measureVisibleLineHeights(G);this.heightMap=(c?HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle,[new ChangedRange(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,c,new MeasuredHeights(G.from,q))}s.heightChanged&&(d|=2)}let Y=!this.viewportIsAppropriate(this.viewport,g)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return Y&&(this.viewport=this.getViewport(g,this.scrollTarget)),this.updateForViewport(),(d&2||Y)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(c?[]:this.lineGaps,e)),d|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),d}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,r){let o=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,l=this.heightOracle,{visibleTop:c,visibleBottom:u}=this,f=new Viewport(s.lineAt(c-o*1e3,QueryType$1.ByHeight,l,0,0).from,s.lineAt(u+(1-o)*1e3,QueryType$1.ByHeight,l,0,0).to);if(r){let{head:d}=r.range;if(d<f.from||d>f.to){let g=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),m=s.lineAt(d,QueryType$1.ByPos,l,0,0),v;r.y=="center"?v=(m.top+m.bottom)/2-g/2:r.y=="start"||r.y=="nearest"&&d<f.from?v=m.top:v=m.bottom-g,f=new Viewport(s.lineAt(v-1e3/2,QueryType$1.ByHeight,l,0,0).from,s.lineAt(v+g+1e3/2,QueryType$1.ByHeight,l,0,0).to)}}return f}mapViewport(e,r){let o=r.mapPos(e.from,-1),s=r.mapPos(e.to,1);return new Viewport(this.heightMap.lineAt(o,QueryType$1.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,QueryType$1.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:r},o=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,QueryType$1.ByPos,this.heightOracle,0,0),{bottom:l}=this.heightMap.lineAt(r,QueryType$1.ByPos,this.heightOracle,0,0),{visibleTop:c,visibleBottom:u}=this;return(e==0||s<=c-Math.max(10,Math.min(-o,250)))&&(r==this.state.doc.length||l>=u+Math.max(10,Math.min(o,250)))&&s>c-2*1e3&&l<u+2*1e3}mapLineGaps(e,r){if(!e.length||r.empty)return e;let o=[];for(let s of e)r.touchesRange(s.from,s.to)||o.push(new LineGap(r.mapPos(s.from),r.mapPos(s.to),s.size));return o}ensureLineGaps(e,r){let o=this.heightOracle.lineWrapping,s=o?1e4:2e3,l=s>>1,c=s<<1;if(this.defaultTextDirection!=Direction.LTR&&!o)return[];let u=[],f=(d,g,m,v)=>{if(g-d<l)return;let b=this.state.selection.main,k=[b.from];b.empty||k.push(b.to);for(let I of k)if(I>d&&I<g){f(d,I-10,m,v),f(I+10,g,m,v);return}let R=find(e,I=>I.from>=m.from&&I.to<=m.to&&Math.abs(I.from-d)<l&&Math.abs(I.to-g)<l&&!k.some($=>I.from<$&&I.to>$));if(!R){if(g<m.to&&r&&o&&r.visibleRanges.some(I=>I.from<=g&&I.to>=g)){let I=r.moveToLineBoundary(EditorSelection.cursor(g),!1,!0).head;I>d&&(g=I)}R=new LineGap(d,g,this.gapSize(m,d,g,v))}u.push(R)};for(let d of this.viewportLines){if(d.length<c)continue;let g=lineStructure(d.from,d.to,this.stateDeco);if(g.total<c)continue;let m=this.scrollTarget?this.scrollTarget.range.head:null,v,b;if(o){let k=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,R,I;if(m!=null){let $=findFraction(g,m),Y=((this.visibleBottom-this.visibleTop)/2+k)/d.height;R=$-Y,I=$+Y}else R=(this.visibleTop-d.top-k)/d.height,I=(this.visibleBottom-d.top+k)/d.height;v=findPosition(g,R),b=findPosition(g,I)}else{let k=g.total*this.heightOracle.charWidth,R=s*this.heightOracle.charWidth,I,$;if(m!=null){let Y=findFraction(g,m),oe=((this.pixelViewport.right-this.pixelViewport.left)/2+R)/k;I=Y-oe,$=Y+oe}else I=(this.pixelViewport.left-R)/k,$=(this.pixelViewport.right+R)/k;v=findPosition(g,I),b=findPosition(g,$)}v>d.from&&f(d.from,v,d,g),b<d.to&&f(b,d.to,d,g)}return u}gapSize(e,r,o,s){let l=findFraction(s,o)-findFraction(s,r);return this.heightOracle.lineWrapping?e.height*l:s.total*this.heightOracle.charWidth*l}updateLineGaps(e){LineGap.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Decoration.set(e.map(r=>r.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let r=[];RangeSet.spans(e,this.viewport.from,this.viewport.to,{span(s,l){r.push({from:s,to:l})},point(){}},20);let o=r.length!=this.visibleRanges.length||this.visibleRanges.some((s,l)=>s.from!=r[l].from||s.to!=r[l].to);return this.visibleRanges=r,o?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(r=>r.from<=e&&r.to>=e)||scaleBlock(this.heightMap.lineAt(e,QueryType$1.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return scaleBlock(this.heightMap.lineAt(this.scaler.fromDOM(e),QueryType$1.ByHeight,this.heightOracle,0,0),this.scaler)}elementAtHeight(e){return scaleBlock(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Viewport{constructor(e,r){this.from=e,this.to=r}}function lineStructure(n,e,r){let o=[],s=n,l=0;return RangeSet.spans(r,n,e,{span(){},point(c,u){c>s&&(o.push({from:s,to:c}),l+=c-s),s=u}},20),s<e&&(o.push({from:s,to:e}),l+=e-s),{total:l,ranges:o}}function findPosition({total:n,ranges:e},r){if(r<=0)return e[0].from;if(r>=1)return e[e.length-1].to;let o=Math.floor(n*r);for(let s=0;;s++){let{from:l,to:c}=e[s],u=c-l;if(o<=u)return l+o;o-=u}}function findFraction(n,e){let r=0;for(let{from:o,to:s}of n.ranges){if(e<=s){r+=e-o;break}r+=s-o}return r/n.total}function find(n,e){for(let r of n)if(e(r))return r}const IdScaler={toDOM(n){return n},fromDOM(n){return n},scale:1};class BigScaler{constructor(e,r,o){let s=0,l=0,c=0;this.viewports=o.map(({from:u,to:f})=>{let d=r.lineAt(u,QueryType$1.ByPos,e,0,0).top,g=r.lineAt(f,QueryType$1.ByPos,e,0,0).bottom;return s+=g-d,{from:u,to:f,top:d,bottom:g,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(r.height-s);for(let u of this.viewports)u.domTop=c+(u.top-l)*this.scale,c=u.domBottom=u.domTop+(u.bottom-u.top),l=u.bottom}toDOM(e){for(let r=0,o=0,s=0;;r++){let l=r<this.viewports.length?this.viewports[r]:null;if(!l||e<l.top)return s+(e-o)*this.scale;if(e<=l.bottom)return l.domTop+(e-l.top);o=l.bottom,s=l.domBottom}}fromDOM(e){for(let r=0,o=0,s=0;;r++){let l=r<this.viewports.length?this.viewports[r]:null;if(!l||e<l.domTop)return o+(e-s)/this.scale;if(e<=l.domBottom)return l.top+(e-l.domTop);o=l.bottom,s=l.domBottom}}}function scaleBlock(n,e){if(e.scale==1)return n;let r=e.toDOM(n.top),o=e.toDOM(n.bottom);return new BlockInfo(n.from,n.length,r,o-r,Array.isArray(n.type)?n.type.map(s=>scaleBlock(s,e)):n.type)}const theme=Facet.define({combine:n=>n.join(" ")}),darkTheme=Facet.define({combine:n=>n.indexOf(!0)>-1}),baseThemeID=StyleModule.newName(),baseLightID=StyleModule.newName(),baseDarkID=StyleModule.newName(),lightDarkIDs={"&light":"."+baseLightID,"&dark":"."+baseDarkID};function buildTheme(n,e,r){return new StyleModule(e,{finish(o){return/&/.test(o)?o.replace(/&\w*/,s=>{if(s=="&")return n;if(!r||!r[s])throw new RangeError(`Unsupported selector: ${s}`);return r[s]}):n+" "+o}})}const baseTheme$1$3=buildTheme("."+baseThemeID,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},lightDarkIDs);class DOMChange{constructor(e,r,o,s){this.typeOver=s,this.bounds=null,this.text="";let{impreciseHead:l,impreciseAnchor:c}=e.docView;if(e.state.readOnly&&r>-1)this.newSel=null;else if(r>-1&&(this.bounds=e.docView.domBoundsAround(r,o,0))){let u=l||c?[]:selectionPoints(e),f=new DOMReader(u,e.state);f.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=f.text,this.newSel=selectionFromPoints(u,this.bounds.from)}else{let u=e.observer.selectionRange,f=l&&l.node==u.focusNode&&l.offset==u.focusOffset||!contains(e.contentDOM,u.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(u.focusNode,u.focusOffset),d=c&&c.node==u.anchorNode&&c.offset==u.anchorOffset||!contains(e.contentDOM,u.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(u.anchorNode,u.anchorOffset);this.newSel=EditorSelection.single(d,f)}}}function applyDOMChange(n,e){let r,{newSel:o}=e,s=n.state.selection.main;if(e.bounds){let{from:l,to:c}=e.bounds,u=s.from,f=null;(n.inputState.lastKeyCode===8&&n.inputState.lastKeyTime>Date.now()-100||browser.android&&e.text.length<c-l)&&(u=s.to,f="end");let d=findDiff(n.state.doc.sliceString(l,c,LineBreakPlaceholder),e.text,u-l,f);d&&(browser.chrome&&n.inputState.lastKeyCode==13&&d.toB==d.from+2&&e.text.slice(d.from,d.toB)==LineBreakPlaceholder+LineBreakPlaceholder&&d.toB--,r={from:l+d.from,to:l+d.toA,insert:Text.of(e.text.slice(d.from,d.toB).split(LineBreakPlaceholder))})}else o&&(!n.hasFocus&&n.state.facet(editable)||o.main.eq(s))&&(o=null);if(!r&&!o)return!1;if(!r&&e.typeOver&&!s.empty&&o&&o.main.empty?r={from:s.from,to:s.to,insert:n.state.doc.slice(s.from,s.to)}:r&&r.from>=s.from&&r.to<=s.to&&(r.from!=s.from||r.to!=s.to)&&s.to-s.from-(r.to-r.from)<=4?r={from:s.from,to:s.to,insert:n.state.doc.slice(s.from,r.from).append(r.insert).append(n.state.doc.slice(r.to,s.to))}:(browser.mac||browser.android)&&r&&r.from==r.to&&r.from==s.head-1&&/^\. ?$/.test(r.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(o&&r.insert.length==2&&(o=EditorSelection.single(o.main.anchor-1,o.main.head-1)),r={from:s.from,to:s.to,insert:Text.of([" "])}):browser.chrome&&r&&r.from==r.to&&r.from==s.head&&r.insert.toString()==`
 `&&n.lineWrapping&&(o&&(o=EditorSelection.single(o.main.anchor-1,o.main.head-1)),r={from:s.from,to:s.to,insert:Text.of([" "])}),r){let l=n.state;if(browser.ios&&n.inputState.flushIOSKey(n)||browser.android&&(r.from==s.from&&r.to==s.to&&r.insert.length==1&&r.insert.lines==2&&dispatchKey(n.contentDOM,"Enter",13)||r.from==s.from-1&&r.to==s.to&&r.insert.length==0&&dispatchKey(n.contentDOM,"Backspace",8)||r.from==s.from&&r.to==s.to+1&&r.insert.length==0&&dispatchKey(n.contentDOM,"Delete",46)))return!0;let c=r.insert.toString();if(n.state.facet(inputHandler$1).some(d=>d(n,r.from,r.to,c)))return!0;n.inputState.composing>=0&&n.inputState.composing++;let u;if(r.from>=s.from&&r.to<=s.to&&r.to-r.from>=(s.to-s.from)/3&&(!o||o.main.empty&&o.main.from==r.from+r.insert.length)&&n.inputState.composing<0){let d=s.from<r.from?l.sliceDoc(s.from,r.from):"",g=s.to>r.to?l.sliceDoc(r.to,s.to):"";u=l.replaceSelection(n.state.toText(d+r.insert.sliceString(0,void 0,n.state.lineBreak)+g))}else{let d=l.changes(r),g=o&&o.main.to<=d.newLength?o.main:void 0;if(l.selection.ranges.length>1&&n.inputState.composing>=0&&r.to<=s.to&&r.to>=s.to-10){let m=n.state.sliceDoc(r.from,r.to),v=compositionSurroundingNode(n)||n.state.doc.lineAt(s.head),b=s.to-r.to,k=s.to-s.from;u=l.changeByRange(R=>{if(R.from==s.from&&R.to==s.to)return{changes:d,range:g||R.map(d)};let I=R.to-b,$=I-m.length;if(R.to-R.from!=k||n.state.sliceDoc($,I)!=m||v&&R.to>=v.from&&R.from<=v.to)return{range:R};let Y=l.changes({from:$,to:I,insert:r.insert}),oe=R.to-s.to;return{changes:Y,range:g?EditorSelection.range(Math.max(0,g.anchor+oe),Math.max(0,g.head+oe)):R.map(Y)}})}else u={changes:d,selection:g&&l.selection.replaceRange(g)}}let f="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,f+=".compose",n.inputState.compositionFirstChange&&(f+=".start",n.inputState.compositionFirstChange=!1)),n.dispatch(u,{scrollIntoView:!0,userEvent:f}),!0}else if(o&&!o.main.eq(s)){let l=!1,c="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(l=!0),c=n.inputState.lastSelectionOrigin),n.dispatch({selection:o,scrollIntoView:l,userEvent:c}),!0}else return!1}function findDiff(n,e,r,o){let s=Math.min(n.length,e.length),l=0;for(;l<s&&n.charCodeAt(l)==e.charCodeAt(l);)l++;if(l==s&&n.length==e.length)return null;let c=n.length,u=e.length;for(;c>0&&u>0&&n.charCodeAt(c-1)==e.charCodeAt(u-1);)c--,u--;if(o=="end"){let f=Math.max(0,l-Math.min(c,u));r-=c+f-l}if(c<l&&n.length<e.length){let f=r<=l&&r>=c?l-r:0;l-=f,u=l+(u-c),c=l}else if(u<l){let f=r<=l&&r>=u?l-r:0;l-=f,c=l+(c-u),u=l}return{from:l,toA:c,toB:u}}function selectionPoints(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:r,anchorOffset:o,focusNode:s,focusOffset:l}=n.observer.selectionRange;return r&&(e.push(new DOMPoint(r,o)),(s!=r||l!=o)&&e.push(new DOMPoint(s,l))),e}function selectionFromPoints(n,e){if(n.length==0)return null;let r=n[0].pos,o=n.length==2?n[1].pos:r;return r>-1&&o>-1?EditorSelection.single(r+e,o+e):null}const observeOptions={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},useCharData=browser.ie&&browser.ie_version<=11;class DOMObserver{constructor(e){this.view=e,this.active=!1,this.selectionRange=new DOMSelectionState,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(r=>{for(let o of r)this.queue.push(o);(browser.ie&&browser.ie_version<=11||browser.ios&&e.composing)&&r.some(o=>o.type=="childList"&&o.removedNodes.length||o.type=="characterData"&&o.oldValue.length>o.target.nodeValue.length)?this.flushSoon():this.flush()}),useCharData&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var r;((r=this.view.docView)===null||r===void 0?void 0:r.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM),this.resizeContent=new ResizeObserver(()=>this.view.requestMeasure()),this.resizeContent.observe(e.contentDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(r=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),r.length>0&&r[r.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(r=>{r.length>0&&r[r.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runScrollHandlers(this.view,e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((r,o)=>r!=e[o]))){this.gapIntersection.disconnect();for(let r of e)this.gapIntersection.observe(r);this.gaps=e}}onSelectionChange(e){let r=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:o}=this,s=this.selectionRange;if(o.state.facet(editable)?o.root.activeElement!=this.dom:!hasSelection(o.dom,s))return;let l=s.anchorNode&&o.docView.nearest(s.anchorNode);if(l&&l.ignoreEvent(e)){r||(this.selectionChanged=!1);return}(browser.ie&&browser.ie_version<=11||browser.android&&browser.chrome)&&!o.state.selection.main.empty&&s.focusNode&&isEquivalentPosition(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,r=browser.safari&&e.root.nodeType==11&&deepActiveElement(this.dom.ownerDocument)==this.dom&&safariSelectionRangeHack(this.view)||getSelection(e.root);if(!r||this.selectionRange.eq(r))return!1;let o=hasSelection(this.dom,r);return o&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&atElementStart(this.dom,r)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(r),o&&(this.selectionChanged=!0),!0)}setSelectionRange(e,r){this.selectionRange.set(e.node,e.offset,r.node,r.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,r=null;for(let o=this.dom;o;)if(o.nodeType==1)!r&&e<this.scrollTargets.length&&this.scrollTargets[e]==o?e++:r||(r=this.scrollTargets.slice(0,e)),r&&r.push(o),o=o.assignedSlot||o.parentNode;else if(o.nodeType==11)o=o.host;else break;if(e<this.scrollTargets.length&&!r&&(r=this.scrollTargets.slice(0,e)),r){for(let o of this.scrollTargets)o.removeEventListener("scroll",this.onScroll);for(let o of this.scrollTargets=r)o.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,observeOptions),useCharData&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),useCharData&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,r){var o;if(!this.delayedAndroidKey){let s=()=>{let l=this.delayedAndroidKey;l&&(this.clearDelayedAndroidKey(),!this.flush()&&l.force&&dispatchKey(this.dom,l.key,l.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:r,force:this.lastChange<Date.now()-50||!!(!((o=this.delayedAndroidKey)===null||o===void 0)&&o.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let r=-1,o=-1,s=!1;for(let l of e){let c=this.readMutation(l);c&&(c.typeOver&&(s=!0),r==-1?{from:r,to:o}=c:(r=Math.min(c.from,r),o=Math.max(c.to,o)))}return{from:r,to:o,typeOver:s}}readChange(){let{from:e,to:r,typeOver:o}=this.processRecords(),s=this.selectionChanged&&hasSelection(this.dom,this.selectionRange);return e<0&&!s?null:(e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new DOMChange(this.view,e,r,o))}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let r=this.readChange();if(!r)return!1;let o=this.view.state,s=applyDOMChange(this.view,r);return this.view.state==o&&this.view.update([]),s}readMutation(e){let r=this.view.docView.nearest(e.target);if(!r||r.ignoreMutation(e))return null;if(r.markDirty(e.type=="attributes"),e.type=="attributes"&&(r.dirty|=4),e.type=="childList"){let o=findChild(r,e.previousSibling||e.target.previousSibling,-1),s=findChild(r,e.nextSibling||e.target.nextSibling,1);return{from:o?r.posAfter(o):r.posAtStart,to:s?r.posBefore(s):r.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,r,o,s;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(r=this.gapIntersection)===null||r===void 0||r.disconnect(),(o=this.resizeScroll)===null||o===void 0||o.disconnect(),(s=this.resizeContent)===null||s===void 0||s.disconnect();for(let l of this.scrollTargets)l.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function findChild(n,e,r){for(;e;){let o=ContentView.get(e);if(o&&o.parent==n)return o;let s=e.parentNode;e=s!=n.dom?s:r>0?e.nextSibling:e.previousSibling}return null}function safariSelectionRangeHack(n){let e=null;function r(f){f.preventDefault(),f.stopImmediatePropagation(),e=f.getTargetRanges()[0]}if(n.contentDOM.addEventListener("beforeinput",r,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",r,!0),!e)return null;let o=e.startContainer,s=e.startOffset,l=e.endContainer,c=e.endOffset,u=n.docView.domAtPos(n.state.selection.main.anchor);return isEquivalentPosition(u.node,u.offset,l,c)&&([o,s,l,c]=[l,c,o,s]),{anchorNode:o,anchorOffset:s,focusNode:l,focusOffset:c}}class EditorView{constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(r=>this.update([r])),this.dispatch=this.dispatch.bind(this),this._root=e.root||getRoot(e.parent)||document,this.viewState=new ViewState(e.state||EditorState.create(e)),this.plugins=this.state.facet(viewPlugin).map(r=>new PluginInstance(r));for(let r of this.plugins)r.update(this);this.observer=new DOMObserver(this),this.inputState=new InputState(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new DocView(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}dispatch(...e){this._dispatch(e.length==1&&e[0]instanceof Transaction?e[0]:this.state.update(...e))}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let r=!1,o=!1,s,l=this.state;for(let v of e){if(v.startState!=l)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");l=v.state}if(this.destroyed){this.viewState.state=l;return}let c=this.hasFocus,u=0,f=null;e.some(v=>v.annotation(isFocusChange))?(this.inputState.notifiedFocused=c,u=1):c!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=c,f=focusChangeTransaction(l,c),f||(u=1));let d=this.observer.delayedAndroidKey,g=null;if(d?(this.observer.clearDelayedAndroidKey(),g=this.observer.readChange(),(g&&!this.state.doc.eq(l.doc)||!this.state.selection.eq(l.selection))&&(g=null)):this.observer.clear(),l.facet(EditorState.phrases)!=this.state.facet(EditorState.phrases))return this.setState(l);s=ViewUpdate.create(this,l,e),s.flags|=u;let m=this.viewState.scrollTarget;try{this.updateState=2;for(let v of e){if(m&&(m=m.map(v.changes)),v.scrollIntoView){let{main:b}=v.state.selection;m=new ScrollTarget(b.empty?b:EditorSelection.cursor(b.head,b.head>b.anchor?-1:1))}for(let b of v.effects)b.is(scrollIntoView$1)&&(m=b.value)}this.viewState.update(s,m),this.bidiCache=CachedOrder.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),r=this.docView.update(s),this.state.facet(styleModule)!=this.styleModules&&this.mountStyles(),o=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(r,e.some(v=>v.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(theme)!=s.state.facet(theme)&&(this.viewState.mustMeasureContent=!0),(r||o||m||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!s.empty)for(let v of this.state.facet(updateListener))v(s);(f||g)&&Promise.resolve().then(()=>{f&&this.state==f.startState&&this.dispatch(f),g&&!applyDOMChange(this,g)&&d.force&&dispatchKey(this.contentDOM,d.key,d.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let r=this.hasFocus;try{for(let o of this.plugins)o.destroy(this);this.viewState=new ViewState(e),this.plugins=e.facet(viewPlugin).map(o=>new PluginInstance(o)),this.pluginMap.clear();for(let o of this.plugins)o.update(this);this.docView=new DocView(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}r&&this.focus(),this.requestMeasure()}updatePlugins(e){let r=e.startState.facet(viewPlugin),o=e.state.facet(viewPlugin);if(r!=o){let s=[];for(let l of o){let c=r.indexOf(l);if(c<0)s.push(new PluginInstance(l));else{let u=this.plugins[c];u.mustUpdate=e,s.push(u)}}for(let l of this.plugins)l.mustUpdate!=e&&l.destroy(this);this.plugins=s,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.forceFlush();let r=null,{scrollHeight:o,scrollTop:s,clientHeight:l}=this.scrollDOM,c=s>o-l-4?o:s;try{for(let u=0;;u++){this.updateState=1;let f=this.viewport,d=this.viewState.lineBlockAtHeight(c),g=this.viewState.measure(this);if(!g&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(u>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let m=[];g&4||([this.measureRequests,m]=[m,this.measureRequests]);let v=m.map(I=>{try{return I.read(this)}catch($){return logException(this.state,$),BadMeasure}}),b=ViewUpdate.create(this,this.state,[]),k=!1,R=!1;b.flags|=g,r?r.flags|=g:r=b,this.updateState=2,b.empty||(this.updatePlugins(b),this.inputState.update(b),this.updateAttrs(),k=this.docView.update(b));for(let I=0;I<m.length;I++)if(v[I]!=BadMeasure)try{let $=m[I];$.write&&$.write(v[I],this)}catch($){logException(this.state,$)}if(this.viewState.editorHeight)if(this.viewState.scrollTarget)this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,R=!0;else{let I=this.viewState.lineBlockAt(d.from).top-d.top;(I>1||I<-1)&&(this.scrollDOM.scrollTop+=I,R=!0)}if(k&&this.docView.updateSelection(!0),this.viewport.from==f.from&&this.viewport.to==f.to&&!R&&this.measureRequests.length==0)break}}finally{this.updateState=0,this.measureScheduled=-1}if(r&&!r.empty)for(let u of this.state.facet(updateListener))u(r)}get themeClasses(){return baseThemeID+" "+(this.state.facet(darkTheme)?baseDarkID:baseLightID)+" "+this.state.facet(theme)}updateAttrs(){let e=attrsFromFacet(this,editorAttributes,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),r={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(editable)?"true":"false",class:"cm-content",style:`${browser.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(r["aria-readonly"]="true"),attrsFromFacet(this,contentAttributes,r);let o=this.observer.ignore(()=>{let s=updateAttrs(this.contentDOM,this.contentAttrs,r),l=updateAttrs(this.dom,this.editorAttrs,e);return s||l});return this.editorAttrs=e,this.contentAttrs=r,o}showAnnouncements(e){let r=!0;for(let o of e)for(let s of o.effects)if(s.is(EditorView.announce)){r&&(this.announceDOM.textContent=""),r=!1;let l=this.announceDOM.appendChild(document.createElement("div"));l.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(styleModule),StyleModule.mount(this.root,this.styleModules.concat(baseTheme$1$3).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let r=0;r<this.measureRequests.length;r++)if(this.measureRequests[r].key===e.key){this.measureRequests[r]=e;return}}this.measureRequests.push(e)}}plugin(e){let r=this.pluginMap.get(e);return(r===void 0||r&&r.spec!=e)&&this.pluginMap.set(e,r=this.plugins.find(o=>o.spec==e)||null),r&&r.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,r,o){return skipAtoms(this,e,moveByChar(this,e,r,o))}moveByGroup(e,r){return skipAtoms(this,e,moveByChar(this,e,r,o=>byGroup(this,e.head,o)))}moveToLineBoundary(e,r,o=!0){return moveToLineBoundary(this,e,r,o)}moveVertically(e,r,o){return skipAtoms(this,e,moveVertically(this,e,r,o))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,r=0){return this.docView.posFromDOM(e,r)}posAtCoords(e,r=!0){return this.readMeasured(),posAtCoords(this,e,r)}coordsAtPos(e,r=1){this.readMeasured();let o=this.docView.coordsAt(e,r);if(!o||o.left==o.right)return o;let s=this.state.doc.lineAt(e),l=this.bidiSpans(s),c=l[BidiSpan.find(l,e-s.from,-1,r)];return flattenRect(o,c.dir==Direction.LTR==r>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(perLineTextDirection)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>MaxBidiLine)return trivialOrder(e.length);let r=this.textDirectionAt(e.from);for(let s of this.bidiCache)if(s.from==e.from&&s.dir==r)return s.order;let o=computeOrder(e.text,r);return this.bidiCache.push(new CachedOrder(e.from,e.to,r,o)),o}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||browser.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{focusPreventScroll(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,r={}){return scrollIntoView$1.of(new ScrollTarget(typeof e=="number"?EditorSelection.cursor(e):e,r.y,r.x,r.yMargin,r.xMargin))}static domEventHandlers(e){return ViewPlugin.define(()=>({}),{eventHandlers:e})}static theme(e,r){let o=StyleModule.newName(),s=[theme.of(o),styleModule.of(buildTheme(`.${o}`,e))];return r&&r.dark&&s.push(darkTheme.of(!0)),s}static baseTheme(e){return Prec.lowest(styleModule.of(buildTheme("."+baseThemeID,e,lightDarkIDs)))}static findFromDOM(e){var r;let o=e.querySelector(".cm-content"),s=o&&ContentView.get(o)||ContentView.get(e);return((r=s==null?void 0:s.rootView)===null||r===void 0?void 0:r.view)||null}}EditorView.styleModule=styleModule;EditorView.inputHandler=inputHandler$1;EditorView.focusChangeEffect=focusChangeEffect;EditorView.perLineTextDirection=perLineTextDirection;EditorView.exceptionSink=exceptionSink;EditorView.updateListener=updateListener;EditorView.editable=editable;EditorView.mouseSelectionStyle=mouseSelectionStyle;EditorView.dragMovesSelection=dragMovesSelection$1;EditorView.clickAddsSelectionRange=clickAddsSelectionRange;EditorView.decorations=decorations;EditorView.atomicRanges=atomicRanges;EditorView.scrollMargins=scrollMargins;EditorView.darkTheme=darkTheme;EditorView.contentAttributes=contentAttributes;EditorView.editorAttributes=editorAttributes;EditorView.lineWrapping=EditorView.contentAttributes.of({class:"cm-lineWrapping"});EditorView.announce=StateEffect.define();const MaxBidiLine=4096,BadMeasure={};class CachedOrder{constructor(e,r,o,s){this.from=e,this.to=r,this.dir=o,this.order=s}static update(e,r){if(r.empty)return e;let o=[],s=e.length?e[e.length-1].dir:Direction.LTR;for(let l=Math.max(0,e.length-10);l<e.length;l++){let c=e[l];c.dir==s&&!r.touchesRange(c.from,c.to)&&o.push(new CachedOrder(r.mapPos(c.from,1),r.mapPos(c.to,-1),c.dir,c.order))}return o}}function attrsFromFacet(n,e,r){for(let o=n.state.facet(e),s=o.length-1;s>=0;s--){let l=o[s],c=typeof l=="function"?l(n):l;c&&combineAttrs(c,r)}return r}const currentPlatform=browser.mac?"mac":browser.windows?"win":browser.linux?"linux":"key";function normalizeKeyName(n,e){const r=n.split(/-(?!$)/);let o=r[r.length-1];o=="Space"&&(o=" ");let s,l,c,u;for(let f=0;f<r.length-1;++f){const d=r[f];if(/^(cmd|meta|m)$/i.test(d))u=!0;else if(/^a(lt)?$/i.test(d))s=!0;else if(/^(c|ctrl|control)$/i.test(d))l=!0;else if(/^s(hift)?$/i.test(d))c=!0;else if(/^mod$/i.test(d))e=="mac"?u=!0:l=!0;else throw new Error("Unrecognized modifier name: "+d)}return s&&(o="Alt-"+o),l&&(o="Ctrl-"+o),u&&(o="Meta-"+o),c&&(o="Shift-"+o),o}function modifiers(n,e,r){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),r!==!1&&e.shiftKey&&(n="Shift-"+n),n}const handleKeyEvents=Prec.default(EditorView.domEventHandlers({keydown(n,e){return runHandlers(getKeymap(e.state),n,e,"editor")}})),keymap=Facet.define({enables:handleKeyEvents}),Keymaps=new WeakMap;function getKeymap(n){let e=n.facet(keymap),r=Keymaps.get(e);return r||Keymaps.set(e,r=buildKeymap(e.reduce((o,s)=>o.concat(s),[]))),r}function runScopeHandlers(n,e,r){return runHandlers(getKeymap(n.state),e,n,r)}let storedPrefix=null;const PrefixTimeout=4e3;function buildKeymap(n,e=currentPlatform){let r=Object.create(null),o=Object.create(null),s=(c,u)=>{let f=o[c];if(f==null)o[c]=u;else if(f!=u)throw new Error("Key binding "+c+" is used both as a regular binding and as a multi-stroke prefix")},l=(c,u,f,d)=>{var g,m;let v=r[c]||(r[c]=Object.create(null)),b=u.split(/ (?!$)/).map(I=>normalizeKeyName(I,e));for(let I=1;I<b.length;I++){let $=b.slice(0,I).join(" ");s($,!0),v[$]||(v[$]={preventDefault:!0,run:[Y=>{let oe=storedPrefix={view:Y,prefix:$,scope:c};return setTimeout(()=>{storedPrefix==oe&&(storedPrefix=null)},PrefixTimeout),!0}]})}let k=b.join(" ");s(k,!1);let R=v[k]||(v[k]={preventDefault:!1,run:((m=(g=v._any)===null||g===void 0?void 0:g.run)===null||m===void 0?void 0:m.slice())||[]});f&&R.run.push(f),d&&(R.preventDefault=!0)};for(let c of n){let u=c.scope?c.scope.split(" "):["editor"];if(c.any)for(let d of u){let g=r[d]||(r[d]=Object.create(null));g._any||(g._any={preventDefault:!1,run:[]});for(let m in g)g[m].run.push(c.any)}let f=c[e]||c.key;if(f)for(let d of u)l(d,f,c.run,c.preventDefault),c.shift&&l(d,"Shift-"+f,c.shift,c.preventDefault)}return r}function runHandlers(n,e,r,o){let s=keyName(e),l=codePointAt(s,0),c=codePointSize(l)==s.length&&s!=" ",u="",f=!1;storedPrefix&&storedPrefix.view==r&&storedPrefix.scope==o&&(u=storedPrefix.prefix+" ",(f=modifierCodes.indexOf(e.keyCode)<0)&&(storedPrefix=null));let d=new Set,g=k=>{if(k){for(let R of k.run)if(!d.has(R)&&(d.add(R),R(r,e)))return!0;k.preventDefault&&(f=!0)}return!1},m=n[o],v,b;if(m){if(g(m[u+modifiers(s,e,!c)]))return!0;if(c&&(e.altKey||e.metaKey||e.ctrlKey)&&!(browser.windows&&e.ctrlKey&&e.altKey)&&(v=base[e.keyCode])&&v!=s){if(g(m[u+modifiers(v,e,!0)]))return!0;if(e.shiftKey&&(b=shift[e.keyCode])!=s&&b!=v&&g(m[u+modifiers(b,e,!1)]))return!0}else if(c&&e.shiftKey&&g(m[u+modifiers(s,e,!0)]))return!0;if(g(m._any))return!0}return f}class RectangleMarker{constructor(e,r,o,s,l){this.className=e,this.left=r,this.top=o,this.width=s,this.height=l}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,r){return r.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,r,o){if(o.empty){let s=e.coordsAtPos(o.head,o.assoc||1);if(!s)return[];let l=getBase(e);return[new RectangleMarker(r,s.left-l.left,s.top-l.top,null,s.bottom-s.top)]}else return rectanglesForRange(e,r,o)}}function getBase(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Direction.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft,top:e.top-n.scrollDOM.scrollTop}}function wrappedLine(n,e,r){let o=EditorSelection.cursor(e);return{from:Math.max(r.from,n.moveToLineBoundary(o,!1,!0).from),to:Math.min(r.to,n.moveToLineBoundary(o,!0,!0).from),type:BlockType.Text}}function blockAt(n,e){let r=n.lineBlockAt(e);if(Array.isArray(r.type)){for(let o of r.type)if(o.to>e||o.to==e&&(o.to==r.to||o.type==BlockType.Text))return o}return r}function rectanglesForRange(n,e,r){if(r.to<=n.viewport.from||r.from>=n.viewport.to)return[];let o=Math.max(r.from,n.viewport.from),s=Math.min(r.to,n.viewport.to),l=n.textDirection==Direction.LTR,c=n.contentDOM,u=c.getBoundingClientRect(),f=getBase(n),d=c.querySelector(".cm-line"),g=d&&window.getComputedStyle(d),m=u.left+(g?parseInt(g.paddingLeft)+Math.min(0,parseInt(g.textIndent)):0),v=u.right-(g?parseInt(g.paddingRight):0),b=blockAt(n,o),k=blockAt(n,s),R=b.type==BlockType.Text?b:null,I=k.type==BlockType.Text?k:null;if(n.lineWrapping&&(R&&(R=wrappedLine(n,o,R)),I&&(I=wrappedLine(n,s,I))),R&&I&&R.from==I.from)return Y(oe(r.from,r.to,R));{let q=R?oe(r.from,null,R):G(b,!1),ne=I?oe(null,r.to,I):G(k,!0),K=[];return(R||b).to<(I||k).from-1?K.push($(m,q.bottom,v,ne.top)):q.bottom<ne.top&&n.elementAtHeight((q.bottom+ne.top)/2).type==BlockType.Text&&(q.bottom=ne.top=(q.bottom+ne.top)/2),Y(q).concat(K).concat(Y(ne))}function $(q,ne,K,qe){return new RectangleMarker(e,q-f.left,ne-f.top-.01,K-q,qe-ne+.01)}function Y({top:q,bottom:ne,horizontal:K}){let qe=[];for(let ge=0;ge<K.length;ge+=2)qe.push($(K[ge],q,K[ge+1],ne));return qe}function oe(q,ne,K){let qe=1e9,ge=-1e9,Z=[];function re(ee,_e,ue,ye,We){let Ze=n.coordsAtPos(ee,ee==K.to?-2:2),Ae=n.coordsAtPos(ue,ue==K.from?2:-2);qe=Math.min(Ze.top,Ae.top,qe),ge=Math.max(Ze.bottom,Ae.bottom,ge),We==Direction.LTR?Z.push(l&&_e?m:Ze.left,l&&ye?v:Ae.right):Z.push(!l&&ye?m:Ae.left,!l&&_e?v:Ze.right)}let He=q??K.from,st=ne??K.to;for(let ee of n.visibleRanges)if(ee.to>He&&ee.from<st)for(let _e=Math.max(ee.from,He),ue=Math.min(ee.to,st);;){let ye=n.state.doc.lineAt(_e);for(let We of n.bidiSpans(ye)){let Ze=We.from+ye.from,Ae=We.to+ye.from;if(Ze>=ue)break;Ae>_e&&re(Math.max(Ze,_e),q==null&&Ze<=He,Math.min(Ae,ue),ne==null&&Ae>=st,We.dir)}if(_e=ye.to+1,_e>=ue)break}return Z.length==0&&re(He,q==null,st,ne==null,n.textDirection),{top:qe,bottom:ge,horizontal:Z}}function G(q,ne){let K=u.top+(ne?q.top:q.bottom);return{top:K,bottom:K,horizontal:[]}}}function sameMarker(n,e){return n.constructor==e.constructor&&n.eq(e)}class LayerView{constructor(e,r){this.view=e,this.layer=r,this.drawn=[],this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),r.above&&this.dom.classList.add("cm-layer-above"),r.class&&this.dom.classList.add(r.class),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),r.mount&&r.mount(this.dom,e)}update(e){e.startState.facet(layerOrder)!=e.state.facet(layerOrder)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&e.view.requestMeasure(this.measureReq)}setOrder(e){let r=0,o=e.facet(layerOrder);for(;r<o.length&&o[r]!=this.layer;)r++;this.dom.style.zIndex=String((this.layer.above?150:-1)-r)}measure(){return this.layer.markers(this.view)}draw(e){if(e.length!=this.drawn.length||e.some((r,o)=>!sameMarker(r,this.drawn[o]))){let r=this.dom.firstChild,o=0;for(let s of e)s.update&&r&&s.constructor&&this.drawn[o].constructor&&s.update(r,this.drawn[o])?(r=r.nextSibling,o++):this.dom.insertBefore(s.draw(),r);for(;r;){let s=r.nextSibling;r.remove(),r=s}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const layerOrder=Facet.define();function layer(n){return[ViewPlugin.define(e=>new LayerView(e,n)),layerOrder.of(n)]}const CanHidePrimary=!browser.ios,selectionConfig=Facet.define({combine(n){return combineConfig(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,r)=>Math.min(e,r),drawRangeCursor:(e,r)=>e||r})}});function drawSelection(n={}){return[selectionConfig.of(n),cursorLayer,selectionLayer,hideNativeSelection,nativeSelectionHidden.of(!0)]}function configChanged(n){return n.startState.facet(selectionConfig)!=n.state.facet(selectionConfig)}const cursorLayer=layer({above:!0,markers(n){let{state:e}=n,r=e.facet(selectionConfig),o=[];for(let s of e.selection.ranges){let l=s==e.selection.main;if(s.empty?!l||CanHidePrimary:r.drawRangeCursor){let c=l?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",u=s.empty?s:EditorSelection.cursor(s.head,s.head>s.anchor?-1:1);for(let f of RectangleMarker.forRange(n,c,u))o.push(f)}}return o},update(n,e){n.transactions.some(o=>o.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let r=configChanged(n);return r&&setBlinkRate(n.state,e),n.docChanged||n.selectionSet||r},mount(n,e){setBlinkRate(e.state,n)},class:"cm-cursorLayer"});function setBlinkRate(n,e){e.style.animationDuration=n.facet(selectionConfig).cursorBlinkRate+"ms"}const selectionLayer=layer({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:RectangleMarker.forRange(n,"cm-selectionBackground",e)).reduce((e,r)=>e.concat(r))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||configChanged(n)},class:"cm-selectionLayer"}),themeSpec={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};CanHidePrimary&&(themeSpec[".cm-line"].caretColor="transparent !important");const hideNativeSelection=Prec.highest(EditorView.theme(themeSpec)),setDropCursorPos=StateEffect.define({map(n,e){return n==null?null:e.mapPos(n)}}),dropCursorPos=StateField.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((r,o)=>o.is(setDropCursorPos)?o.value:r,n)}}),drawDropCursor=ViewPlugin.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let r=n.state.field(dropCursorPos);r==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(dropCursorPos)!=r||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let n=this.view.state.field(dropCursorPos),e=n!=null&&this.view.coordsAtPos(n);if(!e)return null;let r=this.view.scrollDOM.getBoundingClientRect();return{left:e.left-r.left+this.view.scrollDOM.scrollLeft,top:e.top-r.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}}drawCursor(n){this.cursor&&(n?(this.cursor.style.left=n.left+"px",this.cursor.style.top=n.top+"px",this.cursor.style.height=n.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(dropCursorPos)!=n&&this.view.dispatch({effects:setDropCursorPos.of(n)})}},{eventHandlers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function dropCursor(){return[dropCursorPos,drawDropCursor]}function iterMatches(n,e,r,o,s){e.lastIndex=0;for(let l=n.iterRange(r,o),c=r,u;!l.next().done;c+=l.value.length)if(!l.lineBreak)for(;u=e.exec(l.value);)s(c+u.index,u)}function matchRanges(n,e){let r=n.visibleRanges;if(r.length==1&&r[0].from==n.viewport.from&&r[0].to==n.viewport.to)return r;let o=[];for(let{from:s,to:l}of r)s=Math.max(n.state.doc.lineAt(s).from,s-e),l=Math.min(n.state.doc.lineAt(l).to,l+e),o.length&&o[o.length-1].to>=s?o[o.length-1].to=l:o.push({from:s,to:l});return o}class MatchDecorator{constructor(e){const{regexp:r,decoration:o,decorate:s,boundary:l,maxLength:c=1e3}=e;if(!r.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=r,s)this.addMatch=(u,f,d,g)=>s(g,d,d+u[0].length,u,f);else if(typeof o=="function")this.addMatch=(u,f,d,g)=>{let m=o(u,f,d);m&&g(d,d+u[0].length,m)};else if(o)this.addMatch=(u,f,d,g)=>g(d,d+u[0].length,o);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=l,this.maxLength=c}createDeco(e){let r=new RangeSetBuilder,o=r.add.bind(r);for(let{from:s,to:l}of matchRanges(e,this.maxLength))iterMatches(e.state.doc,this.regexp,s,l,(c,u)=>this.addMatch(u,e,c,o));return r.finish()}updateDeco(e,r){let o=1e9,s=-1;return e.docChanged&&e.changes.iterChanges((l,c,u,f)=>{f>e.view.viewport.from&&u<e.view.viewport.to&&(o=Math.min(u,o),s=Math.max(f,s))}),e.viewportChanged||s-o>1e3?this.createDeco(e.view):s>-1?this.updateRange(e.view,r.map(e.changes),o,s):r}updateRange(e,r,o,s){for(let l of e.visibleRanges){let c=Math.max(l.from,o),u=Math.min(l.to,s);if(u>c){let f=e.state.doc.lineAt(c),d=f.to<u?e.state.doc.lineAt(u):f,g=Math.max(l.from,f.from),m=Math.min(l.to,d.to);if(this.boundary){for(;c>f.from;c--)if(this.boundary.test(f.text[c-1-f.from])){g=c;break}for(;u<d.to;u++)if(this.boundary.test(d.text[u-d.from])){m=u;break}}let v=[],b,k=(R,I,$)=>v.push($.range(R,I));if(f==d)for(this.regexp.lastIndex=g-f.from;(b=this.regexp.exec(f.text))&&b.index<m-f.from;)this.addMatch(b,e,b.index+f.from,k);else iterMatches(e.state.doc,this.regexp,g,m,(R,I)=>this.addMatch(I,e,R,k));r=r.update({filterFrom:g,filterTo:m,filter:(R,I)=>R<g||I>m,add:v})}}return r}}const UnicodeRegexpSupport=/x/.unicode!=null?"gu":"g",Specials=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,UnicodeRegexpSupport),Names={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let _supportsTabSize=null;function supportsTabSize(){var n;if(_supportsTabSize==null&&typeof document<"u"&&document.body){let e=document.body.style;_supportsTabSize=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return _supportsTabSize||!1}const specialCharConfig=Facet.define({combine(n){let e=combineConfig(n,{render:null,specialChars:Specials,addSpecialChars:null});return(e.replaceTabs=!supportsTabSize())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,UnicodeRegexpSupport)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,UnicodeRegexpSupport)),e}});function highlightSpecialChars(n={}){return[specialCharConfig.of(n),specialCharPlugin()]}let _plugin=null;function specialCharPlugin(){return _plugin||(_plugin=ViewPlugin.fromClass(class{constructor(n){this.view=n,this.decorations=Decoration.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(specialCharConfig)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new MatchDecorator({regexp:n.specialChars,decoration:(e,r,o)=>{let{doc:s}=r.state,l=codePointAt(e[0],0);if(l==9){let c=s.lineAt(o),u=r.state.tabSize,f=countColumn(c.text,u,o-c.from);return Decoration.replace({widget:new TabWidget((u-f%u)*this.view.defaultCharacterWidth)})}return this.decorationCache[l]||(this.decorationCache[l]=Decoration.replace({widget:new SpecialCharWidget(n,l)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(specialCharConfig);n.startState.facet(specialCharConfig)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const DefaultPlaceholder="";function placeholder$1(n){return n>=32?DefaultPlaceholder:n==10?"":String.fromCharCode(9216+n)}class SpecialCharWidget extends WidgetType{constructor(e,r){super(),this.options=e,this.code=r}eq(e){return e.code==this.code}toDOM(e){let r=placeholder$1(this.code),o=e.state.phrase("Control character")+" "+(Names[this.code]||"0x"+this.code.toString(16)),s=this.options.render&&this.options.render(this.code,o,r);if(s)return s;let l=document.createElement("span");return l.textContent=r,l.title=o,l.setAttribute("aria-label",o),l.className="cm-specialChar",l}ignoreEvent(){return!1}}class TabWidget extends WidgetType{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function highlightActiveLine(){return activeLineHighlighter}const lineDeco=Decoration.line({class:"cm-activeLine"}),activeLineHighlighter=ViewPlugin.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,r=[];for(let o of n.state.selection.ranges){let s=n.lineBlockAt(o.head);s.from>e&&(r.push(lineDeco.range(s.from)),e=s.from)}return Decoration.set(r)}},{decorations:n=>n.decorations});class Placeholder extends WidgetType{constructor(e){super(),this.content=e}toDOM(){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):this.content),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}ignoreEvent(){return!1}}function placeholder(n){return ViewPlugin.fromClass(class{constructor(e){this.view=e,this.placeholder=Decoration.set([Decoration.widget({widget:new Placeholder(n),side:1}).range(0)])}get decorations(){return this.view.state.doc.length?Decoration.none:this.placeholder}},{decorations:e=>e.decorations})}const MaxOff=2e3;function rectangleFor(n,e,r){let o=Math.min(e.line,r.line),s=Math.max(e.line,r.line),l=[];if(e.off>MaxOff||r.off>MaxOff||e.col<0||r.col<0){let c=Math.min(e.off,r.off),u=Math.max(e.off,r.off);for(let f=o;f<=s;f++){let d=n.doc.line(f);d.length<=u&&l.push(EditorSelection.range(d.from+c,d.to+u))}}else{let c=Math.min(e.col,r.col),u=Math.max(e.col,r.col);for(let f=o;f<=s;f++){let d=n.doc.line(f),g=findColumn(d.text,c,n.tabSize,!0);if(g<0)l.push(EditorSelection.cursor(d.to));else{let m=findColumn(d.text,u,n.tabSize);l.push(EditorSelection.range(d.from+g,d.from+m))}}}return l}function absoluteColumn(n,e){let r=n.coordsAtPos(n.viewport.from);return r?Math.round(Math.abs((r.left-e)/n.defaultCharacterWidth)):-1}function getPos(n,e){let r=n.posAtCoords({x:e.clientX,y:e.clientY},!1),o=n.state.doc.lineAt(r),s=r-o.from,l=s>MaxOff?-1:s==o.length?absoluteColumn(n,e.clientX):countColumn(o.text,n.state.tabSize,r-o.from);return{line:o.number,col:l,off:s}}function rectangleSelectionStyle(n,e){let r=getPos(n,e),o=n.state.selection;return r?{update(s){if(s.docChanged){let l=s.changes.mapPos(s.startState.doc.line(r.line).from),c=s.state.doc.lineAt(l);r={line:c.number,col:r.col,off:Math.min(r.off,c.length)},o=o.map(s.changes)}},get(s,l,c){let u=getPos(n,s);if(!u)return o;let f=rectangleFor(n.state,r,u);return f.length?c?EditorSelection.create(f.concat(o.ranges)):EditorSelection.create(f):o}}:null}function rectangularSelection(n){let e=(n==null?void 0:n.eventFilter)||(r=>r.altKey&&r.button==0);return EditorView.mouseSelectionStyle.of((r,o)=>e(o)?rectangleSelectionStyle(r,o):null)}const keys={Alt:[18,n=>n.altKey],Control:[17,n=>n.ctrlKey],Shift:[16,n=>n.shiftKey],Meta:[91,n=>n.metaKey]},showCrosshair={style:"cursor: crosshair"};function crosshairCursor(n={}){let[e,r]=keys[n.key||"Alt"],o=ViewPlugin.fromClass(class{constructor(s){this.view=s,this.isDown=!1}set(s){this.isDown!=s&&(this.isDown=s,this.view.update([]))}},{eventHandlers:{keydown(s){this.set(s.keyCode==e||r(s))},keyup(s){(s.keyCode==e||!r(s))&&this.set(!1)},mousemove(s){this.set(r(s))}}});return[o,EditorView.contentAttributes.of(s=>{var l;return!((l=s.plugin(o))===null||l===void 0)&&l.isDown?showCrosshair:null})]}const Outside="-10000px";class TooltipViewManager{constructor(e,r,o){this.facet=r,this.createTooltipView=o,this.input=e.state.facet(r),this.tooltips=this.input.filter(s=>s),this.tooltipViews=this.tooltips.map(o)}update(e){var r;let o=e.state.facet(this.facet),s=o.filter(c=>c);if(o===this.input){for(let c of this.tooltipViews)c.update&&c.update(e);return!1}let l=[];for(let c=0;c<s.length;c++){let u=s[c],f=-1;if(u){for(let d=0;d<this.tooltips.length;d++){let g=this.tooltips[d];g&&g.create==u.create&&(f=d)}if(f<0)l[c]=this.createTooltipView(u);else{let d=l[c]=this.tooltipViews[f];d.update&&d.update(e)}}}for(let c of this.tooltipViews)l.indexOf(c)<0&&(c.dom.remove(),(r=c.destroy)===null||r===void 0||r.call(c));return this.input=o,this.tooltips=s,this.tooltipViews=l,!0}}function windowSpace(n){let{win:e}=n;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const tooltipConfig=Facet.define({combine:n=>{var e,r,o;return{position:browser.ios?"absolute":((e=n.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((r=n.find(s=>s.parent))===null||r===void 0?void 0:r.parent)||null,tooltipSpace:((o=n.find(s=>s.tooltipSpace))===null||o===void 0?void 0:o.tooltipSpace)||windowSpace}}}),knownHeight=new WeakMap,tooltipPlugin=ViewPlugin.fromClass(class{constructor(n){this.view=n,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let e=n.state.facet(tooltipConfig);this.position=e.position,this.parent=e.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new TooltipViewManager(n,showTooltip,r=>this.createTooltip(r)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(r=>{Date.now()>this.lastTransaction-50&&r.length>0&&r[r.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n);e&&this.observeIntersection();let r=e||n.geometryChanged,o=n.state.facet(tooltipConfig);if(o.position!=this.position){this.position=o.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;r=!0}if(o.parent!=this.parent){this.parent&&this.container.remove(),this.parent=o.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);r=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);r&&this.maybeMeasure()}createTooltip(n){let e=n.create(this.view);if(e.dom.classList.add("cm-tooltip"),n.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let r=document.createElement("div");r.className="cm-tooltip-arrow",e.dom.appendChild(r)}return e.dom.style.position=this.position,e.dom.style.top=Outside,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var n,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let r of this.manager.tooltipViews)r.dom.remove(),(n=r.destroy)===null||n===void 0||n.call(r);(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=this.view.dom.getBoundingClientRect();return{editor:n,parent:this.parent?this.container.getBoundingClientRect():n,pos:this.manager.tooltips.map((e,r)=>{let o=this.manager.tooltipViews[r];return o.getCoords?o.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(tooltipConfig).tooltipSpace(this.view)}}writeMeasure(n){var e;let{editor:r,space:o}=n,s=[];for(let l=0;l<this.manager.tooltips.length;l++){let c=this.manager.tooltips[l],u=this.manager.tooltipViews[l],{dom:f}=u,d=n.pos[l],g=n.size[l];if(!d||d.bottom<=Math.max(r.top,o.top)||d.top>=Math.min(r.bottom,o.bottom)||d.right<Math.max(r.left,o.left)-.1||d.left>Math.min(r.right,o.right)+.1){f.style.top=Outside;continue}let m=c.arrow?u.dom.querySelector(".cm-tooltip-arrow"):null,v=m?7:0,b=g.right-g.left,k=(e=knownHeight.get(u))!==null&&e!==void 0?e:g.bottom-g.top,R=u.offset||noOffset,I=this.view.textDirection==Direction.LTR,$=g.width>o.right-o.left?I?o.left:o.right-g.width:I?Math.min(d.left-(m?14:0)+R.x,o.right-b):Math.max(o.left,d.left-b+(m?14:0)-R.x),Y=!!c.above;!c.strictSide&&(Y?d.top-(g.bottom-g.top)-R.y<o.top:d.bottom+(g.bottom-g.top)+R.y>o.bottom)&&Y==o.bottom-d.bottom>d.top-o.top&&(Y=!Y);let oe=(Y?d.top-o.top:o.bottom-d.bottom)-v;if(oe<k&&u.resize!==!1){if(oe<this.view.defaultLineHeight){f.style.top=Outside;continue}knownHeight.set(u,k),f.style.height=(k=oe)+"px"}else f.style.height&&(f.style.height="");let G=Y?d.top-k-v-R.y:d.bottom+v+R.y,q=$+b;if(u.overlap!==!0)for(let ne of s)ne.left<q&&ne.right>$&&ne.top<G+k&&ne.bottom>G&&(G=Y?ne.top-k-2-v:ne.bottom+v+2);this.position=="absolute"?(f.style.top=G-n.parent.top+"px",f.style.left=$-n.parent.left+"px"):(f.style.top=G+"px",f.style.left=$+"px"),m&&(m.style.left=`${d.left+(I?R.x:-R.x)-($+14-7)}px`),u.overlap!==!0&&s.push({left:$,top:G,right:q,bottom:G+k}),f.classList.toggle("cm-tooltip-above",Y),f.classList.toggle("cm-tooltip-below",!Y),u.positioned&&u.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=Outside}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),baseTheme$4=EditorView.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),noOffset={x:0,y:0},showTooltip=Facet.define({enables:[tooltipPlugin,baseTheme$4]}),showHoverTooltip=Facet.define();class HoverTooltipHost{constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new TooltipViewManager(e,showHoverTooltip,r=>this.createHostedView(r))}static create(e){return new HoverTooltipHost(e)}createHostedView(e){let r=e.create(this.view);return r.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(r.dom),this.mounted&&r.mount&&r.mount(this.view),r}mount(e){for(let r of this.manager.tooltipViews)r.mount&&r.mount(e);this.mounted=!0}positioned(e){for(let r of this.manager.tooltipViews)r.positioned&&r.positioned(e)}update(e){this.manager.update(e)}}const showHoverTooltipHost=showTooltip.compute([showHoverTooltip],n=>{let e=n.facet(showHoverTooltip).filter(r=>r);return e.length===0?null:{pos:Math.min(...e.map(r=>r.pos)),end:Math.max(...e.filter(r=>r.end!=null).map(r=>r.end)),create:HoverTooltipHost.create,above:e[0].above,arrow:e.some(r=>r.arrow)}});class HoverPlugin{constructor(e,r,o,s,l){this.view=e,this.source=r,this.field=o,this.setHover=s,this.hoverTime=l,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:e}=this,r=this.view.contentDOM.contains(e.target)?this.view.posAtCoords(e):null;if(r==null)return;let o=this.view.coordsAtPos(r);if(o==null||e.y<o.top||e.y>o.bottom||e.x<o.left-this.view.defaultCharacterWidth||e.x>o.right+this.view.defaultCharacterWidth)return;let s=this.view.bidiSpans(this.view.state.doc.lineAt(r)).find(u=>u.from<=r&&u.to>=r),l=s&&s.dir==Direction.RTL?-1:1,c=this.source(this.view,r,e.x<o.left?-l:l);if(c!=null&&c.then){let u=this.pending={pos:r};c.then(f=>{this.pending==u&&(this.pending=null,f&&this.view.dispatch({effects:this.setHover.of(f)}))},f=>logException(this.view.state,f,"hover tooltip"))}else c&&this.view.dispatch({effects:this.setHover.of(c)})}mousemove(e){var r;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let o=this.active;if(o&&!isInTooltip(this.lastMove.target)||this.pending){let{pos:s}=o||this.pending,l=(r=o==null?void 0:o.end)!==null&&r!==void 0?r:s;(s==l?this.view.posAtCoords(this.lastMove)!=s:!isOverRange(this.view,s,l,e.clientX,e.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!isInTooltip(e.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function isInTooltip(n){for(let e=n;e;e=e.parentNode)if(e.nodeType==1&&e.classList.contains("cm-tooltip"))return!0;return!1}function isOverRange(n,e,r,o,s,l){let c=document.createRange(),u=n.domAtPos(e),f=n.domAtPos(r);c.setEnd(f.node,f.offset),c.setStart(u.node,u.offset);let d=c.getClientRects();c.detach();for(let g=0;g<d.length;g++){let m=d[g];if(Math.max(m.top-s,s-m.bottom,m.left-o,o-m.right)<=l)return!0}return!1}function hoverTooltip(n,e={}){let r=StateEffect.define(),o=StateField.define({create(){return null},update(s,l){if(s&&(e.hideOnChange&&(l.docChanged||l.selection)||e.hideOn&&e.hideOn(l,s)))return null;if(s&&l.docChanged){let c=l.changes.mapPos(s.pos,-1,MapMode.TrackDel);if(c==null)return null;let u=Object.assign(Object.create(null),s);u.pos=c,s.end!=null&&(u.end=l.changes.mapPos(s.end)),s=u}for(let c of l.effects)c.is(r)&&(s=c.value),c.is(closeHoverTooltipEffect)&&(s=null);return s},provide:s=>showHoverTooltip.from(s)});return[o,ViewPlugin.define(s=>new HoverPlugin(s,n,o,r,e.hoverTime||300)),showHoverTooltipHost]}function getTooltip(n,e){let r=n.plugin(tooltipPlugin);if(!r)return null;let o=r.manager.tooltips.indexOf(e);return o<0?null:r.manager.tooltipViews[o]}const closeHoverTooltipEffect=StateEffect.define(),panelConfig=Facet.define({combine(n){let e,r;for(let o of n)e=e||o.topContainer,r=r||o.bottomContainer;return{topContainer:e,bottomContainer:r}}});function getPanel(n,e){let r=n.plugin(panelPlugin),o=r?r.specs.indexOf(e):-1;return o>-1?r.panels[o]:null}const panelPlugin=ViewPlugin.fromClass(class{constructor(n){this.input=n.state.facet(showPanel),this.specs=this.input.filter(r=>r),this.panels=this.specs.map(r=>r(n));let e=n.state.facet(panelConfig);this.top=new PanelGroup(n,!0,e.topContainer),this.bottom=new PanelGroup(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(r=>r.top)),this.bottom.sync(this.panels.filter(r=>!r.top));for(let r of this.panels)r.dom.classList.add("cm-panel"),r.mount&&r.mount()}update(n){let e=n.state.facet(panelConfig);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new PanelGroup(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new PanelGroup(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let r=n.state.facet(showPanel);if(r!=this.input){let o=r.filter(f=>f),s=[],l=[],c=[],u=[];for(let f of o){let d=this.specs.indexOf(f),g;d<0?(g=f(n.view),u.push(g)):(g=this.panels[d],g.update&&g.update(n)),s.push(g),(g.top?l:c).push(g)}this.specs=o,this.panels=s,this.top.sync(l),this.bottom.sync(c);for(let f of u)f.dom.classList.add("cm-panel"),f.mount&&f.mount()}else for(let o of this.panels)o.update&&o.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>EditorView.scrollMargins.of(e=>{let r=e.plugin(n);return r&&{top:r.top.scrollMargin(),bottom:r.bottom.scrollMargin()}})});class PanelGroup{constructor(e,r,o){this.view=e,this.top=r,this.container=o,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let r of this.panels)r.destroy&&e.indexOf(r)<0&&r.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let r=this.container||this.view.dom;r.insertBefore(this.dom,this.top?r.firstChild:null)}let e=this.dom.firstChild;for(let r of this.panels)if(r.dom.parentNode==this.dom){for(;e!=r.dom;)e=rm(e);e=e.nextSibling}else this.dom.insertBefore(r.dom,e);for(;e;)e=rm(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function rm(n){let e=n.nextSibling;return n.remove(),e}const showPanel=Facet.define({enables:panelPlugin});class GutterMarker extends RangeValue{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}GutterMarker.prototype.elementClass="";GutterMarker.prototype.toDOM=void 0;GutterMarker.prototype.mapMode=MapMode.TrackBefore;GutterMarker.prototype.startSide=GutterMarker.prototype.endSide=-1;GutterMarker.prototype.point=!0;const gutterLineClass=Facet.define(),defaults$1={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>RangeSet.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},activeGutters=Facet.define();function gutter(n){return[gutters(),activeGutters.of(Object.assign(Object.assign({},defaults$1),n))]}const unfixGutters=Facet.define({combine:n=>n.some(e=>e)});function gutters(n){let e=[gutterView];return n&&n.fixed===!1&&e.push(unfixGutters.of(!0)),e}const gutterView=ViewPlugin.fromClass(class{constructor(n){this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=n.state.facet(activeGutters).map(e=>new SingleGutterView(n,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!n.state.facet(unfixGutters),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}update(n){if(this.updateGutters(n)){let e=this.prevViewport,r=n.view.viewport,o=Math.min(e.to,r.to)-Math.max(e.from,r.from);this.syncGutters(o<(r.to-r.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(unfixGutters)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&this.dom.remove();let r=RangeSet.iter(this.view.state.facet(gutterLineClass),this.view.viewport.from),o=[],s=this.gutters.map(l=>new UpdateContext(l,this.view.viewport,-this.view.documentPadding.top));for(let l of this.view.viewportLineBlocks){let c;if(Array.isArray(l.type)){for(let u of l.type)if(u.type==BlockType.Text){c=u;break}}else c=l.type==BlockType.Text?l:void 0;if(c){o.length&&(o=[]),advanceCursor(r,o,l.from);for(let u of s)u.line(this.view,c,o)}}for(let l of s)l.finish();n&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(n){let e=n.startState.facet(activeGutters),r=n.state.facet(activeGutters),o=n.docChanged||n.heightChanged||n.viewportChanged||!RangeSet.eq(n.startState.facet(gutterLineClass),n.state.facet(gutterLineClass),n.view.viewport.from,n.view.viewport.to);if(e==r)for(let s of this.gutters)s.update(n)&&(o=!0);else{o=!0;let s=[];for(let l of r){let c=e.indexOf(l);c<0?s.push(new SingleGutterView(this.view,l)):(this.gutters[c].update(n),s.push(this.gutters[c]))}for(let l of this.gutters)l.dom.remove(),s.indexOf(l)<0&&l.destroy();for(let l of s)this.dom.appendChild(l.dom);this.gutters=s}return o}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:n=>EditorView.scrollMargins.of(e=>{let r=e.plugin(n);return!r||r.gutters.length==0||!r.fixed?null:e.textDirection==Direction.LTR?{left:r.dom.offsetWidth}:{right:r.dom.offsetWidth}})});function asArray(n){return Array.isArray(n)?n:[n]}function advanceCursor(n,e,r){for(;n.value&&n.from<=r;)n.from==r&&e.push(n.value),n.next()}class UpdateContext{constructor(e,r,o){this.gutter=e,this.height=o,this.i=0,this.cursor=RangeSet.iter(e.markers,r.from)}line(e,r,o){let s=[];advanceCursor(this.cursor,s,r.from),o.length&&(s=s.concat(o));let l=this.gutter.config.lineMarker(e,r,s);l&&s.unshift(l);let c=this.gutter;if(s.length==0&&!c.config.renderEmptyElements)return;let u=r.top-this.height;if(this.i==c.elements.length){let f=new GutterElement(e,r.height,u,s);c.elements.push(f),c.dom.appendChild(f.dom)}else c.elements[this.i].update(e,r.height,u,s);this.height=r.bottom,this.i++}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let r=e.elements.pop();e.dom.removeChild(r.dom),r.destroy()}}}class SingleGutterView{constructor(e,r){this.view=e,this.config=r,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let o in r.domEventHandlers)this.dom.addEventListener(o,s=>{let l=s.target,c;if(l!=this.dom&&this.dom.contains(l)){for(;l.parentNode!=this.dom;)l=l.parentNode;let f=l.getBoundingClientRect();c=(f.top+f.bottom)/2}else c=s.clientY;let u=e.lineBlockAtHeight(c-e.documentTop);r.domEventHandlers[o](e,u,s)&&s.preventDefault()});this.markers=asArray(r.markers(e)),r.initialSpacer&&(this.spacer=new GutterElement(e,0,0,[r.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let r=this.markers;if(this.markers=asArray(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let o=e.view.viewport;return!RangeSet.eq(this.markers,r,o.from,o.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class GutterElement{constructor(e,r,o,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,r,o,s)}update(e,r,o,s){this.height!=r&&(this.dom.style.height=(this.height=r)+"px"),this.above!=o&&(this.dom.style.marginTop=(this.above=o)?o+"px":""),sameMarkers(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,r){let o="cm-gutterElement",s=this.dom.firstChild;for(let l=0,c=0;;){let u=c,f=l<r.length?r[l++]:null,d=!1;if(f){let g=f.elementClass;g&&(o+=" "+g);for(let m=c;m<this.markers.length;m++)if(this.markers[m].compare(f)){u=m,d=!0;break}}else u=this.markers.length;for(;c<u;){let g=this.markers[c++];if(g.toDOM){g.destroy(s);let m=s.nextSibling;s.remove(),s=m}}if(!f)break;f.toDOM&&(d?s=s.nextSibling:this.dom.insertBefore(f.toDOM(e),s)),d&&c++}this.dom.className=o,this.markers=r}destroy(){this.setMarkers(null,[])}}function sameMarkers(n,e){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!n[r].compare(e[r]))return!1;return!0}const lineNumberMarkers=Facet.define(),lineNumberConfig=Facet.define({combine(n){return combineConfig(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,r){let o=Object.assign({},e);for(let s in r){let l=o[s],c=r[s];o[s]=l?(u,f,d)=>l(u,f,d)||c(u,f,d):c}return o}})}});class NumberMarker extends GutterMarker{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function formatNumber(n,e){return n.state.facet(lineNumberConfig).formatNumber(e,n.state)}const lineNumberGutter=activeGutters.compute([lineNumberConfig],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(lineNumberMarkers)},lineMarker(e,r,o){return o.some(s=>s.toDOM)?null:new NumberMarker(formatNumber(e,e.state.doc.lineAt(r.from).number))},lineMarkerChange:e=>e.startState.facet(lineNumberConfig)!=e.state.facet(lineNumberConfig),initialSpacer(e){return new NumberMarker(formatNumber(e,maxLineNumber(e.state.doc.lines)))},updateSpacer(e,r){let o=formatNumber(r.view,maxLineNumber(r.view.state.doc.lines));return o==e.number?e:new NumberMarker(o)},domEventHandlers:n.facet(lineNumberConfig).domEventHandlers}));function lineNumbers(n={}){return[lineNumberConfig.of(n),gutters(),lineNumberGutter]}function maxLineNumber(n){let e=9;for(;e<n;)e=e*10+9;return e}const activeLineGutterMarker=new class extends GutterMarker{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},activeLineGutterHighlighter=gutterLineClass.compute(["selection"],n=>{let e=[],r=-1;for(let o of n.selection.ranges){let s=n.doc.lineAt(o.head).from;s>r&&(r=s,e.push(activeLineGutterMarker.range(s)))}return RangeSet.of(e)});function highlightActiveLineGutter(){return activeLineGutterHighlighter}const DefaultBufferLength=1024;let nextPropID=0;class Range{constructor(e,r){this.from=e,this.to=r}}class NodeProp{constructor(e={}){this.id=nextPropID++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=NodeType.match(e)),r=>{let o=e(r);return o===void 0?null:[this,o]}}}NodeProp.closedBy=new NodeProp({deserialize:n=>n.split(" ")});NodeProp.openedBy=new NodeProp({deserialize:n=>n.split(" ")});NodeProp.group=new NodeProp({deserialize:n=>n.split(" ")});NodeProp.contextHash=new NodeProp({perNode:!0});NodeProp.lookAhead=new NodeProp({perNode:!0});NodeProp.mounted=new NodeProp({perNode:!0});const noProps=Object.create(null);class NodeType{constructor(e,r,o,s=0){this.name=e,this.props=r,this.id=o,this.flags=s}static define(e){let r=e.props&&e.props.length?Object.create(null):noProps,o=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),s=new NodeType(e.name||"",r,e.id,o);if(e.props){for(let l of e.props)if(Array.isArray(l)||(l=l(s)),l){if(l[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");r[l[0].id]=l[1]}}return s}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let r=this.prop(NodeProp.group);return r?r.indexOf(e)>-1:!1}return this.id==e}static match(e){let r=Object.create(null);for(let o in e)for(let s of o.split(" "))r[s]=e[o];return o=>{for(let s=o.prop(NodeProp.group),l=-1;l<(s?s.length:0);l++){let c=r[l<0?o.name:s[l]];if(c)return c}}}}NodeType.none=new NodeType("",Object.create(null),0,8);class NodeSet{constructor(e){this.types=e;for(let r=0;r<e.length;r++)if(e[r].id!=r)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let r=[];for(let o of this.types){let s=null;for(let l of e){let c=l(o);c&&(s||(s=Object.assign({},o.props)),s[c[0].id]=c[1])}r.push(s?new NodeType(o.name,s,o.id,o.flags):o)}return new NodeSet(r)}}const CachedNode=new WeakMap,CachedInnerNode=new WeakMap;var IterMode;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(IterMode||(IterMode={}));class Tree{constructor(e,r,o,s,l){if(this.type=e,this.children=r,this.positions=o,this.length=s,this.props=null,l&&l.length){this.props=Object.create(null);for(let[c,u]of l)this.props[typeof c=="number"?c:c.id]=u}}toString(){let e=this.prop(NodeProp.mounted);if(e&&!e.overlay)return e.tree.toString();let r="";for(let o of this.children){let s=o.toString();s&&(r&&(r+=","),r+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(r.length?"("+r+")":""):r}cursor(e=0){return new TreeCursor(this.topNode,e)}cursorAt(e,r=0,o=0){let s=CachedNode.get(this)||this.topNode,l=new TreeCursor(s);return l.moveTo(e,r),CachedNode.set(this,l._tree),l}get topNode(){return new TreeNode(this,0,0,null)}resolve(e,r=0){let o=resolveNode(CachedNode.get(this)||this.topNode,e,r,!1);return CachedNode.set(this,o),o}resolveInner(e,r=0){let o=resolveNode(CachedInnerNode.get(this)||this.topNode,e,r,!0);return CachedInnerNode.set(this,o),o}iterate(e){let{enter:r,leave:o,from:s=0,to:l=this.length}=e;for(let c=this.cursor((e.mode||0)|IterMode.IncludeAnonymous);;){let u=!1;if(c.from<=l&&c.to>=s&&(c.type.isAnonymous||r(c)!==!1)){if(c.firstChild())continue;u=!0}for(;u&&o&&!c.type.isAnonymous&&o(c),!c.nextSibling();){if(!c.parent())return;u=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let r in this.props)e.push([+r,this.props[r]]);return e}balance(e={}){return this.children.length<=8?this:balanceRange(NodeType.none,this.children,this.positions,0,this.children.length,0,this.length,(r,o,s)=>new Tree(this.type,r,o,s,this.propValues),e.makeTree||((r,o,s)=>new Tree(NodeType.none,r,o,s)))}static build(e){return buildTree(e)}}Tree.empty=new Tree(NodeType.none,[],[],0);class FlatBufferCursor{constructor(e,r){this.buffer=e,this.index=r}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new FlatBufferCursor(this.buffer,this.index)}}class TreeBuffer{constructor(e,r,o){this.buffer=e,this.length=r,this.set=o}get type(){return NodeType.none}toString(){let e=[];for(let r=0;r<this.buffer.length;)e.push(this.childString(r)),r=this.buffer[r+3];return e.join(",")}childString(e){let r=this.buffer[e],o=this.buffer[e+3],s=this.set.types[r],l=s.name;if(/\W/.test(l)&&!s.isError&&(l=JSON.stringify(l)),e+=4,o==e)return l;let c=[];for(;e<o;)c.push(this.childString(e)),e=this.buffer[e+3];return l+"("+c.join(",")+")"}findChild(e,r,o,s,l){let{buffer:c}=this,u=-1;for(let f=e;f!=r&&!(checkSide(l,s,c[f+1],c[f+2])&&(u=f,o>0));f=c[f+3]);return u}slice(e,r,o){let s=this.buffer,l=new Uint16Array(r-e),c=0;for(let u=e,f=0;u<r;){l[f++]=s[u++],l[f++]=s[u++]-o;let d=l[f++]=s[u++]-o;l[f++]=s[u++]-e,c=Math.max(c,d)}return new TreeBuffer(l,c,this.set)}}function checkSide(n,e,r,o){switch(n){case-2:return r<e;case-1:return o>=e&&r<e;case 0:return r<e&&o>e;case 1:return r<=e&&o>e;case 2:return o>e;case 4:return!0}}function enterUnfinishedNodesBefore(n,e){let r=n.childBefore(e);for(;r;){let o=r.lastChild;if(!o||o.to!=r.to)break;o.type.isError&&o.from==o.to?(n=r,r=o.prevSibling):r=o}return n}function resolveNode(n,e,r,o){for(var s;n.from==n.to||(r<1?n.from>=e:n.from>e)||(r>-1?n.to<=e:n.to<e);){let c=!o&&n instanceof TreeNode&&n.index<0?null:n.parent;if(!c)return n;n=c}let l=o?0:IterMode.IgnoreOverlays;if(o)for(let c=n,u=c.parent;u;c=u,u=c.parent)c instanceof TreeNode&&c.index<0&&((s=u.enter(e,r,l))===null||s===void 0?void 0:s.from)!=c.from&&(n=u);for(;;){let c=n.enter(e,r,l);if(!c)return n;n=c}}class TreeNode{constructor(e,r,o,s){this._tree=e,this.from=r,this.index=o,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,r,o,s,l=0){for(let c=this;;){for(let{children:u,positions:f}=c._tree,d=r>0?u.length:-1;e!=d;e+=r){let g=u[e],m=f[e]+c.from;if(checkSide(s,o,m,m+g.length)){if(g instanceof TreeBuffer){if(l&IterMode.ExcludeBuffers)continue;let v=g.findChild(0,g.buffer.length,r,o-m,s);if(v>-1)return new BufferNode(new BufferContext(c,g,e,m),null,v)}else if(l&IterMode.IncludeAnonymous||!g.type.isAnonymous||hasChild(g)){let v;if(!(l&IterMode.IgnoreMounts)&&g.props&&(v=g.prop(NodeProp.mounted))&&!v.overlay)return new TreeNode(v.tree,m,e,c);let b=new TreeNode(g,m,e,c);return l&IterMode.IncludeAnonymous||!b.type.isAnonymous?b:b.nextChild(r<0?g.children.length-1:0,r,o,s)}}}if(l&IterMode.IncludeAnonymous||!c.type.isAnonymous||(c.index>=0?e=c.index+r:e=r<0?-1:c._parent._tree.children.length,c=c._parent,!c))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,r,o=0){let s;if(!(o&IterMode.IgnoreOverlays)&&(s=this._tree.prop(NodeProp.mounted))&&s.overlay){let l=e-this.from;for(let{from:c,to:u}of s.overlay)if((r>0?c<=l:c<l)&&(r<0?u>=l:u>l))return new TreeNode(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,r,o)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new TreeCursor(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,r=0){return resolveNode(this,e,r,!1)}resolveInner(e,r=0){return resolveNode(this,e,r,!0)}enterUnfinishedNodesBefore(e){return enterUnfinishedNodesBefore(this,e)}getChild(e,r=null,o=null){let s=getChildren(this,e,r,o);return s.length?s[0]:null}getChildren(e,r=null,o=null){return getChildren(this,e,r,o)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return matchNodeContext(this,e)}}function getChildren(n,e,r,o){let s=n.cursor(),l=[];if(!s.firstChild())return l;if(r!=null){for(;!s.type.is(r);)if(!s.nextSibling())return l}for(;;){if(o!=null&&s.type.is(o))return l;if(s.type.is(e)&&l.push(s.node),!s.nextSibling())return o==null?l:[]}}function matchNodeContext(n,e,r=e.length-1){for(let o=n.parent;r>=0;o=o.parent){if(!o)return!1;if(!o.type.isAnonymous){if(e[r]&&e[r]!=o.name)return!1;r--}}return!0}class BufferContext{constructor(e,r,o,s){this.parent=e,this.buffer=r,this.index=o,this.start=s}}class BufferNode{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,r,o){this.context=e,this._parent=r,this.index=o,this.type=e.buffer.set.types[e.buffer.buffer[o]]}child(e,r,o){let{buffer:s}=this.context,l=s.findChild(this.index+4,s.buffer[this.index+3],e,r-this.context.start,o);return l<0?null:new BufferNode(this.context,this,l)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,r,o=0){if(o&IterMode.ExcludeBuffers)return null;let{buffer:s}=this.context,l=s.findChild(this.index+4,s.buffer[this.index+3],r>0?1:-1,e-this.context.start,r);return l<0?null:new BufferNode(this.context,this,l)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,r=e.buffer[this.index+3];return r<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new BufferNode(this.context,this._parent,r):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,r=this._parent?this._parent.index+4:0;return this.index==r?this.externalSibling(-1):new BufferNode(this.context,this._parent,e.findChild(r,this.index,-1,0,4))}cursor(e=0){return new TreeCursor(this,e)}get tree(){return null}toTree(){let e=[],r=[],{buffer:o}=this.context,s=this.index+4,l=o.buffer[this.index+3];if(l>s){let c=o.buffer[this.index+1];e.push(o.slice(s,l,c)),r.push(0)}return new Tree(this.type,e,r,this.to-this.from)}resolve(e,r=0){return resolveNode(this,e,r,!1)}resolveInner(e,r=0){return resolveNode(this,e,r,!0)}enterUnfinishedNodesBefore(e){return enterUnfinishedNodesBefore(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,r=null,o=null){let s=getChildren(this,e,r,o);return s.length?s[0]:null}getChildren(e,r=null,o=null){return getChildren(this,e,r,o)}get node(){return this}matchContext(e){return matchNodeContext(this,e)}}class TreeCursor{get name(){return this.type.name}constructor(e,r=0){if(this.mode=r,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof TreeNode)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let o=e._parent;o;o=o._parent)this.stack.unshift(o.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,r){this.index=e;let{start:o,buffer:s}=this.buffer;return this.type=r||s.set.types[s.buffer[e]],this.from=o+s.buffer[e+1],this.to=o+s.buffer[e+2],!0}yield(e){return e?e instanceof TreeNode?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,r,o){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,r,o,this.mode));let{buffer:s}=this.buffer,l=s.findChild(this.index+4,s.buffer[this.index+3],e,r-this.buffer.start,o);return l<0?!1:(this.stack.push(this.index),this.yieldBuf(l))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,r,o=this.mode){return this.buffer?o&IterMode.ExcludeBuffers?!1:this.enterChild(1,e,r):this.yield(this._tree.enter(e,r,o))}parent(){if(!this.buffer)return this.yieldNode(this.mode&IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:r}=this.buffer,o=this.stack.length-1;if(e<0){let s=o<0?0:this.stack[o]+4;if(this.index!=s)return this.yieldBuf(r.findChild(s,this.index,-1,0,4))}else{let s=r.buffer[this.index+3];if(s<(o<0?r.buffer.length:r.buffer[this.stack[o]+3]))return this.yieldBuf(s)}return o<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let r,o,{buffer:s}=this;if(s){if(e>0){if(this.index<s.buffer.buffer.length)return!1}else for(let l=0;l<this.index;l++)if(s.buffer.buffer[l+3]<this.index)return!1;({index:r,parent:o}=s)}else({index:r,_parent:o}=this._tree);for(;o;{index:r,_parent:o}=o)if(r>-1)for(let l=r+e,c=e<0?-1:o._tree.children.length;l!=c;l+=e){let u=o._tree.children[l];if(this.mode&IterMode.IncludeAnonymous||u instanceof TreeBuffer||!u.type.isAnonymous||hasChild(u))return!1}return!0}move(e,r){if(r&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,r=0){for(;(this.from==this.to||(r<1?this.from>=e:this.from>e)||(r>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,r););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,r=null,o=0;if(e&&e.context==this.buffer)e:for(let s=this.index,l=this.stack.length;l>=0;){for(let c=e;c;c=c._parent)if(c.index==s){if(s==this.index)return c;r=c,o=l+1;break e}s=this.stack[--l]}for(let s=o;s<this.stack.length;s++)r=new BufferNode(this.buffer,r,this.stack[s]);return this.bufferNode=new BufferNode(this.buffer,r,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,r){for(let o=0;;){let s=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){o++;continue}this.type.isAnonymous||(s=!0)}for(;s&&r&&r(this),s=this.type.isAnonymous,!this.nextSibling();){if(!o)return;this.parent(),o--,s=!0}}}matchContext(e){if(!this.buffer)return matchNodeContext(this.node,e);let{buffer:r}=this.buffer,{types:o}=r.set;for(let s=e.length-1,l=this.stack.length-1;s>=0;l--){if(l<0)return matchNodeContext(this.node,e,s);let c=o[r.buffer[this.stack[l]]];if(!c.isAnonymous){if(e[s]&&e[s]!=c.name)return!1;s--}}return!0}}function hasChild(n){return n.children.some(e=>e instanceof TreeBuffer||!e.type.isAnonymous||hasChild(e))}function buildTree(n){var e;let{buffer:r,nodeSet:o,maxBufferLength:s=DefaultBufferLength,reused:l=[],minRepeatType:c=o.types.length}=n,u=Array.isArray(r)?new FlatBufferCursor(r,r.length):r,f=o.types,d=0,g=0;function m(G,q,ne,K,qe){let{id:ge,start:Z,end:re,size:He}=u,st=g;for(;He<0;)if(u.next(),He==-1){let We=l[ge];ne.push(We),K.push(Z-G);return}else if(He==-3){d=ge;return}else if(He==-4){g=ge;return}else throw new RangeError(`Unrecognized record size: ${He}`);let ee=f[ge],_e,ue,ye=Z-G;if(re-Z<=s&&(ue=R(u.pos-q,qe))){let We=new Uint16Array(ue.size-ue.skip),Ze=u.pos-ue.size,Ae=We.length;for(;u.pos>Ze;)Ae=I(ue.start,We,Ae);_e=new TreeBuffer(We,re-ue.start,o),ye=ue.start-G}else{let We=u.pos-He;u.next();let Ze=[],Ae=[],Bt=ge>=c?ge:-1,Ge=0,Dn=re;for(;u.pos>We;)Bt>=0&&u.id==Bt&&u.size>=0?(u.end<=Dn-s&&(b(Ze,Ae,Z,Ge,u.end,Dn,Bt,st),Ge=Ze.length,Dn=u.end),u.next()):m(Z,We,Ze,Ae,Bt);if(Bt>=0&&Ge>0&&Ge<Ze.length&&b(Ze,Ae,Z,Ge,Z,Dn,Bt,st),Ze.reverse(),Ae.reverse(),Bt>-1&&Ge>0){let An=v(ee);_e=balanceRange(ee,Ze,Ae,0,Ze.length,0,re-Z,An,An)}else _e=k(ee,Ze,Ae,re-Z,st-re)}ne.push(_e),K.push(ye)}function v(G){return(q,ne,K)=>{let qe=0,ge=q.length-1,Z,re;if(ge>=0&&(Z=q[ge])instanceof Tree){if(!ge&&Z.type==G&&Z.length==K)return Z;(re=Z.prop(NodeProp.lookAhead))&&(qe=ne[ge]+Z.length+re)}return k(G,q,ne,K,qe)}}function b(G,q,ne,K,qe,ge,Z,re){let He=[],st=[];for(;G.length>K;)He.push(G.pop()),st.push(q.pop()+ne-qe);G.push(k(o.types[Z],He,st,ge-qe,re-ge)),q.push(qe-ne)}function k(G,q,ne,K,qe=0,ge){if(d){let Z=[NodeProp.contextHash,d];ge=ge?[Z].concat(ge):[Z]}if(qe>25){let Z=[NodeProp.lookAhead,qe];ge=ge?[Z].concat(ge):[Z]}return new Tree(G,q,ne,K,ge)}function R(G,q){let ne=u.fork(),K=0,qe=0,ge=0,Z=ne.end-s,re={size:0,start:0,skip:0};e:for(let He=ne.pos-G;ne.pos>He;){let st=ne.size;if(ne.id==q&&st>=0){re.size=K,re.start=qe,re.skip=ge,ge+=4,K+=4,ne.next();continue}let ee=ne.pos-st;if(st<0||ee<He||ne.start<Z)break;let _e=ne.id>=c?4:0,ue=ne.start;for(ne.next();ne.pos>ee;){if(ne.size<0)if(ne.size==-3)_e+=4;else break e;else ne.id>=c&&(_e+=4);ne.next()}qe=ue,K+=st,ge+=_e}return(q<0||K==G)&&(re.size=K,re.start=qe,re.skip=ge),re.size>4?re:void 0}function I(G,q,ne){let{id:K,start:qe,end:ge,size:Z}=u;if(u.next(),Z>=0&&K<c){let re=ne;if(Z>4){let He=u.pos-(Z-4);for(;u.pos>He;)ne=I(G,q,ne)}q[--ne]=re,q[--ne]=ge-G,q[--ne]=qe-G,q[--ne]=K}else Z==-3?d=K:Z==-4&&(g=K);return ne}let $=[],Y=[];for(;u.pos>0;)m(n.start||0,n.bufferStart||0,$,Y,-1);let oe=(e=n.length)!==null&&e!==void 0?e:$.length?Y[0]+$[0].length:0;return new Tree(f[n.topID],$.reverse(),Y.reverse(),oe)}const nodeSizeCache=new WeakMap;function nodeSize(n,e){if(!n.isAnonymous||e instanceof TreeBuffer||e.type!=n)return 1;let r=nodeSizeCache.get(e);if(r==null){r=1;for(let o of e.children){if(o.type!=n||!(o instanceof Tree)){r=1;break}r+=nodeSize(n,o)}nodeSizeCache.set(e,r)}return r}function balanceRange(n,e,r,o,s,l,c,u,f){let d=0;for(let k=o;k<s;k++)d+=nodeSize(n,e[k]);let g=Math.ceil(d*1.5/8),m=[],v=[];function b(k,R,I,$,Y){for(let oe=I;oe<$;){let G=oe,q=R[oe],ne=nodeSize(n,k[oe]);for(oe++;oe<$;oe++){let K=nodeSize(n,k[oe]);if(ne+K>=g)break;ne+=K}if(oe==G+1){if(ne>g){let K=k[G];b(K.children,K.positions,0,K.children.length,R[G]+Y);continue}m.push(k[G])}else{let K=R[oe-1]+k[oe-1].length-q;m.push(balanceRange(n,k,R,G,oe,q,K,null,f))}v.push(q+Y-l)}}return b(e,r,o,s,0),(u||f)(m,v,c)}class TreeFragment{constructor(e,r,o,s,l=!1,c=!1){this.from=e,this.to=r,this.tree=o,this.offset=s,this.open=(l?1:0)|(c?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,r=[],o=!1){let s=[new TreeFragment(0,e.length,e,0,!1,o)];for(let l of r)l.to>e.length&&s.push(l);return s}static applyChanges(e,r,o=128){if(!r.length)return e;let s=[],l=1,c=e.length?e[0]:null;for(let u=0,f=0,d=0;;u++){let g=u<r.length?r[u]:null,m=g?g.fromA:1e9;if(m-f>=o)for(;c&&c.from<m;){let v=c;if(f>=v.from||m<=v.to||d){let b=Math.max(v.from,f)-d,k=Math.min(v.to,m)-d;v=b>=k?null:new TreeFragment(b,k,v.tree,v.offset+d,u>0,!!g)}if(v&&s.push(v),c.to>m)break;c=l<e.length?e[l++]:null}if(!g)break;f=g.toA,d=g.toA-g.toB}return s}}class Parser{startParse(e,r,o){return typeof e=="string"&&(e=new StringInput(e)),o=o?o.length?o.map(s=>new Range(s.from,s.to)):[new Range(0,0)]:[new Range(0,e.length)],this.createParse(e,r||[],o)}parse(e,r,o){let s=this.startParse(e,r,o);for(;;){let l=s.advance();if(l)return l}}}class StringInput{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,r){return this.string.slice(e,r)}}new NodeProp({perNode:!0});let nextTagID=0;class Tag{constructor(e,r,o){this.set=e,this.base=r,this.modified=o,this.id=nextTagID++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let r=new Tag([],null,[]);if(r.set.push(r),e)for(let o of e.set)r.set.push(o);return r}static defineModifier(){let e=new Modifier;return r=>r.modified.indexOf(e)>-1?r:Modifier.get(r.base||r,r.modified.concat(e).sort((o,s)=>o.id-s.id))}}let nextModifierID=0;class Modifier{constructor(){this.instances=[],this.id=nextModifierID++}static get(e,r){if(!r.length)return e;let o=r[0].instances.find(u=>u.base==e&&sameArray(r,u.modified));if(o)return o;let s=[],l=new Tag(s,e,r);for(let u of r)u.instances.push(l);let c=powerSet(r);for(let u of e.set)if(!u.modified.length)for(let f of c)s.push(Modifier.get(u,f));return l}}function sameArray(n,e){return n.length==e.length&&n.every((r,o)=>r==e[o])}function powerSet(n){let e=[[]];for(let r=0;r<n.length;r++)for(let o=0,s=e.length;o<s;o++)e.push(e[o].concat(n[r]));return e.sort((r,o)=>o.length-r.length)}function styleTags(n){let e=Object.create(null);for(let r in n){let o=n[r];Array.isArray(o)||(o=[o]);for(let s of r.split(" "))if(s){let l=[],c=2,u=s;for(let m=0;;){if(u=="..."&&m>0&&m+3==s.length){c=1;break}let v=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(u);if(!v)throw new RangeError("Invalid path: "+s);if(l.push(v[0]=="*"?"":v[0][0]=='"'?JSON.parse(v[0]):v[0]),m+=v[0].length,m==s.length)break;let b=s[m++];if(m==s.length&&b=="!"){c=0;break}if(b!="/")throw new RangeError("Invalid path: "+s);u=s.slice(m)}let f=l.length-1,d=l[f];if(!d)throw new RangeError("Invalid path: "+s);let g=new Rule(o,c,f>0?l.slice(0,f):null);e[d]=g.sort(e[d])}}return ruleNodeProp.add(e)}const ruleNodeProp=new NodeProp;class Rule{constructor(e,r,o,s){this.tags=e,this.mode=r,this.context=o,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Rule.empty=new Rule([],2,null);function tagHighlighter(n,e){let r=Object.create(null);for(let l of n)if(!Array.isArray(l.tag))r[l.tag.id]=l.class;else for(let c of l.tag)r[c.id]=l.class;let{scope:o,all:s=null}=e||{};return{style:l=>{let c=s;for(let u of l)for(let f of u.set){let d=r[f.id];if(d){c=c?c+" "+d:d;break}}return c},scope:o}}function highlightTags(n,e){let r=null;for(let o of n){let s=o.style(e);s&&(r=r?r+" "+s:s)}return r}function highlightTree(n,e,r,o=0,s=n.length){let l=new HighlightBuilder(o,Array.isArray(e)?e:[e],r);l.highlightRange(n.cursor(),o,s,"",l.highlighters),l.flush(s)}class HighlightBuilder{constructor(e,r,o){this.at=e,this.highlighters=r,this.span=o,this.class=""}startSpan(e,r){r!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=r)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,r,o,s,l){let{type:c,from:u,to:f}=e;if(u>=o||f<=r)return;c.isTop&&(l=this.highlighters.filter(b=>!b.scope||b.scope(c)));let d=s,g=getStyleTags(e)||Rule.empty,m=highlightTags(l,g.tags);if(m&&(d&&(d+=" "),d+=m,g.mode==1&&(s+=(s?" ":"")+m)),this.startSpan(e.from,d),g.opaque)return;let v=e.tree&&e.tree.prop(NodeProp.mounted);if(v&&v.overlay){let b=e.node.enter(v.overlay[0].from+u,1),k=this.highlighters.filter(I=>!I.scope||I.scope(v.tree.type)),R=e.firstChild();for(let I=0,$=u;;I++){let Y=I<v.overlay.length?v.overlay[I]:null,oe=Y?Y.from+u:f,G=Math.max(r,$),q=Math.min(o,oe);if(G<q&&R)for(;e.from<q&&(this.highlightRange(e,G,q,s,l),this.startSpan(Math.min(q,e.to),d),!(e.to>=oe||!e.nextSibling())););if(!Y||oe>o)break;$=Y.to+u,$>r&&(this.highlightRange(b.cursor(),Math.max(r,Y.from+u),Math.min(o,$),s,k),this.startSpan($,d))}R&&e.parent()}else if(e.firstChild()){do if(!(e.to<=r)){if(e.from>=o)break;this.highlightRange(e,r,o,s,l),this.startSpan(Math.min(o,e.to),d)}while(e.nextSibling());e.parent()}}}function getStyleTags(n){let e=n.type.prop(ruleNodeProp);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const t=Tag.define,comment=t(),name=t(),typeName=t(name),propertyName=t(name),literal=t(),string=t(literal),number=t(literal),content=t(),heading=t(content),keyword=t(),operator=t(),punctuation=t(),bracket=t(punctuation),meta=t(),tags={comment,lineComment:t(comment),blockComment:t(comment),docComment:t(comment),name,variableName:t(name),typeName,tagName:t(typeName),propertyName,attributeName:t(propertyName),className:t(name),labelName:t(name),namespace:t(name),macroName:t(name),literal,string,docString:t(string),character:t(string),attributeValue:t(string),number,integer:t(number),float:t(number),bool:t(literal),regexp:t(literal),escape:t(literal),color:t(literal),url:t(literal),keyword,self:t(keyword),null:t(keyword),atom:t(keyword),unit:t(keyword),modifier:t(keyword),operatorKeyword:t(keyword),controlKeyword:t(keyword),definitionKeyword:t(keyword),moduleKeyword:t(keyword),operator,derefOperator:t(operator),arithmeticOperator:t(operator),logicOperator:t(operator),bitwiseOperator:t(operator),compareOperator:t(operator),updateOperator:t(operator),definitionOperator:t(operator),typeOperator:t(operator),controlOperator:t(operator),punctuation,separator:t(punctuation),bracket,angleBracket:t(bracket),squareBracket:t(bracket),paren:t(bracket),brace:t(bracket),content,heading,heading1:t(heading),heading2:t(heading),heading3:t(heading),heading4:t(heading),heading5:t(heading),heading6:t(heading),contentSeparator:t(content),list:t(content),quote:t(content),emphasis:t(content),strong:t(content),link:t(content),monospace:t(content),strikethrough:t(content),inserted:t(),deleted:t(),changed:t(),invalid:t(),meta,documentMeta:t(meta),annotation:t(meta),processingInstruction:t(meta),definition:Tag.defineModifier(),constant:Tag.defineModifier(),function:Tag.defineModifier(),standard:Tag.defineModifier(),local:Tag.defineModifier(),special:Tag.defineModifier()};tagHighlighter([{tag:tags.link,class:"tok-link"},{tag:tags.heading,class:"tok-heading"},{tag:tags.emphasis,class:"tok-emphasis"},{tag:tags.strong,class:"tok-strong"},{tag:tags.keyword,class:"tok-keyword"},{tag:tags.atom,class:"tok-atom"},{tag:tags.bool,class:"tok-bool"},{tag:tags.url,class:"tok-url"},{tag:tags.labelName,class:"tok-labelName"},{tag:tags.inserted,class:"tok-inserted"},{tag:tags.deleted,class:"tok-deleted"},{tag:tags.literal,class:"tok-literal"},{tag:tags.string,class:"tok-string"},{tag:tags.number,class:"tok-number"},{tag:[tags.regexp,tags.escape,tags.special(tags.string)],class:"tok-string2"},{tag:tags.variableName,class:"tok-variableName"},{tag:tags.local(tags.variableName),class:"tok-variableName tok-local"},{tag:tags.definition(tags.variableName),class:"tok-variableName tok-definition"},{tag:tags.special(tags.variableName),class:"tok-variableName2"},{tag:tags.definition(tags.propertyName),class:"tok-propertyName tok-definition"},{tag:tags.typeName,class:"tok-typeName"},{tag:tags.namespace,class:"tok-namespace"},{tag:tags.className,class:"tok-className"},{tag:tags.macroName,class:"tok-macroName"},{tag:tags.propertyName,class:"tok-propertyName"},{tag:tags.operator,class:"tok-operator"},{tag:tags.comment,class:"tok-comment"},{tag:tags.meta,class:"tok-meta"},{tag:tags.invalid,class:"tok-invalid"},{tag:tags.punctuation,class:"tok-punctuation"}]);var _a$1;const languageDataProp=new NodeProp;function defineLanguageFacet(n){return Facet.define({combine:n?e=>e.concat(n):void 0})}const sublanguageProp=new NodeProp;class Language{constructor(e,r,o=[],s=""){this.data=e,this.name=s,EditorState.prototype.hasOwnProperty("tree")||Object.defineProperty(EditorState.prototype,"tree",{get(){return syntaxTree(this)}}),this.parser=r,this.extension=[language.of(this),EditorState.languageData.of((l,c,u)=>{let f=topNodeAt(l,c,u),d=f.type.prop(languageDataProp);if(!d)return[];let g=l.facet(d),m=f.type.prop(sublanguageProp);if(m){let v=f.resolve(c-f.from,u);for(let b of m)if(b.test(v,l)){let k=l.facet(b.facet);return b.type=="replace"?k:k.concat(g)}}return g})].concat(o)}isActiveAt(e,r,o=-1){return topNodeAt(e,r,o).type.prop(languageDataProp)==this.data}findRegions(e){let r=e.facet(language);if((r==null?void 0:r.data)==this.data)return[{from:0,to:e.doc.length}];if(!r||!r.allowsNesting)return[];let o=[],s=(l,c)=>{if(l.prop(languageDataProp)==this.data){o.push({from:c,to:c+l.length});return}let u=l.prop(NodeProp.mounted);if(u){if(u.tree.prop(languageDataProp)==this.data){if(u.overlay)for(let f of u.overlay)o.push({from:f.from+c,to:f.to+c});else o.push({from:c,to:c+l.length});return}else if(u.overlay){let f=o.length;if(s(u.tree,u.overlay[0].from+c),o.length>f)return}}for(let f=0;f<l.children.length;f++){let d=l.children[f];d instanceof Tree&&s(d,l.positions[f]+c)}};return s(syntaxTree(e),0),o}get allowsNesting(){return!0}}Language.setState=StateEffect.define();function topNodeAt(n,e,r){let o=n.facet(language),s=syntaxTree(n).topNode;if(!o||o.allowsNesting)for(let l=s;l;l=l.enter(e,r,IterMode.ExcludeBuffers))l.type.isTop&&(s=l);return s}class LRLanguage extends Language{constructor(e,r,o){super(e,r,[],o),this.parser=r}static define(e){let r=defineLanguageFacet(e.languageData);return new LRLanguage(r,e.parser.configure({props:[languageDataProp.add(o=>o.isTop?r:void 0)]}),e.name)}configure(e,r){return new LRLanguage(this.data,this.parser.configure(e),r||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function syntaxTree(n){let e=n.field(Language.state,!1);return e?e.tree:Tree.empty}class DocInput{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,r){let o=this.cursorPos-this.string.length;return e<o||r>=this.cursorPos?this.doc.sliceString(e,r):this.string.slice(e-o,r-o)}}let currentContext=null;class ParseContext{constructor(e,r,o=[],s,l,c,u,f){this.parser=e,this.state=r,this.fragments=o,this.tree=s,this.treeLen=l,this.viewport=c,this.skipped=u,this.scheduleOn=f,this.parse=null,this.tempSkipped=[]}static create(e,r,o){return new ParseContext(e,r,[],Tree.empty,0,o,[],null)}startParse(){return this.parser.startParse(new DocInput(this.state.doc),this.fragments)}work(e,r){return r!=null&&r>=this.state.doc.length&&(r=void 0),this.tree!=Tree.empty&&this.isDone(r??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var o;if(typeof e=="number"){let s=Date.now()+e;e=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),r!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>r)&&r<this.state.doc.length&&this.parse.stopAt(r);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(TreeFragment.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(o=this.parse.stoppedAt)!==null&&o!==void 0?o:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(r??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,r;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(r=this.parse.advance()););}),this.treeLen=e,this.tree=r,this.fragments=this.withoutTempSkipped(TreeFragment.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let r=currentContext;currentContext=this;try{return e()}finally{currentContext=r}}withoutTempSkipped(e){for(let r;r=this.tempSkipped.pop();)e=cutFragments(e,r.from,r.to);return e}changes(e,r){let{fragments:o,tree:s,treeLen:l,viewport:c,skipped:u}=this;if(this.takeTree(),!e.empty){let f=[];if(e.iterChangedRanges((d,g,m,v)=>f.push({fromA:d,toA:g,fromB:m,toB:v})),o=TreeFragment.applyChanges(o,f),s=Tree.empty,l=0,c={from:e.mapPos(c.from,-1),to:e.mapPos(c.to,1)},this.skipped.length){u=[];for(let d of this.skipped){let g=e.mapPos(d.from,1),m=e.mapPos(d.to,-1);g<m&&u.push({from:g,to:m})}}}return new ParseContext(this.parser,r,o,s,l,c,u,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let r=this.skipped.length;for(let o=0;o<this.skipped.length;o++){let{from:s,to:l}=this.skipped[o];s<e.to&&l>e.from&&(this.fragments=cutFragments(this.fragments,s,l),this.skipped.splice(o--,1))}return this.skipped.length>=r?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,r){this.skipped.push({from:e,to:r})}static getSkippingParser(e){return new class extends Parser{createParse(r,o,s){let l=s[0].from,c=s[s.length-1].to;return{parsedPos:l,advance(){let f=currentContext;if(f){for(let d of s)f.tempSkipped.push(d);e&&(f.scheduleOn=f.scheduleOn?Promise.all([f.scheduleOn,e]):e)}return this.parsedPos=c,new Tree(NodeType.none,[],[],c-l)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let r=this.fragments;return this.treeLen>=e&&r.length&&r[0].from==0&&r[0].to>=e}static get(){return currentContext}}function cutFragments(n,e,r){return TreeFragment.applyChanges(n,[{fromA:e,toA:r,fromB:e,toB:r}])}class LanguageState{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let r=this.context.changes(e.changes,e.state),o=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),r.viewport.to);return r.work(20,o)||r.takeTree(),new LanguageState(r)}static init(e){let r=Math.min(3e3,e.doc.length),o=ParseContext.create(e.facet(language).parser,e,{from:0,to:r});return o.work(20,r)||o.takeTree(),new LanguageState(o)}}Language.state=StateField.define({create:LanguageState.init,update(n,e){for(let r of e.effects)if(r.is(Language.setState))return r.value;return e.startState.facet(language)!=e.state.facet(language)?LanguageState.init(e.state):n.apply(e)}});let requestIdle=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(requestIdle=n=>{let e=-1,r=setTimeout(()=>{e=requestIdleCallback(n,{timeout:500-100})},100);return()=>e<0?clearTimeout(r):cancelIdleCallback(e)});const isInputPending=typeof navigator<"u"&&(!((_a$1=navigator.scheduling)===null||_a$1===void 0)&&_a$1.isInputPending)?()=>navigator.scheduling.isInputPending():null,parseWorker=ViewPlugin.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let r=this.view.state.field(Language.state).context;(r.updateViewport(e.view.viewport)||this.view.viewport.to>r.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(r)}scheduleWork(){if(this.working)return;let{state:e}=this.view,r=e.field(Language.state);(r.tree!=r.context.tree||!r.context.isDone(e.doc.length))&&(this.working=requestIdle(this.work))}work(e){this.working=null;let r=Date.now();if(this.chunkEnd<r&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=r+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:o,viewport:{to:s}}=this.view,l=o.field(Language.state);if(l.tree==l.context.tree&&l.context.isDone(s+1e5))return;let c=Date.now()+Math.min(this.chunkBudget,100,e&&!isInputPending?Math.max(25,e.timeRemaining()-5):1e9),u=l.context.treeLen<s&&o.doc.length>s+1e3,f=l.context.work(()=>isInputPending&&isInputPending()||Date.now()>c,s+(u?0:1e5));this.chunkBudget-=Date.now()-r,(f||this.chunkBudget<=0)&&(l.context.takeTree(),this.view.dispatch({effects:Language.setState.of(new LanguageState(l.context))})),this.chunkBudget>0&&!(f&&!u)&&this.scheduleWork(),this.checkAsyncSchedule(l.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(r=>logException(this.view.state,r)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),language=Facet.define({combine(n){return n.length?n[0]:null},enables:n=>[Language.state,parseWorker,EditorView.contentAttributes.compute([n],e=>{let r=e.facet(n);return r&&r.name?{"data-language":r.name}:{}})]});class LanguageSupport{constructor(e,r=[]){this.language=e,this.support=r,this.extension=[e,r]}}const indentService=Facet.define(),indentUnit=Facet.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(r=>r!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function getIndentUnit(n){let e=n.facet(indentUnit);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function indentString(n,e){let r="",o=n.tabSize,s=n.facet(indentUnit)[0];if(s=="	"){for(;e>=o;)r+="	",e-=o;s=" "}for(let l=0;l<e;l++)r+=s;return r}function getIndentation(n,e){n instanceof EditorState&&(n=new IndentContext(n));for(let o of n.state.facet(indentService)){let s=o(n,e);if(s!==void 0)return s}let r=syntaxTree(n.state);return r?syntaxIndentation(n,r,e):null}class IndentContext{constructor(e,r={}){this.state=e,this.options=r,this.unit=getIndentUnit(e)}lineAt(e,r=1){let o=this.state.doc.lineAt(e),{simulateBreak:s,simulateDoubleBreak:l}=this.options;return s!=null&&s>=o.from&&s<=o.to?l&&s==e?{text:"",from:e}:(r<0?s<e:s<=e)?{text:o.text.slice(s-o.from),from:s}:{text:o.text.slice(0,s-o.from),from:o.from}:o}textAfterPos(e,r=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:o,from:s}=this.lineAt(e,r);return o.slice(e-s,Math.min(o.length,e+100-s))}column(e,r=1){let{text:o,from:s}=this.lineAt(e,r),l=this.countColumn(o,e-s),c=this.options.overrideIndentation?this.options.overrideIndentation(s):-1;return c>-1&&(l+=c-this.countColumn(o,o.search(/\S|$/))),l}countColumn(e,r=e.length){return countColumn(e,this.state.tabSize,r)}lineIndent(e,r=1){let{text:o,from:s}=this.lineAt(e,r),l=this.options.overrideIndentation;if(l){let c=l(s);if(c>-1)return c}return this.countColumn(o,o.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const indentNodeProp=new NodeProp;function syntaxIndentation(n,e,r){return indentFrom(e.resolveInner(r).enterUnfinishedNodesBefore(r),r,n)}function ignoreClosed(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function indentStrategy(n){let e=n.type.prop(indentNodeProp);if(e)return e;let r=n.firstChild,o;if(r&&(o=r.type.prop(NodeProp.closedBy))){let s=n.lastChild,l=s&&o.indexOf(s.name)>-1;return c=>delimitedStrategy(c,!0,1,void 0,l&&!ignoreClosed(c)?s.from:void 0)}return n.parent==null?topIndent:null}function indentFrom(n,e,r){for(;n;n=n.parent){let o=indentStrategy(n);if(o)return o(TreeIndentContext.create(r,e,n))}return null}function topIndent(){return 0}class TreeIndentContext extends IndentContext{constructor(e,r,o){super(e.state,e.options),this.base=e,this.pos=r,this.node=o}static create(e,r,o){return new TreeIndentContext(e,r,o)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let e=this.state.doc.lineAt(this.node.from);for(;;){let r=this.node.resolve(e.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(isParent(r,this.node))break;e=this.state.doc.lineAt(r.from)}return this.lineIndent(e.from)}continue(){let e=this.node.parent;return e?indentFrom(e,this.pos,this.base):0}}function isParent(n,e){for(let r=e;r;r=r.parent)if(n==r)return!0;return!1}function bracketedAligned(n){let e=n.node,r=e.childAfter(e.from),o=e.lastChild;if(!r)return null;let s=n.options.simulateBreak,l=n.state.doc.lineAt(r.from),c=s==null||s<=l.from?l.to:Math.min(l.to,s);for(let u=r.to;;){let f=e.childAfter(u);if(!f||f==o)return null;if(!f.type.isSkipped)return f.from<c?r:null;u=f.to}}function delimitedStrategy(n,e,r,o,s){let l=n.textAfter,c=l.match(/^\s*/)[0].length,u=o&&l.slice(c,c+o.length)==o||s==n.pos+c,f=e?bracketedAligned(n):null;return f?u?n.column(f.from):n.column(f.to):n.baseIndent+(u?0:n.unit*r)}function continuedIndent({except:n,units:e=1}={}){return r=>{let o=n&&n.test(r.textAfter);return r.baseIndent+(o?0:e*r.unit)}}const DontIndentBeyond=200;function indentOnInput(){return EditorState.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let e=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!e.length)return n;let r=n.newDoc,{head:o}=n.newSelection.main,s=r.lineAt(o);if(o>s.from+DontIndentBeyond)return n;let l=r.sliceString(s.from,o);if(!e.some(d=>d.test(l)))return n;let{state:c}=n,u=-1,f=[];for(let{head:d}of c.selection.ranges){let g=c.doc.lineAt(d);if(g.from==u)continue;u=g.from;let m=getIndentation(c,g.from);if(m==null)continue;let v=/^\s*/.exec(g.text)[0],b=indentString(c,m);v!=b&&f.push({from:g.from,to:g.from+v.length,insert:b})}return f.length?[n,{changes:f,sequential:!0}]:n})}const foldService=Facet.define(),foldNodeProp=new NodeProp;function foldInside(n){let e=n.firstChild,r=n.lastChild;return e&&e.to<r.from?{from:e.to,to:r.type.isError?n.to:r.from}:null}function syntaxFolding(n,e,r){let o=syntaxTree(n);if(o.length<r)return null;let s=o.resolveInner(r,1),l=null;for(let c=s;c;c=c.parent){if(c.to<=r||c.from>r)continue;if(l&&c.from<e)break;let u=c.type.prop(foldNodeProp);if(u&&(c.to<o.length-50||o.length==n.doc.length||!isUnfinished(c))){let f=u(c,n);f&&f.from<=r&&f.from>=e&&f.to>r&&(l=f)}}return l}function isUnfinished(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function foldable(n,e,r){for(let o of n.facet(foldService)){let s=o(n,e,r);if(s)return s}return syntaxFolding(n,e,r)}function mapRange(n,e){let r=e.mapPos(n.from,1),o=e.mapPos(n.to,-1);return r>=o?void 0:{from:r,to:o}}const foldEffect=StateEffect.define({map:mapRange}),unfoldEffect=StateEffect.define({map:mapRange});function selectedLines(n){let e=[];for(let{head:r}of n.state.selection.ranges)e.some(o=>o.from<=r&&o.to>=r)||e.push(n.lineBlockAt(r));return e}const foldState=StateField.define({create(){return Decoration.none},update(n,e){n=n.map(e.changes);for(let r of e.effects)r.is(foldEffect)&&!foldExists(n,r.value.from,r.value.to)?n=n.update({add:[foldWidget.range(r.value.from,r.value.to)]}):r.is(unfoldEffect)&&(n=n.update({filter:(o,s)=>r.value.from!=o||r.value.to!=s,filterFrom:r.value.from,filterTo:r.value.to}));if(e.selection){let r=!1,{head:o}=e.selection.main;n.between(o,o,(s,l)=>{s<o&&l>o&&(r=!0)}),r&&(n=n.update({filterFrom:o,filterTo:o,filter:(s,l)=>l<=o||s>=o}))}return n},provide:n=>EditorView.decorations.from(n),toJSON(n,e){let r=[];return n.between(0,e.doc.length,(o,s)=>{r.push(o,s)}),r},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let r=0;r<n.length;){let o=n[r++],s=n[r++];if(typeof o!="number"||typeof s!="number")throw new RangeError("Invalid JSON for fold state");e.push(foldWidget.range(o,s))}return Decoration.set(e,!0)}});function findFold(n,e,r){var o;let s=null;return(o=n.field(foldState,!1))===null||o===void 0||o.between(e,r,(l,c)=>{(!s||s.from>l)&&(s={from:l,to:c})}),s}function foldExists(n,e,r){let o=!1;return n.between(e,e,(s,l)=>{s==e&&l==r&&(o=!0)}),o}function maybeEnable(n,e){return n.field(foldState,!1)?e:e.concat(StateEffect.appendConfig.of(codeFolding()))}const foldCode=n=>{for(let e of selectedLines(n)){let r=foldable(n.state,e.from,e.to);if(r)return n.dispatch({effects:maybeEnable(n.state,[foldEffect.of(r),announceFold(n,r)])}),!0}return!1},unfoldCode=n=>{if(!n.state.field(foldState,!1))return!1;let e=[];for(let r of selectedLines(n)){let o=findFold(n.state,r.from,r.to);o&&e.push(unfoldEffect.of(o),announceFold(n,o,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function announceFold(n,e,r=!0){let o=n.state.doc.lineAt(e.from).number,s=n.state.doc.lineAt(e.to).number;return EditorView.announce.of(`${n.state.phrase(r?"Folded lines":"Unfolded lines")} ${o} ${n.state.phrase("to")} ${s}.`)}const foldAll=n=>{let{state:e}=n,r=[];for(let o=0;o<e.doc.length;){let s=n.lineBlockAt(o),l=foldable(e,s.from,s.to);l&&r.push(foldEffect.of(l)),o=(l?n.lineBlockAt(l.to):s).to+1}return r.length&&n.dispatch({effects:maybeEnable(n.state,r)}),!!r.length},unfoldAll=n=>{let e=n.state.field(foldState,!1);if(!e||!e.size)return!1;let r=[];return e.between(0,n.state.doc.length,(o,s)=>{r.push(unfoldEffect.of({from:o,to:s}))}),n.dispatch({effects:r}),!0},foldKeymap=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:foldCode},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:unfoldCode},{key:"Ctrl-Alt-[",run:foldAll},{key:"Ctrl-Alt-]",run:unfoldAll}],defaultConfig={placeholderDOM:null,placeholderText:""},foldConfig=Facet.define({combine(n){return combineConfig(n,defaultConfig)}});function codeFolding(n){let e=[foldState,baseTheme$1$2];return n&&e.push(foldConfig.of(n)),e}const foldWidget=Decoration.replace({widget:new class extends WidgetType{toDOM(n){let{state:e}=n,r=e.facet(foldConfig),o=l=>{let c=n.lineBlockAt(n.posAtDOM(l.target)),u=findFold(n.state,c.from,c.to);u&&n.dispatch({effects:unfoldEffect.of(u)}),l.preventDefault()};if(r.placeholderDOM)return r.placeholderDOM(n,o);let s=document.createElement("span");return s.textContent=r.placeholderText,s.setAttribute("aria-label",e.phrase("folded code")),s.title=e.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=o,s}}}),foldGutterDefaults={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class FoldMarker extends GutterMarker{constructor(e,r){super(),this.config=e,this.open=r}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let r=document.createElement("span");return r.textContent=this.open?this.config.openText:this.config.closedText,r.title=e.state.phrase(this.open?"Fold line":"Unfold line"),r}}function foldGutter(n={}){let e=Object.assign(Object.assign({},foldGutterDefaults),n),r=new FoldMarker(e,!0),o=new FoldMarker(e,!1),s=ViewPlugin.fromClass(class{constructor(c){this.from=c.viewport.from,this.markers=this.buildMarkers(c)}update(c){(c.docChanged||c.viewportChanged||c.startState.facet(language)!=c.state.facet(language)||c.startState.field(foldState,!1)!=c.state.field(foldState,!1)||syntaxTree(c.startState)!=syntaxTree(c.state)||e.foldingChanged(c))&&(this.markers=this.buildMarkers(c.view))}buildMarkers(c){let u=new RangeSetBuilder;for(let f of c.viewportLineBlocks){let d=findFold(c.state,f.from,f.to)?o:foldable(c.state,f.from,f.to)?r:null;d&&u.add(f.from,f.from,d)}return u.finish()}}),{domEventHandlers:l}=e;return[s,gutter({class:"cm-foldGutter",markers(c){var u;return((u=c.plugin(s))===null||u===void 0?void 0:u.markers)||RangeSet.empty},initialSpacer(){return new FoldMarker(e,!1)},domEventHandlers:Object.assign(Object.assign({},l),{click:(c,u,f)=>{if(l.click&&l.click(c,u,f))return!0;let d=findFold(c.state,u.from,u.to);if(d)return c.dispatch({effects:unfoldEffect.of(d)}),!0;let g=foldable(c.state,u.from,u.to);return g?(c.dispatch({effects:foldEffect.of(g)}),!0):!1}})}),codeFolding()]}const baseTheme$1$2=EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class HighlightStyle{constructor(e,r){this.specs=e;let o;function s(u){let f=StyleModule.newName();return(o||(o=Object.create(null)))["."+f]=u,f}const l=typeof r.all=="string"?r.all:r.all?s(r.all):void 0,c=r.scope;this.scope=c instanceof Language?u=>u.prop(languageDataProp)==c.data:c?u=>u==c:void 0,this.style=tagHighlighter(e.map(u=>({tag:u.tag,class:u.class||s(Object.assign({},u,{tag:null}))})),{all:l}).style,this.module=o?new StyleModule(o):null,this.themeType=r.themeType}static define(e,r){return new HighlightStyle(e,r||{})}}const highlighterFacet=Facet.define(),fallbackHighlighter=Facet.define({combine(n){return n.length?[n[0]]:null}});function getHighlighters(n){let e=n.facet(highlighterFacet);return e.length?e:n.facet(fallbackHighlighter)}function syntaxHighlighting(n,e){let r=[treeHighlighter],o;return n instanceof HighlightStyle&&(n.module&&r.push(EditorView.styleModule.of(n.module)),o=n.themeType),e!=null&&e.fallback?r.push(fallbackHighlighter.of(n)):o?r.push(highlighterFacet.computeN([EditorView.darkTheme],s=>s.facet(EditorView.darkTheme)==(o=="dark")?[n]:[])):r.push(highlighterFacet.of(n)),r}class TreeHighlighter{constructor(e){this.markCache=Object.create(null),this.tree=syntaxTree(e.state),this.decorations=this.buildDeco(e,getHighlighters(e.state))}update(e){let r=syntaxTree(e.state),o=getHighlighters(e.state),s=o!=getHighlighters(e.startState);r.length<e.view.viewport.to&&!s&&r.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(r!=this.tree||e.viewportChanged||s)&&(this.tree=r,this.decorations=this.buildDeco(e.view,o))}buildDeco(e,r){if(!r||!this.tree.length)return Decoration.none;let o=new RangeSetBuilder;for(let{from:s,to:l}of e.visibleRanges)highlightTree(this.tree,r,(c,u,f)=>{o.add(c,u,this.markCache[f]||(this.markCache[f]=Decoration.mark({class:f})))},s,l);return o.finish()}}const treeHighlighter=Prec.high(ViewPlugin.fromClass(TreeHighlighter,{decorations:n=>n.decorations})),defaultHighlightStyle=HighlightStyle.define([{tag:tags.meta,color:"#404740"},{tag:tags.link,textDecoration:"underline"},{tag:tags.heading,textDecoration:"underline",fontWeight:"bold"},{tag:tags.emphasis,fontStyle:"italic"},{tag:tags.strong,fontWeight:"bold"},{tag:tags.strikethrough,textDecoration:"line-through"},{tag:tags.keyword,color:"#708"},{tag:[tags.atom,tags.bool,tags.url,tags.contentSeparator,tags.labelName],color:"#219"},{tag:[tags.literal,tags.inserted],color:"#164"},{tag:[tags.string,tags.deleted],color:"#a11"},{tag:[tags.regexp,tags.escape,tags.special(tags.string)],color:"#e40"},{tag:tags.definition(tags.variableName),color:"#00f"},{tag:tags.local(tags.variableName),color:"#30a"},{tag:[tags.typeName,tags.namespace],color:"#085"},{tag:tags.className,color:"#167"},{tag:[tags.special(tags.variableName),tags.macroName],color:"#256"},{tag:tags.definition(tags.propertyName),color:"#00c"},{tag:tags.comment,color:"#940"},{tag:tags.invalid,color:"#f00"}]),baseTheme$3=EditorView.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),DefaultScanDist=1e4,DefaultBrackets="()[]{}",bracketMatchingConfig=Facet.define({combine(n){return combineConfig(n,{afterCursor:!0,brackets:DefaultBrackets,maxScanDistance:DefaultScanDist,renderMatch:defaultRenderMatch})}}),matchingMark=Decoration.mark({class:"cm-matchingBracket"}),nonmatchingMark=Decoration.mark({class:"cm-nonmatchingBracket"});function defaultRenderMatch(n){let e=[],r=n.matched?matchingMark:nonmatchingMark;return e.push(r.range(n.start.from,n.start.to)),n.end&&e.push(r.range(n.end.from,n.end.to)),e}const bracketMatchingState=StateField.define({create(){return Decoration.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let r=[],o=e.state.facet(bracketMatchingConfig);for(let s of e.state.selection.ranges){if(!s.empty)continue;let l=matchBrackets(e.state,s.head,-1,o)||s.head>0&&matchBrackets(e.state,s.head-1,1,o)||o.afterCursor&&(matchBrackets(e.state,s.head,1,o)||s.head<e.state.doc.length&&matchBrackets(e.state,s.head+1,-1,o));l&&(r=r.concat(o.renderMatch(l,e.state)))}return Decoration.set(r,!0)},provide:n=>EditorView.decorations.from(n)}),bracketMatchingUnique=[bracketMatchingState,baseTheme$3];function bracketMatching(n={}){return[bracketMatchingConfig.of(n),bracketMatchingUnique]}const bracketMatchingHandle=new NodeProp;function matchingNodes(n,e,r){let o=n.prop(e<0?NodeProp.openedBy:NodeProp.closedBy);if(o)return o;if(n.name.length==1){let s=r.indexOf(n.name);if(s>-1&&s%2==(e<0?1:0))return[r[s+e]]}return null}function findHandle(n){let e=n.type.prop(bracketMatchingHandle);return e?e(n.node):n}function matchBrackets(n,e,r,o={}){let s=o.maxScanDistance||DefaultScanDist,l=o.brackets||DefaultBrackets,c=syntaxTree(n),u=c.resolveInner(e,r);for(let f=u;f;f=f.parent){let d=matchingNodes(f.type,r,l);if(d&&f.from<f.to){let g=findHandle(f);if(g&&(r>0?e>=g.from&&e<g.to:e>g.from&&e<=g.to))return matchMarkedBrackets(n,e,r,f,g,d,l)}}return matchPlainBrackets(n,e,r,c,u.type,s,l)}function matchMarkedBrackets(n,e,r,o,s,l,c){let u=o.parent,f={from:s.from,to:s.to},d=0,g=u==null?void 0:u.cursor();if(g&&(r<0?g.childBefore(o.from):g.childAfter(o.to)))do if(r<0?g.to<=o.from:g.from>=o.to){if(d==0&&l.indexOf(g.type.name)>-1&&g.from<g.to){let m=findHandle(g);return{start:f,end:m?{from:m.from,to:m.to}:void 0,matched:!0}}else if(matchingNodes(g.type,r,c))d++;else if(matchingNodes(g.type,-r,c)){if(d==0){let m=findHandle(g);return{start:f,end:m&&m.from<m.to?{from:m.from,to:m.to}:void 0,matched:!1}}d--}}while(r<0?g.prevSibling():g.nextSibling());return{start:f,matched:!1}}function matchPlainBrackets(n,e,r,o,s,l,c){let u=r<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),f=c.indexOf(u);if(f<0||f%2==0!=r>0)return null;let d={from:r<0?e-1:e,to:r>0?e+1:e},g=n.doc.iterRange(e,r>0?n.doc.length:0),m=0;for(let v=0;!g.next().done&&v<=l;){let b=g.value;r<0&&(v+=b.length);let k=e+v*r;for(let R=r>0?0:b.length-1,I=r>0?b.length:-1;R!=I;R+=r){let $=c.indexOf(b[R]);if(!($<0||o.resolveInner(k+R,1).type!=s))if($%2==0==r>0)m++;else{if(m==1)return{start:d,end:{from:k+R,to:k+R+1},matched:$>>1==f>>1};m--}}r>0&&(v+=b.length)}return g.done?{start:d,matched:!1}:null}const noTokens=Object.create(null),typeArray=[NodeType.none],warned=[],defaultTable=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])defaultTable[n]=createTokenType(noTokens,e);function warnForPart(n,e){warned.indexOf(n)>-1||(warned.push(n),console.warn(e))}function createTokenType(n,e){let r=null;for(let l of e.split(".")){let c=n[l]||tags[l];c?typeof c=="function"?r?r=c(r):warnForPart(l,`Modifier ${l} used at start of tag`):r?warnForPart(l,`Tag ${l} used as modifier`):r=c:warnForPart(l,`Unknown highlighting tag ${l}`)}if(!r)return 0;let o=e.replace(/ /g,"_"),s=NodeType.define({id:typeArray.length,name:o,props:[styleTags({[o]:r})]});return typeArray.push(s),s.id}const toggleComment=n=>{let{state:e}=n,r=e.doc.lineAt(e.selection.main.from),o=getConfig(n.state,r.from);return o.line?toggleLineComment(n):o.block?toggleBlockCommentByLine(n):!1};function command(n,e){return({state:r,dispatch:o})=>{if(r.readOnly)return!1;let s=n(e,r);return s?(o(r.update(s)),!0):!1}}const toggleLineComment=command(changeLineComment,0),toggleBlockComment=command(changeBlockComment,0),toggleBlockCommentByLine=command((n,e)=>changeBlockComment(n,e,selectedLineRanges(e)),0);function getConfig(n,e){let r=n.languageDataAt("commentTokens",e);return r.length?r[0]:{}}const SearchMargin=50;function findBlockComment(n,{open:e,close:r},o,s){let l=n.sliceDoc(o-SearchMargin,o),c=n.sliceDoc(s,s+SearchMargin),u=/\s*$/.exec(l)[0].length,f=/^\s*/.exec(c)[0].length,d=l.length-u;if(l.slice(d-e.length,d)==e&&c.slice(f,f+r.length)==r)return{open:{pos:o-u,margin:u&&1},close:{pos:s+f,margin:f&&1}};let g,m;s-o<=2*SearchMargin?g=m=n.sliceDoc(o,s):(g=n.sliceDoc(o,o+SearchMargin),m=n.sliceDoc(s-SearchMargin,s));let v=/^\s*/.exec(g)[0].length,b=/\s*$/.exec(m)[0].length,k=m.length-b-r.length;return g.slice(v,v+e.length)==e&&m.slice(k,k+r.length)==r?{open:{pos:o+v+e.length,margin:/\s/.test(g.charAt(v+e.length))?1:0},close:{pos:s-b-r.length,margin:/\s/.test(m.charAt(k-1))?1:0}}:null}function selectedLineRanges(n){let e=[];for(let r of n.selection.ranges){let o=n.doc.lineAt(r.from),s=r.to<=o.to?o:n.doc.lineAt(r.to),l=e.length-1;l>=0&&e[l].to>o.from?e[l].to=s.to:e.push({from:o.from,to:s.to})}return e}function changeBlockComment(n,e,r=e.selection.ranges){let o=r.map(l=>getConfig(e,l.from).block);if(!o.every(l=>l))return null;let s=r.map((l,c)=>findBlockComment(e,o[c],l.from,l.to));if(n!=2&&!s.every(l=>l))return{changes:e.changes(r.map((l,c)=>s[c]?[]:[{from:l.from,insert:o[c].open+" "},{from:l.to,insert:" "+o[c].close}]))};if(n!=1&&s.some(l=>l)){let l=[];for(let c=0,u;c<s.length;c++)if(u=s[c]){let f=o[c],{open:d,close:g}=u;l.push({from:d.pos-f.open.length,to:d.pos+d.margin},{from:g.pos-g.margin,to:g.pos+f.close.length})}return{changes:l}}return null}function changeLineComment(n,e,r=e.selection.ranges){let o=[],s=-1;for(let{from:l,to:c}of r){let u=o.length,f=1e9,d=getConfig(e,l).line;if(d){for(let g=l;g<=c;){let m=e.doc.lineAt(g);if(m.from>s&&(l==c||c>m.from)){s=m.from;let v=/^\s*/.exec(m.text)[0].length,b=v==m.length,k=m.text.slice(v,v+d.length)==d?v:-1;v<m.text.length&&v<f&&(f=v),o.push({line:m,comment:k,token:d,indent:v,empty:b,single:!1})}g=m.to+1}if(f<1e9)for(let g=u;g<o.length;g++)o[g].indent<o[g].line.text.length&&(o[g].indent=f);o.length==u+1&&(o[u].single=!0)}}if(n!=2&&o.some(l=>l.comment<0&&(!l.empty||l.single))){let l=[];for(let{line:u,token:f,indent:d,empty:g,single:m}of o)(m||!g)&&l.push({from:u.from+d,insert:f+" "});let c=e.changes(l);return{changes:c,selection:e.selection.map(c,1)}}else if(n!=1&&o.some(l=>l.comment>=0)){let l=[];for(let{line:c,comment:u,token:f}of o)if(u>=0){let d=c.from+u,g=d+f.length;c.text[g-c.from]==" "&&g++,l.push({from:d,to:g})}return{changes:l}}return null}const fromHistory=Annotation.define(),isolateHistory=Annotation.define(),invertedEffects=Facet.define(),historyConfig=Facet.define({combine(n){return combineConfig(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,r)=>r},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,r)=>(o,s)=>e(o,s)||r(o,s)})}});function changeEnd(n){let e=0;return n.iterChangedRanges((r,o)=>e=o),e}const historyField_=StateField.define({create(){return HistoryState.empty},update(n,e){let r=e.state.facet(historyConfig),o=e.annotation(fromHistory);if(o){let f=e.docChanged?EditorSelection.single(changeEnd(e.changes)):void 0,d=HistEvent.fromTransaction(e,f),g=o.side,m=g==0?n.undone:n.done;return d?m=updateBranch(m,m.length,r.minDepth,d):m=addSelection(m,e.startState.selection),new HistoryState(g==0?o.rest:m,g==0?m:o.rest)}let s=e.annotation(isolateHistory);if((s=="full"||s=="before")&&(n=n.isolate()),e.annotation(Transaction.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let l=HistEvent.fromTransaction(e),c=e.annotation(Transaction.time),u=e.annotation(Transaction.userEvent);return l?n=n.addChanges(l,c,u,r,e):e.selection&&(n=n.addSelection(e.startState.selection,c,u,r.newGroupDelay)),(s=="full"||s=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new HistoryState(n.done.map(HistEvent.fromJSON),n.undone.map(HistEvent.fromJSON))}});function history$1(n={}){return[historyField_,historyConfig.of(n),EditorView.domEventHandlers({beforeinput(e,r){let o=e.inputType=="historyUndo"?undo:e.inputType=="historyRedo"?redo:null;return o?(e.preventDefault(),o(r)):!1}})]}function cmd(n,e){return function({state:r,dispatch:o}){if(!e&&r.readOnly)return!1;let s=r.field(historyField_,!1);if(!s)return!1;let l=s.pop(n,r,e);return l?(o(l),!0):!1}}const undo=cmd(0,!1),redo=cmd(1,!1),undoSelection=cmd(0,!0),redoSelection=cmd(1,!0);class HistEvent{constructor(e,r,o,s,l){this.changes=e,this.effects=r,this.mapped=o,this.startSelection=s,this.selectionsAfter=l}setSelAfter(e){return new HistEvent(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,r,o;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(r=this.mapped)===null||r===void 0?void 0:r.toJSON(),startSelection:(o=this.startSelection)===null||o===void 0?void 0:o.toJSON(),selectionsAfter:this.selectionsAfter.map(s=>s.toJSON())}}static fromJSON(e){return new HistEvent(e.changes&&ChangeSet.fromJSON(e.changes),[],e.mapped&&ChangeDesc.fromJSON(e.mapped),e.startSelection&&EditorSelection.fromJSON(e.startSelection),e.selectionsAfter.map(EditorSelection.fromJSON))}static fromTransaction(e,r){let o=none$1;for(let s of e.startState.facet(invertedEffects)){let l=s(e);l.length&&(o=o.concat(l))}return!o.length&&e.changes.empty?null:new HistEvent(e.changes.invert(e.startState.doc),o,void 0,r||e.startState.selection,none$1)}static selection(e){return new HistEvent(void 0,none$1,void 0,void 0,e)}}function updateBranch(n,e,r,o){let s=e+1>r+20?e-r-1:0,l=n.slice(s,e);return l.push(o),l}function isAdjacent(n,e){let r=[],o=!1;return n.iterChangedRanges((s,l)=>r.push(s,l)),e.iterChangedRanges((s,l,c,u)=>{for(let f=0;f<r.length;){let d=r[f++],g=r[f++];u>=d&&c<=g&&(o=!0)}}),o}function eqSelectionShape(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((r,o)=>r.empty!=e.ranges[o].empty).length===0}function conc(n,e){return n.length?e.length?n.concat(e):n:e}const none$1=[],MaxSelectionsPerEvent=200;function addSelection(n,e){if(n.length){let r=n[n.length-1],o=r.selectionsAfter.slice(Math.max(0,r.selectionsAfter.length-MaxSelectionsPerEvent));return o.length&&o[o.length-1].eq(e)?n:(o.push(e),updateBranch(n,n.length-1,1e9,r.setSelAfter(o)))}else return[HistEvent.selection([e])]}function popSelection(n){let e=n[n.length-1],r=n.slice();return r[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),r}function addMappingToBranch(n,e){if(!n.length)return n;let r=n.length,o=none$1;for(;r;){let s=mapEvent(n[r-1],e,o);if(s.changes&&!s.changes.empty||s.effects.length){let l=n.slice(0,r);return l[r-1]=s,l}else e=s.mapped,r--,o=s.selectionsAfter}return o.length?[HistEvent.selection(o)]:none$1}function mapEvent(n,e,r){let o=conc(n.selectionsAfter.length?n.selectionsAfter.map(u=>u.map(e)):none$1,r);if(!n.changes)return HistEvent.selection(o);let s=n.changes.map(e),l=e.mapDesc(n.changes,!0),c=n.mapped?n.mapped.composeDesc(l):l;return new HistEvent(s,StateEffect.mapEffects(n.effects,e),c,n.startSelection.map(l),o)}const joinableUserEvent=/^(input\.type|delete)($|\.)/;class HistoryState{constructor(e,r,o=0,s=void 0){this.done=e,this.undone=r,this.prevTime=o,this.prevUserEvent=s}isolate(){return this.prevTime?new HistoryState(this.done,this.undone):this}addChanges(e,r,o,s,l){let c=this.done,u=c[c.length-1];return u&&u.changes&&!u.changes.empty&&e.changes&&(!o||joinableUserEvent.test(o))&&(!u.selectionsAfter.length&&r-this.prevTime<s.newGroupDelay&&s.joinToEvent(l,isAdjacent(u.changes,e.changes))||o=="input.type.compose")?c=updateBranch(c,c.length-1,s.minDepth,new HistEvent(e.changes.compose(u.changes),conc(e.effects,u.effects),u.mapped,u.startSelection,none$1)):c=updateBranch(c,c.length,s.minDepth,e),new HistoryState(c,none$1,r,o)}addSelection(e,r,o,s){let l=this.done.length?this.done[this.done.length-1].selectionsAfter:none$1;return l.length>0&&r-this.prevTime<s&&o==this.prevUserEvent&&o&&/^select($|\.)/.test(o)&&eqSelectionShape(l[l.length-1],e)?this:new HistoryState(addSelection(this.done,e),this.undone,r,o)}addMapping(e){return new HistoryState(addMappingToBranch(this.done,e),addMappingToBranch(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,r,o){let s=e==0?this.done:this.undone;if(s.length==0)return null;let l=s[s.length-1];if(o&&l.selectionsAfter.length)return r.update({selection:l.selectionsAfter[l.selectionsAfter.length-1],annotations:fromHistory.of({side:e,rest:popSelection(s)}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(l.changes){let c=s.length==1?none$1:s.slice(0,s.length-1);return l.mapped&&(c=addMappingToBranch(c,l.mapped)),r.update({changes:l.changes,selection:l.startSelection,effects:l.effects,annotations:fromHistory.of({side:e,rest:c}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}HistoryState.empty=new HistoryState(none$1,none$1);const historyKeymap=[{key:"Mod-z",run:undo,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:redo,preventDefault:!0},{linux:"Ctrl-Shift-z",run:redo,preventDefault:!0},{key:"Mod-u",run:undoSelection,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:redoSelection,preventDefault:!0}];function updateSel(n,e){return EditorSelection.create(n.ranges.map(e),n.mainIndex)}function setSel(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function moveSel({state:n,dispatch:e},r){let o=updateSel(n.selection,r);return o.eq(n.selection)?!1:(e(setSel(n,o)),!0)}function rangeEnd(n,e){return EditorSelection.cursor(e?n.to:n.from)}function cursorByChar(n,e){return moveSel(n,r=>r.empty?n.moveByChar(r,e):rangeEnd(r,e))}function ltrAtCursor(n){return n.textDirectionAt(n.state.selection.main.head)==Direction.LTR}const cursorCharLeft=n=>cursorByChar(n,!ltrAtCursor(n)),cursorCharRight=n=>cursorByChar(n,ltrAtCursor(n));function cursorByGroup(n,e){return moveSel(n,r=>r.empty?n.moveByGroup(r,e):rangeEnd(r,e))}const cursorGroupLeft=n=>cursorByGroup(n,!ltrAtCursor(n)),cursorGroupRight=n=>cursorByGroup(n,ltrAtCursor(n));function interestingNode(n,e,r){if(e.type.prop(r))return!0;let o=e.to-e.from;return o&&(o>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function moveBySyntax(n,e,r){let o=syntaxTree(n).resolveInner(e.head),s=r?NodeProp.closedBy:NodeProp.openedBy;for(let f=e.head;;){let d=r?o.childAfter(f):o.childBefore(f);if(!d)break;interestingNode(n,d,s)?o=d:f=r?d.to:d.from}let l=o.type.prop(s),c,u;return l&&(c=r?matchBrackets(n,o.from,1):matchBrackets(n,o.to,-1))&&c.matched?u=r?c.end.to:c.end.from:u=r?o.to:o.from,EditorSelection.cursor(u,r?-1:1)}const cursorSyntaxLeft=n=>moveSel(n,e=>moveBySyntax(n.state,e,!ltrAtCursor(n))),cursorSyntaxRight=n=>moveSel(n,e=>moveBySyntax(n.state,e,ltrAtCursor(n)));function cursorByLine(n,e){return moveSel(n,r=>{if(!r.empty)return rangeEnd(r,e);let o=n.moveVertically(r,e);return o.head!=r.head?o:n.moveToLineBoundary(r,e)})}const cursorLineUp=n=>cursorByLine(n,!1),cursorLineDown=n=>cursorByLine(n,!0);function pageInfo(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,r=0,o=0,s;if(e){for(let l of n.state.facet(EditorView.scrollMargins)){let c=l(n);c!=null&&c.top&&(r=Math.max(c==null?void 0:c.top,r)),c!=null&&c.bottom&&(o=Math.max(c==null?void 0:c.bottom,o))}s=n.scrollDOM.clientHeight-r-o}else s=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:r,marginBottom:o,selfScroll:e,height:Math.max(n.defaultLineHeight,s-5)}}function cursorByPage(n,e){let r=pageInfo(n),{state:o}=n,s=updateSel(o.selection,c=>c.empty?n.moveVertically(c,e,r.height):rangeEnd(c,e));if(s.eq(o.selection))return!1;let l;if(r.selfScroll){let c=n.coordsAtPos(o.selection.main.head),u=n.scrollDOM.getBoundingClientRect(),f=u.top+r.marginTop,d=u.bottom-r.marginBottom;c&&c.top>f&&c.bottom<d&&(l=EditorView.scrollIntoView(s.main.head,{y:"start",yMargin:c.top-f}))}return n.dispatch(setSel(o,s),{effects:l}),!0}const cursorPageUp=n=>cursorByPage(n,!1),cursorPageDown=n=>cursorByPage(n,!0);function moveByLineBoundary(n,e,r){let o=n.lineBlockAt(e.head),s=n.moveToLineBoundary(e,r);if(s.head==e.head&&s.head!=(r?o.to:o.from)&&(s=n.moveToLineBoundary(e,r,!1)),!r&&s.head==o.from&&o.length){let l=/^\s*/.exec(n.state.sliceDoc(o.from,Math.min(o.from+100,o.to)))[0].length;l&&e.head!=o.from+l&&(s=EditorSelection.cursor(o.from+l))}return s}const cursorLineBoundaryForward=n=>moveSel(n,e=>moveByLineBoundary(n,e,!0)),cursorLineBoundaryBackward=n=>moveSel(n,e=>moveByLineBoundary(n,e,!1)),cursorLineBoundaryLeft=n=>moveSel(n,e=>moveByLineBoundary(n,e,!ltrAtCursor(n))),cursorLineBoundaryRight=n=>moveSel(n,e=>moveByLineBoundary(n,e,ltrAtCursor(n))),cursorLineStart=n=>moveSel(n,e=>EditorSelection.cursor(n.lineBlockAt(e.head).from,1)),cursorLineEnd=n=>moveSel(n,e=>EditorSelection.cursor(n.lineBlockAt(e.head).to,-1));function toMatchingBracket(n,e,r){let o=!1,s=updateSel(n.selection,l=>{let c=matchBrackets(n,l.head,-1)||matchBrackets(n,l.head,1)||l.head>0&&matchBrackets(n,l.head-1,1)||l.head<n.doc.length&&matchBrackets(n,l.head+1,-1);if(!c||!c.end)return l;o=!0;let u=c.start.from==l.head?c.end.to:c.end.from;return r?EditorSelection.range(l.anchor,u):EditorSelection.cursor(u)});return o?(e(setSel(n,s)),!0):!1}const cursorMatchingBracket=({state:n,dispatch:e})=>toMatchingBracket(n,e,!1);function extendSel(n,e){let r=updateSel(n.state.selection,o=>{let s=e(o);return EditorSelection.range(o.anchor,s.head,s.goalColumn,s.bidiLevel||void 0)});return r.eq(n.state.selection)?!1:(n.dispatch(setSel(n.state,r)),!0)}function selectByChar(n,e){return extendSel(n,r=>n.moveByChar(r,e))}const selectCharLeft=n=>selectByChar(n,!ltrAtCursor(n)),selectCharRight=n=>selectByChar(n,ltrAtCursor(n));function selectByGroup(n,e){return extendSel(n,r=>n.moveByGroup(r,e))}const selectGroupLeft=n=>selectByGroup(n,!ltrAtCursor(n)),selectGroupRight=n=>selectByGroup(n,ltrAtCursor(n)),selectSyntaxLeft=n=>extendSel(n,e=>moveBySyntax(n.state,e,!ltrAtCursor(n))),selectSyntaxRight=n=>extendSel(n,e=>moveBySyntax(n.state,e,ltrAtCursor(n)));function selectByLine(n,e){return extendSel(n,r=>n.moveVertically(r,e))}const selectLineUp=n=>selectByLine(n,!1),selectLineDown=n=>selectByLine(n,!0);function selectByPage(n,e){return extendSel(n,r=>n.moveVertically(r,e,pageInfo(n).height))}const selectPageUp=n=>selectByPage(n,!1),selectPageDown=n=>selectByPage(n,!0),selectLineBoundaryForward=n=>extendSel(n,e=>moveByLineBoundary(n,e,!0)),selectLineBoundaryBackward=n=>extendSel(n,e=>moveByLineBoundary(n,e,!1)),selectLineBoundaryLeft=n=>extendSel(n,e=>moveByLineBoundary(n,e,!ltrAtCursor(n))),selectLineBoundaryRight=n=>extendSel(n,e=>moveByLineBoundary(n,e,ltrAtCursor(n))),selectLineStart=n=>extendSel(n,e=>EditorSelection.cursor(n.lineBlockAt(e.head).from)),selectLineEnd=n=>extendSel(n,e=>EditorSelection.cursor(n.lineBlockAt(e.head).to)),cursorDocStart=({state:n,dispatch:e})=>(e(setSel(n,{anchor:0})),!0),cursorDocEnd=({state:n,dispatch:e})=>(e(setSel(n,{anchor:n.doc.length})),!0),selectDocStart=({state:n,dispatch:e})=>(e(setSel(n,{anchor:n.selection.main.anchor,head:0})),!0),selectDocEnd=({state:n,dispatch:e})=>(e(setSel(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),selectAll=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),selectLine=({state:n,dispatch:e})=>{let r=selectedLineBlocks(n).map(({from:o,to:s})=>EditorSelection.range(o,Math.min(s+1,n.doc.length)));return e(n.update({selection:EditorSelection.create(r),userEvent:"select"})),!0},selectParentSyntax=({state:n,dispatch:e})=>{let r=updateSel(n.selection,o=>{var s;let l=syntaxTree(n).resolveInner(o.head,1);for(;!(l.from<o.from&&l.to>=o.to||l.to>o.to&&l.from<=o.from||!(!((s=l.parent)===null||s===void 0)&&s.parent));)l=l.parent;return EditorSelection.range(l.to,l.from)});return e(setSel(n,r)),!0},simplifySelection=({state:n,dispatch:e})=>{let r=n.selection,o=null;return r.ranges.length>1?o=EditorSelection.create([r.main]):r.main.empty||(o=EditorSelection.create([EditorSelection.cursor(r.main.head)])),o?(e(setSel(n,o)),!0):!1};function deleteBy(n,e){if(n.state.readOnly)return!1;let r="delete.selection",{state:o}=n,s=o.changeByRange(l=>{let{from:c,to:u}=l;if(c==u){let f=e(c);f<c?(r="delete.backward",f=skipAtomic(n,f,!1)):f>c&&(r="delete.forward",f=skipAtomic(n,f,!0)),c=Math.min(c,f),u=Math.max(u,f)}else c=skipAtomic(n,c,!1),u=skipAtomic(n,u,!0);return c==u?{range:l}:{changes:{from:c,to:u},range:EditorSelection.cursor(c)}});return s.changes.empty?!1:(n.dispatch(o.update(s,{scrollIntoView:!0,userEvent:r,effects:r=="delete.selection"?EditorView.announce.of(o.phrase("Selection deleted")):void 0})),!0)}function skipAtomic(n,e,r){if(n instanceof EditorView)for(let o of n.state.facet(EditorView.atomicRanges).map(s=>s(n)))o.between(e,e,(s,l)=>{s<e&&l>e&&(e=r?l:s)});return e}const deleteByChar=(n,e)=>deleteBy(n,r=>{let{state:o}=n,s=o.doc.lineAt(r),l,c;if(!e&&r>s.from&&r<s.from+200&&!/[^ \t]/.test(l=s.text.slice(0,r-s.from))){if(l[l.length-1]=="	")return r-1;let u=countColumn(l,o.tabSize),f=u%getIndentUnit(o)||getIndentUnit(o);for(let d=0;d<f&&l[l.length-1-d]==" ";d++)r--;c=r}else c=findClusterBreak(s.text,r-s.from,e,e)+s.from,c==r&&s.number!=(e?o.doc.lines:1)&&(c+=e?1:-1);return c}),deleteCharBackward=n=>deleteByChar(n,!1),deleteCharForward=n=>deleteByChar(n,!0),deleteByGroup=(n,e)=>deleteBy(n,r=>{let o=r,{state:s}=n,l=s.doc.lineAt(o),c=s.charCategorizer(o);for(let u=null;;){if(o==(e?l.to:l.from)){o==r&&l.number!=(e?s.doc.lines:1)&&(o+=e?1:-1);break}let f=findClusterBreak(l.text,o-l.from,e)+l.from,d=l.text.slice(Math.min(o,f)-l.from,Math.max(o,f)-l.from),g=c(d);if(u!=null&&g!=u)break;(d!=" "||o!=r)&&(u=g),o=f}return o}),deleteGroupBackward=n=>deleteByGroup(n,!1),deleteGroupForward=n=>deleteByGroup(n,!0),deleteToLineEnd=n=>deleteBy(n,e=>{let r=n.lineBlockAt(e).to;return e<r?r:Math.min(n.state.doc.length,e+1)}),deleteToLineStart=n=>deleteBy(n,e=>{let r=n.lineBlockAt(e).from;return e>r?r:Math.max(0,e-1)}),splitLine=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let r=n.changeByRange(o=>({changes:{from:o.from,to:o.to,insert:Text.of(["",""])},range:EditorSelection.cursor(o.from)}));return e(n.update(r,{scrollIntoView:!0,userEvent:"input"})),!0},transposeChars=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let r=n.changeByRange(o=>{if(!o.empty||o.from==0||o.from==n.doc.length)return{range:o};let s=o.from,l=n.doc.lineAt(s),c=s==l.from?s-1:findClusterBreak(l.text,s-l.from,!1)+l.from,u=s==l.to?s+1:findClusterBreak(l.text,s-l.from,!0)+l.from;return{changes:{from:c,to:u,insert:n.doc.slice(s,u).append(n.doc.slice(c,s))},range:EditorSelection.cursor(u)}});return r.changes.empty?!1:(e(n.update(r,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function selectedLineBlocks(n){let e=[],r=-1;for(let o of n.selection.ranges){let s=n.doc.lineAt(o.from),l=n.doc.lineAt(o.to);if(!o.empty&&o.to==l.from&&(l=n.doc.lineAt(o.to-1)),r>=s.number){let c=e[e.length-1];c.to=l.to,c.ranges.push(o)}else e.push({from:s.from,to:l.to,ranges:[o]});r=l.number+1}return e}function moveLine(n,e,r){if(n.readOnly)return!1;let o=[],s=[];for(let l of selectedLineBlocks(n)){if(r?l.to==n.doc.length:l.from==0)continue;let c=n.doc.lineAt(r?l.to+1:l.from-1),u=c.length+1;if(r){o.push({from:l.to,to:c.to},{from:l.from,insert:c.text+n.lineBreak});for(let f of l.ranges)s.push(EditorSelection.range(Math.min(n.doc.length,f.anchor+u),Math.min(n.doc.length,f.head+u)))}else{o.push({from:c.from,to:l.from},{from:l.to,insert:n.lineBreak+c.text});for(let f of l.ranges)s.push(EditorSelection.range(f.anchor-u,f.head-u))}}return o.length?(e(n.update({changes:o,scrollIntoView:!0,selection:EditorSelection.create(s,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const moveLineUp=({state:n,dispatch:e})=>moveLine(n,e,!1),moveLineDown=({state:n,dispatch:e})=>moveLine(n,e,!0);function copyLine(n,e,r){if(n.readOnly)return!1;let o=[];for(let s of selectedLineBlocks(n))r?o.push({from:s.from,insert:n.doc.slice(s.from,s.to)+n.lineBreak}):o.push({from:s.to,insert:n.lineBreak+n.doc.slice(s.from,s.to)});return e(n.update({changes:o,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const copyLineUp=({state:n,dispatch:e})=>copyLine(n,e,!1),copyLineDown=({state:n,dispatch:e})=>copyLine(n,e,!0),deleteLine=n=>{if(n.state.readOnly)return!1;let{state:e}=n,r=e.changes(selectedLineBlocks(e).map(({from:s,to:l})=>(s>0?s--:l<e.doc.length&&l++,{from:s,to:l}))),o=updateSel(e.selection,s=>n.moveVertically(s,!0)).map(r);return n.dispatch({changes:r,selection:o,scrollIntoView:!0,userEvent:"delete.line"}),!0};function isBetweenBrackets(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let r=syntaxTree(n).resolveInner(e),o=r.childBefore(e),s=r.childAfter(e),l;return o&&s&&o.to<=e&&s.from>=e&&(l=o.type.prop(NodeProp.closedBy))&&l.indexOf(s.name)>-1&&n.doc.lineAt(o.to).from==n.doc.lineAt(s.from).from?{from:o.to,to:s.from}:null}const insertNewlineAndIndent=newlineAndIndent(!1),insertBlankLine=newlineAndIndent(!0);function newlineAndIndent(n){return({state:e,dispatch:r})=>{if(e.readOnly)return!1;let o=e.changeByRange(s=>{let{from:l,to:c}=s,u=e.doc.lineAt(l),f=!n&&l==c&&isBetweenBrackets(e,l);n&&(l=c=(c<=u.to?u:e.doc.lineAt(c)).to);let d=new IndentContext(e,{simulateBreak:l,simulateDoubleBreak:!!f}),g=getIndentation(d,l);for(g==null&&(g=/^\s*/.exec(e.doc.lineAt(l).text)[0].length);c<u.to&&/\s/.test(u.text[c-u.from]);)c++;f?{from:l,to:c}=f:l>u.from&&l<u.from+100&&!/\S/.test(u.text.slice(0,l))&&(l=u.from);let m=["",indentString(e,g)];return f&&m.push(indentString(e,d.lineIndent(u.from,-1))),{changes:{from:l,to:c,insert:Text.of(m)},range:EditorSelection.cursor(l+1+m[1].length)}});return r(e.update(o,{scrollIntoView:!0,userEvent:"input"})),!0}}function changeBySelectedLine(n,e){let r=-1;return n.changeByRange(o=>{let s=[];for(let c=o.from;c<=o.to;){let u=n.doc.lineAt(c);u.number>r&&(o.empty||o.to>u.from)&&(e(u,s,o),r=u.number),c=u.to+1}let l=n.changes(s);return{changes:s,range:EditorSelection.range(l.mapPos(o.anchor,1),l.mapPos(o.head,1))}})}const indentSelection=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let r=Object.create(null),o=new IndentContext(n,{overrideIndentation:l=>{let c=r[l];return c??-1}}),s=changeBySelectedLine(n,(l,c,u)=>{let f=getIndentation(o,l.from);if(f==null)return;/\S/.test(l.text)||(f=0);let d=/^\s*/.exec(l.text)[0],g=indentString(n,f);(d!=g||u.from<l.from+d.length)&&(r[l.from]=f,c.push({from:l.from,to:l.from+d.length,insert:g}))});return s.changes.empty||e(n.update(s,{userEvent:"indent"})),!0},indentMore=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(changeBySelectedLine(n,(r,o)=>{o.push({from:r.from,insert:n.facet(indentUnit)})}),{userEvent:"input.indent"})),!0),indentLess=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(changeBySelectedLine(n,(r,o)=>{let s=/^\s*/.exec(r.text)[0];if(!s)return;let l=countColumn(s,n.tabSize),c=0,u=indentString(n,Math.max(0,l-getIndentUnit(n)));for(;c<s.length&&c<u.length&&s.charCodeAt(c)==u.charCodeAt(c);)c++;o.push({from:r.from+c,to:r.from+s.length,insert:u.slice(c)})}),{userEvent:"delete.dedent"})),!0),emacsStyleKeymap=[{key:"Ctrl-b",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Ctrl-f",run:cursorCharRight,shift:selectCharRight},{key:"Ctrl-p",run:cursorLineUp,shift:selectLineUp},{key:"Ctrl-n",run:cursorLineDown,shift:selectLineDown},{key:"Ctrl-a",run:cursorLineStart,shift:selectLineStart},{key:"Ctrl-e",run:cursorLineEnd,shift:selectLineEnd},{key:"Ctrl-d",run:deleteCharForward},{key:"Ctrl-h",run:deleteCharBackward},{key:"Ctrl-k",run:deleteToLineEnd},{key:"Ctrl-Alt-h",run:deleteGroupBackward},{key:"Ctrl-o",run:splitLine},{key:"Ctrl-t",run:transposeChars},{key:"Ctrl-v",run:cursorPageDown}],standardKeymap=[{key:"ArrowLeft",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:cursorGroupLeft,shift:selectGroupLeft,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:cursorLineBoundaryLeft,shift:selectLineBoundaryLeft,preventDefault:!0},{key:"ArrowRight",run:cursorCharRight,shift:selectCharRight,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:cursorGroupRight,shift:selectGroupRight,preventDefault:!0},{mac:"Cmd-ArrowRight",run:cursorLineBoundaryRight,shift:selectLineBoundaryRight,preventDefault:!0},{key:"ArrowUp",run:cursorLineUp,shift:selectLineUp,preventDefault:!0},{mac:"Cmd-ArrowUp",run:cursorDocStart,shift:selectDocStart},{mac:"Ctrl-ArrowUp",run:cursorPageUp,shift:selectPageUp},{key:"ArrowDown",run:cursorLineDown,shift:selectLineDown,preventDefault:!0},{mac:"Cmd-ArrowDown",run:cursorDocEnd,shift:selectDocEnd},{mac:"Ctrl-ArrowDown",run:cursorPageDown,shift:selectPageDown},{key:"PageUp",run:cursorPageUp,shift:selectPageUp},{key:"PageDown",run:cursorPageDown,shift:selectPageDown},{key:"Home",run:cursorLineBoundaryBackward,shift:selectLineBoundaryBackward,preventDefault:!0},{key:"Mod-Home",run:cursorDocStart,shift:selectDocStart},{key:"End",run:cursorLineBoundaryForward,shift:selectLineBoundaryForward,preventDefault:!0},{key:"Mod-End",run:cursorDocEnd,shift:selectDocEnd},{key:"Enter",run:insertNewlineAndIndent},{key:"Mod-a",run:selectAll},{key:"Backspace",run:deleteCharBackward,shift:deleteCharBackward},{key:"Delete",run:deleteCharForward},{key:"Mod-Backspace",mac:"Alt-Backspace",run:deleteGroupBackward},{key:"Mod-Delete",mac:"Alt-Delete",run:deleteGroupForward},{mac:"Mod-Backspace",run:deleteToLineStart},{mac:"Mod-Delete",run:deleteToLineEnd}].concat(emacsStyleKeymap.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),defaultKeymap=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:cursorSyntaxLeft,shift:selectSyntaxLeft},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:cursorSyntaxRight,shift:selectSyntaxRight},{key:"Alt-ArrowUp",run:moveLineUp},{key:"Shift-Alt-ArrowUp",run:copyLineUp},{key:"Alt-ArrowDown",run:moveLineDown},{key:"Shift-Alt-ArrowDown",run:copyLineDown},{key:"Escape",run:simplifySelection},{key:"Mod-Enter",run:insertBlankLine},{key:"Alt-l",mac:"Ctrl-l",run:selectLine},{key:"Mod-i",run:selectParentSyntax,preventDefault:!0},{key:"Mod-[",run:indentLess},{key:"Mod-]",run:indentMore},{key:"Mod-Alt-\\",run:indentSelection},{key:"Shift-Mod-k",run:deleteLine},{key:"Shift-Mod-\\",run:cursorMatchingBracket},{key:"Mod-/",run:toggleComment},{key:"Alt-A",run:toggleBlockComment}].concat(standardKeymap),indentWithTab={key:"Tab",run:indentMore,shift:indentLess};function crelt(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,r=arguments[1];if(r&&typeof r=="object"&&r.nodeType==null&&!Array.isArray(r)){for(var o in r)if(Object.prototype.hasOwnProperty.call(r,o)){var s=r[o];typeof s=="string"?n.setAttribute(o,s):s!=null&&(n[o]=s)}e++}for(;e<arguments.length;e++)add(n,arguments[e]);return n}function add(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var r=0;r<e.length;r++)add(n,e[r]);else throw new RangeError("Unsupported child node: "+e)}const basicNormalize=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class SearchCursor{constructor(e,r,o=0,s=e.length,l,c){this.test=c,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(o,s),this.bufferStart=o,this.normalize=l?u=>l(basicNormalize(u)):basicNormalize,this.query=this.normalize(r)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return codePointAt(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let r=fromCodePoint(e),o=this.bufferStart+this.bufferPos;this.bufferPos+=codePointSize(e);let s=this.normalize(r);for(let l=0,c=o;;l++){let u=s.charCodeAt(l),f=this.match(u,c);if(f)return this.value=f,this;if(l==s.length-1)break;c==o&&l<r.length&&r.charCodeAt(l)==u&&c++}}}match(e,r){let o=null;for(let s=0;s<this.matches.length;s+=2){let l=this.matches[s],c=!1;this.query.charCodeAt(l)==e&&(l==this.query.length-1?o={from:this.matches[s+1],to:r+1}:(this.matches[s]++,c=!0)),c||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?o={from:r,to:r+1}:this.matches.push(1,r)),o&&this.test&&!this.test(o.from,o.to,this.buffer,this.bufferPos)&&(o=null),o}}typeof Symbol<"u"&&(SearchCursor.prototype[Symbol.iterator]=function(){return this});const empty={from:-1,to:-1,match:/.*/.exec("")},baseFlags="gm"+(/x/.unicode==null?"":"u");class RegExpCursor{constructor(e,r,o,s=0,l=e.length){if(this.text=e,this.to=l,this.curLine="",this.done=!1,this.value=empty,/\\[sWDnr]|\n|\r|\[\^/.test(r))return new MultilineRegExpCursor(e,r,o,s,l);this.re=new RegExp(r,baseFlags+(o!=null&&o.ignoreCase?"i":"")),this.test=o==null?void 0:o.test,this.iter=e.iter();let c=e.lineAt(s);this.curLineStart=c.from,this.matchPos=toCharEnd(e,s),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let r=this.matchPos<=this.to&&this.re.exec(this.curLine);if(r){let o=this.curLineStart+r.index,s=o+r[0].length;if(this.matchPos=toCharEnd(this.text,s+(o==s?1:0)),o==this.curLineStart+this.curLine.length&&this.nextLine(),(o<s||o>this.value.to)&&(!this.test||this.test(o,s,r)))return this.value={from:o,to:s,match:r},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const flattened=new WeakMap;class FlattenedDoc{constructor(e,r){this.from=e,this.text=r}get to(){return this.from+this.text.length}static get(e,r,o){let s=flattened.get(e);if(!s||s.from>=o||s.to<=r){let u=new FlattenedDoc(r,e.sliceString(r,o));return flattened.set(e,u),u}if(s.from==r&&s.to==o)return s;let{text:l,from:c}=s;return c>r&&(l=e.sliceString(r,c)+l,c=r),s.to<o&&(l+=e.sliceString(s.to,o)),flattened.set(e,new FlattenedDoc(c,l)),new FlattenedDoc(r,l.slice(r-c,o-c))}}class MultilineRegExpCursor{constructor(e,r,o,s,l){this.text=e,this.to=l,this.done=!1,this.value=empty,this.matchPos=toCharEnd(e,s),this.re=new RegExp(r,baseFlags+(o!=null&&o.ignoreCase?"i":"")),this.test=o==null?void 0:o.test,this.flat=FlattenedDoc.get(e,s,this.chunkEnd(s+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,r=this.re.exec(this.flat.text);if(r&&!r[0]&&r.index==e&&(this.re.lastIndex=e+1,r=this.re.exec(this.flat.text)),r){let o=this.flat.from+r.index,s=o+r[0].length;if((this.flat.to>=this.to||r.index+r[0].length<=this.flat.text.length-10)&&(!this.test||this.test(o,s,r)))return this.value={from:o,to:s,match:r},this.matchPos=toCharEnd(this.text,s+(o==s?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=FlattenedDoc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(RegExpCursor.prototype[Symbol.iterator]=MultilineRegExpCursor.prototype[Symbol.iterator]=function(){return this});function validRegExp(n){try{return new RegExp(n,baseFlags),!0}catch{return!1}}function toCharEnd(n,e){if(e>=n.length)return e;let r=n.lineAt(e),o;for(;e<r.to&&(o=r.text.charCodeAt(e-r.from))>=56320&&o<57344;)e++;return e}function createLineDialog(n){let e=crelt("input",{class:"cm-textfield",name:"line"}),r=crelt("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),n.dispatch({effects:dialogEffect.of(!1)}),n.focus()):s.keyCode==13&&(s.preventDefault(),o())},onsubmit:s=>{s.preventDefault(),o()}},crelt("label",n.state.phrase("Go to line"),": ",e)," ",crelt("button",{class:"cm-button",type:"submit"},n.state.phrase("go")));function o(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!s)return;let{state:l}=n,c=l.doc.lineAt(l.selection.main.head),[,u,f,d,g]=s,m=d?+d.slice(1):0,v=f?+f:c.number;if(f&&g){let k=v/100;u&&(k=k*(u=="-"?-1:1)+c.number/l.doc.lines),v=Math.round(l.doc.lines*k)}else f&&u&&(v=v*(u=="-"?-1:1)+c.number);let b=l.doc.line(Math.max(1,Math.min(l.doc.lines,v)));n.dispatch({effects:dialogEffect.of(!1),selection:EditorSelection.cursor(b.from+Math.max(0,Math.min(m,b.length))),scrollIntoView:!0}),n.focus()}return{dom:r}}const dialogEffect=StateEffect.define(),dialogField=StateField.define({create(){return!0},update(n,e){for(let r of e.effects)r.is(dialogEffect)&&(n=r.value);return n},provide:n=>showPanel.from(n,e=>e?createLineDialog:null)}),gotoLine=n=>{let e=getPanel(n,createLineDialog);if(!e){let r=[dialogEffect.of(!0)];n.state.field(dialogField,!1)==null&&r.push(StateEffect.appendConfig.of([dialogField,baseTheme$1$1])),n.dispatch({effects:r}),e=getPanel(n,createLineDialog)}return e&&e.dom.querySelector("input").focus(),!0},baseTheme$1$1=EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),defaultHighlightOptions={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},highlightConfig=Facet.define({combine(n){return combineConfig(n,defaultHighlightOptions,{highlightWordAroundCursor:(e,r)=>e||r,minSelectionLength:Math.min,maxMatches:Math.min})}});function highlightSelectionMatches(n){let e=[defaultTheme,matchHighlighter];return n&&e.push(highlightConfig.of(n)),e}const matchDeco=Decoration.mark({class:"cm-selectionMatch"}),mainMatchDeco=Decoration.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function insideWordBoundaries(n,e,r,o){return(r==0||n(e.sliceDoc(r-1,r))!=CharCategory.Word)&&(o==e.doc.length||n(e.sliceDoc(o,o+1))!=CharCategory.Word)}function insideWord(n,e,r,o){return n(e.sliceDoc(r,r+1))==CharCategory.Word&&n(e.sliceDoc(o-1,o))==CharCategory.Word}const matchHighlighter=ViewPlugin.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(highlightConfig),{state:r}=n,o=r.selection;if(o.ranges.length>1)return Decoration.none;let s=o.main,l,c=null;if(s.empty){if(!e.highlightWordAroundCursor)return Decoration.none;let f=r.wordAt(s.head);if(!f)return Decoration.none;c=r.charCategorizer(s.head),l=r.sliceDoc(f.from,f.to)}else{let f=s.to-s.from;if(f<e.minSelectionLength||f>200)return Decoration.none;if(e.wholeWords){if(l=r.sliceDoc(s.from,s.to),c=r.charCategorizer(s.head),!(insideWordBoundaries(c,r,s.from,s.to)&&insideWord(c,r,s.from,s.to)))return Decoration.none}else if(l=r.sliceDoc(s.from,s.to).trim(),!l)return Decoration.none}let u=[];for(let f of n.visibleRanges){let d=new SearchCursor(r.doc,l,f.from,f.to);for(;!d.next().done;){let{from:g,to:m}=d.value;if((!c||insideWordBoundaries(c,r,g,m))&&(s.empty&&g<=s.from&&m>=s.to?u.push(mainMatchDeco.range(g,m)):(g>=s.to||m<=s.from)&&u.push(matchDeco.range(g,m)),u.length>e.maxMatches))return Decoration.none}}return Decoration.set(u)}},{decorations:n=>n.decorations}),defaultTheme=EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),selectWord=({state:n,dispatch:e})=>{let{selection:r}=n,o=EditorSelection.create(r.ranges.map(s=>n.wordAt(s.head)||EditorSelection.cursor(s.head)),r.mainIndex);return o.eq(r)?!1:(e(n.update({selection:o})),!0)};function findNextOccurrence(n,e){let{main:r,ranges:o}=n.selection,s=n.wordAt(r.head),l=s&&s.from==r.from&&s.to==r.to;for(let c=!1,u=new SearchCursor(n.doc,e,o[o.length-1].to);;)if(u.next(),u.done){if(c)return null;u=new SearchCursor(n.doc,e,0,Math.max(0,o[o.length-1].from-1)),c=!0}else{if(c&&o.some(f=>f.from==u.value.from))continue;if(l){let f=n.wordAt(u.value.from);if(!f||f.from!=u.value.from||f.to!=u.value.to)continue}return u.value}}const selectNextOccurrence=({state:n,dispatch:e})=>{let{ranges:r}=n.selection;if(r.some(l=>l.from===l.to))return selectWord({state:n,dispatch:e});let o=n.sliceDoc(r[0].from,r[0].to);if(n.selection.ranges.some(l=>n.sliceDoc(l.from,l.to)!=o))return!1;let s=findNextOccurrence(n,o);return s?(e(n.update({selection:n.selection.addRange(EditorSelection.range(s.from,s.to),!1),effects:EditorView.scrollIntoView(s.to)})),!0):!1},searchConfigFacet=Facet.define({combine(n){return combineConfig(n,{top:!1,caseSensitive:!1,literal:!1,wholeWord:!1,createPanel:e=>new SearchPanel(e),scrollToMatch:e=>EditorView.scrollIntoView(e)})}});class SearchQuery{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||validRegExp(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(r,o)=>o=="n"?`
`:o=="r"?"\r":o=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new RegExpQuery(this):new StringQuery(this)}getCursor(e,r=0,o){let s=e.doc?e:EditorState.create({doc:e});return o==null&&(o=s.doc.length),this.regexp?regexpCursor(this,s,r,o):stringCursor(this,s,r,o)}}class QueryType{constructor(e){this.spec=e}}function stringCursor(n,e,r,o){return new SearchCursor(e.doc,n.unquoted,r,o,n.caseSensitive?void 0:s=>s.toLowerCase(),n.wholeWord?stringWordTest(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function stringWordTest(n,e){return(r,o,s,l)=>((l>r||l+s.length<o)&&(l=Math.max(0,r-2),s=n.sliceString(l,Math.min(n.length,o+2))),(e(charBefore(s,r-l))!=CharCategory.Word||e(charAfter(s,r-l))!=CharCategory.Word)&&(e(charAfter(s,o-l))!=CharCategory.Word||e(charBefore(s,o-l))!=CharCategory.Word))}class StringQuery extends QueryType{constructor(e){super(e)}nextMatch(e,r,o){let s=stringCursor(this.spec,e,o,e.doc.length).nextOverlapping();return s.done&&(s=stringCursor(this.spec,e,0,r).nextOverlapping()),s.done?null:s.value}prevMatchInRange(e,r,o){for(let s=o;;){let l=Math.max(r,s-1e4-this.spec.unquoted.length),c=stringCursor(this.spec,e,l,s),u=null;for(;!c.nextOverlapping().done;)u=c.value;if(u)return u;if(l==r)return null;s-=1e4}}prevMatch(e,r,o){return this.prevMatchInRange(e,0,r)||this.prevMatchInRange(e,o,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,r){let o=stringCursor(this.spec,e,0,e.doc.length),s=[];for(;!o.next().done;){if(s.length>=r)return null;s.push(o.value)}return s}highlight(e,r,o,s){let l=stringCursor(this.spec,e,Math.max(0,r-this.spec.unquoted.length),Math.min(o+this.spec.unquoted.length,e.doc.length));for(;!l.next().done;)s(l.value.from,l.value.to)}}function regexpCursor(n,e,r,o){return new RegExpCursor(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:n.wholeWord?regexpWordTest(e.charCategorizer(e.selection.main.head)):void 0},r,o)}function charBefore(n,e){return n.slice(findClusterBreak(n,e,!1),e)}function charAfter(n,e){return n.slice(e,findClusterBreak(n,e))}function regexpWordTest(n){return(e,r,o)=>!o[0].length||(n(charBefore(o.input,o.index))!=CharCategory.Word||n(charAfter(o.input,o.index))!=CharCategory.Word)&&(n(charAfter(o.input,o.index+o[0].length))!=CharCategory.Word||n(charBefore(o.input,o.index+o[0].length))!=CharCategory.Word)}class RegExpQuery extends QueryType{nextMatch(e,r,o){let s=regexpCursor(this.spec,e,o,e.doc.length).next();return s.done&&(s=regexpCursor(this.spec,e,0,r).next()),s.done?null:s.value}prevMatchInRange(e,r,o){for(let s=1;;s++){let l=Math.max(r,o-s*1e4),c=regexpCursor(this.spec,e,l,o),u=null;for(;!c.next().done;)u=c.value;if(u&&(l==r||u.from>l+10))return u;if(l==r)return null}}prevMatch(e,r,o){return this.prevMatchInRange(e,0,r)||this.prevMatchInRange(e,o,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,(r,o)=>o=="$"?"$":o=="&"?e.match[0]:o!="0"&&+o<e.match.length?e.match[o]:r))}matchAll(e,r){let o=regexpCursor(this.spec,e,0,e.doc.length),s=[];for(;!o.next().done;){if(s.length>=r)return null;s.push(o.value)}return s}highlight(e,r,o,s){let l=regexpCursor(this.spec,e,Math.max(0,r-250),Math.min(o+250,e.doc.length));for(;!l.next().done;)s(l.value.from,l.value.to)}}const setSearchQuery=StateEffect.define(),togglePanel$1=StateEffect.define(),searchState=StateField.define({create(n){return new SearchState(defaultQuery(n).create(),null)},update(n,e){for(let r of e.effects)r.is(setSearchQuery)?n=new SearchState(r.value.create(),n.panel):r.is(togglePanel$1)&&(n=new SearchState(n.query,r.value?createSearchPanel:null));return n},provide:n=>showPanel.from(n,e=>e.panel)});class SearchState{constructor(e,r){this.query=e,this.panel=r}}const matchMark=Decoration.mark({class:"cm-searchMatch"}),selectedMatchMark=Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"}),searchHighlighter=ViewPlugin.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(searchState))}update(n){let e=n.state.field(searchState);(e!=n.startState.field(searchState)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return Decoration.none;let{view:r}=this,o=new RangeSetBuilder;for(let s=0,l=r.visibleRanges,c=l.length;s<c;s++){let{from:u,to:f}=l[s];for(;s<c-1&&f>l[s+1].from-2*250;)f=l[++s].to;n.highlight(r.state,u,f,(d,g)=>{let m=r.state.selection.ranges.some(v=>v.from==d&&v.to==g);o.add(d,g,m?selectedMatchMark:matchMark)})}return o.finish()}},{decorations:n=>n.decorations});function searchCommand(n){return e=>{let r=e.state.field(searchState,!1);return r&&r.query.spec.valid?n(e,r):openSearchPanel(e)}}const findNext=searchCommand((n,{query:e})=>{let{to:r}=n.state.selection.main,o=e.nextMatch(n.state,r,r);if(!o)return!1;let s=EditorSelection.single(o.from,o.to),l=n.state.facet(searchConfigFacet);return n.dispatch({selection:s,effects:[announceMatch(n,o),l.scrollToMatch(s.main)],userEvent:"select.search"}),!0}),findPrevious=searchCommand((n,{query:e})=>{let{state:r}=n,{from:o}=r.selection.main,s=e.prevMatch(r,o,o);if(!s)return!1;let l=EditorSelection.single(s.from,s.to),c=n.state.facet(searchConfigFacet);return n.dispatch({selection:l,effects:[announceMatch(n,s),c.scrollToMatch(l.main)],userEvent:"select.search"}),!0}),selectMatches=searchCommand((n,{query:e})=>{let r=e.matchAll(n.state,1e3);return!r||!r.length?!1:(n.dispatch({selection:EditorSelection.create(r.map(o=>EditorSelection.range(o.from,o.to))),userEvent:"select.search.matches"}),!0)}),selectSelectionMatches=({state:n,dispatch:e})=>{let r=n.selection;if(r.ranges.length>1||r.main.empty)return!1;let{from:o,to:s}=r.main,l=[],c=0;for(let u=new SearchCursor(n.doc,n.sliceDoc(o,s));!u.next().done;){if(l.length>1e3)return!1;u.value.from==o&&(c=l.length),l.push(EditorSelection.range(u.value.from,u.value.to))}return e(n.update({selection:EditorSelection.create(l,c),userEvent:"select.search.matches"})),!0},replaceNext=searchCommand((n,{query:e})=>{let{state:r}=n,{from:o,to:s}=r.selection.main;if(r.readOnly)return!1;let l=e.nextMatch(r,o,o);if(!l)return!1;let c=[],u,f,d=[];if(l.from==o&&l.to==s&&(f=r.toText(e.getReplacement(l)),c.push({from:l.from,to:l.to,insert:f}),l=e.nextMatch(r,l.from,l.to),d.push(EditorView.announce.of(r.phrase("replaced match on line $",r.doc.lineAt(o).number)+"."))),l){let g=c.length==0||c[0].from>=l.to?0:l.to-l.from-f.length;u=EditorSelection.single(l.from-g,l.to-g),d.push(announceMatch(n,l)),d.push(r.facet(searchConfigFacet).scrollToMatch(u.main))}return n.dispatch({changes:c,selection:u,effects:d,userEvent:"input.replace"}),!0}),replaceAll=searchCommand((n,{query:e})=>{if(n.state.readOnly)return!1;let r=e.matchAll(n.state,1e9).map(s=>{let{from:l,to:c}=s;return{from:l,to:c,insert:e.getReplacement(s)}});if(!r.length)return!1;let o=n.state.phrase("replaced $ matches",r.length)+".";return n.dispatch({changes:r,effects:EditorView.announce.of(o),userEvent:"input.replace.all"}),!0});function createSearchPanel(n){return n.state.facet(searchConfigFacet).createPanel(n)}function defaultQuery(n,e){var r,o,s,l;let c=n.selection.main,u=c.empty||c.to>c.from+100?"":n.sliceDoc(c.from,c.to);if(e&&!u)return e;let f=n.facet(searchConfigFacet);return new SearchQuery({search:((r=e==null?void 0:e.literal)!==null&&r!==void 0?r:f.literal)?u:u.replace(/\n/g,"\\n"),caseSensitive:(o=e==null?void 0:e.caseSensitive)!==null&&o!==void 0?o:f.caseSensitive,literal:(s=e==null?void 0:e.literal)!==null&&s!==void 0?s:f.literal,wholeWord:(l=e==null?void 0:e.wholeWord)!==null&&l!==void 0?l:f.wholeWord})}const openSearchPanel=n=>{let e=n.state.field(searchState,!1);if(e&&e.panel){let r=getPanel(n,createSearchPanel);if(!r)return!1;let o=r.dom.querySelector("[main-field]");if(o&&o!=n.root.activeElement){let s=defaultQuery(n.state,e.query.spec);s.valid&&n.dispatch({effects:setSearchQuery.of(s)}),o.focus(),o.select()}}else n.dispatch({effects:[togglePanel$1.of(!0),e?setSearchQuery.of(defaultQuery(n.state,e.query.spec)):StateEffect.appendConfig.of(searchExtensions)]});return!0},closeSearchPanel=n=>{let e=n.state.field(searchState,!1);if(!e||!e.panel)return!1;let r=getPanel(n,createSearchPanel);return r&&r.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:togglePanel$1.of(!1)}),!0},searchKeymap=[{key:"Mod-f",run:openSearchPanel,scope:"editor search-panel"},{key:"F3",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:closeSearchPanel,scope:"editor search-panel"},{key:"Mod-Shift-l",run:selectSelectionMatches},{key:"Alt-g",run:gotoLine},{key:"Mod-d",run:selectNextOccurrence,preventDefault:!0}];class SearchPanel{constructor(e){this.view=e;let r=this.query=e.state.field(searchState).query.spec;this.commit=this.commit.bind(this),this.searchField=crelt("input",{value:r.search,placeholder:phrase(e,"Find"),"aria-label":phrase(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=crelt("input",{value:r.replace,placeholder:phrase(e,"Replace"),"aria-label":phrase(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=crelt("input",{type:"checkbox",name:"case",form:"",checked:r.caseSensitive,onchange:this.commit}),this.reField=crelt("input",{type:"checkbox",name:"re",form:"",checked:r.regexp,onchange:this.commit}),this.wordField=crelt("input",{type:"checkbox",name:"word",form:"",checked:r.wholeWord,onchange:this.commit});function o(s,l,c){return crelt("button",{class:"cm-button",name:s,onclick:l,type:"button"},c)}this.dom=crelt("div",{onkeydown:s=>this.keydown(s),class:"cm-search"},[this.searchField,o("next",()=>findNext(e),[phrase(e,"next")]),o("prev",()=>findPrevious(e),[phrase(e,"previous")]),o("select",()=>selectMatches(e),[phrase(e,"all")]),crelt("label",null,[this.caseField,phrase(e,"match case")]),crelt("label",null,[this.reField,phrase(e,"regexp")]),crelt("label",null,[this.wordField,phrase(e,"by word")]),...e.state.readOnly?[]:[crelt("br"),this.replaceField,o("replace",()=>replaceNext(e),[phrase(e,"replace")]),o("replaceAll",()=>replaceAll(e),[phrase(e,"replace all")])],crelt("button",{name:"close",onclick:()=>closeSearchPanel(e),"aria-label":phrase(e,"close"),type:"button"},[""])])}commit(){let e=new SearchQuery({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:setSearchQuery.of(e)}))}keydown(e){runScopeHandlers(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?findPrevious:findNext)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),replaceNext(this.view))}update(e){for(let r of e.transactions)for(let o of r.effects)o.is(setSearchQuery)&&!o.value.eq(this.query)&&this.setQuery(o.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(searchConfigFacet).top}}function phrase(n,e){return n.state.phrase(e)}const AnnounceMargin=30,Break=/[\s\.,:;?!]/;function announceMatch(n,{from:e,to:r}){let o=n.state.doc.lineAt(e),s=n.state.doc.lineAt(r).to,l=Math.max(o.from,e-AnnounceMargin),c=Math.min(s,r+AnnounceMargin),u=n.state.sliceDoc(l,c);if(l!=o.from){for(let f=0;f<AnnounceMargin;f++)if(!Break.test(u[f+1])&&Break.test(u[f])){u=u.slice(f);break}}if(c!=s){for(let f=u.length-1;f>u.length-AnnounceMargin;f--)if(!Break.test(u[f-1])&&Break.test(u[f])){u=u.slice(0,f);break}}return EditorView.announce.of(`${n.state.phrase("current match")}. ${u} ${n.state.phrase("on line")} ${o.number}.`)}const baseTheme$2=EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),searchExtensions=[searchState,Prec.lowest(searchHighlighter),baseTheme$2];class CompletionContext{constructor(e,r,o){this.state=e,this.pos=r,this.explicit=o,this.abortListeners=[]}tokenBefore(e){let r=syntaxTree(this.state).resolveInner(this.pos,-1);for(;r&&e.indexOf(r.name)<0;)r=r.parent;return r?{from:r.from,to:this.pos,text:this.state.sliceDoc(r.from,this.pos),type:r.type}:null}matchBefore(e){let r=this.state.doc.lineAt(this.pos),o=Math.max(r.from,this.pos-250),s=r.text.slice(o-r.from,this.pos-r.from),l=s.search(ensureAnchor(e,!1));return l<0?null:{from:o+l,to:this.pos,text:s.slice(l)}}get aborted(){return this.abortListeners==null}addEventListener(e,r){e=="abort"&&this.abortListeners&&this.abortListeners.push(r)}}function toSet(n){let e=Object.keys(n).join(""),r=/\w/.test(e);return r&&(e=e.replace(/\w/g,"")),`[${r?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function prefixMatch(n){let e=Object.create(null),r=Object.create(null);for(let{label:s}of n){e[s[0]]=!0;for(let l=1;l<s.length;l++)r[s[l]]=!0}let o=toSet(e)+toSet(r)+"*$";return[new RegExp("^"+o),new RegExp(o)]}function completeFromList(n){let e=n.map(s=>typeof s=="string"?{label:s}:s),[r,o]=e.every(s=>/^\w+$/.test(s.label))?[/\w*$/,/\w+$/]:prefixMatch(e);return s=>{let l=s.matchBefore(o);return l||s.explicit?{from:l?l.from:s.pos,options:e,validFor:r}:null}}class Option{constructor(e,r,o,s){this.completion=e,this.source=r,this.match=o,this.score=s}}function cur(n){return n.selection.main.from}function ensureAnchor(n,e){var r;let{source:o}=n,s=e&&o[0]!="^",l=o[o.length-1]!="$";return!s&&!l?n:new RegExp(`${s?"^":""}(?:${o})${l?"$":""}`,(r=n.flags)!==null&&r!==void 0?r:n.ignoreCase?"i":"")}const pickedCompletion=Annotation.define();function insertCompletionText(n,e,r,o){let{main:s}=n.selection,l=o-r;return Object.assign(Object.assign({},n.changeByRange(c=>c!=s&&l&&n.sliceDoc(c.from-l,c.from+o-s.from)!=n.sliceDoc(r,o)?{range:c}:{changes:{from:c.from-l,to:o==s.from?c.to:c.from+o-s.from,insert:e},range:EditorSelection.cursor(c.from-l+e.length)})),{userEvent:"input.complete"})}function applyCompletion(n,e){const r=e.completion.apply||e.completion.label;let o=e.source;typeof r=="string"?n.dispatch(Object.assign(Object.assign({},insertCompletionText(n.state,r,o.from,o.to)),{annotations:pickedCompletion.of(e.completion)})):r(n,e.completion,o.from,o.to)}const SourceCache=new WeakMap;function asSource(n){if(!Array.isArray(n))return n;let e=SourceCache.get(n);return e||SourceCache.set(n,e=completeFromList(n)),e}const startCompletionEffect=StateEffect.define(),closeCompletionEffect=StateEffect.define();class FuzzyMatcher{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let r=0;r<e.length;){let o=codePointAt(e,r),s=codePointSize(o);this.chars.push(o);let l=e.slice(r,r+s),c=l.toUpperCase();this.folded.push(codePointAt(c==l?l.toLowerCase():c,0)),r+=s}this.astral=e.length!=this.chars.length}match(e){if(this.pattern.length==0)return[0];if(e.length<this.pattern.length)return null;let{chars:r,folded:o,any:s,precise:l,byWord:c}=this;if(r.length==1){let Y=codePointAt(e,0),oe=codePointSize(Y),G=oe==e.length?0:-100;if(Y!=r[0])if(Y==o[0])G+=-200;else return null;return[G,0,oe]}let u=e.indexOf(this.pattern);if(u==0)return[e.length==this.pattern.length?0:-100,0,this.pattern.length];let f=r.length,d=0;if(u<0){for(let Y=0,oe=Math.min(e.length,200);Y<oe&&d<f;){let G=codePointAt(e,Y);(G==r[d]||G==o[d])&&(s[d++]=Y),Y+=codePointSize(G)}if(d<f)return null}let g=0,m=0,v=!1,b=0,k=-1,R=-1,I=/[a-z]/.test(e),$=!0;for(let Y=0,oe=Math.min(e.length,200),G=0;Y<oe&&m<f;){let q=codePointAt(e,Y);u<0&&(g<f&&q==r[g]&&(l[g++]=Y),b<f&&(q==r[b]||q==o[b]?(b==0&&(k=Y),R=Y+1,b++):b=0));let ne,K=q<255?q>=48&&q<=57||q>=97&&q<=122?2:q>=65&&q<=90?1:0:(ne=fromCodePoint(q))!=ne.toLowerCase()?1:ne!=ne.toUpperCase()?2:0;(!Y||K==1&&I||G==0&&K!=0)&&(r[m]==q||o[m]==q&&(v=!0)?c[m++]=Y:c.length&&($=!1)),G=K,Y+=codePointSize(q)}return m==f&&c[0]==0&&$?this.result(-100+(v?-200:0),c,e):b==f&&k==0?[-200-e.length+(R==e.length?0:-100),0,R]:u>-1?[-700-e.length,u,u+this.pattern.length]:b==f?[-200+-700-e.length,k,R]:m==f?this.result(-100+(v?-200:0)+-700+($?0:-1100),c,e):r.length==2?null:this.result((s[0]?-700:0)+-200+-1100,s,e)}result(e,r,o){let s=[e-o.length],l=1;for(let c of r){let u=c+(this.astral?codePointSize(codePointAt(o,c)):1);l>1&&s[l-1]==c?s[l-1]=u:(s[l++]=c,s[l++]=u)}return s}}const completionConfig=Facet.define({combine(n){return combineConfig(n,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:defaultPositionInfo,compareCompletions:(e,r)=>e.label.localeCompare(r.label),interactionDelay:75},{defaultKeymap:(e,r)=>e&&r,closeOnBlur:(e,r)=>e&&r,icons:(e,r)=>e&&r,tooltipClass:(e,r)=>o=>joinClass(e(o),r(o)),optionClass:(e,r)=>o=>joinClass(e(o),r(o)),addToOptions:(e,r)=>e.concat(r)})}});function joinClass(n,e){return n?e?n+" "+e:n:e}function defaultPositionInfo(n,e,r,o,s){let l=n.textDirection==Direction.RTL,c=l,u=!1,f="top",d,g,m=e.left-s.left,v=s.right-e.right,b=o.right-o.left,k=o.bottom-o.top;if(c&&m<Math.min(b,v)?c=!1:!c&&v<Math.min(b,m)&&(c=!0),b<=(c?m:v))d=Math.max(s.top,Math.min(r.top,s.bottom-k))-e.top,g=Math.min(400,c?m:v);else{u=!0,g=Math.min(400,(l?e.right:s.right-e.left)-30);let R=s.bottom-e.bottom;R>=k||R>e.top?d=r.bottom-e.top:(f="bottom",d=e.bottom-r.top)}return{style:`${f}: ${d}px; max-width: ${g}px`,class:"cm-completionInfo-"+(u?l?"left-narrow":"right-narrow":c?"left":"right")}}function optionContent(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(r){let o=document.createElement("div");return o.classList.add("cm-completionIcon"),r.type&&o.classList.add(...r.type.split(/\s+/g).map(s=>"cm-completionIcon-"+s)),o.setAttribute("aria-hidden","true"),o},position:20}),e.push({render(r,o,s){let l=document.createElement("span");l.className="cm-completionLabel";let{label:c}=r,u=0;for(let f=1;f<s.length;){let d=s[f++],g=s[f++];d>u&&l.appendChild(document.createTextNode(c.slice(u,d)));let m=l.appendChild(document.createElement("span"));m.appendChild(document.createTextNode(c.slice(d,g))),m.className="cm-completionMatchedText",u=g}return u<c.length&&l.appendChild(document.createTextNode(c.slice(u))),l},position:50},{render(r){if(!r.detail)return null;let o=document.createElement("span");return o.className="cm-completionDetail",o.textContent=r.detail,o},position:80}),e.sort((r,o)=>r.position-o.position).map(r=>r.render)}function rangeAroundSelected(n,e,r){if(n<=r)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let s=Math.floor(e/r);return{from:s*r,to:(s+1)*r}}let o=Math.floor((n-e)/r);return{from:n-(o+1)*r,to:n-o*r}}class CompletionTooltip{constructor(e,r){this.view=e,this.stateField=r,this.info=null,this.placeInfoReq={read:()=>this.measureInfo(),write:u=>this.placeInfo(u),key:this},this.space=null,this.currentClass="";let o=e.state.field(r),{options:s,selected:l}=o.open,c=e.state.facet(completionConfig);this.optionContent=optionContent(c),this.optionClass=c.optionClass,this.tooltipClass=c.tooltipClass,this.range=rangeAroundSelected(s.length,l,c.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",u=>{for(let f=u.target,d;f&&f!=this.dom;f=f.parentNode)if(f.nodeName=="LI"&&(d=/-(\d+)$/.exec(f.id))&&+d[1]<s.length){applyCompletion(e,s[+d[1]]),u.preventDefault();return}}),this.dom.addEventListener("focusout",u=>{let f=e.state.field(this.stateField,!1);f&&f.tooltip&&e.state.facet(completionConfig).closeOnBlur&&u.relatedTarget!=e.contentDOM&&e.dispatch({effects:closeCompletionEffect.of(null)})}),this.list=this.dom.appendChild(this.createListBox(s,o.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}mount(){this.updateSel()}update(e){var r,o,s;let l=e.state.field(this.stateField),c=e.startState.field(this.stateField);this.updateTooltipClass(e.state),l!=c&&(this.updateSel(),((r=l.open)===null||r===void 0?void 0:r.disabled)!=((o=c.open)===null||o===void 0?void 0:o.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!(!((s=l.open)===null||s===void 0)&&s.disabled)))}updateTooltipClass(e){let r=this.tooltipClass(e);if(r!=this.currentClass){for(let o of this.currentClass.split(" "))o&&this.dom.classList.remove(o);for(let o of r.split(" "))o&&this.dom.classList.add(o);this.currentClass=r}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),r=e.open;if((r.selected>-1&&r.selected<this.range.from||r.selected>=this.range.to)&&(this.range=rangeAroundSelected(r.options.length,r.selected,this.view.state.facet(completionConfig).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(r.options,e.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})),this.updateSelectedOption(r.selected)){this.info&&(this.info.remove(),this.info=null);let{completion:o}=r.options[r.selected],{info:s}=o;if(!s)return;let l=typeof s=="string"?document.createTextNode(s):s(o);if(!l)return;"then"in l?l.then(c=>{c&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(c)}).catch(c=>logException(this.view.state,c,"completion info")):this.addInfoPane(l)}}addInfoPane(e){let r=this.info=document.createElement("div");r.className="cm-tooltip cm-completionInfo",r.appendChild(e),this.dom.appendChild(r),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let r=null;for(let o=this.list.firstChild,s=this.range.from;o;o=o.nextSibling,s++)o.nodeName!="LI"||!o.id?s--:s==e?o.hasAttribute("aria-selected")||(o.setAttribute("aria-selected","true"),r=o):o.hasAttribute("aria-selected")&&o.removeAttribute("aria-selected");return r&&scrollIntoView(this.list,r),r}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let r=this.dom.getBoundingClientRect(),o=this.info.getBoundingClientRect(),s=e.getBoundingClientRect(),l=this.space;if(!l){let c=this.dom.ownerDocument.defaultView||window;l={left:0,top:0,right:c.innerWidth,bottom:c.innerHeight}}return s.top>Math.min(l.bottom,r.bottom)-10||s.bottom<Math.max(l.top,r.top)+10?null:this.view.state.facet(completionConfig).positionInfo(this.view,r,s,o,l)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,r,o){const s=document.createElement("ul");s.id=r,s.setAttribute("role","listbox"),s.setAttribute("aria-expanded","true"),s.setAttribute("aria-label",this.view.state.phrase("Completions"));let l=null;for(let c=o.from;c<o.to;c++){let{completion:u,match:f}=e[c],{section:d}=u;if(d){let v=typeof d=="string"?d:d.name;if(v!=l&&(c>o.from||o.from==0))if(l=v,typeof d!="string"&&d.header)s.appendChild(d.header(d));else{let b=s.appendChild(document.createElement("completion-section"));b.textContent=v}}const g=s.appendChild(document.createElement("li"));g.id=r+"-"+c,g.setAttribute("role","option");let m=this.optionClass(u);m&&(g.className=m);for(let v of this.optionContent){let b=v(u,this.view.state,f);b&&g.appendChild(b)}}return o.from&&s.classList.add("cm-completionListIncompleteTop"),o.to<e.length&&s.classList.add("cm-completionListIncompleteBottom"),s}}function completionTooltip(n){return e=>new CompletionTooltip(e,n)}function scrollIntoView(n,e){let r=n.getBoundingClientRect(),o=e.getBoundingClientRect();o.top<r.top?n.scrollTop-=r.top-o.top:o.bottom>r.bottom&&(n.scrollTop+=o.bottom-r.bottom)}function score(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function sortOptions(n,e){let r=[],o=null,s=f=>{r.push(f);let{section:d}=f.completion;if(d){o||(o=[]);let g=typeof d=="string"?d:d.name;o.some(m=>m.name==g)||o.push(typeof d=="string"?{name:g}:d)}};for(let f of n)if(f.hasResult())if(f.result.filter===!1){let d=f.result.getMatch;for(let g of f.result.options){let m=[1e9-r.length];if(d)for(let v of d(g))m.push(v);s(new Option(g,f,m,m[0]))}}else{let d=new FuzzyMatcher(e.sliceDoc(f.from,f.to)),g;for(let m of f.result.options)(g=d.match(m.label))&&s(new Option(m,f,g,g[0]+(m.boost||0)))}if(o){let f=Object.create(null),d=0,g=(m,v)=>{var b,k;return((b=m.rank)!==null&&b!==void 0?b:1e9)-((k=v.rank)!==null&&k!==void 0?k:1e9)||(m.name<v.name?-1:1)};for(let m of o.sort(g))d-=1e5,f[m.name]=d;for(let m of r){let{section:v}=m.completion;v&&(m.score+=f[typeof v=="string"?v:v.name])}}let l=[],c=null,u=e.facet(completionConfig).compareCompletions;for(let f of r.sort((d,g)=>g.score-d.score||u(d.completion,g.completion)))!c||c.label!=f.completion.label||c.detail!=f.completion.detail||c.type!=null&&f.completion.type!=null&&c.type!=f.completion.type||c.apply!=f.completion.apply?l.push(f):score(f.completion)>score(c)&&(l[l.length-1]=f),c=f.completion;return l}class CompletionDialog{constructor(e,r,o,s,l,c){this.options=e,this.attrs=r,this.tooltip=o,this.timestamp=s,this.selected=l,this.disabled=c}setSelected(e,r){return e==this.selected||e>=this.options.length?this:new CompletionDialog(this.options,makeAttrs(r,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,r,o,s,l){let c=sortOptions(e,r);if(!c.length)return s&&e.some(f=>f.state==1)?new CompletionDialog(s.options,s.attrs,s.tooltip,s.timestamp,s.selected,!0):null;let u=r.facet(completionConfig).selectOnOpen?0:-1;if(s&&s.selected!=u&&s.selected!=-1){let f=s.options[s.selected].completion;for(let d=0;d<c.length;d++)if(c[d].completion==f){u=d;break}}return new CompletionDialog(c,makeAttrs(o,u),{pos:e.reduce((f,d)=>d.hasResult()?Math.min(f,d.from):f,1e8),create:completionTooltip(completionState),above:l.aboveCursor},s?s.timestamp:Date.now(),u,!1)}map(e){return new CompletionDialog(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class CompletionState{constructor(e,r,o){this.active=e,this.id=r,this.open=o}static start(){return new CompletionState(none,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:r}=e,o=r.facet(completionConfig),l=(o.override||r.languageDataAt("autocomplete",cur(r)).map(asSource)).map(u=>(this.active.find(d=>d.source==u)||new ActiveSource(u,this.active.some(d=>d.state!=0)?1:0)).update(e,o));l.length==this.active.length&&l.every((u,f)=>u==this.active[f])&&(l=this.active);let c=this.open;c&&e.docChanged&&(c=c.map(e.changes)),e.selection||l.some(u=>u.hasResult()&&e.changes.touchesRange(u.from,u.to))||!sameResults(l,this.active)?c=CompletionDialog.build(l,r,this.id,c,o):c&&c.disabled&&!l.some(u=>u.state==1)&&(c=null),!c&&l.every(u=>u.state!=1)&&l.some(u=>u.hasResult())&&(l=l.map(u=>u.hasResult()?new ActiveSource(u.source,0):u));for(let u of e.effects)u.is(setSelectedEffect)&&(c=c&&c.setSelected(u.value,this.id));return l==this.active&&c==this.open?this:new CompletionState(l,this.id,c)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:baseAttrs}}function sameResults(n,e){if(n==e)return!0;for(let r=0,o=0;;){for(;r<n.length&&!n[r].hasResult;)r++;for(;o<e.length&&!e[o].hasResult;)o++;let s=r==n.length,l=o==e.length;if(s||l)return s==l;if(n[r++].result!=e[o++].result)return!1}}const baseAttrs={"aria-autocomplete":"list"};function makeAttrs(n,e){let r={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(r["aria-activedescendant"]=n+"-"+e),r}const none=[];function getUserEvent(n){return n.isUserEvent("input.type")?"input":n.isUserEvent("delete.backward")?"delete":null}class ActiveSource{constructor(e,r,o=-1){this.source=e,this.state=r,this.explicitPos=o}hasResult(){return!1}update(e,r){let o=getUserEvent(e),s=this;o?s=s.handleUserEvent(e,o,r):e.docChanged?s=s.handleChange(e):e.selection&&s.state!=0&&(s=new ActiveSource(s.source,0));for(let l of e.effects)if(l.is(startCompletionEffect))s=new ActiveSource(s.source,1,l.value?cur(e.state):-1);else if(l.is(closeCompletionEffect))s=new ActiveSource(s.source,0);else if(l.is(setActiveEffect))for(let c of l.value)c.source==s.source&&(s=c);return s}handleUserEvent(e,r,o){return r=="delete"||!o.activateOnTyping?this.map(e.changes):new ActiveSource(this.source,1)}handleChange(e){return e.changes.touchesRange(cur(e.startState))?new ActiveSource(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new ActiveSource(this.source,this.state,e.mapPos(this.explicitPos))}}class ActiveResult extends ActiveSource{constructor(e,r,o,s,l){super(e,2,r),this.result=o,this.from=s,this.to=l}hasResult(){return!0}handleUserEvent(e,r,o){var s;let l=e.changes.mapPos(this.from),c=e.changes.mapPos(this.to,1),u=cur(e.state);if((this.explicitPos<0?u<=l:u<this.from)||u>c||r=="delete"&&cur(e.startState)==this.from)return new ActiveSource(this.source,r=="input"&&o.activateOnTyping?1:0);let f=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos),d;return checkValid(this.result.validFor,e.state,l,c)?new ActiveResult(this.source,f,this.result,l,c):this.result.update&&(d=this.result.update(this.result,l,c,new CompletionContext(e.state,u,f>=0)))?new ActiveResult(this.source,f,d,d.from,(s=d.to)!==null&&s!==void 0?s:cur(e.state)):new ActiveSource(this.source,1,f)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new ActiveSource(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new ActiveResult(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1))}}function checkValid(n,e,r,o){if(!n)return!1;let s=e.sliceDoc(r,o);return typeof n=="function"?n(s,r,o,e):ensureAnchor(n,!0).test(s)}const setActiveEffect=StateEffect.define({map(n,e){return n.map(r=>r.map(e))}}),setSelectedEffect=StateEffect.define(),completionState=StateField.define({create(){return CompletionState.start()},update(n,e){return n.update(e)},provide:n=>[showTooltip.from(n,e=>e.tooltip),EditorView.contentAttributes.from(n,e=>e.attrs)]});function moveCompletionSelection(n,e="option"){return r=>{let o=r.state.field(completionState,!1);if(!o||!o.open||o.open.disabled||Date.now()-o.open.timestamp<r.state.facet(completionConfig).interactionDelay)return!1;let s=1,l;e=="page"&&(l=getTooltip(r,o.open.tooltip))&&(s=Math.max(2,Math.floor(l.dom.offsetHeight/l.dom.querySelector("li").offsetHeight)-1));let{length:c}=o.open.options,u=o.open.selected>-1?o.open.selected+s*(n?1:-1):n?0:c-1;return u<0?u=e=="page"?0:c-1:u>=c&&(u=e=="page"?c-1:0),r.dispatch({effects:setSelectedEffect.of(u)}),!0}}const acceptCompletion=n=>{let e=n.state.field(completionState,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||Date.now()-e.open.timestamp<n.state.facet(completionConfig).interactionDelay?!1:(e.open.disabled||applyCompletion(n,e.open.options[e.open.selected]),!0)},startCompletion=n=>n.state.field(completionState,!1)?(n.dispatch({effects:startCompletionEffect.of(!0)}),!0):!1,closeCompletion=n=>{let e=n.state.field(completionState,!1);return!e||!e.active.some(r=>r.state!=0)?!1:(n.dispatch({effects:closeCompletionEffect.of(null)}),!0)};class RunningQuery{constructor(e,r){this.active=e,this.context=r,this.time=Date.now(),this.updates=[],this.done=void 0}}const DebounceTime=50,MaxUpdateCount=50,MinAbortTime=1e3,completionPlugin=ViewPlugin.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let e of n.state.field(completionState).active)e.state==1&&this.startQuery(e)}update(n){let e=n.state.field(completionState);if(!n.selectionSet&&!n.docChanged&&n.startState.field(completionState)==e)return;let r=n.transactions.some(o=>(o.selection||o.docChanged)&&!getUserEvent(o));for(let o=0;o<this.running.length;o++){let s=this.running[o];if(r||s.updates.length+n.transactions.length>MaxUpdateCount&&Date.now()-s.time>MinAbortTime){for(let l of s.context.abortListeners)try{l()}catch(c){logException(this.view.state,c)}s.context.abortListeners=null,this.running.splice(o--,1)}else s.updates.push(...n.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=e.active.some(o=>o.state==1&&!this.running.some(s=>s.active.source==o.source))?setTimeout(()=>this.startUpdate(),DebounceTime):-1,this.composing!=0)for(let o of n.transactions)getUserEvent(o)=="input"?this.composing=2:this.composing==2&&o.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:n}=this.view,e=n.field(completionState);for(let r of e.active)r.state==1&&!this.running.some(o=>o.active.source==r.source)&&this.startQuery(r)}startQuery(n){let{state:e}=this.view,r=cur(e),o=new CompletionContext(e,r,n.explicitPos==r),s=new RunningQuery(n,o);this.running.push(s),Promise.resolve(n.source(o)).then(l=>{s.context.aborted||(s.done=l||null,this.scheduleAccept())},l=>{this.view.dispatch({effects:closeCompletionEffect.of(null)}),logException(this.view.state,l)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),DebounceTime))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],r=this.view.state.facet(completionConfig);for(let o=0;o<this.running.length;o++){let s=this.running[o];if(s.done===void 0)continue;if(this.running.splice(o--,1),s.done){let c=new ActiveResult(s.active.source,s.active.explicitPos,s.done,s.done.from,(n=s.done.to)!==null&&n!==void 0?n:cur(s.updates.length?s.updates[0].startState:this.view.state));for(let u of s.updates)c=c.update(u,r);if(c.hasResult()){e.push(c);continue}}let l=this.view.state.field(completionState).active.find(c=>c.source==s.active.source);if(l&&l.state==1)if(s.done==null){let c=new ActiveSource(s.active.source,0);for(let u of s.updates)c=c.update(u,r);c.state!=1&&e.push(c)}else this.startQuery(l)}e.length&&this.view.dispatch({effects:setActiveEffect.of(e)})}},{eventHandlers:{blur(n){let e=this.view.state.field(completionState,!1);if(e&&e.tooltip&&this.view.state.facet(completionConfig).closeOnBlur){let r=e.open&&getTooltip(this.view,e.open.tooltip);(!r||!r.dom.contains(n.relatedTarget))&&this.view.dispatch({effects:closeCompletionEffect.of(null)})}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:startCompletionEffect.of(!1)}),20),this.composing=0}}}),baseTheme$1=EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),defaults={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},closeBracketEffect=StateEffect.define({map(n,e){let r=e.mapPos(n,-1,MapMode.TrackAfter);return r??void 0}}),closedBracket=new class extends RangeValue{};closedBracket.startSide=1;closedBracket.endSide=-1;const bracketState=StateField.define({create(){return RangeSet.empty},update(n,e){if(e.selection){let r=e.state.doc.lineAt(e.selection.main.head).from,o=e.startState.doc.lineAt(e.startState.selection.main.head).from;r!=e.changes.mapPos(o,-1)&&(n=RangeSet.empty)}n=n.map(e.changes);for(let r of e.effects)r.is(closeBracketEffect)&&(n=n.update({add:[closedBracket.range(r.value,r.value+1)]}));return n}});function closeBrackets(){return[inputHandler,bracketState]}const definedClosing="()[]{}<>";function closing(n){for(let e=0;e<definedClosing.length;e+=2)if(definedClosing.charCodeAt(e)==n)return definedClosing.charAt(e+1);return fromCodePoint(n<128?n:n+1)}function config(n,e){return n.languageDataAt("closeBrackets",e)[0]||defaults}const android=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),inputHandler=EditorView.inputHandler.of((n,e,r,o)=>{if((android?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let s=n.state.selection.main;if(o.length>2||o.length==2&&codePointSize(codePointAt(o,0))==1||e!=s.from||r!=s.to)return!1;let l=insertBracket(n.state,o);return l?(n.dispatch(l),!0):!1}),deleteBracketPair=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let o=config(n,n.selection.main.head).brackets||defaults.brackets,s=null,l=n.changeByRange(c=>{if(c.empty){let u=prevChar(n.doc,c.head);for(let f of o)if(f==u&&nextChar(n.doc,c.head)==closing(codePointAt(f,0)))return{changes:{from:c.head-f.length,to:c.head+f.length},range:EditorSelection.cursor(c.head-f.length)}}return{range:s=c}});return s||e(n.update(l,{scrollIntoView:!0,userEvent:"delete.backward"})),!s},closeBracketsKeymap=[{key:"Backspace",run:deleteBracketPair}];function insertBracket(n,e){let r=config(n,n.selection.main.head),o=r.brackets||defaults.brackets;for(let s of o){let l=closing(codePointAt(s,0));if(e==s)return l==s?handleSame(n,s,o.indexOf(s+s+s)>-1,r):handleOpen(n,s,l,r.before||defaults.before);if(e==l&&closedBracketAt(n,n.selection.main.from))return handleClose(n,s,l)}return null}function closedBracketAt(n,e){let r=!1;return n.field(bracketState).between(0,n.doc.length,o=>{o==e&&(r=!0)}),r}function nextChar(n,e){let r=n.sliceString(e,e+2);return r.slice(0,codePointSize(codePointAt(r,0)))}function prevChar(n,e){let r=n.sliceString(e-2,e);return codePointSize(codePointAt(r,0))==r.length?r:r.slice(1)}function handleOpen(n,e,r,o){let s=null,l=n.changeByRange(c=>{if(!c.empty)return{changes:[{insert:e,from:c.from},{insert:r,from:c.to}],effects:closeBracketEffect.of(c.to+e.length),range:EditorSelection.range(c.anchor+e.length,c.head+e.length)};let u=nextChar(n.doc,c.head);return!u||/\s/.test(u)||o.indexOf(u)>-1?{changes:{insert:e+r,from:c.head},effects:closeBracketEffect.of(c.head+e.length),range:EditorSelection.cursor(c.head+e.length)}:{range:s=c}});return s?null:n.update(l,{scrollIntoView:!0,userEvent:"input.type"})}function handleClose(n,e,r){let o=null,s=n.changeByRange(l=>l.empty&&nextChar(n.doc,l.head)==r?{changes:{from:l.head,to:l.head+r.length,insert:r},range:EditorSelection.cursor(l.head+r.length)}:o={range:l});return o?null:n.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function handleSame(n,e,r,o){let s=o.stringPrefixes||defaults.stringPrefixes,l=null,c=n.changeByRange(u=>{if(!u.empty)return{changes:[{insert:e,from:u.from},{insert:e,from:u.to}],effects:closeBracketEffect.of(u.to+e.length),range:EditorSelection.range(u.anchor+e.length,u.head+e.length)};let f=u.head,d=nextChar(n.doc,f),g;if(d==e){if(nodeStart(n,f))return{changes:{insert:e+e,from:f},effects:closeBracketEffect.of(f+e.length),range:EditorSelection.cursor(f+e.length)};if(closedBracketAt(n,f)){let v=r&&n.sliceDoc(f,f+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:f,to:f+v.length,insert:v},range:EditorSelection.cursor(f+v.length)}}}else{if(r&&n.sliceDoc(f-2*e.length,f)==e+e&&(g=canStartStringAt(n,f-2*e.length,s))>-1&&nodeStart(n,g))return{changes:{insert:e+e+e+e,from:f},effects:closeBracketEffect.of(f+e.length),range:EditorSelection.cursor(f+e.length)};if(n.charCategorizer(f)(d)!=CharCategory.Word&&canStartStringAt(n,f,s)>-1&&!probablyInString(n,f,e,s))return{changes:{insert:e+e,from:f},effects:closeBracketEffect.of(f+e.length),range:EditorSelection.cursor(f+e.length)}}return{range:l=u}});return l?null:n.update(c,{scrollIntoView:!0,userEvent:"input.type"})}function nodeStart(n,e){let r=syntaxTree(n).resolveInner(e+1);return r.parent&&r.from==e}function probablyInString(n,e,r,o){let s=syntaxTree(n).resolveInner(e,-1),l=o.reduce((c,u)=>Math.max(c,u.length),0);for(let c=0;c<5;c++){let u=n.sliceDoc(s.from,Math.min(s.to,s.from+r.length+l)),f=u.indexOf(r);if(!f||f>-1&&o.indexOf(u.slice(0,f))>-1){let g=s.firstChild;for(;g&&g.from==s.from&&g.to-g.from>r.length+f;){if(n.sliceDoc(g.to-r.length,g.to)==r)return!1;g=g.firstChild}return!0}let d=s.to==e&&s.parent;if(!d)break;s=d}return!1}function canStartStringAt(n,e,r){let o=n.charCategorizer(e);if(o(n.sliceDoc(e-1,e))!=CharCategory.Word)return e;for(let s of r){let l=e-s.length;if(n.sliceDoc(l,e)==s&&o(n.sliceDoc(l-1,l))!=CharCategory.Word)return l}return-1}function autocompletion(n={}){return[completionState,completionConfig.of(n),completionPlugin,completionKeymapExt,baseTheme$1]}const completionKeymap=[{key:"Ctrl-Space",run:startCompletion},{key:"Escape",run:closeCompletion},{key:"ArrowDown",run:moveCompletionSelection(!0)},{key:"ArrowUp",run:moveCompletionSelection(!1)},{key:"PageDown",run:moveCompletionSelection(!0,"page")},{key:"PageUp",run:moveCompletionSelection(!1,"page")},{key:"Enter",run:acceptCompletion}],completionKeymapExt=Prec.highest(keymap.computeN([completionConfig],n=>n.facet(completionConfig).defaultKeymap?[completionKeymap]:[]));class SelectedDiagnostic{constructor(e,r,o){this.from=e,this.to=r,this.diagnostic=o}}class LintState{constructor(e,r,o){this.diagnostics=e,this.panel=r,this.selected=o}static init(e,r,o){let s=e,l=o.facet(lintConfig).markerFilter;l&&(s=l(s));let c=Decoration.set(s.map(u=>u.from==u.to||u.from==u.to-1&&o.doc.lineAt(u.from).to==u.from?Decoration.widget({widget:new DiagnosticWidget(u),diagnostic:u}).range(u.from):Decoration.mark({attributes:{class:"cm-lintRange cm-lintRange-"+u.severity},diagnostic:u}).range(u.from,u.to)),!0);return new LintState(c,r,findDiagnostic(c))}}function findDiagnostic(n,e=null,r=0){let o=null;return n.between(r,1e9,(s,l,{spec:c})=>{if(!(e&&c.diagnostic!=e))return o=new SelectedDiagnostic(s,l,c.diagnostic),!1}),o}function hideTooltip(n,e){return!!(n.effects.some(r=>r.is(setDiagnosticsEffect))||n.changes.touchesRange(e.pos))}function maybeEnableLint(n,e){return n.field(lintState,!1)?e:e.concat(StateEffect.appendConfig.of(lintExtensions))}const setDiagnosticsEffect=StateEffect.define(),togglePanel=StateEffect.define(),movePanelSelection=StateEffect.define(),lintState=StateField.define({create(){return new LintState(Decoration.none,null,null)},update(n,e){if(e.docChanged){let r=n.diagnostics.map(e.changes),o=null;if(n.selected){let s=e.changes.mapPos(n.selected.from,1);o=findDiagnostic(r,n.selected.diagnostic,s)||findDiagnostic(r,null,s)}n=new LintState(r,n.panel,o)}for(let r of e.effects)r.is(setDiagnosticsEffect)?n=LintState.init(r.value,n.panel,e.state):r.is(togglePanel)?n=new LintState(n.diagnostics,r.value?LintPanel.open:null,n.selected):r.is(movePanelSelection)&&(n=new LintState(n.diagnostics,n.panel,r.value));return n},provide:n=>[showPanel.from(n,e=>e.panel),EditorView.decorations.from(n,e=>e.diagnostics)]}),activeMark=Decoration.mark({class:"cm-lintRange cm-lintRange-active"});function lintTooltip(n,e,r){let{diagnostics:o}=n.state.field(lintState),s=[],l=2e8,c=0;o.between(e-(r<0?1:0),e+(r>0?1:0),(f,d,{spec:g})=>{e>=f&&e<=d&&(f==d||(e>f||r>0)&&(e<d||r<0))&&(s.push(g.diagnostic),l=Math.min(f,l),c=Math.max(d,c))});let u=n.state.facet(lintConfig).tooltipFilter;return u&&(s=u(s)),s.length?{pos:l,end:c,above:n.state.doc.lineAt(l).to<c,create(){return{dom:diagnosticsTooltip(n,s)}}}:null}function diagnosticsTooltip(n,e){return crelt("ul",{class:"cm-tooltip-lint"},e.map(r=>renderDiagnostic(n,r,!1)))}const openLintPanel=n=>{let e=n.state.field(lintState,!1);(!e||!e.panel)&&n.dispatch({effects:maybeEnableLint(n.state,[togglePanel.of(!0)])});let r=getPanel(n,LintPanel.open);return r&&r.dom.querySelector(".cm-panel-lint ul").focus(),!0},closeLintPanel=n=>{let e=n.state.field(lintState,!1);return!e||!e.panel?!1:(n.dispatch({effects:togglePanel.of(!1)}),!0)},nextDiagnostic=n=>{let e=n.state.field(lintState,!1);if(!e)return!1;let r=n.state.selection.main,o=e.diagnostics.iter(r.to+1);return!o.value&&(o=e.diagnostics.iter(0),!o.value||o.from==r.from&&o.to==r.to)?!1:(n.dispatch({selection:{anchor:o.from,head:o.to},scrollIntoView:!0}),!0)},lintKeymap=[{key:"Mod-Shift-m",run:openLintPanel,preventDefault:!0},{key:"F8",run:nextDiagnostic}],lintConfig=Facet.define({combine(n){return Object.assign({sources:n.map(e=>e.source)},combineConfig(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(e,r)=>e?r?o=>e(o)||r(o):e:r}))}});function assignKeys(n){let e=[];if(n)e:for(let{name:r}of n){for(let o=0;o<r.length;o++){let s=r[o];if(/[a-zA-Z]/.test(s)&&!e.some(l=>l.toLowerCase()==s.toLowerCase())){e.push(s);continue e}}e.push("")}return e}function renderDiagnostic(n,e,r){var o;let s=r?assignKeys(e.actions):[];return crelt("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},crelt("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage():e.message),(o=e.actions)===null||o===void 0?void 0:o.map((l,c)=>{let u=!1,f=v=>{if(v.preventDefault(),u)return;u=!0;let b=findDiagnostic(n.state.field(lintState).diagnostics,e);b&&l.apply(n,b.from,b.to)},{name:d}=l,g=s[c]?d.indexOf(s[c]):-1,m=g<0?d:[d.slice(0,g),crelt("u",d.slice(g,g+1)),d.slice(g+1)];return crelt("button",{type:"button",class:"cm-diagnosticAction",onclick:f,onmousedown:f,"aria-label":` Action: ${d}${g<0?"":` (access key "${s[c]})"`}.`},m)}),e.source&&crelt("div",{class:"cm-diagnosticSource"},e.source))}class DiagnosticWidget extends WidgetType{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return crelt("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class PanelItem{constructor(e,r){this.diagnostic=r,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=renderDiagnostic(e,r,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class LintPanel{constructor(e){this.view=e,this.items=[];let r=s=>{if(s.keyCode==27)closeLintPanel(this.view),this.view.focus();else if(s.keyCode==38||s.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(s.keyCode==40||s.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(s.keyCode==36)this.moveSelection(0);else if(s.keyCode==35)this.moveSelection(this.items.length-1);else if(s.keyCode==13)this.view.focus();else if(s.keyCode>=65&&s.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:l}=this.items[this.selectedIndex],c=assignKeys(l.actions);for(let u=0;u<c.length;u++)if(c[u].toUpperCase().charCodeAt(0)==s.keyCode){let f=findDiagnostic(this.view.state.field(lintState).diagnostics,l);f&&l.actions[u].apply(e,f.from,f.to)}}else return;s.preventDefault()},o=s=>{for(let l=0;l<this.items.length;l++)this.items[l].dom.contains(s.target)&&this.moveSelection(l)};this.list=crelt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:r,onclick:o}),this.dom=crelt("div",{class:"cm-panel-lint"},this.list,crelt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>closeLintPanel(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(lintState).selected;if(!e)return-1;for(let r=0;r<this.items.length;r++)if(this.items[r].diagnostic==e.diagnostic)return r;return-1}update(){let{diagnostics:e,selected:r}=this.view.state.field(lintState),o=0,s=!1,l=null;for(e.between(0,this.view.state.doc.length,(c,u,{spec:f})=>{let d=-1,g;for(let m=o;m<this.items.length;m++)if(this.items[m].diagnostic==f.diagnostic){d=m;break}d<0?(g=new PanelItem(this.view,f.diagnostic),this.items.splice(o,0,g),s=!0):(g=this.items[d],d>o&&(this.items.splice(o,d-o),s=!0)),r&&g.diagnostic==r.diagnostic?g.dom.hasAttribute("aria-selected")||(g.dom.setAttribute("aria-selected","true"),l=g):g.dom.hasAttribute("aria-selected")&&g.dom.removeAttribute("aria-selected"),o++});o<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)s=!0,this.items.pop();this.items.length==0&&(this.items.push(new PanelItem(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),s=!0),l?(this.list.setAttribute("aria-activedescendant",l.id),this.view.requestMeasure({key:this,read:()=>({sel:l.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:c,panel:u})=>{c.top<u.top?this.list.scrollTop-=u.top-c.top:c.bottom>u.bottom&&(this.list.scrollTop+=c.bottom-u.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),s&&this.sync()}sync(){let e=this.list.firstChild;function r(){let o=e;e=o.nextSibling,o.remove()}for(let o of this.items)if(o.dom.parentNode==this.list){for(;e!=o.dom;)r();e=o.dom.nextSibling}else this.list.insertBefore(o.dom,e);for(;e;)r()}moveSelection(e){if(this.selectedIndex<0)return;let r=this.view.state.field(lintState),o=findDiagnostic(r.diagnostics,this.items[e].diagnostic);o&&this.view.dispatch({selection:{anchor:o.from,head:o.to},scrollIntoView:!0,effects:movePanelSelection.of(o)})}static open(e){return new LintPanel(e)}}function svg(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function underline(n){return svg(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const baseTheme=EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:underline("#d11")},".cm-lintRange-warning":{backgroundImage:underline("orange")},".cm-lintRange-info":{backgroundImage:underline("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),lintExtensions=[lintState,EditorView.decorations.compute([lintState],n=>{let{selected:e,panel:r}=n.field(lintState);return!e||!r||e.from==e.to?Decoration.none:Decoration.set([activeMark.range(e.from,e.to)])}),hoverTooltip(lintTooltip,{hideOn:hideTooltip}),baseTheme],basicSetup=(()=>[lineNumbers(),highlightActiveLineGutter(),highlightSpecialChars(),history$1(),foldGutter(),drawSelection(),dropCursor(),EditorState.allowMultipleSelections.of(!0),indentOnInput(),syntaxHighlighting(defaultHighlightStyle,{fallback:!0}),bracketMatching(),closeBrackets(),autocompletion(),rectangularSelection(),crosshairCursor(),highlightActiveLine(),highlightSelectionMatches(),keymap.of([...closeBracketsKeymap,...defaultKeymap,...searchKeymap,...historyKeymap,...foldKeymap,...completionKeymap,...lintKeymap])])();/*!
* VueCodemirror v6.1.1
* Copyright (c) Surmon. All rights reserved.
* Released under the MIT License.
* Surmon
*/var h=Object.freeze({autofocus:!1,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"",autoDestroy:!0,extensions:[basicSetup]}),y=Symbol("vue-codemirror-global-config"),O,j=function(n){var e=n.onUpdate,r=n.onChange,o=n.onFocus,s=n.onBlur,l=function(c,u){var f={};for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&u.indexOf(d)<0&&(f[d]=c[d]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function"){var g=0;for(d=Object.getOwnPropertySymbols(c);g<d.length;g++)u.indexOf(d[g])<0&&Object.prototype.propertyIsEnumerable.call(c,d[g])&&(f[d[g]]=c[d[g]])}return f}(n,["onUpdate","onChange","onFocus","onBlur"]);return EditorState.create({doc:l.doc,selection:l.selection,extensions:(Array.isArray(l.extensions)?l.extensions:[l.extensions]).concat([EditorView.updateListener.of(function(c){e(c),c.docChanged&&r(c.state.doc.toString(),c),c.focusChanged&&(c.view.hasFocus?o(c):s(c))})])})},S$1=function(n){var e=new Compartment;return{compartment:e,run:function(r){e.get(n.state)?n.dispatch({effects:e.reconfigure(r)}):n.dispatch({effects:StateEffect.appendConfig.of(e.of(r))})}}},x=function(n,e){var r=S$1(n),o=r.compartment,s=r.run;return function(l){var c=o.get(n.state);s(l??c!==e?e:[])}},C$1={type:Boolean,default:void 0},D={autofocus:C$1,disabled:C$1,indentWithTab:C$1,tabSize:Number,placeholder:String,style:Object,autoDestroy:C$1,phrases:Object,root:Object,extensions:Array,selection:Object},U={modelValue:{type:String,default:""}},w=Object.assign(Object.assign({},D),U);(function(n){n.Change="change",n.Update="update",n.Focus="focus",n.Blur="blur",n.Ready="ready",n.ModelUpdate="update:modelValue"})(O||(O={}));var z$1={};z$1[O.Change]=function(n,e){return!0},z$1[O.Update]=function(n){return!0},z$1[O.Focus]=function(n){return!0},z$1[O.Blur]=function(n){return!0},z$1[O.Ready]=function(n){return!0};var B$1={};B$1[O.ModelUpdate]=z$1[O.Change];var F=Object.assign(Object.assign({},z$1),B$1),P=defineComponent({name:"VueCodemirror",props:Object.assign({},w),emits:Object.assign({},F),setup:function(n,e){var r=shallowRef(),o=shallowRef(),s=shallowRef(),l=Object.assign(Object.assign({},h),inject(y,{})),c=computed(function(){var u={};return Object.keys(toRaw(n)).forEach(function(f){var d;f!=="modelValue"&&(u[f]=(d=n[f])!==null&&d!==void 0?d:l[f])}),u});return onMounted(function(){var u;o.value=j({doc:n.modelValue,selection:c.value.selection,extensions:(u=l.extensions)!==null&&u!==void 0?u:[],onFocus:function(d){return e.emit(O.Focus,d)},onBlur:function(d){return e.emit(O.Blur,d)},onUpdate:function(d){return e.emit(O.Update,d)},onChange:function(d,g){d!==n.modelValue&&(e.emit(O.Change,d,g),e.emit(O.ModelUpdate,d,g))}}),s.value=function(d){return new EditorView(Object.assign({},d))}({state:o.value,parent:r.value,root:c.value.root});var f=function(d){var g=function(){return d.state.doc.toString()},m=S$1(d).run,v=x(d,[EditorView.editable.of(!1),EditorState.readOnly.of(!0)]),b=x(d,keymap.of([indentWithTab])),k=S$1(d).run,R=S$1(d).run,I=S$1(d).run,$=S$1(d).run;return{focus:function(){return d.focus()},getDoc:g,setDoc:function(Y){Y!==g()&&d.dispatch({changes:{from:0,to:d.state.doc.length,insert:Y}})},reExtensions:m,toggleDisabled:v,toggleIndentWithTab:b,setTabSize:function(Y){k([EditorState.tabSize.of(Y),indentUnit.of(" ".repeat(Y))])},setPhrases:function(Y){R([EditorState.phrases.of(Y)])},setPlaceholder:function(Y){I(placeholder(Y))},setStyle:function(Y){Y===void 0&&(Y={}),$(EditorView.theme({"&":Object.assign({},Y)}))}}}(s.value);watch(function(){return n.modelValue},function(d){d!==f.getDoc()&&f.setDoc(d)}),watch(function(){return n.extensions},function(d){return f.reExtensions(d||[])},{immediate:!0}),watch(function(){return c.value.disabled},function(d){return f.toggleDisabled(d)},{immediate:!0}),watch(function(){return c.value.indentWithTab},function(d){return f.toggleIndentWithTab(d)},{immediate:!0}),watch(function(){return c.value.tabSize},function(d){return f.setTabSize(d)},{immediate:!0}),watch(function(){return c.value.phrases},function(d){return f.setPhrases(d||{})},{immediate:!0}),watch(function(){return c.value.placeholder},function(d){return f.setPlaceholder(d)},{immediate:!0}),watch(function(){return c.value.style},function(d){return f.setStyle(d)},{immediate:!0}),c.value.autofocus&&f.focus(),e.emit(O.Ready,{state:o.value,view:s.value,container:r.value})}),onBeforeUnmount(function(){c.value.autoDestroy&&s.value&&function(u){u.destroy()}(s.value)}),function(){return h$1("div",{class:"v-codemirror",style:{display:"contents"},ref:r})}}}),T=P,V=function(n,e){n.component(P.name,P),n.component("Codemirror",P),function(r,o){r.provide(y,o)}(n,e)},W={Codemirror:T,install:V};/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const isBrowser=typeof window<"u";function isESModule(n){return n.__esModule||n[Symbol.toStringTag]==="Module"}const assign=Object.assign;function applyToParams(n,e){const r={};for(const o in e){const s=e[o];r[o]=isArray(s)?s.map(n):n(s)}return r}const noop=()=>{},isArray=Array.isArray,TRAILING_SLASH_RE=/\/$/,removeTrailingSlash=n=>n.replace(TRAILING_SLASH_RE,"");function parseURL(n,e,r="/"){let o,s={},l="",c="";const u=e.indexOf("#");let f=e.indexOf("?");return u<f&&u>=0&&(f=-1),f>-1&&(o=e.slice(0,f),l=e.slice(f+1,u>-1?u:e.length),s=n(l)),u>-1&&(o=o||e.slice(0,u),c=e.slice(u,e.length)),o=resolveRelativePath(o??e,r),{fullPath:o+(l&&"?")+l+c,path:o,query:s,hash:c}}function stringifyURL(n,e){const r=e.query?n(e.query):"";return e.path+(r&&"?")+r+(e.hash||"")}function stripBase(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function isSameRouteLocation(n,e,r){const o=e.matched.length-1,s=r.matched.length-1;return o>-1&&o===s&&isSameRouteRecord(e.matched[o],r.matched[s])&&isSameRouteLocationParams(e.params,r.params)&&n(e.query)===n(r.query)&&e.hash===r.hash}function isSameRouteRecord(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function isSameRouteLocationParams(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const r in n)if(!isSameRouteLocationParamsValue(n[r],e[r]))return!1;return!0}function isSameRouteLocationParamsValue(n,e){return isArray(n)?isEquivalentArray(n,e):isArray(e)?isEquivalentArray(e,n):n===e}function isEquivalentArray(n,e){return isArray(e)?n.length===e.length&&n.every((r,o)=>r===e[o]):n.length===1&&n[0]===e}function resolveRelativePath(n,e){if(n.startsWith("/"))return n;if(!n)return e;const r=e.split("/"),o=n.split("/");let s=r.length-1,l,c;for(l=0;l<o.length;l++)if(c=o[l],c!==".")if(c==="..")s>1&&s--;else break;return r.slice(0,s).join("/")+"/"+o.slice(l-(l===o.length?1:0)).join("/")}var NavigationType;(function(n){n.pop="pop",n.push="push"})(NavigationType||(NavigationType={}));var NavigationDirection;(function(n){n.back="back",n.forward="forward",n.unknown=""})(NavigationDirection||(NavigationDirection={}));function normalizeBase(n){if(!n)if(isBrowser){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),removeTrailingSlash(n)}const BEFORE_HASH_RE=/^[^#]+#/;function createHref(n,e){return n.replace(BEFORE_HASH_RE,"#")+e}function getElementPosition(n,e){const r=document.documentElement.getBoundingClientRect(),o=n.getBoundingClientRect();return{behavior:e.behavior,left:o.left-r.left-(e.left||0),top:o.top-r.top-(e.top||0)}}const computeScrollPosition=()=>({left:window.pageXOffset,top:window.pageYOffset});function scrollToPosition(n){let e;if("el"in n){const r=n.el,o=typeof r=="string"&&r.startsWith("#"),s=typeof r=="string"?o?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!s)return;e=getElementPosition(s,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function getScrollKey(n,e){return(history.state?history.state.position-e:-1)+n}const scrollPositions=new Map;function saveScrollPosition(n,e){scrollPositions.set(n,e)}function getSavedScrollPosition(n){const e=scrollPositions.get(n);return scrollPositions.delete(n),e}let createBaseLocation=()=>location.protocol+"//"+location.host;function createCurrentLocation(n,e){const{pathname:r,search:o,hash:s}=e,l=n.indexOf("#");if(l>-1){let u=s.includes(n.slice(l))?n.slice(l).length:1,f=s.slice(u);return f[0]!=="/"&&(f="/"+f),stripBase(f,"")}return stripBase(r,n)+o+s}function useHistoryListeners(n,e,r,o){let s=[],l=[],c=null;const u=({state:v})=>{const b=createCurrentLocation(n,location),k=r.value,R=e.value;let I=0;if(v){if(r.value=b,e.value=v,c&&c===k){c=null;return}I=R?v.position-R.position:0}else o(b);s.forEach($=>{$(r.value,k,{delta:I,type:NavigationType.pop,direction:I?I>0?NavigationDirection.forward:NavigationDirection.back:NavigationDirection.unknown})})};function f(){c=r.value}function d(v){s.push(v);const b=()=>{const k=s.indexOf(v);k>-1&&s.splice(k,1)};return l.push(b),b}function g(){const{history:v}=window;v.state&&v.replaceState(assign({},v.state,{scroll:computeScrollPosition()}),"")}function m(){for(const v of l)v();l=[],window.removeEventListener("popstate",u),window.removeEventListener("beforeunload",g)}return window.addEventListener("popstate",u),window.addEventListener("beforeunload",g),{pauseListeners:f,listen:d,destroy:m}}function buildState(n,e,r,o=!1,s=!1){return{back:n,current:e,forward:r,replaced:o,position:window.history.length,scroll:s?computeScrollPosition():null}}function useHistoryStateNavigation(n){const{history:e,location:r}=window,o={value:createCurrentLocation(n,r)},s={value:e.state};s.value||l(o.value,{back:null,current:o.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function l(f,d,g){const m=n.indexOf("#"),v=m>-1?(r.host&&document.querySelector("base")?n:n.slice(m))+f:createBaseLocation()+n+f;try{e[g?"replaceState":"pushState"](d,"",v),s.value=d}catch(b){console.error(b),r[g?"replace":"assign"](v)}}function c(f,d){const g=assign({},e.state,buildState(s.value.back,f,s.value.forward,!0),d,{position:s.value.position});l(f,g,!0),o.value=f}function u(f,d){const g=assign({},s.value,e.state,{forward:f,scroll:computeScrollPosition()});l(g.current,g,!0);const m=assign({},buildState(o.value,f,null),{position:g.position+1},d);l(f,m,!1),o.value=f}return{location:o,state:s,push:u,replace:c}}function createWebHistory(n){n=normalizeBase(n);const e=useHistoryStateNavigation(n),r=useHistoryListeners(n,e.state,e.location,e.replace);function o(l,c=!0){c||r.pauseListeners(),history.go(l)}const s=assign({location:"",base:n,go:o,createHref:createHref.bind(null,n)},e,r);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function isRouteLocation(n){return typeof n=="string"||n&&typeof n=="object"}function isRouteName(n){return typeof n=="string"||typeof n=="symbol"}const START_LOCATION_NORMALIZED={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},NavigationFailureSymbol=Symbol("");var NavigationFailureType;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(NavigationFailureType||(NavigationFailureType={}));function createRouterError(n,e){return assign(new Error,{type:n,[NavigationFailureSymbol]:!0},e)}function isNavigationFailure(n,e){return n instanceof Error&&NavigationFailureSymbol in n&&(e==null||!!(n.type&e))}const BASE_PARAM_PATTERN="[^/]+?",BASE_PATH_PARSER_OPTIONS={sensitive:!1,strict:!1,start:!0,end:!0},REGEX_CHARS_RE=/[.+*?^${}()[\]/\\]/g;function tokensToParser(n,e){const r=assign({},BASE_PATH_PARSER_OPTIONS,e),o=[];let s=r.start?"^":"";const l=[];for(const d of n){const g=d.length?[]:[90];r.strict&&!d.length&&(s+="/");for(let m=0;m<d.length;m++){const v=d[m];let b=40+(r.sensitive?.25:0);if(v.type===0)m||(s+="/"),s+=v.value.replace(REGEX_CHARS_RE,"\\$&"),b+=40;else if(v.type===1){const{value:k,repeatable:R,optional:I,regexp:$}=v;l.push({name:k,repeatable:R,optional:I});const Y=$||BASE_PARAM_PATTERN;if(Y!==BASE_PARAM_PATTERN){b+=10;try{new RegExp(`(${Y})`)}catch(G){throw new Error(`Invalid custom RegExp for param "${k}" (${Y}): `+G.message)}}let oe=R?`((?:${Y})(?:/(?:${Y}))*)`:`(${Y})`;m||(oe=I&&d.length<2?`(?:/${oe})`:"/"+oe),I&&(oe+="?"),s+=oe,b+=20,I&&(b+=-8),R&&(b+=-20),Y===".*"&&(b+=-50)}g.push(b)}o.push(g)}if(r.strict&&r.end){const d=o.length-1;o[d][o[d].length-1]+=.7000000000000001}r.strict||(s+="/?"),r.end?s+="$":r.strict&&(s+="(?:/|$)");const c=new RegExp(s,r.sensitive?"":"i");function u(d){const g=d.match(c),m={};if(!g)return null;for(let v=1;v<g.length;v++){const b=g[v]||"",k=l[v-1];m[k.name]=b&&k.repeatable?b.split("/"):b}return m}function f(d){let g="",m=!1;for(const v of n){(!m||!g.endsWith("/"))&&(g+="/"),m=!1;for(const b of v)if(b.type===0)g+=b.value;else if(b.type===1){const{value:k,repeatable:R,optional:I}=b,$=k in d?d[k]:"";if(isArray($)&&!R)throw new Error(`Provided param "${k}" is an array but it is not repeatable (* or + modifiers)`);const Y=isArray($)?$.join("/"):$;if(!Y)if(I)v.length<2&&(g.endsWith("/")?g=g.slice(0,-1):m=!0);else throw new Error(`Missing required param "${k}"`);g+=Y}}return g||"/"}return{re:c,score:o,keys:l,parse:u,stringify:f}}function compareScoreArray(n,e){let r=0;for(;r<n.length&&r<e.length;){const o=e[r]-n[r];if(o)return o;r++}return n.length<e.length?n.length===1&&n[0]===40+40?-1:1:n.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function comparePathParserScore(n,e){let r=0;const o=n.score,s=e.score;for(;r<o.length&&r<s.length;){const l=compareScoreArray(o[r],s[r]);if(l)return l;r++}if(Math.abs(s.length-o.length)===1){if(isLastScoreNegative(o))return 1;if(isLastScoreNegative(s))return-1}return s.length-o.length}function isLastScoreNegative(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const ROOT_TOKEN={type:0,value:""},VALID_PARAM_RE=/[a-zA-Z0-9_]/;function tokenizePath(n){if(!n)return[[]];if(n==="/")return[[ROOT_TOKEN]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(b){throw new Error(`ERR (${r})/"${d}": ${b}`)}let r=0,o=r;const s=[];let l;function c(){l&&s.push(l),l=[]}let u=0,f,d="",g="";function m(){d&&(r===0?l.push({type:0,value:d}):r===1||r===2||r===3?(l.length>1&&(f==="*"||f==="+")&&e(`A repeatable param (${d}) must be alone in its segment. eg: '/:ids+.`),l.push({type:1,value:d,regexp:g,repeatable:f==="*"||f==="+",optional:f==="*"||f==="?"})):e("Invalid state to consume buffer"),d="")}function v(){d+=f}for(;u<n.length;){if(f=n[u++],f==="\\"&&r!==2){o=r,r=4;continue}switch(r){case 0:f==="/"?(d&&m(),c()):f===":"?(m(),r=1):v();break;case 4:v(),r=o;break;case 1:f==="("?r=2:VALID_PARAM_RE.test(f)?v():(m(),r=0,f!=="*"&&f!=="?"&&f!=="+"&&u--);break;case 2:f===")"?g[g.length-1]=="\\"?g=g.slice(0,-1)+f:r=3:g+=f;break;case 3:m(),r=0,f!=="*"&&f!=="?"&&f!=="+"&&u--,g="";break;default:e("Unknown state");break}}return r===2&&e(`Unfinished custom RegExp for param "${d}"`),m(),c(),s}function createRouteRecordMatcher(n,e,r){const o=tokensToParser(tokenizePath(n.path),r),s=assign(o,{record:n,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function createRouterMatcher(n,e){const r=[],o=new Map;e=mergeOptions({strict:!1,end:!0,sensitive:!1},e);function s(g){return o.get(g)}function l(g,m,v){const b=!v,k=normalizeRouteRecord(g);k.aliasOf=v&&v.record;const R=mergeOptions(e,g),I=[k];if("alias"in g){const oe=typeof g.alias=="string"?[g.alias]:g.alias;for(const G of oe)I.push(assign({},k,{components:v?v.record.components:k.components,path:G,aliasOf:v?v.record:k}))}let $,Y;for(const oe of I){const{path:G}=oe;if(m&&G[0]!=="/"){const q=m.record.path,ne=q[q.length-1]==="/"?"":"/";oe.path=m.record.path+(G&&ne+G)}if($=createRouteRecordMatcher(oe,m,R),v?v.alias.push($):(Y=Y||$,Y!==$&&Y.alias.push($),b&&g.name&&!isAliasRecord($)&&c(g.name)),k.children){const q=k.children;for(let ne=0;ne<q.length;ne++)l(q[ne],$,v&&v.children[ne])}v=v||$,($.record.components&&Object.keys($.record.components).length||$.record.name||$.record.redirect)&&f($)}return Y?()=>{c(Y)}:noop}function c(g){if(isRouteName(g)){const m=o.get(g);m&&(o.delete(g),r.splice(r.indexOf(m),1),m.children.forEach(c),m.alias.forEach(c))}else{const m=r.indexOf(g);m>-1&&(r.splice(m,1),g.record.name&&o.delete(g.record.name),g.children.forEach(c),g.alias.forEach(c))}}function u(){return r}function f(g){let m=0;for(;m<r.length&&comparePathParserScore(g,r[m])>=0&&(g.record.path!==r[m].record.path||!isRecordChildOf(g,r[m]));)m++;r.splice(m,0,g),g.record.name&&!isAliasRecord(g)&&o.set(g.record.name,g)}function d(g,m){let v,b={},k,R;if("name"in g&&g.name){if(v=o.get(g.name),!v)throw createRouterError(1,{location:g});R=v.record.name,b=assign(paramsFromLocation(m.params,v.keys.filter(Y=>!Y.optional).map(Y=>Y.name)),g.params&&paramsFromLocation(g.params,v.keys.map(Y=>Y.name))),k=v.stringify(b)}else if("path"in g)k=g.path,v=r.find(Y=>Y.re.test(k)),v&&(b=v.parse(k),R=v.record.name);else{if(v=m.name?o.get(m.name):r.find(Y=>Y.re.test(m.path)),!v)throw createRouterError(1,{location:g,currentLocation:m});R=v.record.name,b=assign({},m.params,g.params),k=v.stringify(b)}const I=[];let $=v;for(;$;)I.unshift($.record),$=$.parent;return{name:R,path:k,params:b,matched:I,meta:mergeMetaFields(I)}}return n.forEach(g=>l(g)),{addRoute:l,resolve:d,removeRoute:c,getRoutes:u,getRecordMatcher:s}}function paramsFromLocation(n,e){const r={};for(const o of e)o in n&&(r[o]=n[o]);return r}function normalizeRouteRecord(n){return{path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:void 0,beforeEnter:n.beforeEnter,props:normalizeRecordProps(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}}}function normalizeRecordProps(n){const e={},r=n.props||!1;if("component"in n)e.default=r;else for(const o in n.components)e[o]=typeof r=="boolean"?r:r[o];return e}function isAliasRecord(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function mergeMetaFields(n){return n.reduce((e,r)=>assign(e,r.meta),{})}function mergeOptions(n,e){const r={};for(const o in n)r[o]=o in e?e[o]:n[o];return r}function isRecordChildOf(n,e){return e.children.some(r=>r===n||isRecordChildOf(n,r))}const HASH_RE=/#/g,AMPERSAND_RE=/&/g,SLASH_RE=/\//g,EQUAL_RE=/=/g,IM_RE=/\?/g,PLUS_RE=/\+/g,ENC_BRACKET_OPEN_RE=/%5B/g,ENC_BRACKET_CLOSE_RE=/%5D/g,ENC_CARET_RE=/%5E/g,ENC_BACKTICK_RE=/%60/g,ENC_CURLY_OPEN_RE=/%7B/g,ENC_PIPE_RE=/%7C/g,ENC_CURLY_CLOSE_RE=/%7D/g,ENC_SPACE_RE=/%20/g;function commonEncode(n){return encodeURI(""+n).replace(ENC_PIPE_RE,"|").replace(ENC_BRACKET_OPEN_RE,"[").replace(ENC_BRACKET_CLOSE_RE,"]")}function encodeHash(n){return commonEncode(n).replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryValue(n){return commonEncode(n).replace(PLUS_RE,"%2B").replace(ENC_SPACE_RE,"+").replace(HASH_RE,"%23").replace(AMPERSAND_RE,"%26").replace(ENC_BACKTICK_RE,"`").replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryKey(n){return encodeQueryValue(n).replace(EQUAL_RE,"%3D")}function encodePath(n){return commonEncode(n).replace(HASH_RE,"%23").replace(IM_RE,"%3F")}function encodeParam(n){return n==null?"":encodePath(n).replace(SLASH_RE,"%2F")}function decode(n){try{return decodeURIComponent(""+n)}catch{}return""+n}function parseQuery(n){const e={};if(n===""||n==="?")return e;const o=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<o.length;++s){const l=o[s].replace(PLUS_RE," "),c=l.indexOf("="),u=decode(c<0?l:l.slice(0,c)),f=c<0?null:decode(l.slice(c+1));if(u in e){let d=e[u];isArray(d)||(d=e[u]=[d]),d.push(f)}else e[u]=f}return e}function stringifyQuery(n){let e="";for(let r in n){const o=n[r];if(r=encodeQueryKey(r),o==null){o!==void 0&&(e+=(e.length?"&":"")+r);continue}(isArray(o)?o.map(l=>l&&encodeQueryValue(l)):[o&&encodeQueryValue(o)]).forEach(l=>{l!==void 0&&(e+=(e.length?"&":"")+r,l!=null&&(e+="="+l))})}return e}function normalizeQuery(n){const e={};for(const r in n){const o=n[r];o!==void 0&&(e[r]=isArray(o)?o.map(s=>s==null?null:""+s):o==null?o:""+o)}return e}const matchedRouteKey=Symbol(""),viewDepthKey=Symbol(""),routerKey=Symbol(""),routeLocationKey=Symbol(""),routerViewLocationKey=Symbol("");function useCallbacks(){let n=[];function e(o){return n.push(o),()=>{const s=n.indexOf(o);s>-1&&n.splice(s,1)}}function r(){n=[]}return{add:e,list:()=>n,reset:r}}function guardToPromiseFn(n,e,r,o,s){const l=o&&(o.enterCallbacks[s]=o.enterCallbacks[s]||[]);return()=>new Promise((c,u)=>{const f=m=>{m===!1?u(createRouterError(4,{from:r,to:e})):m instanceof Error?u(m):isRouteLocation(m)?u(createRouterError(2,{from:e,to:m})):(l&&o.enterCallbacks[s]===l&&typeof m=="function"&&l.push(m),c())},d=n.call(o&&o.instances[s],e,r,f);let g=Promise.resolve(d);n.length<3&&(g=g.then(f)),g.catch(m=>u(m))})}function extractComponentsGuards(n,e,r,o){const s=[];for(const l of n)for(const c in l.components){let u=l.components[c];if(!(e!=="beforeRouteEnter"&&!l.instances[c]))if(isRouteComponent(u)){const d=(u.__vccOpts||u)[e];d&&s.push(guardToPromiseFn(d,r,o,l,c))}else{let f=u();s.push(()=>f.then(d=>{if(!d)return Promise.reject(new Error(`Couldn't resolve component "${c}" at "${l.path}"`));const g=isESModule(d)?d.default:d;l.components[c]=g;const v=(g.__vccOpts||g)[e];return v&&guardToPromiseFn(v,r,o,l,c)()}))}}return s}function isRouteComponent(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function useLink(n){const e=inject(routerKey),r=inject(routeLocationKey),o=computed(()=>e.resolve(unref(n.to))),s=computed(()=>{const{matched:f}=o.value,{length:d}=f,g=f[d-1],m=r.matched;if(!g||!m.length)return-1;const v=m.findIndex(isSameRouteRecord.bind(null,g));if(v>-1)return v;const b=getOriginalPath(f[d-2]);return d>1&&getOriginalPath(g)===b&&m[m.length-1].path!==b?m.findIndex(isSameRouteRecord.bind(null,f[d-2])):v}),l=computed(()=>s.value>-1&&includesParams(r.params,o.value.params)),c=computed(()=>s.value>-1&&s.value===r.matched.length-1&&isSameRouteLocationParams(r.params,o.value.params));function u(f={}){return guardEvent(f)?e[unref(n.replace)?"replace":"push"](unref(n.to)).catch(noop):Promise.resolve()}return{route:o,href:computed(()=>o.value.href),isActive:l,isExactActive:c,navigate:u}}const RouterLinkImpl=defineComponent({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink,setup(n,{slots:e}){const r=reactive(useLink(n)),{options:o}=inject(routerKey),s=computed(()=>({[getLinkClass(n.activeClass,o.linkActiveClass,"router-link-active")]:r.isActive,[getLinkClass(n.exactActiveClass,o.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const l=e.default&&e.default(r);return n.custom?l:h$1("a",{"aria-current":r.isExactActive?n.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:s.value},l)}}}),RouterLink=RouterLinkImpl;function guardEvent(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function includesParams(n,e){for(const r in e){const o=e[r],s=n[r];if(typeof o=="string"){if(o!==s)return!1}else if(!isArray(s)||s.length!==o.length||o.some((l,c)=>l!==s[c]))return!1}return!0}function getOriginalPath(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const getLinkClass=(n,e,r)=>n??e??r,RouterViewImpl=defineComponent({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:r}){const o=inject(routerViewLocationKey),s=computed(()=>n.route||o.value),l=inject(viewDepthKey,0),c=computed(()=>{let d=unref(l);const{matched:g}=s.value;let m;for(;(m=g[d])&&!m.components;)d++;return d}),u=computed(()=>s.value.matched[c.value]);provide(viewDepthKey,computed(()=>c.value+1)),provide(matchedRouteKey,u),provide(routerViewLocationKey,s);const f=ref();return watch(()=>[f.value,u.value,n.name],([d,g,m],[v,b,k])=>{g&&(g.instances[m]=d,b&&b!==g&&d&&d===v&&(g.leaveGuards.size||(g.leaveGuards=b.leaveGuards),g.updateGuards.size||(g.updateGuards=b.updateGuards))),d&&g&&(!b||!isSameRouteRecord(g,b)||!v)&&(g.enterCallbacks[m]||[]).forEach(R=>R(d))},{flush:"post"}),()=>{const d=s.value,g=n.name,m=u.value,v=m&&m.components[g];if(!v)return normalizeSlot(r.default,{Component:v,route:d});const b=m.props[g],k=b?b===!0?d.params:typeof b=="function"?b(d):b:null,I=h$1(v,assign({},k,e,{onVnodeUnmounted:$=>{$.component.isUnmounted&&(m.instances[g]=null)},ref:f}));return normalizeSlot(r.default,{Component:I,route:d})||I}}});function normalizeSlot(n,e){if(!n)return null;const r=n(e);return r.length===1?r[0]:r}const RouterView=RouterViewImpl;function createRouter(n){const e=createRouterMatcher(n.routes,n),r=n.parseQuery||parseQuery,o=n.stringifyQuery||stringifyQuery,s=n.history,l=useCallbacks(),c=useCallbacks(),u=useCallbacks(),f=shallowRef(START_LOCATION_NORMALIZED);let d=START_LOCATION_NORMALIZED;isBrowser&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const g=applyToParams.bind(null,fe=>""+fe),m=applyToParams.bind(null,encodeParam),v=applyToParams.bind(null,decode);function b(fe,le){let H,J;return isRouteName(fe)?(H=e.getRecordMatcher(fe),J=le):J=fe,e.addRoute(J,H)}function k(fe){const le=e.getRecordMatcher(fe);le&&e.removeRoute(le)}function R(){return e.getRoutes().map(fe=>fe.record)}function I(fe){return!!e.getRecordMatcher(fe)}function $(fe,le){if(le=assign({},le||f.value),typeof fe=="string"){const N=parseURL(r,fe,le.path),_=e.resolve({path:N.path},le),te=s.createHref(N.fullPath);return assign(N,_,{params:v(_.params),hash:decode(N.hash),redirectedFrom:void 0,href:te})}let H;if("path"in fe)H=assign({},fe,{path:parseURL(r,fe.path,le.path).path});else{const N=assign({},fe.params);for(const _ in N)N[_]==null&&delete N[_];H=assign({},fe,{params:m(fe.params)}),le.params=m(le.params)}const J=e.resolve(H,le),Ce=fe.hash||"";J.params=g(v(J.params));const Ve=stringifyURL(o,assign({},fe,{hash:encodeHash(Ce),path:J.path})),Le=s.createHref(Ve);return assign({fullPath:Ve,hash:Ce,query:o===stringifyQuery?normalizeQuery(fe.query):fe.query||{}},J,{redirectedFrom:void 0,href:Le})}function Y(fe){return typeof fe=="string"?parseURL(r,fe,f.value.path):assign({},fe)}function oe(fe,le){if(d!==fe)return createRouterError(8,{from:le,to:fe})}function G(fe){return K(fe)}function q(fe){return G(assign(Y(fe),{replace:!0}))}function ne(fe){const le=fe.matched[fe.matched.length-1];if(le&&le.redirect){const{redirect:H}=le;let J=typeof H=="function"?H(fe):H;return typeof J=="string"&&(J=J.includes("?")||J.includes("#")?J=Y(J):{path:J},J.params={}),assign({query:fe.query,hash:fe.hash,params:"path"in J?{}:fe.params},J)}}function K(fe,le){const H=d=$(fe),J=f.value,Ce=fe.state,Ve=fe.force,Le=fe.replace===!0,N=ne(H);if(N)return K(assign(Y(N),{state:typeof N=="object"?assign({},Ce,N.state):Ce,force:Ve,replace:Le}),le||H);const _=H;_.redirectedFrom=le;let te;return!Ve&&isSameRouteLocation(o,J,H)&&(te=createRouterError(16,{to:_,from:J}),Ae(J,J,!0,!1)),(te?Promise.resolve(te):ge(_,J)).catch(ae=>isNavigationFailure(ae)?isNavigationFailure(ae,2)?ae:Ze(ae):ye(ae,_,J)).then(ae=>{if(ae){if(isNavigationFailure(ae,2))return K(assign({replace:Le},Y(ae.to),{state:typeof ae.to=="object"?assign({},Ce,ae.to.state):Ce,force:Ve}),le||_)}else ae=re(_,J,!0,Le,Ce);return Z(_,J,ae),ae})}function qe(fe,le){const H=oe(fe,le);return H?Promise.reject(H):Promise.resolve()}function ge(fe,le){let H;const[J,Ce,Ve]=extractChangingRecords(fe,le);H=extractComponentsGuards(J.reverse(),"beforeRouteLeave",fe,le);for(const N of J)N.leaveGuards.forEach(_=>{H.push(guardToPromiseFn(_,fe,le))});const Le=qe.bind(null,fe,le);return H.push(Le),runGuardQueue(H).then(()=>{H=[];for(const N of l.list())H.push(guardToPromiseFn(N,fe,le));return H.push(Le),runGuardQueue(H)}).then(()=>{H=extractComponentsGuards(Ce,"beforeRouteUpdate",fe,le);for(const N of Ce)N.updateGuards.forEach(_=>{H.push(guardToPromiseFn(_,fe,le))});return H.push(Le),runGuardQueue(H)}).then(()=>{H=[];for(const N of fe.matched)if(N.beforeEnter&&!le.matched.includes(N))if(isArray(N.beforeEnter))for(const _ of N.beforeEnter)H.push(guardToPromiseFn(_,fe,le));else H.push(guardToPromiseFn(N.beforeEnter,fe,le));return H.push(Le),runGuardQueue(H)}).then(()=>(fe.matched.forEach(N=>N.enterCallbacks={}),H=extractComponentsGuards(Ve,"beforeRouteEnter",fe,le),H.push(Le),runGuardQueue(H))).then(()=>{H=[];for(const N of c.list())H.push(guardToPromiseFn(N,fe,le));return H.push(Le),runGuardQueue(H)}).catch(N=>isNavigationFailure(N,8)?N:Promise.reject(N))}function Z(fe,le,H){for(const J of u.list())J(fe,le,H)}function re(fe,le,H,J,Ce){const Ve=oe(fe,le);if(Ve)return Ve;const Le=le===START_LOCATION_NORMALIZED,N=isBrowser?history.state:{};H&&(J||Le?s.replace(fe.fullPath,assign({scroll:Le&&N&&N.scroll},Ce)):s.push(fe.fullPath,Ce)),f.value=fe,Ae(fe,le,H,Le),Ze()}let He;function st(){He||(He=s.listen((fe,le,H)=>{if(!An.listening)return;const J=$(fe),Ce=ne(J);if(Ce){K(assign(Ce,{replace:!0}),J).catch(noop);return}d=J;const Ve=f.value;isBrowser&&saveScrollPosition(getScrollKey(Ve.fullPath,H.delta),computeScrollPosition()),ge(J,Ve).catch(Le=>isNavigationFailure(Le,12)?Le:isNavigationFailure(Le,2)?(K(Le.to,J).then(N=>{isNavigationFailure(N,20)&&!H.delta&&H.type===NavigationType.pop&&s.go(-1,!1)}).catch(noop),Promise.reject()):(H.delta&&s.go(-H.delta,!1),ye(Le,J,Ve))).then(Le=>{Le=Le||re(J,Ve,!1),Le&&(H.delta&&!isNavigationFailure(Le,8)?s.go(-H.delta,!1):H.type===NavigationType.pop&&isNavigationFailure(Le,20)&&s.go(-1,!1)),Z(J,Ve,Le)}).catch(noop)}))}let ee=useCallbacks(),_e=useCallbacks(),ue;function ye(fe,le,H){Ze(fe);const J=_e.list();return J.length?J.forEach(Ce=>Ce(fe,le,H)):console.error(fe),Promise.reject(fe)}function We(){return ue&&f.value!==START_LOCATION_NORMALIZED?Promise.resolve():new Promise((fe,le)=>{ee.add([fe,le])})}function Ze(fe){return ue||(ue=!fe,st(),ee.list().forEach(([le,H])=>fe?H(fe):le()),ee.reset()),fe}function Ae(fe,le,H,J){const{scrollBehavior:Ce}=n;if(!isBrowser||!Ce)return Promise.resolve();const Ve=!H&&getSavedScrollPosition(getScrollKey(fe.fullPath,0))||(J||!H)&&history.state&&history.state.scroll||null;return nextTick().then(()=>Ce(fe,le,Ve)).then(Le=>Le&&scrollToPosition(Le)).catch(Le=>ye(Le,fe,le))}const Bt=fe=>s.go(fe);let Ge;const Dn=new Set,An={currentRoute:f,listening:!0,addRoute:b,removeRoute:k,hasRoute:I,getRoutes:R,resolve:$,options:n,push:G,replace:q,go:Bt,back:()=>Bt(-1),forward:()=>Bt(1),beforeEach:l.add,beforeResolve:c.add,afterEach:u.add,onError:_e.add,isReady:We,install(fe){const le=this;fe.component("RouterLink",RouterLink),fe.component("RouterView",RouterView),fe.config.globalProperties.$router=le,Object.defineProperty(fe.config.globalProperties,"$route",{enumerable:!0,get:()=>unref(f)}),isBrowser&&!Ge&&f.value===START_LOCATION_NORMALIZED&&(Ge=!0,G(s.location).catch(Ce=>{}));const H={};for(const Ce in START_LOCATION_NORMALIZED)H[Ce]=computed(()=>f.value[Ce]);fe.provide(routerKey,le),fe.provide(routeLocationKey,reactive(H)),fe.provide(routerViewLocationKey,f);const J=fe.unmount;Dn.add(fe),fe.unmount=function(){Dn.delete(fe),Dn.size<1&&(d=START_LOCATION_NORMALIZED,He&&He(),He=null,f.value=START_LOCATION_NORMALIZED,Ge=!1,ue=!1),J()}}};return An}function runGuardQueue(n){return n.reduce((e,r)=>e.then(()=>r()),Promise.resolve())}function extractChangingRecords(n,e){const r=[],o=[],s=[],l=Math.max(e.matched.length,n.matched.length);for(let c=0;c<l;c++){const u=e.matched[c];u&&(n.matched.find(d=>isSameRouteRecord(d,u))?o.push(u):r.push(u));const f=n.matched[c];f&&(e.matched.find(d=>isSameRouteRecord(d,f))||s.push(f))}return[r,o,s]}const _sfc_main$3={__name:"App",setup(n){return(e,r)=>(openBlock(),createBlock(unref(RouterView)))}};class Stack{constructor(e,r,o,s,l,c,u,f,d,g=0,m){this.p=e,this.stack=r,this.state=o,this.reducePos=s,this.pos=l,this.score=c,this.buffer=u,this.bufferBase=f,this.curContext=d,this.lookAhead=g,this.parent=m}toString(){return`[${this.stack.filter((e,r)=>r%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,r,o=0){let s=e.parser.context;return new Stack(e,[],r,o,o,0,[],0,s?new StackContext(s,s.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,r){this.stack.push(this.state,r,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var r;let o=e>>19,s=e&65535,{parser:l}=this.p,c=l.dynamicPrecedence(s);if(c&&(this.score+=c),o==0){this.pushState(l.getGoto(this.state,s,!0),this.reducePos),s<l.minRepeatTerm&&this.storeNode(s,this.reducePos,this.reducePos,4,!0),this.reduceContext(s,this.reducePos);return}let u=this.stack.length-(o-1)*3-(e&262144?6:0),f=u?this.stack[u-2]:this.p.ranges[0].from,d=this.reducePos-f;d>=2e3&&!(!((r=this.p.parser.nodeSet.types[s])===null||r===void 0)&&r.isAnonymous)&&(f==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=d):this.p.lastBigReductionSize<d&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=f,this.p.lastBigReductionSize=d));let g=u?this.stack[u-1]:0,m=this.bufferBase+this.buffer.length-g;if(s<l.minRepeatTerm||e&131072){let v=l.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(s,f,v,m+4,!0)}if(e&262144)this.state=this.stack[u];else{let v=this.stack[u-3];this.state=l.getGoto(v,s,!0)}for(;this.stack.length>u;)this.stack.pop();this.reduceContext(s,f)}storeNode(e,r,o,s=4,l=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let c=this,u=this.buffer.length;if(u==0&&c.parent&&(u=c.bufferBase-c.parent.bufferBase,c=c.parent),u>0&&c.buffer[u-4]==0&&c.buffer[u-1]>-1){if(r==o)return;if(c.buffer[u-2]>=r){c.buffer[u-2]=o;return}}}if(!l||this.pos==o)this.buffer.push(e,r,o,s);else{let c=this.buffer.length;if(c>0&&this.buffer[c-4]!=0)for(;c>0&&this.buffer[c-2]>o;)this.buffer[c]=this.buffer[c-4],this.buffer[c+1]=this.buffer[c-3],this.buffer[c+2]=this.buffer[c-2],this.buffer[c+3]=this.buffer[c-1],c-=4,s>4&&(s-=4);this.buffer[c]=e,this.buffer[c+1]=r,this.buffer[c+2]=o,this.buffer[c+3]=s}}shift(e,r,o){let s=this.pos;if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=o,this.shiftContext(r,s),r<=this.p.parser.maxNode&&this.buffer.push(r,s,o,4);else{let l=e,{parser:c}=this.p;(o>this.pos||r<=c.maxNode)&&(this.pos=o,c.stateFlag(l,1)||(this.reducePos=o)),this.pushState(l,s),this.shiftContext(r,s),r<=c.maxNode&&this.buffer.push(r,s,o,4)}}apply(e,r,o){e&65536?this.reduce(e):this.shift(e,r,o)}useNode(e,r){let o=this.p.reused.length-1;(o<0||this.p.reused[o]!=e)&&(this.p.reused.push(e),o++);let s=this.pos;this.reducePos=this.pos=s+e.length,this.pushState(r,s),this.buffer.push(o,s,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,r=e.buffer.length;for(;r>0&&e.buffer[r-2]>e.reducePos;)r-=4;let o=e.buffer.slice(r),s=e.bufferBase+r;for(;e&&s==e.bufferBase;)e=e.parent;return new Stack(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,o,s,this.curContext,this.lookAhead,e)}recoverByDelete(e,r){let o=e<=this.p.parser.maxNode;o&&this.storeNode(e,this.pos,r,4),this.storeNode(0,this.pos,r,o?8:4),this.pos=this.reducePos=r,this.score-=190}canShift(e){for(let r=new SimulatedStack(this);;){let o=this.p.parser.stateSlot(r.state,4)||this.p.parser.hasAction(r.state,e);if(o==0)return!1;if(!(o&65536))return!0;r.reduce(o)}}recoverByInsert(e){if(this.stack.length>=300)return[];let r=this.p.parser.nextStates(this.state);if(r.length>4<<1||this.stack.length>=120){let s=[];for(let l=0,c;l<r.length;l+=2)(c=r[l+1])!=this.state&&this.p.parser.hasAction(c,e)&&s.push(r[l],c);if(this.stack.length<120)for(let l=0;s.length<4<<1&&l<r.length;l+=2){let c=r[l+1];s.some((u,f)=>f&1&&u==c)||s.push(r[l],c)}r=s}let o=[];for(let s=0;s<r.length&&o.length<4;s+=2){let l=r[s+1];if(l==this.state)continue;let c=this.split();c.pushState(l,this.pos),c.storeNode(0,c.pos,c.pos,4,!0),c.shiftContext(r[s],this.pos),c.score-=200,o.push(c)}return o}forceReduce(){let e=this.p.parser.stateSlot(this.state,5);if(!(e&65536))return!1;let{parser:r}=this.p;if(!r.validAction(this.state,e)){let o=e>>19,s=e&65535,l=this.stack.length-o*3;if(l<0||r.getGoto(this.stack[l],s,!1)<0)return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let r=0;r<this.stack.length;r+=3)if(this.stack[r]!=e.stack[r])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,r){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(r)))}reduceContext(e,r){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(r)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4)}updateContext(e){if(e!=this.curContext.context){let r=new StackContext(this.curContext.tracker,e);r.hash!=this.curContext.hash&&this.emitContext(),this.curContext=r}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class StackContext{constructor(e,r){this.tracker=e,this.context=r,this.hash=e.strict?e.hash(r):0}}var Recover;(function(n){n[n.Insert=200]="Insert",n[n.Delete=190]="Delete",n[n.Reduce=100]="Reduce",n[n.MaxNext=4]="MaxNext",n[n.MaxInsertStackDepth=300]="MaxInsertStackDepth",n[n.DampenInsertStackDepth=120]="DampenInsertStackDepth",n[n.MinBigReduction=2e3]="MinBigReduction"})(Recover||(Recover={}));class SimulatedStack{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let r=e&65535,o=e>>19;o==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(o-1)*3;let s=this.start.p.parser.getGoto(this.stack[this.base-3],r,!0);this.state=s}}class StackBufferCursor{constructor(e,r,o){this.stack=e,this.pos=r,this.index=o,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,r=e.bufferBase+e.buffer.length){return new StackBufferCursor(e,r,r-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new StackBufferCursor(this.stack,this.pos,this.index)}}function decodeArray(n,e=Uint16Array){if(typeof n!="string")return n;let r=null;for(let o=0,s=0;o<n.length;){let l=0;for(;;){let c=n.charCodeAt(o++),u=!1;if(c==126){l=65535;break}c>=92&&c--,c>=34&&c--;let f=c-32;if(f>=46&&(f-=46,u=!0),l+=f,u)break;l*=46}r?r[s++]=l:r=new e(l)}return r}class CachedToken{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const nullToken=new CachedToken;class InputStream{constructor(e,r){this.input=e,this.ranges=r,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=nullToken,this.rangeIndex=0,this.pos=this.chunkPos=r[0].from,this.range=r[0],this.end=r[r.length-1].to,this.readNext()}resolveOffset(e,r){let o=this.range,s=this.rangeIndex,l=this.pos+e;for(;l<o.from;){if(!s)return null;let c=this.ranges[--s];l-=o.from-c.to,o=c}for(;r<0?l>o.to:l>=o.to;){if(s==this.ranges.length-1)return null;let c=this.ranges[++s];l+=c.from-o.to,o=c}return l}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let r of this.ranges)if(r.to>e)return Math.max(e,r.from);return this.end}peek(e){let r=this.chunkOff+e,o,s;if(r>=0&&r<this.chunk.length)o=this.pos+e,s=this.chunk.charCodeAt(r);else{let l=this.resolveOffset(e,1);if(l==null)return-1;if(o=l,o>=this.chunk2Pos&&o<this.chunk2Pos+this.chunk2.length)s=this.chunk2.charCodeAt(o-this.chunk2Pos);else{let c=this.rangeIndex,u=this.range;for(;u.to<=o;)u=this.ranges[++c];this.chunk2=this.input.chunk(this.chunk2Pos=o),o+this.chunk2.length>u.to&&(this.chunk2=this.chunk2.slice(0,u.to-o)),s=this.chunk2.charCodeAt(0)}}return o>=this.token.lookAhead&&(this.token.lookAhead=o+1),s}acceptToken(e,r=0){let o=r?this.resolveOffset(r,-1):this.pos;if(o==null||o<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=o}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:r}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=r,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),r=this.pos+e.length;this.chunk=r>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,r){if(r?(this.token=r,r.start=e,r.lookAhead=e+1,r.value=r.extended=-1):this.token=nullToken,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,r){if(e>=this.chunkPos&&r<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,r-this.chunkPos);if(e>=this.chunk2Pos&&r<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,r-this.chunk2Pos);if(e>=this.range.from&&r<=this.range.to)return this.input.read(e,r);let o="";for(let s of this.ranges){if(s.from>=r)break;s.to>e&&(o+=this.input.read(Math.max(s.from,e),Math.min(s.to,r)))}return o}}class TokenGroup{constructor(e,r){this.data=e,this.id=r}token(e,r){let{parser:o}=r.p;readToken(this.data,e,r,this.id,o.data,o.tokenPrecTable)}}TokenGroup.prototype.contextual=TokenGroup.prototype.fallback=TokenGroup.prototype.extend=!1;TokenGroup.prototype.fallback=TokenGroup.prototype.extend=!1;function readToken(n,e,r,o,s,l){let c=0,u=1<<o,{dialect:f}=r.p.parser;e:for(;u&n[c];){let d=n[c+1];for(let b=c+3;b<d;b+=2)if((n[b+1]&u)>0){let k=n[b];if(f.allows(k)&&(e.token.value==-1||e.token.value==k||overrides(k,e.token.value,s,l))){e.acceptToken(k);break}}let g=e.next,m=0,v=n[c+2];if(e.next<0&&v>m&&n[d+v*3-3]==65535&&n[d+v*3-3]==65535){c=n[d+v*3-1];continue e}for(;m<v;){let b=m+v>>1,k=d+b+(b<<1),R=n[k],I=n[k+1]||65536;if(g<R)v=b;else if(g>=I)m=b+1;else{c=n[k+2],e.advance();continue e}}break}}function findOffset(n,e,r){for(let o=e,s;(s=n[o])!=65535;o++)if(s==r)return o-e;return-1}function overrides(n,e,r,o){let s=findOffset(r,o,e);return s<0||findOffset(r,o,n)<s}const verbose=typeof process<"u"&&process.env&&/\bparse\b/.test({}.LOG);let stackIDs=null;var Safety;(function(n){n[n.Margin=25]="Margin"})(Safety||(Safety={}));function cutAt(n,e,r){let o=n.cursor(IterMode.IncludeAnonymous);for(o.moveTo(e);;)if(!(r<0?o.childBefore(e):o.childAfter(e)))for(;;){if((r<0?o.to<e:o.from>e)&&!o.type.isError)return r<0?Math.max(0,Math.min(o.to-1,e-25)):Math.min(n.length,Math.max(o.from+1,e+25));if(r<0?o.prevSibling():o.nextSibling())break;if(!o.parent())return r<0?0:n.length}}class FragmentCursor{constructor(e,r){this.fragments=e,this.nodeSet=r,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?cutAt(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?cutAt(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let r=this.trees.length-1;if(r<0)return this.nextFragment(),null;let o=this.trees[r],s=this.index[r];if(s==o.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let l=o.children[s],c=this.start[r]+o.positions[s];if(c>e)return this.nextStart=c,null;if(l instanceof Tree){if(c==e){if(c<this.safeFrom)return null;let u=c+l.length;if(u<=this.safeTo){let f=l.prop(NodeProp.lookAhead);if(!f||u+f<this.fragment.to)return l}}this.index[r]++,c+l.length>=Math.max(this.safeFrom,e)&&(this.trees.push(l),this.start.push(c),this.index.push(0))}else this.index[r]++,this.nextStart=c+l.length}}}class TokenCache{constructor(e,r){this.stream=r,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(o=>new CachedToken)}getActions(e){let r=0,o=null,{parser:s}=e.p,{tokenizers:l}=s,c=s.stateSlot(e.state,3),u=e.curContext?e.curContext.hash:0,f=0;for(let d=0;d<l.length;d++){if(!(1<<d&c))continue;let g=l[d],m=this.tokens[d];if(!(o&&!g.fallback)&&((g.contextual||m.start!=e.pos||m.mask!=c||m.context!=u)&&(this.updateCachedToken(m,g,e),m.mask=c,m.context=u),m.lookAhead>m.end+25&&(f=Math.max(m.lookAhead,f)),m.value!=0)){let v=r;if(m.extended>-1&&(r=this.addActions(e,m.extended,m.end,r)),r=this.addActions(e,m.value,m.end,r),!g.extend&&(o=m,r>v))break}}for(;this.actions.length>r;)this.actions.pop();return f&&e.setLookAhead(f),!o&&e.pos==this.stream.end&&(o=new CachedToken,o.value=e.p.parser.eofTerm,o.start=o.end=e.pos,r=this.addActions(e,o.value,o.end,r)),this.mainToken=o,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let r=new CachedToken,{pos:o,p:s}=e;return r.start=o,r.end=Math.min(o+1,s.stream.end),r.value=o==s.stream.end?s.parser.eofTerm:0,r}updateCachedToken(e,r,o){let s=this.stream.clipPos(o.pos);if(r.token(this.stream.reset(s,e),o),e.value>-1){let{parser:l}=o.p;for(let c=0;c<l.specialized.length;c++)if(l.specialized[c]==e.value){let u=l.specializers[c](this.stream.read(e.start,e.end),o);if(u>=0&&o.p.parser.dialect.allows(u>>1)){u&1?e.extended=u>>1:e.value=u>>1;break}}}else e.value=0,e.end=this.stream.clipPos(s+1)}putAction(e,r,o,s){for(let l=0;l<s;l+=3)if(this.actions[l]==e)return s;return this.actions[s++]=e,this.actions[s++]=r,this.actions[s++]=o,s}addActions(e,r,o,s){let{state:l}=e,{parser:c}=e.p,{data:u}=c;for(let f=0;f<2;f++)for(let d=c.stateSlot(l,f?2:1);;d+=3){if(u[d]==65535)if(u[d+1]==1)d=pair(u,d+2);else{s==0&&u[d+1]==2&&(s=this.putAction(pair(u,d+2),r,o,s));break}u[d]==r&&(s=this.putAction(pair(u,d+1),r,o,s))}return s}}var Rec;(function(n){n[n.Distance=5]="Distance",n[n.MaxRemainingPerStep=3]="MaxRemainingPerStep",n[n.MinBufferLengthPrune=500]="MinBufferLengthPrune",n[n.ForceReduceLimit=10]="ForceReduceLimit",n[n.CutDepth=15e3]="CutDepth",n[n.CutTo=9e3]="CutTo",n[n.MaxLeftAssociativeReductionCount=300]="MaxLeftAssociativeReductionCount",n[n.MaxStackCount=12]="MaxStackCount"})(Rec||(Rec={}));class Parse{constructor(e,r,o,s){this.parser=e,this.input=r,this.ranges=s,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new InputStream(r,s),this.tokens=new TokenCache(e,this.stream),this.topTerm=e.top[1];let{from:l}=s[0];this.stacks=[Stack.start(this,e.top[0],l)],this.fragments=o.length&&this.stream.end-l>e.bufferLength*4?new FragmentCursor(o,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,r=this.minStackPos,o=this.stacks=[],s,l;if(this.bigReductionCount>300&&e.length==1){let[c]=e;for(;c.forceReduce()&&c.stack.length&&c.stack[c.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let c=0;c<e.length;c++){let u=e[c];for(;;){if(this.tokens.mainToken=null,u.pos>r)o.push(u);else{if(this.advanceStack(u,o,e))continue;{s||(s=[],l=[]),s.push(u);let f=this.tokens.getMainToken(u);l.push(f.value,f.end)}}break}}if(!o.length){let c=s&&findFinished(s);if(c)return this.stackToTree(c);if(this.parser.strict)throw verbose&&s&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+r);this.recovering||(this.recovering=5)}if(this.recovering&&s){let c=this.stoppedAt!=null&&s[0].pos>this.stoppedAt?s[0]:this.runRecovery(s,l,o);if(c)return this.stackToTree(c.forceAll())}if(this.recovering){let c=this.recovering==1?1:this.recovering*3;if(o.length>c)for(o.sort((u,f)=>f.score-u.score);o.length>c;)o.pop();o.some(u=>u.reducePos>r)&&this.recovering--}else if(o.length>1){e:for(let c=0;c<o.length-1;c++){let u=o[c];for(let f=c+1;f<o.length;f++){let d=o[f];if(u.sameState(d)||u.buffer.length>500&&d.buffer.length>500)if((u.score-d.score||u.buffer.length-d.buffer.length)>0)o.splice(f--,1);else{o.splice(c--,1);continue e}}}o.length>12&&o.splice(12,o.length-12)}this.minStackPos=o[0].pos;for(let c=1;c<o.length;c++)o[c].pos<this.minStackPos&&(this.minStackPos=o[c].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,r,o){let s=e.pos,{parser:l}=this,c=verbose?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&s>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let d=e.curContext&&e.curContext.tracker.strict,g=d?e.curContext.hash:0;for(let m=this.fragments.nodeAt(s);m;){let v=this.parser.nodeSet.types[m.type.id]==m.type?l.getGoto(e.state,m.type.id):-1;if(v>-1&&m.length&&(!d||(m.prop(NodeProp.contextHash)||0)==g))return e.useNode(m,v),verbose&&console.log(c+this.stackID(e)+` (via reuse of ${l.getName(m.type.id)})`),!0;if(!(m instanceof Tree)||m.children.length==0||m.positions[0]>0)break;let b=m.children[0];if(b instanceof Tree&&m.positions[0]==0)m=b;else break}}let u=l.stateSlot(e.state,4);if(u>0)return e.reduce(u),verbose&&console.log(c+this.stackID(e)+` (via always-reduce ${l.getName(u&65535)})`),!0;if(e.stack.length>=15e3)for(;e.stack.length>9e3&&e.forceReduce(););let f=this.tokens.getActions(e);for(let d=0;d<f.length;){let g=f[d++],m=f[d++],v=f[d++],b=d==f.length||!o,k=b?e:e.split();if(k.apply(g,m,v),verbose&&console.log(c+this.stackID(k)+` (via ${g&65536?`reduce of ${l.getName(g&65535)}`:"shift"} for ${l.getName(m)} @ ${s}${k==e?"":", split"})`),b)return!0;k.pos>s?r.push(k):o.push(k)}return!1}advanceFully(e,r){let o=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>o)return pushStackDedup(e,r),!0}}runRecovery(e,r,o){let s=null,l=!1;for(let c=0;c<e.length;c++){let u=e[c],f=r[c<<1],d=r[(c<<1)+1],g=verbose?this.stackID(u)+" -> ":"";if(u.deadEnd&&(l||(l=!0,u.restart(),verbose&&console.log(g+this.stackID(u)+" (restarted)"),this.advanceFully(u,o))))continue;let m=u.split(),v=g;for(let b=0;m.forceReduce()&&b<10&&(verbose&&console.log(v+this.stackID(m)+" (via force-reduce)"),!this.advanceFully(m,o));b++)verbose&&(v=this.stackID(m)+" -> ");for(let b of u.recoverByInsert(f))verbose&&console.log(g+this.stackID(b)+" (via recover-insert)"),this.advanceFully(b,o);this.stream.end>u.pos?(d==u.pos&&(d++,f=0),u.recoverByDelete(f,d),verbose&&console.log(g+this.stackID(u)+` (via recover-delete ${this.parser.getName(f)})`),pushStackDedup(u,o)):(!s||s.score<u.score)&&(s=u)}return s}stackToTree(e){return e.close(),Tree.build({buffer:StackBufferCursor.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let r=(stackIDs||(stackIDs=new WeakMap)).get(e);return r||stackIDs.set(e,r=String.fromCodePoint(this.nextStackID++)),r+e}}function pushStackDedup(n,e){for(let r=0;r<e.length;r++){let o=e[r];if(o.pos==n.pos&&o.sameState(n)){e[r].score<n.score&&(e[r]=n);return}}e.push(n)}class Dialect{constructor(e,r,o){this.source=e,this.flags=r,this.disabled=o}allows(e){return!this.disabled||this.disabled[e]==0}}class LRParser extends Parser{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let r=e.nodeNames.split(" ");this.minRepeatTerm=r.length;for(let u=0;u<e.repeatNodeCount;u++)r.push("");let o=Object.keys(e.topRules).map(u=>e.topRules[u][1]),s=[];for(let u=0;u<r.length;u++)s.push([]);function l(u,f,d){s[u].push([f,f.deserialize(String(d))])}if(e.nodeProps)for(let u of e.nodeProps){let f=u[0];typeof f=="string"&&(f=NodeProp[f]);for(let d=1;d<u.length;){let g=u[d++];if(g>=0)l(g,f,u[d++]);else{let m=u[d+-g];for(let v=-g;v>0;v--)l(u[d++],f,m);d++}}}this.nodeSet=new NodeSet(r.map((u,f)=>NodeType.define({name:f>=this.minRepeatTerm?void 0:u,id:f,props:s[f],top:o.indexOf(f)>-1,error:f==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(f)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=DefaultBufferLength;let c=decodeArray(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let u=0;u<this.specializerSpecs.length;u++)this.specialized[u]=this.specializerSpecs[u].term;this.specializers=this.specializerSpecs.map(getSpecializer),this.states=decodeArray(e.states,Uint32Array),this.data=decodeArray(e.stateData),this.goto=decodeArray(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(u=>typeof u=="number"?new TokenGroup(c,u):u),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,r,o){let s=new Parse(this,e,r,o);for(let l of this.wrappers)s=l(s,e,r,o);return s}getGoto(e,r,o=!1){let s=this.goto;if(r>=s[0])return-1;for(let l=s[r+1];;){let c=s[l++],u=c&1,f=s[l++];if(u&&o)return f;for(let d=l+(c>>1);l<d;l++)if(s[l]==e)return f;if(u)return-1}}hasAction(e,r){let o=this.data;for(let s=0;s<2;s++)for(let l=this.stateSlot(e,s?2:1),c;;l+=3){if((c=o[l])==65535)if(o[l+1]==1)c=o[l=pair(o,l+2)];else{if(o[l+1]==2)return pair(o,l+2);break}if(c==r||c==0)return pair(o,l+1)}return 0}stateSlot(e,r){return this.states[e*6+r]}stateFlag(e,r){return(this.stateSlot(e,0)&r)>0}validAction(e,r){if(r==this.stateSlot(e,4))return!0;for(let o=this.stateSlot(e,1);;o+=3){if(this.data[o]==65535)if(this.data[o+1]==1)o=pair(this.data,o+2);else return!1;if(r==pair(this.data,o+1))return!0}}nextStates(e){let r=[];for(let o=this.stateSlot(e,1);;o+=3){if(this.data[o]==65535)if(this.data[o+1]==1)o=pair(this.data,o+2);else break;if(!(this.data[o+2]&1)){let s=this.data[o+1];r.some((l,c)=>c&1&&l==s)||r.push(this.data[o],s)}}return r}configure(e){let r=Object.assign(Object.create(LRParser.prototype),this);if(e.props&&(r.nodeSet=this.nodeSet.extend(...e.props)),e.top){let o=this.topRules[e.top];if(!o)throw new RangeError(`Invalid top rule name ${e.top}`);r.top=o}return e.tokenizers&&(r.tokenizers=this.tokenizers.map(o=>{let s=e.tokenizers.find(l=>l.from==o);return s?s.to:o})),e.specializers&&(r.specializers=this.specializers.slice(),r.specializerSpecs=this.specializerSpecs.map((o,s)=>{let l=e.specializers.find(u=>u.from==o.external);if(!l)return o;let c=Object.assign(Object.assign({},o),{external:l.to});return r.specializers[s]=getSpecializer(c),c})),e.contextTracker&&(r.context=e.contextTracker),e.dialect&&(r.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(r.strict=e.strict),e.wrap&&(r.wrappers=r.wrappers.concat(e.wrap)),e.bufferLength!=null&&(r.bufferLength=e.bufferLength),r}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let r=this.dynamicPrecedences;return r==null?0:r[e]||0}parseDialect(e){let r=Object.keys(this.dialects),o=r.map(()=>!1);if(e)for(let l of e.split(" ")){let c=r.indexOf(l);c>=0&&(o[c]=!0)}let s=null;for(let l=0;l<r.length;l++)if(!o[l])for(let c=this.dialects[r[l]],u;(u=this.data[c++])!=65535;)(s||(s=new Uint8Array(this.maxTerm+1)))[u]=1;return new Dialect(e,o,s)}static deserialize(e){return new LRParser(e)}}function pair(n,e){return n[e]|n[e+1]<<16}function findFinished(n){let e=null;for(let r of n){let o=r.p.stoppedAt;(r.pos==r.p.stream.end||o!=null&&r.pos>o)&&r.p.parser.stateFlag(r.state,2)&&(!e||e.score<r.score)&&(e=r)}return e}function getSpecializer(n){if(n.external){let e=n.extend?1:0;return(r,o)=>n.external(r,o)<<1|e}return n.get}const jsonHighlighting=styleTags({String:tags.string,Number:tags.number,"True False":tags.bool,PropertyName:tags.propertyName,Null:tags.null,",":tags.separator,"[ ]":tags.squareBracket,"{ }":tags.brace}),parser=LRParser.deserialize({version:14,states:"$bOVQPOOOOQO'#Cb'#CbOnQPO'#CeOvQPO'#CjOOQO'#Cp'#CpQOQPOOOOQO'#Cg'#CgO}QPO'#CfO!SQPO'#CrOOQO,59P,59PO![QPO,59PO!aQPO'#CuOOQO,59U,59UO!iQPO,59UOVQPO,59QOqQPO'#CkO!nQPO,59^OOQO1G.k1G.kOVQPO'#ClO!vQPO,59aOOQO1G.p1G.pOOQO1G.l1G.lOOQO,59V,59VOOQO-E6i-E6iOOQO,59W,59WOOQO-E6j-E6j",stateData:"#O~OcOS~OQSORSOSSOTSOWQO]ROePO~OVXOeUO~O[[O~PVOg^O~Oh_OVfX~OVaO~OhbO[iX~O[dO~Oh_OVfa~OhbO[ia~O",goto:"!kjPPPPPPkPPkqwPPk{!RPPP!XP!ePP!hXSOR^bQWQRf_TVQ_Q`WRg`QcZRicQTOQZRQe^RhbRYQR]R",nodeNames:" JsonText True False Null Number String } { Object Property PropertyName ] [ Array",maxTerm:25,nodeProps:[["openedBy",7,"{",12,"["],["closedBy",8,"}",13,"]"]],propSources:[jsonHighlighting],skippedNodes:[0],repeatNodeCount:2,tokenData:"(p~RaXY!WYZ!W]^!Wpq!Wrs!]|}$i}!O$n!Q!R$w!R![&V![!]&h!}#O&m#P#Q&r#Y#Z&w#b#c'f#h#i'}#o#p(f#q#r(k~!]Oc~~!`Upq!]qr!]rs!rs#O!]#O#P!w#P~!]~!wOe~~!zXrs!]!P!Q!]#O#P!]#U#V!]#Y#Z!]#b#c!]#f#g!]#h#i!]#i#j#g~#jR!Q![#s!c!i#s#T#Z#s~#vR!Q![$P!c!i$P#T#Z$P~$SR!Q![$]!c!i$]#T#Z$]~$`R!Q![!]!c!i!]#T#Z!]~$nOh~~$qQ!Q!R$w!R![&V~$|RT~!O!P%V!g!h%k#X#Y%k~%YP!Q![%]~%bRT~!Q![%]!g!h%k#X#Y%k~%nR{|%w}!O%w!Q![%}~%zP!Q![%}~&SPT~!Q![%}~&[ST~!O!P%V!Q![&V!g!h%k#X#Y%k~&mOg~~&rO]~~&wO[~~&zP#T#U&}~'QP#`#a'T~'WP#g#h'Z~'^P#X#Y'a~'fOR~~'iP#i#j'l~'oP#`#a'r~'uP#`#a'x~'}OS~~(QP#f#g(T~(WP#i#j(Z~(^P#X#Y(a~(fOQ~~(kOW~~(pOV~",tokenizers:[0],topRules:{JsonText:[0,1]},tokenPrec:0}),jsonLanguage=LRLanguage.define({name:"json",parser:parser.configure({props:[indentNodeProp.add({Object:continuedIndent({except:/^\s*\}/}),Array:continuedIndent({except:/^\s*\]/})}),foldNodeProp.add({"Object Array":foldInside})]}),languageData:{closeBrackets:{brackets:["[","{",'"']},indentOnInput:/^\s*[\}\]]$/}});function json(){return new LanguageSupport(jsonLanguage)}const chalky="#e5c07b",coral="#e06c75",cyan="#56b6c2",invalid="#ffffff",ivory="#abb2bf",stone="#7d8799",malibu="#61afef",sage="#98c379",whiskey="#d19a66",violet="#c678dd",darkBackground="#21252b",highlightBackground="#2c313a",background="#282c34",tooltipBackground="#353a42",selection="#3E4451",cursor="#528bff",oneDarkTheme=EditorView.theme({"&":{color:ivory,backgroundColor:background},".cm-content":{caretColor:cursor},".cm-cursor, .cm-dropCursor":{borderLeftColor:cursor},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:selection},".cm-panels":{backgroundColor:darkBackground,color:ivory},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:background,color:stone,border:"none"},".cm-activeLineGutter":{backgroundColor:highlightBackground},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:tooltipBackground},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:tooltipBackground,borderBottomColor:tooltipBackground},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:highlightBackground,color:ivory}}},{dark:!0}),oneDarkHighlightStyle=HighlightStyle.define([{tag:tags.keyword,color:violet},{tag:[tags.name,tags.deleted,tags.character,tags.propertyName,tags.macroName],color:coral},{tag:[tags.function(tags.variableName),tags.labelName],color:malibu},{tag:[tags.color,tags.constant(tags.name),tags.standard(tags.name)],color:whiskey},{tag:[tags.definition(tags.name),tags.separator],color:ivory},{tag:[tags.typeName,tags.className,tags.number,tags.changed,tags.annotation,tags.modifier,tags.self,tags.namespace],color:chalky},{tag:[tags.operator,tags.operatorKeyword,tags.url,tags.escape,tags.regexp,tags.link,tags.special(tags.string)],color:cyan},{tag:[tags.meta,tags.comment],color:stone},{tag:tags.strong,fontWeight:"bold"},{tag:tags.emphasis,fontStyle:"italic"},{tag:tags.strikethrough,textDecoration:"line-through"},{tag:tags.link,color:stone,textDecoration:"underline"},{tag:tags.heading,fontWeight:"bold",color:coral},{tag:[tags.atom,tags.bool,tags.special(tags.variableName)],color:whiskey},{tag:[tags.processingInstruction,tags.string,tags.inserted],color:sage},{tag:tags.invalid,color:invalid}]),oneDark=[oneDarkTheme,syntaxHighlighting(oneDarkHighlightStyle)];var _o;const to=typeof window<"u",Ir=n=>typeof n<"u",Tr=n=>typeof n=="boolean",ze=n=>typeof n=="function",Te=n=>typeof n=="number",Pe=n=>typeof n=="string",Pr=()=>{};to&&(_o=window==null?void 0:window.navigator)!=null&&_o.userAgent&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function se(n){return typeof n=="function"?n():unref(n)}function Dr(n,e){function r(...o){return new Promise((s,l)=>{Promise.resolve(n(()=>e.apply(this,o),{fn:e,thisArg:this,args:o})).then(s).catch(l)})}return r}const vi=n=>n();function Ar(n=vi){const e=ref(!0);function r(){e.value=!1}function o(){e.value=!0}const s=(...l)=>{e.value&&n(...l)};return{isActive:readonly(e),pause:r,resume:o,eventFilter:s}}function wo(n,e=!1,r="Timeout"){return new Promise((o,s)=>{setTimeout(e?()=>s(r):o,n)})}function zr(n){return n}function wn(n,e){let r,o,s;const l=ref(!0),c=()=>{l.value=!0,s()};watch(n,c,{flush:"sync"});const u=ze(e)?e:e.get,f=ze(e)?void 0:e.set,d=customRef((g,m)=>(o=g,s=m,{get(){return l.value&&(r=u(),l.value=!1),o(),r},set(v){f==null||f(v)}}));return Object.isExtensible(d)&&(d.trigger=c),d}function Mt(n){return getCurrentScope()?(onScopeDispose(n),!0):!1}function Br(n,e=!0){getCurrentInstance()?onMounted(n):e?n():nextTick(n)}function Rn(n,e=!1){function r(m,{flush:v="sync",deep:b=!1,timeout:k,throwOnTimeout:R}={}){let I=null;const $=[new Promise(Y=>{I=watch(n,oe=>{m(oe)!==e&&(I==null||I(),Y(oe))},{flush:v,deep:b,immediate:!0})})];return k!=null&&$.push(wo(k,R).then(()=>se(n)).finally(()=>I==null?void 0:I())),Promise.race($)}function o(m,v){if(!isRef(m))return r(oe=>oe===m,v);const{flush:b="sync",deep:k=!1,timeout:R,throwOnTimeout:I}=v??{};let $=null;const Y=[new Promise(oe=>{$=watch([n,m],([G,q])=>{e!==(G===q)&&($==null||$(),oe(G))},{flush:b,deep:k,immediate:!0})})];return R!=null&&Y.push(wo(R,I).then(()=>se(n)).finally(()=>($==null||$(),se(n)))),Promise.race(Y)}function s(m){return r(v=>!!v,m)}function l(m){return o(null,m)}function c(m){return o(void 0,m)}function u(m){return r(Number.isNaN,m)}function f(m,v){return r(b=>{const k=Array.from(b);return k.includes(m)||k.includes(se(m))},v)}function d(m){return g(1,m)}function g(m=1,v){let b=-1;return r(()=>(b+=1,b>=m),v)}return Array.isArray(se(n))?{toMatch:r,toContains:f,changed:d,changedTimes:g,get not(){return Rn(n,!e)}}:{toMatch:r,toBe:o,toBeTruthy:s,toBeNull:l,toBeNaN:u,toBeUndefined:c,changed:d,changedTimes:g,get not(){return Rn(n,!e)}}}function pe(n){return Rn(n)}var bo=Object.getOwnPropertySymbols,Rr=Object.prototype.hasOwnProperty,Vr=Object.prototype.propertyIsEnumerable,Hr=(n,e)=>{var r={};for(var o in n)Rr.call(n,o)&&e.indexOf(o)<0&&(r[o]=n[o]);if(n!=null&&bo)for(var o of bo(n))e.indexOf(o)<0&&Vr.call(n,o)&&(r[o]=n[o]);return r};function Lr(n,e,r={}){const o=r,{eventFilter:s=vi}=o,l=Hr(o,["eventFilter"]);return watch(n,Dr(s,e),l)}var Fr=Object.defineProperty,Gr=Object.defineProperties,Yr=Object.getOwnPropertyDescriptors,Ft=Object.getOwnPropertySymbols,mi=Object.prototype.hasOwnProperty,pi=Object.prototype.propertyIsEnumerable,Eo=(n,e,r)=>e in n?Fr(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Xr=(n,e)=>{for(var r in e||(e={}))mi.call(e,r)&&Eo(n,r,e[r]);if(Ft)for(var r of Ft(e))pi.call(e,r)&&Eo(n,r,e[r]);return n},Ur=(n,e)=>Gr(n,Yr(e)),Zr=(n,e)=>{var r={};for(var o in n)mi.call(n,o)&&e.indexOf(o)<0&&(r[o]=n[o]);if(n!=null&&Ft)for(var o of Ft(n))e.indexOf(o)<0&&pi.call(n,o)&&(r[o]=n[o]);return r};function Je(n,e,r={}){const o=r,{eventFilter:s}=o,l=Zr(o,["eventFilter"]),{eventFilter:c,pause:u,resume:f,isActive:d}=Ar(s);return{stop:Lr(n,e,Ur(Xr({},l),{eventFilter:c})),pause:u,resume:f,isActive:d}}function yi(n){var e;const r=se(n);return(e=r==null?void 0:r.$el)!=null?e:r}const no=to?window:void 0;function oo(...n){let e,r,o,s;if(Pe(n[0])||Array.isArray(n[0])?([r,o,s]=n,e=no):[e,r,o,s]=n,!e)return Pr;Array.isArray(r)||(r=[r]),Array.isArray(o)||(o=[o]);const l=[],c=()=>{l.forEach(g=>g()),l.length=0},u=(g,m,v,b)=>(g.addEventListener(m,v,b),()=>g.removeEventListener(m,v,b)),f=watch(()=>[yi(e),se(s)],([g,m])=>{c(),g&&l.push(...r.flatMap(v=>o.map(b=>u(g,v,b,m))))},{immediate:!0,flush:"post"}),d=()=>{f(),c()};return Mt(d),d}const Kr=n=>typeof n=="function"?n:typeof n=="string"?e=>e.key===n:Array.isArray(n)?e=>n.includes(e.key):()=>!0;function So(...n){let e,r,o={};n.length===3?(e=n[0],r=n[1],o=n[2]):n.length===2?typeof n[1]=="object"?(e=!0,r=n[0],o=n[1]):(e=n[0],r=n[1]):(e=!0,r=n[0]);const{target:s=no,eventName:l="keydown",passive:c=!1}=o,u=Kr(e);return oo(s,l,f=>{u(f)&&r(f)},c)}function Wr(n,e=!1){const r=ref(),o=()=>r.value=!!n();return o(),Br(o,e),r}function qr(n){return JSON.parse(JSON.stringify(n))}const Vn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Hn="__vueuse_ssr_handlers__";Vn[Hn]=Vn[Hn]||{};var No=Object.getOwnPropertySymbols,jr=Object.prototype.hasOwnProperty,Qr=Object.prototype.propertyIsEnumerable,Jr=(n,e)=>{var r={};for(var o in n)jr.call(n,o)&&e.indexOf(o)<0&&(r[o]=n[o]);if(n!=null&&No)for(var o of No(n))e.indexOf(o)<0&&Qr.call(n,o)&&(r[o]=n[o]);return r};function ea(n,e,r={}){const o=r,{window:s=no}=o,l=Jr(o,["window"]);let c;const u=Wr(()=>s&&"ResizeObserver"in s),f=()=>{c&&(c.disconnect(),c=void 0)},d=watch(()=>yi(n),m=>{f(),u.value&&s&&m&&(c=new ResizeObserver(e),c.observe(m,l))},{immediate:!0,flush:"post"}),g=()=>{f(),d()};return Mt(g),{isSupported:u,stop:g}}var Co;(function(n){n.UP="UP",n.RIGHT="RIGHT",n.DOWN="DOWN",n.LEFT="LEFT",n.NONE="NONE"})(Co||(Co={}));var ta=Object.defineProperty,Mo=Object.getOwnPropertySymbols,na=Object.prototype.hasOwnProperty,oa=Object.prototype.propertyIsEnumerable,$o=(n,e,r)=>e in n?ta(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,ia=(n,e)=>{for(var r in e||(e={}))na.call(e,r)&&$o(n,r,e[r]);if(Mo)for(var r of Mo(e))oa.call(e,r)&&$o(n,r,e[r]);return n};const ra={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};ia({linear:zr},ra);function yt(n,e,r,o={}){var s,l,c;const{clone:u=!1,passive:f=!1,eventName:d,deep:g=!1,defaultValue:m}=o,v=getCurrentInstance(),b=r||(v==null?void 0:v.emit)||((s=v==null?void 0:v.$emit)==null?void 0:s.bind(v))||((c=(l=v==null?void 0:v.proxy)==null?void 0:l.$emit)==null?void 0:c.bind(v==null?void 0:v.proxy));let k=d;e||(e="modelValue"),k=d||k||`update:${e.toString()}`;const R=$=>u?ze(u)?u($):qr($):$,I=()=>Ir(n[e])?R(n[e]):m;if(f){const $=I(),Y=ref($);return watch(()=>n[e],oe=>Y.value=R(oe)),watch(Y,oe=>{(oe!==n[e]||g)&&b(k,oe)},{deep:g}),Y}else return computed({get(){return I()},set($){b(k,$)}})}function X(n=()=>{}){const e=ref(new Set);n&&e.value.add(n);const r=o=>{e.value.delete(o)};return{on:o=>{e.value.has(n)&&e.value.delete(n),e.value.add(o);const s=()=>r(o);return Mt(s),{off:s}},off:r,trigger:o=>Promise.all(Array.from(e.value).map(s=>s(o))),fns:e}}const aa=["production","prod"];function wt(n,...e){aa.includes("production")||console.warn(`[Vue Flow]: ${n}`,...e)}function sa(){return{edgesChange:X(),nodesChange:X(),nodeDoubleClick:X(),nodeClick:X(),nodeMouseEnter:X(),nodeMouseMove:X(),nodeMouseLeave:X(),nodeContextMenu:X(),nodeDragStart:X(),nodeDrag:X(),nodeDragStop:X(),nodesInitialized:X(),miniMapNodeClick:X(),miniMapNodeDoubleClick:X(),miniMapNodeMouseEnter:X(),miniMapNodeMouseMove:X(),miniMapNodeMouseLeave:X(),connect:X(),connectStart:X(),connectEnd:X(),clickConnectStart:X(),clickConnectEnd:X(),paneReady:X(),move:X(),moveStart:X(),moveEnd:X(),selectionDragStart:X(),selectionDrag:X(),selectionDragStop:X(),selectionContextMenu:X(),selectionStart:X(),selectionEnd:X(),viewportChangeStart:X(),viewportChange:X(),viewportChangeEnd:X(),paneScroll:X(),paneClick:X(),paneContextMenu:X(),paneMouseEnter:X(),paneMouseMove:X(),paneMouseLeave:X(),edgeContextMenu:X(),edgeMouseEnter:X(),edgeMouseMove:X(),edgeMouseLeave:X(),edgeDoubleClick:X(),edgeClick:X(),edgeUpdateStart:X(),edgeUpdate:X(),edgeUpdateEnd:X(),updateNodeInternals:X(),error:X(n=>wt(n.message))}}function la(n,e){onBeforeMount(()=>{for(const[r,o]of Object.entries(e.value)){const s=l=>{n(r,l)};o.on(s),Mt(()=>{o.off(s)})}})}var he=(n=>(n.MISSING_VIEWPORT_DIMENSIONS="MISSING_VIEWPORT_DIMENSIONS",n.NODE_NOT_FOUND="NODE_NOT_FOUND",n.NODE_MISSING_PARENT="NODE_MISSING_PARENT",n.NODE_TYPE_MISSING="NODE_TYPE_MISSING",n.NODE_EXTENT_INVALID="NODE_EXTENT_INVALID",n.EDGE_INVALID="EDGE_INVALID",n.EDGE_NOT_FOUND="EDGE_NOT_FOUND",n.EDGE_SOURCE_MISSING="EDGE_SOURCE_MISSING",n.EDGE_TARGET_MISSING="EDGE_TARGET_MISSING",n.EDGE_TYPE_MISSING="EDGE_TYPE_MISSING",n.EDGE_SOURCE_TARGET_SAME="EDGE_SOURCE_TARGET_SAME",n.EDGE_SOURCE_TARGET_MISSING="EDGE_SOURCE_TARGET_MISSING",n.EDGE_ORPHANED="EDGE_ORPHANED",n))(he||{});const bn={MISSING_VIEWPORT_DIMENSIONS:()=>"The Vue Flow parent container needs a width and a height to render the graph",NODE_NOT_FOUND:n=>`Node not found
Node: ${n}`,NODE_MISSING_PARENT:(n,e)=>`Node is missing a parent
Node: ${n}
Parent: ${e}`,NODE_TYPE_MISSING:n=>`Node type is missing
Type: ${n}`,NODE_EXTENT_INVALID:n=>`Only child nodes can use a parent extent
Node: ${n}`,EDGE_INVALID:n=>`An edge needs a source and a target
Edge: ${n}`,EDGE_SOURCE_MISSING:(n,e)=>`Edge source is missing
Edge: ${n} 
Source: ${e}`,EDGE_TARGET_MISSING:(n,e)=>`Edge target is missing
Edge: ${n} 
Target: ${e}`,EDGE_TYPE_MISSING:n=>`Edge type is missing
Type: ${n}`,EDGE_SOURCE_TARGET_SAME:(n,e,r)=>`Edge source and target are the same
Edge: ${n} 
Source: ${e} 
Target: ${r}`,EDGE_SOURCE_TARGET_MISSING:(n,e,r)=>`Edge source or target is missing
Edge: ${n} 
Source: ${e} 
Target: ${r}`,EDGE_ORPHANED:n=>`Edge was orphaned (suddenly missing source or target) and has been removed
Edge: ${n}`,EDGE_NOT_FOUND:n=>`Edge not found
Edge: ${n}`};class ve extends Error{constructor(e,...r){var o;super((o=bn[e])==null?void 0:o.call(bn,...r)),this.code=e}}const io=()=>typeof window<"u"?window:{chrome:!1};function ko(n){return{...n.computedPosition||{x:0,y:0},width:n.dimensions.width||0,height:n.dimensions.height||0}}function Ln(n,e){const r=Math.max(0,Math.min(n.x+n.width,e.x+e.width)-Math.max(n.x,e.x)),o=Math.max(0,Math.min(n.y+n.height,e.y+e.height)-Math.max(n.y,e.y));return Math.ceil(r*o)}function nn(n){return{width:n.offsetWidth,height:n.offsetHeight}}function ct(n,e=0,r=1){return Math.min(Math.max(n,e),r)}function ro(n,e){return{x:ct(n.x,e[0][0],e[1][0]),y:ct(n.y,e[0][1],e[1][1])}}function Oo(n){const e=n.getRootNode(),r=io();return"elementFromPoint"in e?e:r.document}function $e(n){return n&&"id"in n&&"source"in n&&"target"in n}function ua(n){return $e(n)&&"sourceNode"in n&&"targetNode"in n}function xt(n){return n&&"id"in n&&!$e(n)}function et(n){return xt(n)&&"computedPosition"in n}function ca(n){return!!n.width&&!!n.height&&!!n.x&&!!n.y}function da(n,e={}){let r=e;return et(n)||(r={type:n.type??e.type??"default",dimensions:markRaw({width:0,height:0}),handleBounds:{source:[],target:[]},computedPosition:markRaw({z:0,...n.position}),draggable:void 0,selectable:void 0,connectable:void 0,focusable:void 0,selected:!1,dragging:!1,resizing:!1,initialized:!1,...e,data:de(n.data)?n.data:{},events:markRaw(de(n.events)?n.events:{})}),Object.assign({},r,n,{id:n.id.toString()})}function ao(n,e={}){const r=de(n.events)?n.events:e.events&&de(e.events)?e.events:{},o=de(n.data)?n.data:e.data&&de(e.data)?e.data:{};return e=ua(n)?e:{...e,sourceHandle:(n.sourceHandle?n.sourceHandle.toString():void 0)||e.sourceHandle,targetHandle:(n.targetHandle?n.targetHandle.toString():void 0)||e.targetHandle,type:n.type??e.type??"default",source:n.source.toString()||e.source,target:n.target.toString()||e.target,updatable:n.updatable??e.updatable,selectable:n.selectable??e.selectable,focusable:n.focusable??e.focusable,data:o,events:markRaw(r),label:(n.label&&!Pe(n.label)?markRaw(n.label):n.label)||e.label,interactionWidth:n.interactionWidth||e.interactionWidth},Object.assign({},e,n,{id:n.id.toString()})}function on({source:n,sourceHandle:e,target:r,targetHandle:o}){return`vueflow__edge-${n}${e??""}-${r}${o??""}`}function _i(n,e){return e.some(r=>$e(r)&&r.source===n.source&&r.target===n.target&&(r.sourceHandle===n.sourceHandle||!r.sourceHandle&&!n.sourceHandle)&&(r.targetHandle===n.targetHandle||!r.targetHandle&&!n.targetHandle))}function fa({x:n,y:e},{x:r,y:o,zoom:s}){return{x:n*s+r,y:e*s+o}}function so({x:n,y:e},{x:r,y:o,zoom:s},l,[c,u]){const f={x:(n-r)/s,y:(e-o)/s};return l?{x:c*Math.round(f.x/c),y:u*Math.round(f.y/u)}:f}function wi(n,e){return{x:Math.min(n.x,e.x),y:Math.min(n.y,e.y),x2:Math.max(n.x2,e.x2),y2:Math.max(n.y2,e.y2)}}function Gt({x:n,y:e,width:r,height:o}){return{x:n,y:e,x2:n+r,y2:e+o}}function bi({x:n,y:e,x2:r,y2:o}){return{x:n,y:e,width:r-n,height:o-e}}function lo(n){const e=n.reduce((r,{computedPosition:o={x:0,y:0},dimensions:s={width:0,height:0}}={})=>wi(r,Gt({...o,...s})),{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return bi(e)}function Ei(n,e,{x:r,y:o,zoom:s}={x:0,y:0,zoom:1},l=!1,c=!1){const u={x:(e.x-r)/s,y:(e.y-o)/s,width:e.width/s,height:e.height/s};return n.filter(f=>{const{computedPosition:d={x:0,y:0},dimensions:g={width:0,height:0},selectable:m}=f;if(c&&!m)return!1;const v={...d,width:g.width||0,height:g.height||0},b=Ln(u,v),k=typeof g.width>"u"||typeof g.height>"u"||g.width===0||g.height===0,R=l&&b>0,I=g.width*g.height;return k||R||b>=I})}function rn(n,e){const r=n.map(o=>Pe(o)?o:o.id);return e.filter(o=>r.includes(o.source)||r.includes(o.target))}function Yt(n,e,r,o,s,l=.1,c={x:0,y:0}){const u=e/(n.width*(1+l)),f=r/(n.height*(1+l)),d=Math.min(u,f),g=ct(d,o,s),m=n.x+n.width/2,v=n.y+n.height/2,b=e/2-m*g+(c.x??0),k=r/2-v*g+(c.y??0);return{x:b,y:k,zoom:g}}function ha(n,e){return{x:e.x+n.x,y:e.y+n.y,z:(n.z>e.z?n.z:e.z)+1}}function Si(n,e){if(!n.parentNode)return!1;const r=e(n.parentNode);return r?r.selected?!0:Si(r,e):!1}function Xe(n,e){return typeof n>"u"?"":typeof n=="string"?n:`${e?`${e}__`:""}${Object.keys(n).sort().map(r=>`${r}=${n[r]}`).join("&")}`}function de(n){return typeof unref(n)<"u"}function ga(n,e,r){if(!n.source||!n.target)return r(new ve(he.EDGE_INVALID,n.id)),!1;let o;return $e(n)?o=n:o={...n,id:on(n)},o=ao(o),_i(o,e)?!1:o}function va(n,e,r,o,s,l){if(!e.source||!e.target)return l(new ve(he.EDGE_INVALID,n.id)),!1;const c=o(n.id);if(!c)return l(new ve(he.EDGE_NOT_FOUND,n.id)),!1;const{id:u,...f}=n,d={...f,id:s?on(e):u,source:e.source,target:e.target,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle};return r.splice(r.indexOf(c),1,d),d}function Io(n,e,r,o){const s={},l=n.map(u=>{const f=da(u,{...r(u.id),parentNode:u.parentNode});return u.parentNode&&(s[u.parentNode]=!0),f}),c=[...l,...e];return l.forEach(u=>{const f=c.find(d=>d.id===u.parentNode);u.parentNode&&!f&&o(new ve(he.NODE_MISSING_PARENT,u.id,u.parentNode)),(u.parentNode||s[u.id])&&(s[u.id]&&(u.isParent=!0),f&&(f.isParent=!0))}),l}var Q=(n=>(n.Left="left",n.Top="top",n.Right="right",n.Bottom="bottom",n))(Q||{}),uo=(n=>(n.Partial="partial",n.Full="full",n))(uo||{}),Ye=(n=>(n.Bezier="default",n.SimpleBezier="simple-bezier",n.Straight="straight",n.Step="step",n.SmoothStep="smoothstep",n))(Ye||{}),je=(n=>(n.Strict="strict",n.Loose="loose",n))(je||{}),Fn=(n=>(n.Arrow="arrow",n.ArrowClosed="arrowclosed",n))(Fn||{}),Xt=(n=>(n.Free="free",n.Vertical="vertical",n.Horizontal="horizontal",n))(Xt||{});const To=Symbol("vueFlow"),Ni=Symbol("nodeId"),Ci=Symbol("nodeRef"),Mi=Symbol("edgeId"),$i=Symbol("edgeRef"),an=Symbol("slots");function pa(n){const e=n??inject(Ni,""),r=inject(Ci,null),{findNode:o,edges:s,emits:l}=ce(),c=o(e);return c||l.error(new ve(he.NODE_NOT_FOUND,e)),{id:e,nodeEl:r,node:c,parentNode:computed(()=>o(c.parentNode)),connectedEdges:computed(()=>rn([c],s.value))}}function co(n){return"clientX"in n}function ot(n,e){var r,o;const s=co(n),l=s?n.clientX:(r=n.touches)==null?void 0:r[0].clientX,c=s?n.clientY:(o=n.touches)==null?void 0:o[0].clientY;return{x:l-((e==null?void 0:e.left)??0),y:c-((e==null?void 0:e.top)??0)}}function Ut(n,e,r){const o=((r==null?void 0:r.x)??0)+e.x,s=((r==null?void 0:r.y)??0)+e.y,l=(r==null?void 0:r.width)??e.width,c=(r==null?void 0:r.height)??e.height;switch(n){case Q.Top:return{x:o+l/2,y:s};case Q.Right:return{x:o+l,y:s+c/2};case Q.Bottom:return{x:o+l/2,y:s+c};case Q.Left:return{x:o,y:s+c/2}}}function Po(n=[],e){return n.length?!e||n.length===1?n[0]:e&&n.find(r=>r.id===e)||null:null}function ya(n,e,r,o,s,l){const c=Ut(r,{...n.dimensions,...n.computedPosition},e),u=Ut(l,{...o.dimensions,...o.computedPosition},s);return{sourceX:c.x,sourceY:c.y,targetX:u.x,targetY:u.y}}function xa({sourcePos:n,targetPos:e,sourceWidth:r,sourceHeight:o,targetWidth:s,targetHeight:l,width:c,height:u,viewport:f}){const d={x:Math.min(n.x,e.x),y:Math.min(n.y,e.y),x2:Math.max(n.x+r,e.x+s),y2:Math.max(n.y+o,e.y+l)};d.x===d.x2&&(d.x2+=1),d.y===d.y2&&(d.y2+=1);const g=Gt({x:(0-f.x)/f.zoom,y:(0-f.y)/f.zoom,width:c/f.zoom,height:u/f.zoom}),m=Math.max(0,Math.min(g.x2,d.x2)-Math.max(g.x,d.x)),v=Math.max(0,Math.min(g.y2,d.y2)-Math.max(g.y,d.y));return Math.ceil(m*v)>0}function _a(n,e,r=!1){let o=-1;const s=n.reduce((l,c)=>{const u=Te(c.zIndex);let f=u?c.zIndex:0;const d=e(c.source),g=e(c.target);return!d||!g||(r&&(f=u?c.zIndex:Math.max(d.computedPosition.z||0,g.computedPosition.z||0)),l[f]?l[f].push(c):l[f]=[c],o=f>o?f:o),l},{});return Object.entries(Object.keys(s).length?s:{0:[]}).map(([l,c])=>{const u=+l;return{edges:c,level:u,isMaxLevel:u===o}})}function En(n){n==null||n.classList.remove("valid","connecting","vue-flow__handle-valid","vue-flow__handle-connecting")}function Do(n,e,r,o){return(e[r]||[]).reduce((s,l)=>(`${n.id}-${l.id}-${r}`!==o&&s.push({id:l.id||null,type:r,nodeId:n.id,...Ut(l.position,{...n.dimensions,...n.computedPosition},l)}),s),[])}function wa(n,e,r){let o=null,s=1/0;return r.forEach(l=>{const c=Math.sqrt((l.x-n.x)**2+(l.y-n.y)**2);c<=e&&c<s&&(s=c,o=l)}),o}function Ao(n,e,r,o,s,l,c,u,f,d){const g=l==="target",m=u.querySelector(`.vue-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),{x:v,y:b}=ot(n),k=u.elementFromPoint(v,b),R=k!=null&&k.classList.contains("vue-flow__handle")?k:m,I={handleDomNode:R,isValid:!1,connection:{source:"",target:"",sourceHandle:null,targetHandle:null},endHandle:null};if(R){const $=ki(void 0,R),Y=R.getAttribute("data-nodeid"),oe=R.getAttribute("data-handleid"),G=R.classList.contains("connectable"),q=R.classList.contains("connectableend"),ne={source:g?Y:o,sourceHandle:g?oe:s,target:g?o:Y,targetHandle:g?s:oe};I.connection=ne,G&&q&&(r===je.Strict?g&&$==="source"||!g&&$==="target":Y!==o||oe!==s)&&(I.endHandle={nodeId:Y,handleId:oe,type:$},I.isValid=c(ne,{edges:f,sourceNode:d(ne.source),targetNode:d(ne.target)}))}return I}function ba({nodes:n,nodeId:e,handleId:r,handleType:o}){return n.reduce((s,l)=>{const{handleBounds:c}=l;let u=[],f=[];return c&&(u=Do(l,c,"source",`${e}-${r}-${o}`),f=Do(l,c,"target",`${e}-${r}-${o}`)),s.push(...u,...f),s},[])}function ki(n,e){return n||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function Ea(n,e){let r=null;return e?r="valid":n&&!e&&(r="invalid"),r}function zo(n,e,r){return n<e?ct(Math.abs(n-e),1,50)/50:n>r?-ct(Math.abs(n-r),1,50)/50:0}function Oi(n,e){const r=zo(n.x,35,e.width-35)*20,o=zo(n.y,35,e.height-35)*20;return[r,o]}function Ot(){return!0}function Ii({handleId:n,nodeId:e,type:r,isValidConnection:o,edgeUpdaterType:s,onEdgeUpdate:l,onEdgeUpdateEnd:c}){const u=computed(()=>se(r)==="target"),{vueFlowRef:f,connectionMode:d,connectionRadius:g,connectOnClick:m,connectionClickStartHandle:v,nodesConnectable:b,autoPanOnConnect:k,findNode:R,panBy:I,getNodes:$,startConnection:Y,updateConnection:oe,endConnection:G,emits:q,viewport:ne,edges:K,isValidConnection:qe}=ce();let ge=null,Z=!1,re=null;function He(ee){var _e;const ue=co(ee),ye=Oo(ee.target);if(ue&&ee.button===0||!ue){let We=function(te){Ve=ot(te,J),Ge=wa(so(Ve,ne.value,!1,[1,1]),g.value,N),Le||(_(),Le=!0);const ae=Ao(te,Ge,d.value,se(e),se(n),u.value?"target":"source",Bt,ye,K.value,R);if(ge=ae.connection,Z=ae.isValid,re=ae.handleDomNode,oe(Ge&&Z?fa({x:Ge.x,y:Ge.y},ne.value):Ve,ae.endHandle,Ea(!!Ge,Z)),!Ge&&!Z&&!re)return En(Ce);ge&&ge.source!==ge.target&&re&&(En(Ce),Ce=re,re.classList.add("connecting","vue-flow__handle-connecting"),re.classList.toggle("valid",Z),re.classList.toggle("vue-flow__handle-valid",Z))},Ze=function(te){(Ge||re)&&ge&&Z&&(l?l(te,ge):q.connect(ge)),q.connectEnd(te),s&&(c==null||c(te)),En(Ce),cancelAnimationFrame(Dn),G(te),Le=!1,Z=!1,ge=null,re=null,ye.removeEventListener("mousemove",We),ye.removeEventListener("mouseup",Ze),ye.removeEventListener("touchmove",We),ye.removeEventListener("touchend",Ze)};const Ae=R(se(e));let Bt=o||qe.value||Ot;!Bt&&Ae&&(Bt=(u?Ae.isValidSourcePos:Ae.isValidTargetPos)||Ot);let Ge,Dn=0;const{x:An,y:fe}=ot(ee),le=ye==null?void 0:ye.elementFromPoint(An,fe),H=ki(se(s),le),J=(_e=f.value)==null?void 0:_e.getBoundingClientRect();if(!J||!H)return;let Ce,Ve=ot(ee,J),Le=!1;const N=ba({nodes:$.value,nodeId:se(e),handleId:se(n),handleType:H}),_=()=>{if(!k)return;const[te,ae]=Oi(Ve,J);I({x:te,y:ae}),Dn=requestAnimationFrame(_)};Y({nodeId:se(e),handleId:se(n),type:H},{x:An-J.left,y:fe-J.top},ee),q.connectStart({event:ee,nodeId:se(e),handleId:se(n),handleType:H}),ye.addEventListener("mousemove",We),ye.addEventListener("mouseup",Ze),ye.addEventListener("touchmove",We),ye.addEventListener("touchend",Ze)}}function st(ee){if(m.value)if(!v.value)q.clickConnectStart({event:ee,nodeId:se(e),handleId:se(n)}),Y({nodeId:se(e),type:se(r),handleId:se(n)},void 0,ee,!0);else{let _e=o||qe.value||Ot;const ue=R(se(e));if(!_e&&ue&&(_e=(u?ue.isValidSourcePos:ue.isValidTargetPos)||Ot),ue&&(typeof ue.connectable>"u"?b.value:ue.connectable)===!1)return;const ye=Oo(ee.target),{connection:We,isValid:Ze}=Ao(ee,{nodeId:se(e),id:se(n),type:se(r)},d.value,v.value.nodeId,v.value.handleId||null,v.value.type,_e,ye,K.value,R),Ae=We.source===We.target;Ze&&!Ae&&q.connect(We),q.clickConnectEnd(ee),G(ee,!0)}}return{handlePointerDown:He,handleClick:st}}function Sa(n,e){const r={};for(const o in n)e.includes(o)||Object.defineProperty(r,o,{enumerable:!0,get:()=>n[o]});return r}const Na=["data-id","data-handleid","data-nodeid","data-handlepos"],Ca={name:"Handle",compatConfig:{MODE:3}},Zt=defineComponent({...Ca,props:{id:null,type:null,position:{default:Q.Top},isValidConnection:{type:Function},connectable:{type:[Boolean,String,Function],default:void 0},connectableStart:{type:Boolean,default:!0},connectableEnd:{type:Boolean,default:!0}},setup(n){const e=Sa(n,["position","connectable","connectableStart","connectableEnd","id","isValidConnection"]),r=toRef(e,"type","source"),{connectionStartHandle:o,connectionClickStartHandle:s,connectionEndHandle:l,vueFlowRef:c,nodesConnectable:u,noDragClassName:f,noPanClassName:d}=ce(),{id:g,node:m,nodeEl:v,connectedEdges:b}=pa(),k=ref(),R=computed(()=>n.id??`${g}__handle-${n.position}`),I=computed(()=>typeof n.connectableStart<"u"?n.connectableStart:!0),$=computed(()=>typeof n.connectableEnd<"u"?n.connectableEnd:!0),{handlePointerDown:Y,handleClick:oe}=Ii({nodeId:g,handleId:R,isValidConnection:n.isValidConnection,type:r}),G=computed(()=>Pe(n.connectable)&&n.connectable==="single"?!b.value.some(ge=>{const Z=ge[`${r.value}Handle`];return ge[r.value]!==g?!1:Z?Z===R.value:!0}):ze(n.connectable)?n.connectable(m,b.value):de(n.connectable)?n.connectable:u.value),q=computed(()=>{var ge,Z,re,He,st,ee;return((ge=o.value)==null?void 0:ge.nodeId)===g&&((Z=o.value)==null?void 0:Z.handleId)===R.value&&((re=o.value)==null?void 0:re.type)===r.value||((He=l.value)==null?void 0:He.nodeId)===g&&((st=l.value)==null?void 0:st.handleId)===R.value&&((ee=l.value)==null?void 0:ee.type)===r.value}),ne=computed(()=>{var ge,Z,re;return((ge=s.value)==null?void 0:ge.nodeId)===g&&((Z=s.value)==null?void 0:Z.handleId)===R.value&&((re=s.value)==null?void 0:re.type)===r.value});pe(()=>m.initialized).toBe(!0,{flush:"post"}).then(()=>{var ge;const Z=(ge=m.handleBounds[r.value])==null?void 0:ge.find(ye=>ye.id===R.value);if(!c.value||Z)return;const re=c.value.querySelector(".vue-flow__transformationpane");if(!v||!k.value||!re||!R.value)return;const He=v.value.getBoundingClientRect(),st=k.value.getBoundingClientRect(),ee=window.getComputedStyle(re),{m22:_e}=new window.DOMMatrixReadOnly(ee.transform),ue={id:R.value,position:n.position,x:(st.left-He.left)/_e,y:(st.top-He.top)/_e,...nn(k.value)};m.handleBounds[r.value]=[...m.handleBounds[r.value]??[],ue]});function K(ge){const Z=co(ge);G.value&&I.value&&(Z&&ge.button===0||!Z)&&Y(ge)}function qe(ge){!g||!s.value&&!I.value||G.value&&oe(ge)}return(ge,Z)=>(openBlock(),createElementBlock("div",{ref_key:"handle",ref:k,"data-id":`${unref(g)}-${unref(R)}-${unref(r)}`,"data-handleid":unref(R),"data-nodeid":unref(g),"data-handlepos":n.position,class:normalizeClass(["vue-flow__handle",[`vue-flow__handle-${n.position}`,`vue-flow__handle-${unref(R)}`,unref(f),unref(d),unref(r),{connectable:unref(G),connecting:unref(ne),connectablestart:unref(I),connectableend:unref($),connectionindicator:unref(G)&&(unref(I)&&!unref(q)||unref($)&&unref(q))}]]),onMousedown:K,onTouchstartPassive:K,onClick:qe},[renderSlot(ge.$slots,"default",{id:n.id})],42,Na))}}),sn=function({sourcePosition:n=Q.Bottom,targetPosition:e=Q.Top,label:r,connectable:o=!0,isValidTargetPos:s,isValidSourcePos:l}){return[h$1(Zt,{type:"target",position:e,connectable:o,isValidConnection:s}),typeof r!="string"&&r?h$1(r):h$1("div",{innerHTML:r}),h$1(Zt,{type:"source",position:n,connectable:o,isValidConnection:l})]};sn.props=["sourcePosition","targetPosition","label","isValidTargetPos","isValidSourcePos","connectable"];sn.inheritAttrs=!1;sn.compatConfig={MODE:3};const Ma=sn,ln=function({sourcePosition:n=Q.Bottom,label:e,connectable:r=!0,isValidSourcePos:o}){return[typeof e!="string"&&e?h$1(e):h$1("div",{innerHTML:e}),h$1(Zt,{type:"source",position:n,connectable:r,isValidConnection:o})]};ln.props=["sourcePosition","label","isValidSourcePos","connectable"];ln.inheritAttrs=!1;ln.compatConfig={MODE:3};const $a=ln,un=function({targetPosition:n=Q.Top,label:e,connectable:r=!0,isValidTargetPos:o}){return[h$1(Zt,{type:"target",position:n,connectable:r,isValidConnection:o}),typeof e!="string"&&e?h$1(e):h$1("div",{innerHTML:e})]};un.props=["targetPosition","label","isValidTargetPos","connectable"];un.inheritAttrs=!1;un.compatConfig={MODE:3};const ka=un;function Bo(n,e,r){let o=n;do{if(o&&o.matches(e))return!0;if(o===r)return!1;o=o.parentElement}while(o);return!1}function Oa(n,e,r,o,s){return n.filter(l=>(l.selected||l.id===s)&&(!l.parentNode||!Si(l,o))&&(l.draggable||e&&typeof l.draggable>"u")).map(l=>{var c,u;return markRaw({id:l.id,position:l.position||{x:0,y:0},distance:{x:r.x-((c=l.computedPosition)==null?void 0:c.x)||0,y:r.y-((u=l.computedPosition)==null?void 0:u.y)||0},from:l.computedPosition,extent:l.extent,parentNode:l.parentNode,dimensions:l.dimensions})})}function Sn({id:n,dragItems:e,findNode:r}){const o=e.map(s=>r(s.id));return[n?o.find(s=>s.id===n):o[0],o]}function Ti(n){if(Array.isArray(n))switch(n.length){case 1:return[n[0],n[0],n[0],n[0]];case 2:return[n[0],n[1],n[0],n[1]];case 3:return[n[0],n[1],n[2],n[1]];case 4:return n;default:return[0,0,0,0]}return[n,n,n,n]}function Ia(n,e,r){const[o,s,l,c]=typeof n!="string"?Ti(n.padding):[0,0,0,0];return r&&Te(r.computedPosition.x)&&Te(r.computedPosition.y)&&Te(r.dimensions.width)&&Te(r.dimensions.height)?[[r.computedPosition.x+c,r.computedPosition.y+o],[r.computedPosition.x+(r.dimensions.width-e.dimensions.width)-s,r.computedPosition.y+(r.dimensions.height-e.dimensions.height)-l]]:!1}function Ta(n,e,r,o){let s=n.extent||r;if(s==="parent"||!Array.isArray(s)&&(s==null?void 0:s.range)==="parent")if(n.parentNode&&o&&n.dimensions.width&&n.dimensions.height){const l=Ia(s,n,o);l&&(s=l)}else e(new ve(he.NODE_EXTENT_INVALID,n.id)),s=r;else if(Array.isArray(s)){const l=(o==null?void 0:o.computedPosition.x)||0,c=(o==null?void 0:o.computedPosition.y)||0;s=[[s[0][0]+l,s[0][1]+c],[s[1][0]+l,s[1][1]+c]]}else if(s!=null&&s.range&&Array.isArray(s.range)){const[l,c,u,f]=Ti(s.padding),d=(o==null?void 0:o.computedPosition.x)||0,g=(o==null?void 0:o.computedPosition.y)||0;s=[[s.range[0][0]+d+f,s.range[0][1]+g+l],[s.range[1][0]+d-c,s.range[1][1]+g-u]]}return s}function fo(n,e,r,o,s){const l=Ta(n,r,o,s),c=ro(e,l);return{position:{x:c.x-((s==null?void 0:s.computedPosition.x)||0),y:c.y-((s==null?void 0:s.computedPosition.y)||0)},computedPosition:c}}function Pi(){const{getSelectedNodes:n,nodeExtent:e,updateNodePositions:r,findNode:o,snapGrid:s,snapToGrid:l,nodesDraggable:c,emits:u}=ce();return(f,d=!1)=>{const g=l.value?s.value[0]:5,m=l.value?s.value[1]:5,v=d?4:1,b=f.x*g*v,k=f.y*m*v,R=n.value.filter(I=>I.draggable||c&&typeof I.draggable>"u").map(I=>{const $={x:I.computedPosition.x+b,y:I.computedPosition.y+k},{computedPosition:Y}=fo(I,$,u.error,e.value,I.parentNode?o(I.parentNode):void 0);return{id:I.id,position:Y,from:I.position,distance:{x:f.x,y:f.y},dimensions:I.dimensions}});r(R,!0,!1)}}function Pa(){return{doubleClick:X(),click:X(),mouseEnter:X(),mouseMove:X(),mouseLeave:X(),contextMenu:X(),dragStart:X(),drag:X(),dragStop:X()}}function Da(n,e){const r=Pa();return r.doubleClick.on(o=>{var s,l;e.nodeDoubleClick(o),(l=(s=n.events)==null?void 0:s.doubleClick)==null||l.call(s,o)}),r.click.on(o=>{var s,l;e.nodeClick(o),(l=(s=n.events)==null?void 0:s.click)==null||l.call(s,o)}),r.mouseEnter.on(o=>{var s,l;e.nodeMouseEnter(o),(l=(s=n.events)==null?void 0:s.mouseEnter)==null||l.call(s,o)}),r.mouseMove.on(o=>{var s,l;e.nodeMouseMove(o),(l=(s=n.events)==null?void 0:s.mouseMove)==null||l.call(s,o)}),r.mouseLeave.on(o=>{var s,l;e.nodeMouseLeave(o),(l=(s=n.events)==null?void 0:s.mouseLeave)==null||l.call(s,o)}),r.contextMenu.on(o=>{var s,l;e.nodeContextMenu(o),(l=(s=n.events)==null?void 0:s.contextMenu)==null||l.call(s,o)}),r.dragStart.on(o=>{var s,l;e.nodeDragStart(o),(l=(s=n.events)==null?void 0:s.dragStart)==null||l.call(s,o)}),r.drag.on(o=>{var s,l;e.nodeDrag(o),(l=(s=n.events)==null?void 0:s.drag)==null||l.call(s,o)}),r.dragStop.on(o=>{var s,l;e.nodeDragStop(o),(l=(s=n.events)==null?void 0:s.dragStop)==null||l.call(s,o)}),Object.entries(r).reduce((o,[s,l])=>(o.emit[s]=l.trigger,o.on[s]=l.on,o),{emit:{},on:{}})}function Aa(){const{viewport:n,snapGrid:e,snapToGrid:r}=ce();return({sourceEvent:o})=>{const s=o.touches?o.touches[0].clientX:o.clientX,l=o.touches?o.touches[0].clientY:o.clientY,c={x:(s-n.value.x)/n.value.zoom,y:(l-n.value.y)/n.value.zoom};return{xSnapped:r.value?e.value[0]*Math.round(c.x/e.value[0]):c.x,ySnapped:r.value?e.value[1]*Math.round(c.y/e.value[1]):c.y,...c}}}function Ro(n,e,r){const o=e.querySelectorAll(`.vue-flow__handle${n}`);if(!o||!o.length)return;const s=Array.from(o),l=e.getBoundingClientRect();return s.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-l.left)/r,y:(u.top-l.top)/r,...nn(c)}})}function Gn(n,e,r,o,s,l=!1,c){s.value=!1,n.selected?(l||n.selected&&e)&&(o([n]),nextTick(c.blur)):r([n])}var za={value:()=>{}};function cn(){for(var n=0,e=arguments.length,r={},o;n<e;++n){if(!(o=arguments[n]+"")||o in r||/[\s.]/.test(o))throw new Error("illegal type: "+o);r[o]=[]}return new Rt(r)}function Rt(n){this._=n}function Ba(n,e){return n.trim().split(/^|\s+/).map(function(r){var o="",s=r.indexOf(".");if(s>=0&&(o=r.slice(s+1),r=r.slice(0,s)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:o}})}Rt.prototype=cn.prototype={constructor:Rt,on:function(n,e){var r=this._,o=Ba(n+"",r),s,l=-1,c=o.length;if(arguments.length<2){for(;++l<c;)if((s=(n=o[l]).type)&&(s=Ra(r[s],n.name)))return s;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++l<c;)if(s=(n=o[l]).type)r[s]=Vo(r[s],n.name,e);else if(e==null)for(s in r)r[s]=Vo(r[s],n.name,null);return this},copy:function(){var n={},e=this._;for(var r in e)n[r]=e[r].slice();return new Rt(n)},call:function(n,e){if((s=arguments.length-2)>0)for(var r=new Array(s),o=0,s,l;o<s;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(l=this._[n],o=0,s=l.length;o<s;++o)l[o].value.apply(e,r)},apply:function(n,e,r){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var o=this._[n],s=0,l=o.length;s<l;++s)o[s].value.apply(e,r)}};function Ra(n,e){for(var r=0,o=n.length,s;r<o;++r)if((s=n[r]).name===e)return s.value}function Vo(n,e,r){for(var o=0,s=n.length;o<s;++o)if(n[o].name===e){n[o]=za,n=n.slice(0,o).concat(n.slice(o+1));break}return r!=null&&n.push({name:e,value:r}),n}var Yn="http://www.w3.org/1999/xhtml";const Ho={svg:"http://www.w3.org/2000/svg",xhtml:Yn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function dn(n){var e=n+="",r=e.indexOf(":");return r>=0&&(e=n.slice(0,r))!=="xmlns"&&(n=n.slice(r+1)),Ho.hasOwnProperty(e)?{space:Ho[e],local:n}:n}function Va(n){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===Yn&&e.documentElement.namespaceURI===Yn?e.createElement(n):e.createElementNS(r,n)}}function Ha(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function Di(n){var e=dn(n);return(e.local?Ha:Va)(e)}function La(){}function ho(n){return n==null?La:function(){return this.querySelector(n)}}function Fa(n){typeof n!="function"&&(n=ho(n));for(var e=this._groups,r=e.length,o=new Array(r),s=0;s<r;++s)for(var l=e[s],c=l.length,u=o[s]=new Array(c),f,d,g=0;g<c;++g)(f=l[g])&&(d=n.call(f,f.__data__,g,l))&&("__data__"in f&&(d.__data__=f.__data__),u[g]=d);return new xe(o,this._parents)}function Ga(n){return n==null?[]:Array.isArray(n)?n:Array.from(n)}function Ya(){return[]}function Ai(n){return n==null?Ya:function(){return this.querySelectorAll(n)}}function Xa(n){return function(){return Ga(n.apply(this,arguments))}}function Ua(n){typeof n=="function"?n=Xa(n):n=Ai(n);for(var e=this._groups,r=e.length,o=[],s=[],l=0;l<r;++l)for(var c=e[l],u=c.length,f,d=0;d<u;++d)(f=c[d])&&(o.push(n.call(f,f.__data__,d,c)),s.push(f));return new xe(o,s)}function zi(n){return function(){return this.matches(n)}}function Bi(n){return function(e){return e.matches(n)}}var Za=Array.prototype.find;function Ka(n){return function(){return Za.call(this.children,n)}}function Wa(){return this.firstElementChild}function qa(n){return this.select(n==null?Wa:Ka(typeof n=="function"?n:Bi(n)))}var ja=Array.prototype.filter;function Qa(){return Array.from(this.children)}function Ja(n){return function(){return ja.call(this.children,n)}}function es(n){return this.selectAll(n==null?Qa:Ja(typeof n=="function"?n:Bi(n)))}function ts(n){typeof n!="function"&&(n=zi(n));for(var e=this._groups,r=e.length,o=new Array(r),s=0;s<r;++s)for(var l=e[s],c=l.length,u=o[s]=[],f,d=0;d<c;++d)(f=l[d])&&n.call(f,f.__data__,d,l)&&u.push(f);return new xe(o,this._parents)}function Ri(n){return new Array(n.length)}function ns(){return new xe(this._enter||this._groups.map(Ri),this._parents)}function Kt(n,e){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=e}Kt.prototype={constructor:Kt,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,e){return this._parent.insertBefore(n,e)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};function os(n){return function(){return n}}function is(n,e,r,o,s,l){for(var c=0,u,f=e.length,d=l.length;c<d;++c)(u=e[c])?(u.__data__=l[c],o[c]=u):r[c]=new Kt(n,l[c]);for(;c<f;++c)(u=e[c])&&(s[c]=u)}function rs(n,e,r,o,s,l,c){var u,f,d=new Map,g=e.length,m=l.length,v=new Array(g),b;for(u=0;u<g;++u)(f=e[u])&&(v[u]=b=c.call(f,f.__data__,u,e)+"",d.has(b)?s[u]=f:d.set(b,f));for(u=0;u<m;++u)b=c.call(n,l[u],u,l)+"",(f=d.get(b))?(o[u]=f,f.__data__=l[u],d.delete(b)):r[u]=new Kt(n,l[u]);for(u=0;u<g;++u)(f=e[u])&&d.get(v[u])===f&&(s[u]=f)}function as(n){return n.__data__}function ss(n,e){if(!arguments.length)return Array.from(this,as);var r=e?rs:is,o=this._parents,s=this._groups;typeof n!="function"&&(n=os(n));for(var l=s.length,c=new Array(l),u=new Array(l),f=new Array(l),d=0;d<l;++d){var g=o[d],m=s[d],v=m.length,b=ls(n.call(g,g&&g.__data__,d,o)),k=b.length,R=u[d]=new Array(k),I=c[d]=new Array(k),$=f[d]=new Array(v);r(g,m,R,I,$,b,e);for(var Y=0,oe=0,G,q;Y<k;++Y)if(G=R[Y]){for(Y>=oe&&(oe=Y+1);!(q=I[oe])&&++oe<k;);G._next=q||null}}return c=new xe(c,o),c._enter=u,c._exit=f,c}function ls(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function us(){return new xe(this._exit||this._groups.map(Ri),this._parents)}function cs(n,e,r){var o=this.enter(),s=this,l=this.exit();return typeof n=="function"?(o=n(o),o&&(o=o.selection())):o=o.append(n+""),e!=null&&(s=e(s),s&&(s=s.selection())),r==null?l.remove():r(l),o&&s?o.merge(s).order():s}function ds(n){for(var e=n.selection?n.selection():n,r=this._groups,o=e._groups,s=r.length,l=o.length,c=Math.min(s,l),u=new Array(s),f=0;f<c;++f)for(var d=r[f],g=o[f],m=d.length,v=u[f]=new Array(m),b,k=0;k<m;++k)(b=d[k]||g[k])&&(v[k]=b);for(;f<s;++f)u[f]=r[f];return new xe(u,this._parents)}function fs(){for(var n=this._groups,e=-1,r=n.length;++e<r;)for(var o=n[e],s=o.length-1,l=o[s],c;--s>=0;)(c=o[s])&&(l&&c.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(c,l),l=c);return this}function hs(n){n||(n=gs);function e(m,v){return m&&v?n(m.__data__,v.__data__):!m-!v}for(var r=this._groups,o=r.length,s=new Array(o),l=0;l<o;++l){for(var c=r[l],u=c.length,f=s[l]=new Array(u),d,g=0;g<u;++g)(d=c[g])&&(f[g]=d);f.sort(e)}return new xe(s,this._parents).order()}function gs(n,e){return n<e?-1:n>e?1:n>=e?0:NaN}function vs(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this}function ms(){return Array.from(this)}function ps(){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var o=n[e],s=0,l=o.length;s<l;++s){var c=o[s];if(c)return c}return null}function ys(){let n=0;for(const e of this)++n;return n}function xs(){return!this.node()}function _s(n){for(var e=this._groups,r=0,o=e.length;r<o;++r)for(var s=e[r],l=0,c=s.length,u;l<c;++l)(u=s[l])&&n.call(u,u.__data__,l,s);return this}function ws(n){return function(){this.removeAttribute(n)}}function bs(n){return function(){this.removeAttributeNS(n.space,n.local)}}function Es(n,e){return function(){this.setAttribute(n,e)}}function Ss(n,e){return function(){this.setAttributeNS(n.space,n.local,e)}}function Ns(n,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(n):this.setAttribute(n,r)}}function Cs(n,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,r)}}function Ms(n,e){var r=dn(n);if(arguments.length<2){var o=this.node();return r.local?o.getAttributeNS(r.space,r.local):o.getAttribute(r)}return this.each((e==null?r.local?bs:ws:typeof e=="function"?r.local?Cs:Ns:r.local?Ss:Es)(r,e))}function Vi(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function $s(n){return function(){this.style.removeProperty(n)}}function ks(n,e,r){return function(){this.style.setProperty(n,e,r)}}function Os(n,e,r){return function(){var o=e.apply(this,arguments);o==null?this.style.removeProperty(n):this.style.setProperty(n,o,r)}}function Is(n,e,r){return arguments.length>1?this.each((e==null?$s:typeof e=="function"?Os:ks)(n,e,r??"")):dt(this.node(),n)}function dt(n,e){return n.style.getPropertyValue(e)||Vi(n).getComputedStyle(n,null).getPropertyValue(e)}function Ts(n){return function(){delete this[n]}}function Ps(n,e){return function(){this[n]=e}}function Ds(n,e){return function(){var r=e.apply(this,arguments);r==null?delete this[n]:this[n]=r}}function As(n,e){return arguments.length>1?this.each((e==null?Ts:typeof e=="function"?Ds:Ps)(n,e)):this.node()[n]}function Hi(n){return n.trim().split(/^|\s+/)}function go(n){return n.classList||new Li(n)}function Li(n){this._node=n,this._names=Hi(n.getAttribute("class")||"")}Li.prototype={add:function(n){var e=this._names.indexOf(n);e<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var e=this._names.indexOf(n);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};function Fi(n,e){for(var r=go(n),o=-1,s=e.length;++o<s;)r.add(e[o])}function Gi(n,e){for(var r=go(n),o=-1,s=e.length;++o<s;)r.remove(e[o])}function zs(n){return function(){Fi(this,n)}}function Bs(n){return function(){Gi(this,n)}}function Rs(n,e){return function(){(e.apply(this,arguments)?Fi:Gi)(this,n)}}function Vs(n,e){var r=Hi(n+"");if(arguments.length<2){for(var o=go(this.node()),s=-1,l=r.length;++s<l;)if(!o.contains(r[s]))return!1;return!0}return this.each((typeof e=="function"?Rs:e?zs:Bs)(r,e))}function Hs(){this.textContent=""}function Ls(n){return function(){this.textContent=n}}function Fs(n){return function(){var e=n.apply(this,arguments);this.textContent=e??""}}function Gs(n){return arguments.length?this.each(n==null?Hs:(typeof n=="function"?Fs:Ls)(n)):this.node().textContent}function Ys(){this.innerHTML=""}function Xs(n){return function(){this.innerHTML=n}}function Us(n){return function(){var e=n.apply(this,arguments);this.innerHTML=e??""}}function Zs(n){return arguments.length?this.each(n==null?Ys:(typeof n=="function"?Us:Xs)(n)):this.node().innerHTML}function Ks(){this.nextSibling&&this.parentNode.appendChild(this)}function Ws(){return this.each(Ks)}function qs(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function js(){return this.each(qs)}function Qs(n){var e=typeof n=="function"?n:Di(n);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Js(){return null}function el(n,e){var r=typeof n=="function"?n:Di(n),o=e==null?Js:typeof e=="function"?e:ho(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),o.apply(this,arguments)||null)})}function tl(){var n=this.parentNode;n&&n.removeChild(this)}function nl(){return this.each(tl)}function ol(){var n=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(n,this.nextSibling):n}function il(){var n=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(n,this.nextSibling):n}function rl(n){return this.select(n?il:ol)}function al(n){return arguments.length?this.property("__data__",n):this.node().__data__}function sl(n){return function(e){n.call(this,e,this.__data__)}}function ll(n){return n.trim().split(/^|\s+/).map(function(e){var r="",o=e.indexOf(".");return o>=0&&(r=e.slice(o+1),e=e.slice(0,o)),{type:e,name:r}})}function ul(n){return function(){var e=this.__on;if(e){for(var r=0,o=-1,s=e.length,l;r<s;++r)l=e[r],(!n.type||l.type===n.type)&&l.name===n.name?this.removeEventListener(l.type,l.listener,l.options):e[++o]=l;++o?e.length=o:delete this.__on}}}function cl(n,e,r){return function(){var o=this.__on,s,l=sl(e);if(o){for(var c=0,u=o.length;c<u;++c)if((s=o[c]).type===n.type&&s.name===n.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=l,s.options=r),s.value=e;return}}this.addEventListener(n.type,l,r),s={type:n.type,name:n.name,value:e,listener:l,options:r},o?o.push(s):this.__on=[s]}}function dl(n,e,r){var o=ll(n+""),s,l=o.length,c;if(arguments.length<2){var u=this.node().__on;if(u){for(var f=0,d=u.length,g;f<d;++f)for(s=0,g=u[f];s<l;++s)if((c=o[s]).type===g.type&&c.name===g.name)return g.value}return}for(u=e?cl:ul,s=0;s<l;++s)this.each(u(o[s],e,r));return this}function Yi(n,e,r){var o=Vi(n),s=o.CustomEvent;typeof s=="function"?s=new s(e,r):(s=o.document.createEvent("Event"),r?(s.initEvent(e,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(e,!1,!1)),n.dispatchEvent(s)}function fl(n,e){return function(){return Yi(this,n,e)}}function hl(n,e){return function(){return Yi(this,n,e.apply(this,arguments))}}function gl(n,e){return this.each((typeof e=="function"?hl:fl)(n,e))}function*vl(){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var o=n[e],s=0,l=o.length,c;s<l;++s)(c=o[s])&&(yield c)}var Xi=[null];function xe(n,e){this._groups=n,this._parents=e}function $t(){return new xe([[document.documentElement]],Xi)}function ml(){return this}xe.prototype=$t.prototype={constructor:xe,select:Fa,selectAll:Ua,selectChild:qa,selectChildren:es,filter:ts,data:ss,enter:ns,exit:us,join:cs,merge:ds,selection:ml,order:fs,sort:hs,call:vs,nodes:ms,node:ps,size:ys,empty:xs,each:_s,attr:Ms,style:Is,property:As,classed:Vs,text:Gs,html:Zs,raise:Ws,lower:js,append:Qs,insert:el,remove:nl,clone:rl,datum:al,on:dl,dispatch:gl,[Symbol.iterator]:vl};function we(n){return typeof n=="string"?new xe([[document.querySelector(n)]],[document.documentElement]):new xe([[n]],Xi)}function pl(n){let e;for(;e=n.sourceEvent;)n=e;return n}function Ne(n,e){if(n=pl(n),e===void 0&&(e=n.currentTarget),e){var r=e.ownerSVGElement||e;if(r.createSVGPoint){var o=r.createSVGPoint();return o.x=n.clientX,o.y=n.clientY,o=o.matrixTransform(e.getScreenCTM().inverse()),[o.x,o.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[n.clientX-s.left-e.clientLeft,n.clientY-s.top-e.clientTop]}}return[n.pageX,n.pageY]}const yl={passive:!1},bt={capture:!0,passive:!1};function Nn(n){n.stopImmediatePropagation()}function it(n){n.preventDefault(),n.stopImmediatePropagation()}function Ui(n){var e=n.document.documentElement,r=we(n).on("dragstart.drag",it,bt);"onselectstart"in e?r.on("selectstart.drag",it,bt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Zi(n,e){var r=n.document.documentElement,o=we(n).on("dragstart.drag",null);e&&(o.on("click.drag",it,bt),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in r?o.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const It=n=>()=>n;function Xn(n,{sourceEvent:e,subject:r,target:o,identifier:s,active:l,x:c,y:u,dx:f,dy:d,dispatch:g}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:c,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:g}})}Xn.prototype.on=function(){var n=this._.on.apply(this._,arguments);return n===this._?this:n};function xl(n){return!n.ctrlKey&&!n.button}function _l(){return this.parentNode}function wl(n,e){return e??{x:n.x,y:n.y}}function bl(){return navigator.maxTouchPoints||"ontouchstart"in this}function El(){var n=xl,e=_l,r=wl,o=bl,s={},l=cn("start","drag","end"),c=0,u,f,d,g,m=0;function v(G){G.on("mousedown.drag",b).filter(o).on("touchstart.drag",I).on("touchmove.drag",$,yl).on("touchend.drag touchcancel.drag",Y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function b(G,q){if(!(g||!n.call(this,G,q))){var ne=oe(this,e.call(this,G,q),G,q,"mouse");ne&&(we(G.view).on("mousemove.drag",k,bt).on("mouseup.drag",R,bt),Ui(G.view),Nn(G),d=!1,u=G.clientX,f=G.clientY,ne("start",G))}}function k(G){if(it(G),!d){var q=G.clientX-u,ne=G.clientY-f;d=q*q+ne*ne>m}s.mouse("drag",G)}function R(G){we(G.view).on("mousemove.drag mouseup.drag",null),Zi(G.view,d),it(G),s.mouse("end",G)}function I(G,q){if(n.call(this,G,q)){var ne=G.changedTouches,K=e.call(this,G,q),qe=ne.length,ge,Z;for(ge=0;ge<qe;++ge)(Z=oe(this,K,G,q,ne[ge].identifier,ne[ge]))&&(Nn(G),Z("start",G,ne[ge]))}}function $(G){var q=G.changedTouches,ne=q.length,K,qe;for(K=0;K<ne;++K)(qe=s[q[K].identifier])&&(it(G),qe("drag",G,q[K]))}function Y(G){var q=G.changedTouches,ne=q.length,K,qe;for(g&&clearTimeout(g),g=setTimeout(function(){g=null},500),K=0;K<ne;++K)(qe=s[q[K].identifier])&&(Nn(G),qe("end",G,q[K]))}function oe(G,q,ne,K,qe,ge){var Z=l.copy(),re=Ne(ge||ne,q),He,st,ee;if((ee=r.call(G,new Xn("beforestart",{sourceEvent:ne,target:v,identifier:qe,active:c,x:re[0],y:re[1],dx:0,dy:0,dispatch:Z}),K))!=null)return He=ee.x-re[0]||0,st=ee.y-re[1]||0,function _e(ue,ye,We){var Ze=re,Ae;switch(ue){case"start":s[qe]=_e,Ae=c++;break;case"end":delete s[qe],--c;case"drag":re=Ne(We||ye,q),Ae=c;break}Z.call(ue,G,new Xn(ue,{sourceEvent:ye,subject:ee,target:v,identifier:qe,active:Ae,x:re[0]+He,y:re[1]+st,dx:re[0]-Ze[0],dy:re[1]-Ze[1],dispatch:Z}),K)}}return v.filter=function(G){return arguments.length?(n=typeof G=="function"?G:It(!!G),v):n},v.container=function(G){return arguments.length?(e=typeof G=="function"?G:It(G),v):e},v.subject=function(G){return arguments.length?(r=typeof G=="function"?G:It(G),v):r},v.touchable=function(G){return arguments.length?(o=typeof G=="function"?G:It(!!G),v):o},v.on=function(){var G=l.on.apply(l,arguments);return G===l?v:G},v.clickDistance=function(G){return arguments.length?(m=(G=+G)*G,v):Math.sqrt(m)},v}function Ki(n){const e=ce(),r=toRef(e,"vueFlowRef"),o=toRef(e,"snapToGrid"),s=toRef(e,"snapGrid"),l=toRef(e,"noDragClassName"),c=toRef(e,"nodes"),u=toRef(e,"nodeExtent"),f=toRef(e,"viewport"),d=toRef(e,"autoPanOnNodeDrag"),g=toRef(e,"nodesDraggable"),m=toRef(e,"panBy"),v=toRef(e,"findNode"),b=toRef(e,"multiSelectionActive"),k=toRef(e,"nodesSelectionActive"),R=toRef(e,"selectNodesOnDrag"),I=toRef(e,"removeSelectedElements"),$=toRef(e,"addSelectedNodes"),Y=toRef(e,"updateNodePositions"),oe=toRef(e,"emits"),{onStart:G,onDrag:q,onStop:ne,el:K,disabled:qe,id:ge,selectable:Z}=n,re=ref(!1);let He=ref([]),st=ref(),ee=ref(null),_e=ref({x:void 0,y:void 0}),ue=ref({x:0,y:0}),ye=ref(null),We=ref(0),Ze=ref(!1),Ae=ref({x:0,y:0});const Bt=Aa(),Ge=({x:An,y:fe})=>{_e.value={x:An,y:fe};let le=!1;if(He.value=He.value.map(H=>{const J={x:An-H.distance.x,y:fe-H.distance.y};o.value&&(J.x=s.value[0]*Math.round(J.x/s.value[0]),J.y=s.value[1]*Math.round(J.y/s.value[1]));const{computedPosition:Ce}=fo(H,J,oe.value.error,u.value,H.parentNode?v.value(H.parentNode):void 0);return le=le||H.position.x!==Ce.x||H.position.y!==Ce.y,H.position=Ce,H}),!!le&&(Y.value(He.value,!0,!0),re.value=!0,ye.value)){const[H,J]=Sn({id:ge,dragItems:He.value,findNode:v.value});q({event:ye.value,node:H,nodes:J})}},Dn=()=>{if(!ee.value)return;const[An,fe]=Oi(ue.value,ee.value);if(An!==0||fe!==0){const le={x:(_e.value.x??0)-An/f.value.zoom,y:(_e.value.y??0)-fe/f.value.zoom};m.value({x:An,y:fe},H=>{(Math.round(H.x)!==Math.round(Ae.value.x)||Math.round(H.y)!==Math.round(Ae.value.y))&&(Ge(le),Ae.value=H,_e.value=le)})}We.value=requestAnimationFrame(Dn)};return watch([()=>se(qe),K],([An,fe])=>{if(fe){const le=we(fe);if(An)le.on(".drag",null);else{const H=v.value(ge);st.value=El().on("start",J=>{var Ce;!R.value&&!b.value&&H&&(H.selected||I.value()),H&&se(Z)&&R.value&&Gn(H,b.value,$.value,I.value,k,!1,fe);const Ve=Bt(J);if(_e.value=Ve,He.value=Oa(c.value,g.value,Ve,v.value,ge),He.value.length){const[Le,N]=Sn({id:ge,dragItems:He.value,findNode:v.value});G({event:J.sourceEvent,node:Le,nodes:N})}ee.value=((Ce=r.value)==null?void 0:Ce.getBoundingClientRect())||null,ue.value=ot(J.sourceEvent,ee.value)}).on("drag",J=>{const Ce=Bt(J);!Ze.value&&d.value&&(Ze.value=!0,Dn()),(_e.value.x!==Ce.xSnapped||_e.value.y!==Ce.ySnapped)&&He.value.length&&(ye.value=J.sourceEvent,ue.value=ot(J.sourceEvent,ee.value),Ge(Ce))}).on("end",J=>{if(re.value=!1,Ze.value=!1,cancelAnimationFrame(We.value),He.value.length){Y.value(He.value,!1,!1);const[Ce,Ve]=Sn({id:ge,dragItems:He.value,findNode:v.value});ne({event:J.sourceEvent,node:Ce,nodes:Ve})}}).filter(J=>{const Ce=J.target;return!J.button&&(!l.value||!Bo(Ce,`.${l.value}`,fe)&&(!(H!=null&&H.dragHandle)||Bo(Ce,H.dragHandle,fe)))}),le.call(st.value)}}}),re}const Wi="vue-flow__node-desc",qi="vue-flow__edge-desc",Sl="vue-flow__aria-live",ji=["Enter"," ","Escape"],rt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};function Un(n){var e,r;const o=((r=(e=n.composedPath)==null?void 0:e.call(n))==null?void 0:r[0])||n.target,s=ze(o.hasAttribute)?o.hasAttribute("contenteditable"):!1,l=ze(o.closest)?o.closest(".nokey"):null;return["INPUT","SELECT","TEXTAREA"].includes(o==null?void 0:o.nodeName)||s||!!l}function Nl(n){return n.ctrlKey||n.metaKey||n.shiftKey}function Cl(n,e){return r=>n.some(o=>{const s=o.split("+").map(l=>l.trim().toLowerCase());return s.length===1?r.key===o:(e.add(r.key.toLowerCase()),s.every(l=>e.has(l)))})}const _t=(n,e)=>{const r=io(),o=ref(se(n)===!0),s=ref(!1),l=ref(new Set);return watch(o,()=>{e==null||e(o.value)}),watchEffect(()=>{let c=se(n);if(r&&typeof r.addEventListener<"u"&&oo(r,"blur",()=>{o.value=!1}),Tr(c)){o.value=c;return}Array.isArray(c)&&(c=Cl(c,l.value)),c&&(So(c,u=>{s.value=Nl(u),!(!s.value&&Un(u))&&(u.preventDefault(),o.value=!0)},{eventName:"keydown"}),So(c,u=>{if(o.value){if(!s.value&&Un(u))return;s.value=!1,l.value.clear(),o.value=!1}},{eventName:"keyup"}))}),o},Ml=defineComponent({name:"Node",compatConfig:{MODE:3},props:["name","type","id","draggable","selectable","focusable","connectable","node","resizeObserver"],setup(n){provide(Ni,n.id);const e=ce(),r=toRef(e,"id"),o=toRef(e,"edges"),s=toRef(e,"noPanClassName"),l=toRef(e,"selectNodesOnDrag"),c=toRef(e,"nodesSelectionActive"),u=toRef(e,"multiSelectionActive"),f=toRef(e,"emits"),d=toRef(e,"findNode"),g=toRef(e,"removeSelectedNodes"),m=toRef(e,"addSelectedNodes"),v=toRef(e,"updateNodeDimensions"),b=toRef(e,"onUpdateNodeInternals"),k=toRef(e,"getIntersectingNodes"),R=toRef(e,"getNodeTypes"),I=toRef(e,"nodeExtent"),$=toRef(e,"elevateNodesOnSelect"),Y=toRef(e,"disableKeyboardA11y"),oe=toRef(e,"ariaLiveMessage"),G=toRef(e,"snapToGrid"),q=toRef(e,"snapGrid"),ne=Pi(),K=yt(n,"node"),qe=computed(()=>d.value(K.value.parentNode)),ge=computed(()=>rn([K.value],o.value)),Z=ref();provide(Ci,Z);const{emit:re,on:He}=Da(K.value,f.value),st=Ki({id:n.id,el:Z,disabled:()=>!n.draggable,selectable:()=>n.selectable,onStart(le){re.dragStart({...le,intersections:k.value(K.value)})},onDrag(le){re.drag({...le,intersections:k.value(K.value)})},onStop(le){re.dragStop({...le,intersections:k.value(K.value)})}}),ee=computed(()=>K.value.class instanceof Function?K.value.class(K.value):K.value.class),_e=computed(()=>{const le=(K.value.style instanceof Function?K.value.style(K.value):K.value.style)||{},H=K.value.width instanceof Function?K.value.width(K.value):K.value.width,J=K.value.height instanceof Function?K.value.height(K.value):K.value.height;return H&&(le.width=typeof H=="string"?H:`${H}px`),J&&(le.height=typeof J=="string"?J:`${J}px`),le}),ue=()=>Number(K.value.zIndex??_e.value.zIndex??0);return b.value(le=>{le.includes(n.id)&&We()}),onMounted(()=>{n.resizeObserver.observe(Z.value)}),onBeforeUnmount(()=>{n.resizeObserver.unobserve(Z.value)}),watch([()=>K.value.type,()=>K.value.sourcePosition,()=>K.value.targetPosition],()=>{v.value([{id:n.id,nodeElement:Z.value,forceUpdate:!0}])},{flush:"pre"}),watch([()=>K.value.position.x,()=>K.value.position.y,()=>{var le;return(le=qe.value)==null?void 0:le.computedPosition.x},()=>{var le;return(le=qe.value)==null?void 0:le.computedPosition.y},()=>{var le;return(le=qe.value)==null?void 0:le.computedPosition.z},()=>ue(),()=>K.value.selected,()=>K.value.dimensions.height,()=>K.value.dimensions.width,()=>{var le;return(le=qe.value)==null?void 0:le.dimensions.height},()=>{var le;return(le=qe.value)==null?void 0:le.dimensions.width}],([le,H,J,Ce,Ve,Le])=>{const N={x:le,y:H,z:Le+($.value&&K.value.selected?1e3:0)};Te(J)&&Te(Ce)?K.value.computedPosition=ha({x:J,y:Ce,z:Ve},N):K.value.computedPosition=N},{flush:"pre",immediate:!0}),watch([()=>K.value.extent,()=>I.value],([le,H],[J,Ce])=>{(le!==J||H!==Ce)&&ye()}),K.value.extent==="parent"||typeof K.value.extent=="object"&&"range"in K.value.extent&&K.value.extent.range==="parent"?pe(()=>K.value.initialized).toBe(!0).then(ye):ye(),()=>h$1("div",{ref:Z,"data-id":K.value.id,class:["vue-flow__node",`vue-flow__node-${n.type===!1?"default":n.name}`,{[s.value]:n.draggable,dragging:st==null?void 0:st.value,selected:K.value.selected,selectable:n.selectable},ee.value],style:{zIndex:K.value.computedPosition.z??ue(),transform:`translate(${K.value.computedPosition.x}px,${K.value.computedPosition.y}px)`,pointerEvents:n.selectable||n.draggable?"all":"none",visibility:K.value.initialized?"visible":"hidden",..._e.value},tabIndex:n.focusable?0:void 0,role:n.focusable?"button":void 0,"aria-describedby":Y.value?void 0:`${Wi}-${r.value}`,"aria-label":K.value.ariaLabel,onMouseenter:Ze,onMousemove:Ae,onMouseleave:Bt,onContextmenu:Ge,onClick:An,onDblclick:Dn,onKeydown:fe},[h$1(n.type===!1?R.value.default:n.type,{id:K.value.id,type:K.value.type,data:K.value.data,events:{...K.value.events,...He},selected:!!K.value.selected,resizing:!!K.value.resizing,dragging:st.value,connectable:n.connectable,position:K.value.position,dimensions:K.value.dimensions,isValidTargetPos:K.value.isValidTargetPos,isValidSourcePos:K.value.isValidSourcePos,parent:K.value.parentNode,zIndex:K.value.computedPosition.z,targetPosition:K.value.targetPosition,sourcePosition:K.value.sourcePosition,label:K.value.label,dragHandle:K.value.dragHandle,onUpdateNodeInternals:We})]);function ye(){const le=K.value.computedPosition;G.value&&(le.x=q.value[0]*Math.round(le.x/q.value[0]),le.y=q.value[1]*Math.round(le.y/q.value[1]));const{computedPosition:H,position:J}=fo(K.value,le,f.value.error,I.value,qe.value);(K.value.computedPosition.x!==H.x||K.value.computedPosition.y!==H.y)&&(K.value.computedPosition={...K.value.computedPosition,...H}),(K.value.position.x!==J.x||K.value.position.y!==J.y)&&(K.value.position=J)}function We(){Z.value&&v.value([{id:n.id,nodeElement:Z.value,forceUpdate:!0}])}function Ze(le){st!=null&&st.value||re.mouseEnter({event:le,node:K.value,connectedEdges:ge.value})}function Ae(le){st!=null&&st.value||re.mouseMove({event:le,node:K.value,connectedEdges:ge.value})}function Bt(le){st!=null&&st.value||re.mouseLeave({event:le,node:K.value,connectedEdges:ge.value})}function Ge(le){return re.contextMenu({event:le,node:K.value,connectedEdges:ge.value})}function Dn(le){return re.doubleClick({event:le,node:K.value,connectedEdges:ge.value})}function An(le){n.selectable&&(!l.value||!n.draggable)&&Gn(K.value,u.value,m.value,g.value,c,!1,Z.value),re.click({event:le,node:K.value,connectedEdges:ge.value})}function fe(le){var H;if(!Un(le))if(ji.includes(le.key)&&n.selectable){const J=le.key==="Escape";J&&((H=Z.value)==null||H.blur()),Gn(K.value,u.value,m.value,g.value,c,J,Z.value)}else!Y.value&&n.draggable&&K.value.selected&&rt[le.key]&&(oe.value=`Moved selected node ${le.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~K.value.position.x}, y: ${~~K.value.position.y}`,ne({x:rt[le.key].x,y:rt[le.key].y},le.shiftKey))}}}),$l=Ml,kl=["transform"],Ol=["width","height","x","y","rx","ry"],Il=["y"],Tl={name:"EdgeText",compatConfig:{MODE:3}},Pl=defineComponent({...Tl,props:{x:null,y:null,label:null,labelStyle:{default:{}},labelShowBg:{type:Boolean,default:!0},labelBgStyle:{default:{}},labelBgPadding:{default:[2,4]},labelBgBorderRadius:{default:2}},setup(n){let e=ref({x:0,y:0,width:0,height:0});const r=ref(null),o=computed(()=>`translate(${n.x-e.value.width/2} ${n.y-e.value.height/2})`);onMounted(s),watch([()=>n.x,()=>n.y,r,()=>n.label],s);function s(){if(!r.value)return;const l=r.value.getBBox();(l.width!==e.value.width||l.height!==e.value.height)&&(e.value=l)}return(l,c)=>(openBlock(),createElementBlock("g",{transform:unref(o),class:"vue-flow__edge-textwrapper"},[n.labelShowBg?(openBlock(),createElementBlock("rect",{key:0,class:"vue-flow__edge-textbg",width:`${unref(e).width+2*n.labelBgPadding[0]}px`,height:`${unref(e).height+2*n.labelBgPadding[1]}px`,x:-n.labelBgPadding[0],y:-n.labelBgPadding[1],style:normalizeStyle(n.labelBgStyle),rx:n.labelBgBorderRadius,ry:n.labelBgBorderRadius},null,12,Ol)):createCommentVNode("",!0),createBaseVNode("text",mergeProps(l.$attrs,{ref_key:"el",ref:r,class:"vue-flow__edge-text",y:unref(e).height/2,dy:"0.3em",style:n.labelStyle}),[renderSlot(l.$slots,"default",{},()=>[unref(Pe)(n.label)?(openBlock(),createElementBlock(Fragment,{key:1},[createTextVNode(toDisplayString(n.label),1)],64)):(openBlock(),createBlock(resolveDynamicComponent(n.label),{key:0}))])],16,Il)],8,kl))}}),fn=function({path:n,label:e,labelX:r,labelY:o,labelBgBorderRadius:s,labelBgPadding:l,labelBgStyle:c,labelShowBg:u=!0,labelStyle:f,markerStart:d,markerEnd:g,interactionWidth:m=20},{attrs:v}){return[h$1("path",{style:v.style,class:["vue-flow__edge-path",v.class].join(" "),d:n,"marker-end":g,"marker-start":d}),m?h$1("path",{d:n,fill:"none","stroke-opacity":0,"stroke-width":m}):null,e&&Te(r)&&Te(o)?h$1(Pl,{x:r,y:o,label:e,labelStyle:f,labelShowBg:u,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:s}):null]};fn.props=["path","labelX","labelY","label","labelBgBorderRadius","labelBgPadding","labelBgStyle","labelShowBg","labelStyle","markerStart","markerEnd","interactionWidth"];fn.inheritAttrs=!1;fn.compatConfig={MODE:3};const hn=fn;function Qi({sourceX:n,sourceY:e,targetX:r,targetY:o}){const s=Math.abs(r-n)/2,l=r<n?r+s:r-s,c=Math.abs(o-e)/2,u=o<e?o+c:o-c;return[l,u,s,c]}function Ji({sourceX:n,sourceY:e,targetX:r,targetY:o,sourceControlX:s,sourceControlY:l,targetControlX:c,targetControlY:u}){const f=n*.125+s*.375+c*.375+r*.125,d=e*.125+l*.375+u*.375+o*.125,g=Math.abs(f-n),m=Math.abs(d-e);return[f,d,g,m]}function Tt(n,e){return n>=0?.5*n:e*25*Math.sqrt(-n)}function Lo({pos:n,x1:e,y1:r,x2:o,y2:s,c:l}){let c,u;switch(n){case Q.Left:c=e-Tt(e-o,l),u=r;break;case Q.Right:c=e+Tt(o-e,l),u=r;break;case Q.Top:c=e,u=r-Tt(r-s,l);break;case Q.Bottom:c=e,u=r+Tt(s-r,l);break}return[c,u]}function Zn({sourceX:n,sourceY:e,sourcePosition:r=Q.Bottom,targetX:o,targetY:s,targetPosition:l=Q.Top,curvature:c=.25}){const[u,f]=Lo({pos:r,x1:n,y1:e,x2:o,y2:s,c}),[d,g]=Lo({pos:l,x1:o,y1:s,x2:n,y2:e,c}),[m,v,b,k]=Ji({sourceX:n,sourceY:e,targetX:o,targetY:s,sourceControlX:u,sourceControlY:f,targetControlX:d,targetControlY:g});return[`M${n},${e} C${u},${f} ${d},${g} ${o},${s}`,m,v,b,k]}const gn=function({sourcePosition:n=Q.Bottom,targetPosition:e=Q.Top,...r},{attrs:o}){const[s,l,c]=Zn({sourcePosition:n,targetPosition:e,...r});return h$1(hn,{path:s,labelX:l,labelY:c,...r,...o})};gn.props=["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","curvature","markerEnd","markerStart","interactionWidth"];gn.inheritAttrs=!1;gn.compatConfig={MODE:3};const Dl=gn;function Fo({pos:n,x1:e,y1:r,x2:o,y2:s}){let l,c;switch(n){case Q.Left:case Q.Right:l=.5*(e+o),c=r;break;case Q.Top:case Q.Bottom:l=e,c=.5*(r+s);break}return[l,c]}function er({sourceX:n,sourceY:e,sourcePosition:r=Q.Bottom,targetX:o,targetY:s,targetPosition:l=Q.Top}){const[c,u]=Fo({pos:r,x1:n,y1:e,x2:o,y2:s}),[f,d]=Fo({pos:l,x1:o,y1:s,x2:n,y2:e}),[g,m,v,b]=Ji({sourceX:n,sourceY:e,targetX:o,targetY:s,sourceControlX:c,sourceControlY:u,targetControlX:f,targetControlY:d});return[`M${n},${e} C${c},${u} ${f},${d} ${o},${s}`,g,m,v,b]}const vn=function({sourcePosition:n=Q.Bottom,targetPosition:e=Q.Top,...r},{attrs:o}){const[s,l,c]=er({sourcePosition:n,targetPosition:e,...r});return h$1(hn,{path:s,labelX:l,labelY:c,...r,...o})};vn.props=["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"];vn.inheritAttrs=!1;vn.compatConfig={MODE:3};const Al=vn,Go={[Q.Left]:{x:-1,y:0},[Q.Right]:{x:1,y:0},[Q.Top]:{x:0,y:-1},[Q.Bottom]:{x:0,y:1}};function zl({source:n,sourcePosition:e=Q.Bottom,target:r}){return e===Q.Left||e===Q.Right?n.x<r.x?{x:1,y:0}:{x:-1,y:0}:n.y<r.y?{x:0,y:1}:{x:0,y:-1}}function Yo(n,e){return Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2)}function Bl({source:n,sourcePosition:e=Q.Bottom,target:r,targetPosition:o=Q.Top,center:s,offset:l}){const c=Go[e],u=Go[o],f={x:n.x+c.x*l,y:n.y+c.y*l},d={x:r.x+u.x*l,y:r.y+u.y*l},g=zl({source:f,sourcePosition:e,target:d}),m=g.x!==0?"x":"y",v=g[m];let b,k,R;const[I,$,Y,oe]=Qi({sourceX:n.x,sourceY:n.y,targetX:r.x,targetY:r.y});if(c[m]*u[m]===-1){k=s.x||I,R=s.y||$;const G=[{x:k,y:f.y},{x:k,y:d.y}],q=[{x:f.x,y:R},{x:d.x,y:R}];c[m]===v?b=m==="x"?G:q:b=m==="x"?q:G}else{const G=[{x:f.x,y:d.y}],q=[{x:d.x,y:f.y}];if(m==="x"?b=c.x===v?q:G:b=c.y===v?G:q,e!==o){const ne=m==="x"?"y":"x",K=c[m]===u[ne],qe=f[ne]>d[ne],ge=f[ne]<d[ne];(c[m]===1&&(!K&&qe||K&&ge)||c[m]!==1&&(!K&&ge||K&&qe))&&(b=m==="x"?G:q)}k=b[0].x,R=b[0].y}return[[n,f,...b,d,r],k,R,Y,oe]}function Rl(n,e,r,o){const s=Math.min(Yo(n,e)/2,Yo(e,r)/2,o),{x:l,y:c}=e;if(n.x===l&&l===r.x||n.y===c&&c===r.y)return`L${l} ${c}`;if(n.y===c){const d=n.x<r.x?-1:1,g=n.y<r.y?1:-1;return`L ${l+s*d},${c}Q ${l},${c} ${l},${c+s*g}`}const u=n.x<r.x?1:-1,f=n.y<r.y?-1:1;return`L ${l},${c+s*f}Q ${l},${c} ${l+s*u},${c}`}function Kn({sourceX:n,sourceY:e,sourcePosition:r=Q.Bottom,targetX:o,targetY:s,targetPosition:l=Q.Top,borderRadius:c=5,centerX:u,centerY:f,offset:d=20}){const[g,m,v,b,k]=Bl({source:{x:n,y:e},sourcePosition:r,target:{x:o,y:s},targetPosition:l,center:{x:u,y:f},offset:d});return[g.reduce((R,I,$)=>{let Y;return $>0&&$<g.length-1?Y=Rl(g[$-1],I,g[$+1],c):Y=`${$===0?"M":"L"}${I.x} ${I.y}`,R+=Y,R},""),m,v,b,k]}const mn=function({sourcePosition:n=Q.Bottom,targetPosition:e=Q.Top,...r},{attrs:o}){const[s,l,c]=Kn({sourcePosition:n,targetPosition:e,...r});return h$1(hn,{path:s,labelX:l,labelY:c,...r,...o})};mn.props=["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","borderRadius","markerEnd","markerStart","interactionWidth","offset"];mn.inheritAttrs=!1;mn.compatConfig={MODE:3};const tr=mn,pn=function(n,{attrs:e}){return h$1(tr,{...n,...e,borderRadius:0})};pn.props=["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"];pn.inheritAttrs=!1;pn.compatConfig={MODE:3};const Vl=pn;function nr({sourceX:n,sourceY:e,targetX:r,targetY:o}){const[s,l,c,u]=Qi({sourceX:n,sourceY:e,targetX:r,targetY:o});return[`M ${n},${e}L ${r},${o}`,s,l,c,u]}const yn=function(n,{attrs:e}){const[r,o,s]=nr(n);return h$1(hn,{path:r,labelX:o,labelY:s,...n,...e})};yn.props=["label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"];yn.inheritAttrs=!1;yn.compatConfig={MODE:3};const Hl=yn;function Ll(n,e,r){return r===Q.Left?n-e:r===Q.Right?n+e:n}function Fl(n,e,r){return r===Q.Top?n-e:r===Q.Bottom?n+e:n}const vo=function({radius:n=10,centerX:e=0,centerY:r=0,position:o=Q.Top,type:s}){return h$1("circle",{class:`vue-flow__edgeupdater vue-flow__edgeupdater-${s}`,cx:Ll(e,n,o),cy:Fl(r,n,o),r:n,stroke:"transparent",fill:"transparent"})};vo.props=["radius","centerX","centerY","position","type"];vo.compatConfig={MODE:3};const Xo=vo;function Gl(){return{doubleClick:X(),click:X(),mouseEnter:X(),mouseMove:X(),mouseLeave:X(),contextMenu:X(),updateStart:X(),update:X(),updateEnd:X()}}function Yl(n,e){const r=Gl();return r.doubleClick.on(o=>{var s,l;e.edgeDoubleClick(o),(l=(s=n.events)==null?void 0:s.doubleClick)==null||l.call(s,o)}),r.click.on(o=>{var s,l;e.edgeClick(o),(l=(s=n.events)==null?void 0:s.click)==null||l.call(s,o)}),r.mouseEnter.on(o=>{var s,l;e.edgeMouseEnter(o),(l=(s=n.events)==null?void 0:s.mouseEnter)==null||l.call(s,o)}),r.mouseMove.on(o=>{var s,l;e.edgeMouseMove(o),(l=(s=n.events)==null?void 0:s.mouseMove)==null||l.call(s,o)}),r.mouseLeave.on(o=>{var s,l;e.edgeMouseLeave(o),(l=(s=n.events)==null?void 0:s.mouseLeave)==null||l.call(s,o)}),r.contextMenu.on(o=>{var s,l;e.edgeContextMenu(o),(l=(s=n.events)==null?void 0:s.contextMenu)==null||l.call(s,o)}),r.updateStart.on(o=>{var s,l;e.edgeUpdateStart(o),(l=(s=n.events)==null?void 0:s.updateStart)==null||l.call(s,o)}),r.update.on(o=>{var s,l;e.edgeUpdate(o),(l=(s=n.events)==null?void 0:s.update)==null||l.call(s,o)}),r.updateEnd.on(o=>{var s,l;e.edgeUpdateEnd(o),(l=(s=n.events)==null?void 0:s.updateEnd)==null||l.call(s,o)}),Object.entries(r).reduce((o,[s,l])=>(o.emit[s]=l.trigger,o.on[s]=l.on,o),{emit:{},on:{}})}const Xl=defineComponent({name:"Edge",compatConfig:{MODE:3},props:["name","type","id","updatable","selectable","focusable","edge"],setup(n){const{id:e,addSelectedEdges:r,connectionMode:o,edgeUpdaterRadius:s,emits:l,nodesSelectionActive:c,noPanClassName:u,getEdgeTypes:f,removeSelectedEdges:d,findEdge:g,findNode:m,isValidConnection:v}=ce(),b=Yl(n.edge,l),k=yt(n,"edge");let R=ref(!1),I=ref(!1);const $=ref(""),Y=ref(null),oe=ref("source"),G=ref();provide(Mi,n.id),provide($i,G);const q=computed(()=>k.value.class instanceof Function?k.value.class(k.value):k.value.class),ne=computed(()=>k.value.style instanceof Function?k.value.style(k.value):k.value.style),{handlePointerDown:K}=Ii({nodeId:$,handleId:Y,type:oe,isValidConnection:v.value,edgeUpdaterType:oe,onEdgeUpdate:Z,onEdgeUpdateEnd:re});return()=>{const Ge=m(k.value.source),Dn=m(k.value.target);if(!Ge||!Dn||!k.value)return null;let An;o.value===je.Strict?An=Ge.handleBounds.source:An=[...Ge.handleBounds.source||[],...Ge.handleBounds.target||[]];const fe=Po(An,k.value.sourceHandle);let le;o.value===je.Strict?le=Dn.handleBounds.target:le=[...Dn.handleBounds.target||[],...Dn.handleBounds.source||[]];const H=Po(le,k.value.targetHandle),J=fe?fe.position:Q.Bottom,Ce=H?H.position:Q.Top,{sourceX:Ve,sourceY:Le,targetY:N,targetX:_}=ya(Ge,fe,J,Dn,H,Ce);return k.value.sourceX=Ve,k.value.sourceY=Le,k.value.targetX=_,k.value.targetY=N,h$1("g",{ref:G,key:n.id,"data-id":n.id,class:["vue-flow__edge",`vue-flow__edge-${n.type===!1?"default":n.name}`,u.value,q.value,{updating:R.value,selected:k.value.selected,animated:k.value.animated,inactive:!n.selectable}],onClick:st,onContextmenu:ee,onDblclick:_e,onMouseenter:ue,onMousemove:ye,onMouseleave:We,onKeyDown:n.focusable?Bt:void 0,tabIndex:n.focusable?0:void 0,"aria-label":k.value.ariaLabel===null?void 0:k.value.ariaLabel||`Edge from ${k.value.source} to ${k.value.target}`,"aria-describedby":n.focusable?`${qi}-${e}`:void 0,role:n.focusable?"button":void 0},[I.value?null:h$1(n.type===!1?f.value.default:n.type,{id:n.id,sourceNode:Ge,targetNode:Dn,source:k.value.source,target:k.value.target,type:k.value.type,updatable:n.updatable,selected:k.value.selected,animated:k.value.animated,label:k.value.label,labelStyle:k.value.labelStyle,labelShowBg:k.value.labelShowBg,labelBgStyle:k.value.labelBgStyle,labelBgPadding:k.value.labelBgPadding,labelBgBorderRadius:k.value.labelBgBorderRadius,data:k.value.data,events:{...k.value.events,...b.on},style:ne.value,markerStart:`url(#${Xe(k.value.markerStart,e)})`,markerEnd:`url(#${Xe(k.value.markerEnd,e)})`,sourcePosition:J,targetPosition:Ce,sourceX:Ve,sourceY:Le,targetX:_,targetY:N,sourceHandleId:k.value.sourceHandle,targetHandleId:k.value.targetHandle,interactionWidth:k.value.interactionWidth}),[n.updatable==="source"||n.updatable===!0?[h$1("g",{onMousedown:Ze,onMouseenter:qe,onMouseout:ge},h$1(Xo,{position:J,centerX:Ve,centerY:Le,radius:s.value,type:"source","data-type":"source"}))]:null,n.updatable==="target"||n.updatable===!0?[h$1("g",{onMousedown:Ae,onMouseenter:qe,onMouseout:ge},h$1(Xo,{position:Ce,centerX:_,centerY:N,radius:s.value,type:"target","data-type":"target"}))]:null]])};function qe(){R.value=!0}function ge(){R.value=!1}function Z(Ge,Dn){b.emit.update({event:Ge,edge:k.value,connection:Dn})}function re(Ge){b.emit.updateEnd({event:Ge,edge:k.value}),I.value=!1}function He(Ge,Dn){Ge.button===0&&(I.value=!0,$.value=Dn?k.value.target:k.value.source,Y.value=(Dn?k.value.targetHandle:k.value.sourceHandle)??"",oe.value=Dn?"target":"source",b.emit.updateStart({event:Ge,edge:k.value}),K(Ge))}function st(Ge){const Dn={event:Ge,edge:k.value};n.selectable&&(c.value=!1,r([k.value])),b.emit.click(Dn)}function ee(Ge){b.emit.contextMenu({event:Ge,edge:k.value})}function _e(Ge){b.emit.doubleClick({event:Ge,edge:k.value})}function ue(Ge){b.emit.mouseEnter({event:Ge,edge:k.value})}function ye(Ge){b.emit.mouseMove({event:Ge,edge:k.value})}function We(Ge){b.emit.mouseLeave({event:Ge,edge:k.value})}function Ze(Ge){He(Ge,!0)}function Ae(Ge){He(Ge,!1)}function Bt(Ge){var Dn;ji.includes(Ge.key)&&n.selectable&&(Ge.key==="Escape"?((Dn=G.value)==null||Dn.blur(),d([g(n.id)])):r([g(n.id)]))}}}),Ul=Xl,Wl={class:"vue-flow__connection"},ql=["d","marker-end","marker-start"],jl={name:"ConnectionLine",compatConfig:{MODE:3}},Ql=defineComponent({...jl,props:{sourceNode:null},setup(n){var e;const r=ce(),o=toRef(r,"connectionMode"),s=toRef(r,"connectionStartHandle"),l=toRef(r,"connectionEndHandle"),c=toRef(r,"connectionPosition"),u=toRef(r,"connectionLineType"),f=toRef(r,"connectionLineStyle"),d=toRef(r,"connectionLineOptions"),g=toRef(r,"connectionStatus"),m=toRef(r,"viewport"),v=toRef(r,"findNode"),b={[Q.Left]:Q.Right,[Q.Right]:Q.Left,[Q.Top]:Q.Bottom,[Q.Bottom]:Q.Top},k=(e=inject(an))==null?void 0:e["connection-line"],R=computed(()=>s.value.handleId),I=computed(()=>s.value.type),$=computed(()=>{var Z;return((Z=l.value)==null?void 0:Z.handleId)&&v.value(l.value.nodeId)||null}),Y=computed(()=>{var Z,re;return(o.value===je.Strict?(Z=n.sourceNode.handleBounds[I.value])==null?void 0:Z.find(He=>He.id===R.value):[...n.sourceNode.handleBounds.source||[],...n.sourceNode.handleBounds.target||[]].find(He=>He.id===R.value))||((re=n.sourceNode.handleBounds[I.value??"source"])==null?void 0:re[0])}),oe=computed(()=>{var Z,re,He;return $.value&&((Z=l.value)==null?void 0:Z.handleId)&&((o.value===je.Strict?(re=$.value.handleBounds[I.value==="source"?"target":"source"])==null?void 0:re.find(st=>{var ee;return st.id===((ee=l.value)==null?void 0:ee.handleId)}):[...$.value.handleBounds.source||[],...$.value.handleBounds.target||[]].find(st=>{var ee;return st.id===((ee=l.value)==null?void 0:ee.handleId)}))||((He=$.value.handleBounds[I.value??"target"])==null?void 0:He[0]))||null}),G=computed(()=>{var Z;return(Z=Y.value)==null?void 0:Z.position}),q=computed(()=>Y.value?Ut(G.value||Q.Top,{...n.sourceNode.dimensions,...n.sourceNode.computedPosition},Y.value):{x:n.sourceNode.dimensions.width/2,y:n.sourceNode.dimensions.height/2}),ne=computed(()=>G.value?b[G.value]:void 0),K=computed(()=>(c.value.x-m.value.x)/m.value.zoom),qe=computed(()=>(c.value.y-m.value.y)/m.value.zoom),ge=computed(()=>{let Z;const re={sourceX:q.value.x,sourceY:q.value.y,sourcePosition:G.value,targetX:K.value,targetY:qe.value,targetPosition:ne.value};switch(u.value??d.value.type){case Ye.Bezier:[Z]=Zn(re);break;case Ye.Step:[Z]=Kn({...re,borderRadius:0});break;case Ye.SmoothStep:[Z]=Kn(re);break;case Ye.SimpleBezier:[Z]=er(re);break;case Ye.Straight:[Z]=nr(re);break;default:[Z]=Zn(re);break}return Z});return(Z,re)=>{var He;return openBlock(),createElementBlock("g",Wl,[unref(k)?(openBlock(),createBlock(resolveDynamicComponent(unref(k)),normalizeProps(mergeProps({key:0},{sourceX:unref(q).x,sourceY:unref(q).y,sourcePosition:(He=unref(Y))==null?void 0:He.position,targetX:unref(K),targetY:unref(qe),targetPosition:unref(ne),sourceNode:n.sourceNode,sourceHandle:unref(Y),targetNode:unref($),targetHandle:unref(oe),markerEnd:`url(#${unref(Xe)(unref(d).markerEnd)})`,markerStart:`url(#${unref(Xe)(unref(d).markerStart)})`,connectionStatus:unref(g)})),null,16)):(openBlock(),createElementBlock("path",{key:1,d:unref(ge),class:normalizeClass(["vue-flow__connection-path",[unref(d).class,unref(g)]]),style:normalizeStyle(unref(f)||unref(d).style||{}),"marker-end":`url(#${unref(Xe)(unref(d).markerEnd)})`,"marker-start":`url(#${unref(Xe)(unref(d).markerStart)})`},null,14,ql))])}}}),Jl=["tabIndex"],eu={name:"NodesSelection",compatConfig:{MODE:3}},tu=defineComponent({...eu,setup(n){const e=ce(),r=toRef(e,"emits"),o=toRef(e,"viewport"),s=toRef(e,"getSelectedNodes"),l=toRef(e,"noPanClassName"),c=toRef(e,"disableKeyboardA11y"),u=toRef(e,"userSelectionActive"),f=Pi(),d=ref(),g=Ki({el:d,onStart(R){r.value.selectionDragStart(R)},onDrag(R){r.value.selectionDrag(R)},onStop(R){r.value.selectionDragStop(R)}});onMounted(()=>{var R;c.value||(R=d.value)==null||R.focus({preventScroll:!0})});const m=computed(()=>lo(s.value)),v=computed(()=>({width:`${m.value.width}px`,height:`${m.value.height}px`,top:`${m.value.y}px`,left:`${m.value.x}px`}));function b(R){r.value.selectionContextMenu({event:R,nodes:s.value})}function k(R){c.value||rt[R.key]&&f({x:rt[R.key].x,y:rt[R.key].y},R.shiftKey)}return(R,I)=>!unref(u)&&unref(m).width&&unref(m).height?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["vue-flow__nodesselection vue-flow__container",unref(l)]),style:normalizeStyle({transform:`translate(${unref(o).x}px,${unref(o).y}px) scale(${unref(o).zoom})`})},[createBaseVNode("div",{ref_key:"el",ref:d,class:normalizeClass([{dragging:unref(g)},"vue-flow__nodesselection-rect"]),style:normalizeStyle(unref(v)),tabIndex:unref(c)?void 0:-1,onContextmenu:b,onKeydown:k},null,46,Jl)],6)):createCommentVNode("",!0)}}),nu={name:"UserSelection",compatConfig:{MODE:3}},ou=defineComponent({...nu,setup(n){const{userSelectionRect:e}=ce();return(r,o)=>{var s,l,c,u;return openBlock(),createElementBlock("div",{class:"vue-flow__selection vue-flow__container",style:normalizeStyle({width:`${(s=unref(e))==null?void 0:s.width}px`,height:`${(l=unref(e))==null?void 0:l.height}px`,transform:`translate(${(c=unref(e))==null?void 0:c.x}px, ${(u=unref(e))==null?void 0:u.y}px)`})},null,4)}}}),iu={input:$a,default:Ma,output:ka},ru={default:Dl,straight:Hl,step:Vl,smoothstep:tr,simplebezier:Al};function au(){return{vueFlowRef:null,viewportRef:null,nodes:[],edges:[],nodeTypes:{},edgeTypes:{},initialized:!1,dimensions:{width:0,height:0},viewport:{x:0,y:0,zoom:1},d3Zoom:null,d3Selection:null,d3ZoomHandler:null,minZoom:.5,maxZoom:2,translateExtent:[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],nodeExtent:[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],selectionMode:uo.Full,paneDragging:!1,preventScrolling:!0,zoomOnScroll:!0,zoomOnPinch:!0,zoomOnDoubleClick:!0,panOnScroll:!1,panOnScrollSpeed:.5,panOnScrollMode:Xt.Free,panOnDrag:!0,edgeUpdaterRadius:10,onlyRenderVisibleElements:!1,defaultViewport:{x:0,y:0,zoom:1},nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,defaultMarkerColor:"#b1b1b7",connectionLineStyle:{},connectionLineType:null,connectionLineOptions:{type:Ye.Bezier,style:{}},connectionMode:je.Loose,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectionPosition:{x:NaN,y:NaN},connectionRadius:20,connectOnClick:!0,connectionStatus:null,isValidConnection:null,snapGrid:[15,15],snapToGrid:!1,edgesUpdatable:!1,edgesFocusable:!0,nodesFocusable:!0,nodesConnectable:!0,nodesDraggable:!0,elementsSelectable:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,selectionKeyCode:"Shift",multiSelectionKeyCode:"Meta",zoomActivationKeyCode:"Meta",deleteKeyCode:"Backspace",panActivationKeyCode:"Space",hooks:sa(),applyDefault:!0,autoConnect:!1,fitViewOnInit:!1,noDragClassName:"nodrag",noWheelClassName:"nowheel",noPanClassName:"nopan",defaultEdgeOptions:void 0,elevateEdgesOnSelect:!1,elevateNodesOnSelect:!0,autoPanOnNodeDrag:!0,autoPanOnConnect:!0,disableKeyboardA11y:!1,ariaLiveMessage:"",__experimentalFeatures:{nestedFlow:!1},vueFlowVersion:"1.19.0"}}function or(n){const e=au();return n&&Object.keys(n).forEach(r=>{const o=n[r];de(o)&&(e[r]=o)}),e}function su(n,e,r){const o=computed(()=>R=>n.nodes&&!e.value.length?n.nodes.find(I=>I.id===R):n.nodes[e.value.indexOf(R)]),s=computed(()=>R=>n.edges&&!r.value.length?n.edges.find(I=>I.id===R):n.edges[r.value.indexOf(R)]),l=computed(()=>{var R;const I={...ru,...n.edgeTypes},$=Object.keys(I);return(R=n.edges)==null||R.forEach(Y=>Y.type&&!$.includes(Y.type)&&(I[Y.type]=Y.type)),I}),c=computed(()=>{var R;const I={...iu,...n.nodeTypes},$=Object.keys(I);return(R=n.nodes)==null||R.forEach(Y=>Y.type&&!$.includes(Y.type)&&(I[Y.type]=Y.type)),I}),u=computed(()=>{const R=n.nodes.filter(I=>!I.hidden);return n.onlyRenderVisibleElements?R&&Ei(R,{x:0,y:0,width:n.dimensions.width,height:n.dimensions.height},n.viewport,!0):R??[]}),f=(R,I,$)=>{if(I=I??o.value(R.source),$=$??o.value(R.target),!I||!$){n.hooks.error.trigger(new ve(he.EDGE_ORPHANED,R.id));return}return!R.hidden&&!$.hidden&&!I.hidden},d=computed(()=>n.onlyRenderVisibleElements?n.edges.filter(R=>{const I=o.value(R.source),$=o.value(R.target);return f(R,I,$)&&xa({sourcePos:I.computedPosition||{x:0,y:0},targetPos:$.computedPosition||{x:0,y:0},sourceWidth:I.dimensions.width,sourceHeight:I.dimensions.height,targetWidth:$.dimensions.width,targetHeight:$.dimensions.height,width:n.dimensions.width,height:n.dimensions.height,viewport:n.viewport})}):n.edges.filter(R=>f(R))),g=computed(()=>[...u.value,...d.value]),m=computed(()=>n.nodes.filter(R=>R.selected)),v=computed(()=>n.edges.filter(R=>R.selected)),b=computed(()=>[...m.value??[],...v.value??[]]),k=computed(()=>u.value.filter(R=>R.initialized&&R.handleBounds!==void 0));return{getNode:o,getEdge:s,getElements:g,getEdgeTypes:l,getNodeTypes:c,getEdges:d,getNodes:u,getSelectedElements:b,getSelectedNodes:m,getSelectedEdges:v,getNodesInitialized:k}}function mo(n,e,r){n.prototype=e.prototype=r,r.constructor=n}function ir(n,e){var r=Object.create(n.prototype);for(var o in e)r[o]=e[o];return r}function kt(){}var Et=.7,Wt=1/Et,at="\\s*([+-]?\\d+)\\s*",St="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Me="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",lu=/^#([0-9a-f]{3,8})$/,uu=new RegExp(`^rgb\\(${at},${at},${at}\\)$`),cu=new RegExp(`^rgb\\(${Me},${Me},${Me}\\)$`),du=new RegExp(`^rgba\\(${at},${at},${at},${St}\\)$`),fu=new RegExp(`^rgba\\(${Me},${Me},${Me},${St}\\)$`),hu=new RegExp(`^hsl\\(${St},${Me},${Me}\\)$`),gu=new RegExp(`^hsla\\(${St},${Me},${Me},${St}\\)$`),Uo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};mo(kt,Nt,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:Zo,formatHex:Zo,formatHex8:vu,formatHsl:mu,formatRgb:Ko,toString:Ko});function Zo(){return this.rgb().formatHex()}function vu(){return this.rgb().formatHex8()}function mu(){return rr(this).formatHsl()}function Ko(){return this.rgb().formatRgb()}function Nt(n){var e,r;return n=(n+"").trim().toLowerCase(),(e=lu.exec(n))?(r=e[1].length,e=parseInt(e[1],16),r===6?Wo(e):r===3?new me(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Pt(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Pt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=uu.exec(n))?new me(e[1],e[2],e[3],1):(e=cu.exec(n))?new me(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=du.exec(n))?Pt(e[1],e[2],e[3],e[4]):(e=fu.exec(n))?Pt(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=hu.exec(n))?Qo(e[1],e[2]/100,e[3]/100,1):(e=gu.exec(n))?Qo(e[1],e[2]/100,e[3]/100,e[4]):Uo.hasOwnProperty(n)?Wo(Uo[n]):n==="transparent"?new me(NaN,NaN,NaN,0):null}function Wo(n){return new me(n>>16&255,n>>8&255,n&255,1)}function Pt(n,e,r,o){return o<=0&&(n=e=r=NaN),new me(n,e,r,o)}function pu(n){return n instanceof kt||(n=Nt(n)),n?(n=n.rgb(),new me(n.r,n.g,n.b,n.opacity)):new me}function Wn(n,e,r,o){return arguments.length===1?pu(n):new me(n,e,r,o??1)}function me(n,e,r,o){this.r=+n,this.g=+e,this.b=+r,this.opacity=+o}mo(me,Wn,ir(kt,{brighter(n){return n=n==null?Wt:Math.pow(Wt,n),new me(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?Et:Math.pow(Et,n),new me(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new me(Ke(this.r),Ke(this.g),Ke(this.b),qt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qo,formatHex:qo,formatHex8:yu,formatRgb:jo,toString:jo}));function qo(){return`#${Ue(this.r)}${Ue(this.g)}${Ue(this.b)}`}function yu(){return`#${Ue(this.r)}${Ue(this.g)}${Ue(this.b)}${Ue((isNaN(this.opacity)?1:this.opacity)*255)}`}function jo(){const n=qt(this.opacity);return`${n===1?"rgb(":"rgba("}${Ke(this.r)}, ${Ke(this.g)}, ${Ke(this.b)}${n===1?")":`, ${n})`}`}function qt(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function Ke(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function Ue(n){return n=Ke(n),(n<16?"0":"")+n.toString(16)}function Qo(n,e,r,o){return o<=0?n=e=r=NaN:r<=0||r>=1?n=e=NaN:e<=0&&(n=NaN),new be(n,e,r,o)}function rr(n){if(n instanceof be)return new be(n.h,n.s,n.l,n.opacity);if(n instanceof kt||(n=Nt(n)),!n)return new be;if(n instanceof be)return n;n=n.rgb();var e=n.r/255,r=n.g/255,o=n.b/255,s=Math.min(e,r,o),l=Math.max(e,r,o),c=NaN,u=l-s,f=(l+s)/2;return u?(e===l?c=(r-o)/u+(r<o)*6:r===l?c=(o-e)/u+2:c=(e-r)/u+4,u/=f<.5?l+s:2-l-s,c*=60):u=f>0&&f<1?0:c,new be(c,u,f,n.opacity)}function xu(n,e,r,o){return arguments.length===1?rr(n):new be(n,e,r,o??1)}function be(n,e,r,o){this.h=+n,this.s=+e,this.l=+r,this.opacity=+o}mo(be,xu,ir(kt,{brighter(n){return n=n==null?Wt:Math.pow(Wt,n),new be(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?Et:Math.pow(Et,n),new be(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,r=this.l,o=r+(r<.5?r:1-r)*e,s=2*r-o;return new me(Cn(n>=240?n-240:n+120,s,o),Cn(n,s,o),Cn(n<120?n+240:n-120,s,o),this.opacity)},clamp(){return new be(Jo(this.h),Dt(this.s),Dt(this.l),qt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=qt(this.opacity);return`${n===1?"hsl(":"hsla("}${Jo(this.h)}, ${Dt(this.s)*100}%, ${Dt(this.l)*100}%${n===1?")":`, ${n})`}`}}));function Jo(n){return n=(n||0)%360,n<0?n+360:n}function Dt(n){return Math.max(0,Math.min(1,n||0))}function Cn(n,e,r){return(n<60?e+(r-e)*n/60:n<180?r:n<240?e+(r-e)*(240-n)/60:e)*255}const ar=n=>()=>n;function _u(n,e){return function(r){return n+r*e}}function wu(n,e,r){return n=Math.pow(n,r),e=Math.pow(e,r)-n,r=1/r,function(o){return Math.pow(n+o*e,r)}}function bu(n){return(n=+n)==1?sr:function(e,r){return r-e?wu(e,r,n):ar(isNaN(e)?r:e)}}function sr(n,e){var r=e-n;return r?_u(n,r):ar(isNaN(n)?e:n)}const ei=function n(e){var r=bu(e);function o(s,l){var c=r((s=Wn(s)).r,(l=Wn(l)).r),u=r(s.g,l.g),f=r(s.b,l.b),d=sr(s.opacity,l.opacity);return function(g){return s.r=c(g),s.g=u(g),s.b=f(g),s.opacity=d(g),s+""}}return o.gamma=n,o}(1);function Re(n,e){return n=+n,e=+e,function(r){return n*(1-r)+e*r}}var qn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Mn=new RegExp(qn.source,"g");function Eu(n){return function(){return n}}function Su(n){return function(e){return n(e)+""}}function Nu(n,e){var r=qn.lastIndex=Mn.lastIndex=0,o,s,l,c=-1,u=[],f=[];for(n=n+"",e=e+"";(o=qn.exec(n))&&(s=Mn.exec(e));)(l=s.index)>r&&(l=e.slice(r,l),u[c]?u[c]+=l:u[++c]=l),(o=o[0])===(s=s[0])?u[c]?u[c]+=s:u[++c]=s:(u[++c]=null,f.push({i:c,x:Re(o,s)})),r=Mn.lastIndex;return r<e.length&&(l=e.slice(r),u[c]?u[c]+=l:u[++c]=l),u.length<2?f[0]?Su(f[0].x):Eu(e):(e=f.length,function(d){for(var g=0,m;g<e;++g)u[(m=f[g]).i]=m.x(d);return u.join("")})}var ti=180/Math.PI,jn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function lr(n,e,r,o,s,l){var c,u,f;return(c=Math.sqrt(n*n+e*e))&&(n/=c,e/=c),(f=n*r+e*o)&&(r-=n*f,o-=e*f),(u=Math.sqrt(r*r+o*o))&&(r/=u,o/=u,f/=u),n*o<e*r&&(n=-n,e=-e,f=-f,c=-c),{translateX:s,translateY:l,rotate:Math.atan2(e,n)*ti,skewX:Math.atan(f)*ti,scaleX:c,scaleY:u}}var At;function Cu(n){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return e.isIdentity?jn:lr(e.a,e.b,e.c,e.d,e.e,e.f)}function Mu(n){return n==null||(At||(At=document.createElementNS("http://www.w3.org/2000/svg","g")),At.setAttribute("transform",n),!(n=At.transform.baseVal.consolidate()))?jn:(n=n.matrix,lr(n.a,n.b,n.c,n.d,n.e,n.f))}function ur(n,e,r,o){function s(d){return d.length?d.pop()+" ":""}function l(d,g,m,v,b,k){if(d!==m||g!==v){var R=b.push("translate(",null,e,null,r);k.push({i:R-4,x:Re(d,m)},{i:R-2,x:Re(g,v)})}else(m||v)&&b.push("translate("+m+e+v+r)}function c(d,g,m,v){d!==g?(d-g>180?g+=360:g-d>180&&(d+=360),v.push({i:m.push(s(m)+"rotate(",null,o)-2,x:Re(d,g)})):g&&m.push(s(m)+"rotate("+g+o)}function u(d,g,m,v){d!==g?v.push({i:m.push(s(m)+"skewX(",null,o)-2,x:Re(d,g)}):g&&m.push(s(m)+"skewX("+g+o)}function f(d,g,m,v,b,k){if(d!==m||g!==v){var R=b.push(s(b)+"scale(",null,",",null,")");k.push({i:R-4,x:Re(d,m)},{i:R-2,x:Re(g,v)})}else(m!==1||v!==1)&&b.push(s(b)+"scale("+m+","+v+")")}return function(d,g){var m=[],v=[];return d=n(d),g=n(g),l(d.translateX,d.translateY,g.translateX,g.translateY,m,v),c(d.rotate,g.rotate,m,v),u(d.skewX,g.skewX,m,v),f(d.scaleX,d.scaleY,g.scaleX,g.scaleY,m,v),d=g=null,function(b){for(var k=-1,R=v.length,I;++k<R;)m[(I=v[k]).i]=I.x(b);return m.join("")}}}var $u=ur(Cu,"px, ","px)","deg)"),ku=ur(Mu,", ",")",")"),Ou=1e-12;function ni(n){return((n=Math.exp(n))+1/n)/2}function Iu(n){return((n=Math.exp(n))-1/n)/2}function Tu(n){return((n=Math.exp(2*n))-1)/(n+1)}const Pu=function n(e,r,o){function s(l,c){var u=l[0],f=l[1],d=l[2],g=c[0],m=c[1],v=c[2],b=g-u,k=m-f,R=b*b+k*k,I,$;if(R<Ou)$=Math.log(v/d)/e,I=function(K){return[u+K*b,f+K*k,d*Math.exp(e*K*$)]};else{var Y=Math.sqrt(R),oe=(v*v-d*d+o*R)/(2*d*r*Y),G=(v*v-d*d-o*R)/(2*v*r*Y),q=Math.log(Math.sqrt(oe*oe+1)-oe),ne=Math.log(Math.sqrt(G*G+1)-G);$=(ne-q)/e,I=function(K){var qe=K*$,ge=ni(q),Z=d/(r*Y)*(ge*Tu(e*qe+q)-Iu(q));return[u+Z*b,f+Z*k,d*ge/ni(e*qe+q)]}}return I.duration=$*1e3*e/Math.SQRT2,I}return s.rho=function(l){var c=Math.max(.001,+l),u=c*c,f=u*u;return n(c,u,f)},s}(Math.SQRT2,2,4);var ft=0,mt=0,gt=0,cr=1e3,jt,pt,Qt=0,Qe=0,xn=0,Ct=typeof performance=="object"&&performance.now?performance:Date,dr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function po(){return Qe||(dr(Du),Qe=Ct.now()+xn)}function Du(){Qe=0}function Jt(){this._call=this._time=this._next=null}Jt.prototype=fr.prototype={constructor:Jt,restart:function(n,e,r){if(typeof n!="function")throw new TypeError("callback is not a function");r=(r==null?po():+r)+(e==null?0:+e),!this._next&&pt!==this&&(pt?pt._next=this:jt=this,pt=this),this._call=n,this._time=r,Qn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Qn())}};function fr(n,e,r){var o=new Jt;return o.restart(n,e,r),o}function Au(){po(),++ft;for(var n=jt,e;n;)(e=Qe-n._time)>=0&&n._call.call(void 0,e),n=n._next;--ft}function oi(){Qe=(Qt=Ct.now())+xn,ft=mt=0;try{Au()}finally{ft=0,Bu(),Qe=0}}function zu(){var n=Ct.now(),e=n-Qt;e>cr&&(xn-=e,Qt=n)}function Bu(){for(var n,e=jt,r,o=1/0;e;)e._call?(o>e._time&&(o=e._time),n=e,e=e._next):(r=e._next,e._next=null,e=n?n._next=r:jt=r);pt=n,Qn(o)}function Qn(n){if(!ft){mt&&(mt=clearTimeout(mt));var e=n-Qe;e>24?(n<1/0&&(mt=setTimeout(oi,n-Ct.now()-xn)),gt&&(gt=clearInterval(gt))):(gt||(Qt=Ct.now(),gt=setInterval(zu,cr)),ft=1,dr(oi))}}function ii(n,e,r){var o=new Jt;return e=e==null?0:+e,o.restart(s=>{o.stop(),n(s+e)},e,r),o}var Ru=cn("start","end","cancel","interrupt"),Vu=[],hr=0,ri=1,Jn=2,Vt=3,ai=4,eo=5,Ht=6;function _n(n,e,r,o,s,l){var c=n.__transition;if(!c)n.__transition={};else if(r in c)return;Hu(n,r,{name:e,index:o,group:s,on:Ru,tween:Vu,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:hr})}function yo(n,e){var r=Se(n,e);if(r.state>hr)throw new Error("too late; already scheduled");return r}function ke(n,e){var r=Se(n,e);if(r.state>Vt)throw new Error("too late; already running");return r}function Se(n,e){var r=n.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function Hu(n,e,r){var o=n.__transition,s;o[e]=r,r.timer=fr(l,0,r.time);function l(d){r.state=ri,r.timer.restart(c,r.delay,r.time),r.delay<=d&&c(d-r.delay)}function c(d){var g,m,v,b;if(r.state!==ri)return f();for(g in o)if(b=o[g],b.name===r.name){if(b.state===Vt)return ii(c);b.state===ai?(b.state=Ht,b.timer.stop(),b.on.call("interrupt",n,n.__data__,b.index,b.group),delete o[g]):+g<e&&(b.state=Ht,b.timer.stop(),b.on.call("cancel",n,n.__data__,b.index,b.group),delete o[g])}if(ii(function(){r.state===Vt&&(r.state=ai,r.timer.restart(u,r.delay,r.time),u(d))}),r.state=Jn,r.on.call("start",n,n.__data__,r.index,r.group),r.state===Jn){for(r.state=Vt,s=new Array(v=r.tween.length),g=0,m=-1;g<v;++g)(b=r.tween[g].value.call(n,n.__data__,r.index,r.group))&&(s[++m]=b);s.length=m+1}}function u(d){for(var g=d<r.duration?r.ease.call(null,d/r.duration):(r.timer.restart(f),r.state=eo,1),m=-1,v=s.length;++m<v;)s[m].call(n,g);r.state===eo&&(r.on.call("end",n,n.__data__,r.index,r.group),f())}function f(){r.state=Ht,r.timer.stop(),delete o[e];for(var d in o)return;delete n.__transition}}function Lt(n,e){var r=n.__transition,o,s,l=!0,c;if(r){e=e==null?null:e+"";for(c in r){if((o=r[c]).name!==e){l=!1;continue}s=o.state>Jn&&o.state<eo,o.state=Ht,o.timer.stop(),o.on.call(s?"interrupt":"cancel",n,n.__data__,o.index,o.group),delete r[c]}l&&delete n.__transition}}function Lu(n){return this.each(function(){Lt(this,n)})}function Fu(n,e){var r,o;return function(){var s=ke(this,n),l=s.tween;if(l!==r){o=r=l;for(var c=0,u=o.length;c<u;++c)if(o[c].name===e){o=o.slice(),o.splice(c,1);break}}s.tween=o}}function Gu(n,e,r){var o,s;if(typeof r!="function")throw new Error;return function(){var l=ke(this,n),c=l.tween;if(c!==o){s=(o=c).slice();for(var u={name:e,value:r},f=0,d=s.length;f<d;++f)if(s[f].name===e){s[f]=u;break}f===d&&s.push(u)}l.tween=s}}function Yu(n,e){var r=this._id;if(n+="",arguments.length<2){for(var o=Se(this.node(),r).tween,s=0,l=o.length,c;s<l;++s)if((c=o[s]).name===n)return c.value;return null}return this.each((e==null?Fu:Gu)(r,n,e))}function xo(n,e,r){var o=n._id;return n.each(function(){var s=ke(this,o);(s.value||(s.value={}))[e]=r.apply(this,arguments)}),function(s){return Se(s,o).value[e]}}function gr(n,e){var r;return(typeof e=="number"?Re:e instanceof Nt?ei:(r=Nt(e))?(e=r,ei):Nu)(n,e)}function Xu(n){return function(){this.removeAttribute(n)}}function Uu(n){return function(){this.removeAttributeNS(n.space,n.local)}}function Zu(n,e,r){var o,s=r+"",l;return function(){var c=this.getAttribute(n);return c===s?null:c===o?l:l=e(o=c,r)}}function Ku(n,e,r){var o,s=r+"",l;return function(){var c=this.getAttributeNS(n.space,n.local);return c===s?null:c===o?l:l=e(o=c,r)}}function Wu(n,e,r){var o,s,l;return function(){var c,u=r(this),f;return u==null?void this.removeAttribute(n):(c=this.getAttribute(n),f=u+"",c===f?null:c===o&&f===s?l:(s=f,l=e(o=c,u)))}}function qu(n,e,r){var o,s,l;return function(){var c,u=r(this),f;return u==null?void this.removeAttributeNS(n.space,n.local):(c=this.getAttributeNS(n.space,n.local),f=u+"",c===f?null:c===o&&f===s?l:(s=f,l=e(o=c,u)))}}function ju(n,e){var r=dn(n),o=r==="transform"?ku:gr;return this.attrTween(n,typeof e=="function"?(r.local?qu:Wu)(r,o,xo(this,"attr."+n,e)):e==null?(r.local?Uu:Xu)(r):(r.local?Ku:Zu)(r,o,e))}function Qu(n,e){return function(r){this.setAttribute(n,e.call(this,r))}}function Ju(n,e){return function(r){this.setAttributeNS(n.space,n.local,e.call(this,r))}}function ec(n,e){var r,o;function s(){var l=e.apply(this,arguments);return l!==o&&(r=(o=l)&&Ju(n,l)),r}return s._value=e,s}function tc(n,e){var r,o;function s(){var l=e.apply(this,arguments);return l!==o&&(r=(o=l)&&Qu(n,l)),r}return s._value=e,s}function nc(n,e){var r="attr."+n;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var o=dn(n);return this.tween(r,(o.local?ec:tc)(o,e))}function oc(n,e){return function(){yo(this,n).delay=+e.apply(this,arguments)}}function ic(n,e){return e=+e,function(){yo(this,n).delay=e}}function rc(n){var e=this._id;return arguments.length?this.each((typeof n=="function"?oc:ic)(e,n)):Se(this.node(),e).delay}function ac(n,e){return function(){ke(this,n).duration=+e.apply(this,arguments)}}function sc(n,e){return e=+e,function(){ke(this,n).duration=e}}function lc(n){var e=this._id;return arguments.length?this.each((typeof n=="function"?ac:sc)(e,n)):Se(this.node(),e).duration}function uc(n,e){if(typeof e!="function")throw new Error;return function(){ke(this,n).ease=e}}function cc(n){var e=this._id;return arguments.length?this.each(uc(e,n)):Se(this.node(),e).ease}function dc(n,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;ke(this,n).ease=r}}function fc(n){if(typeof n!="function")throw new Error;return this.each(dc(this._id,n))}function hc(n){typeof n!="function"&&(n=zi(n));for(var e=this._groups,r=e.length,o=new Array(r),s=0;s<r;++s)for(var l=e[s],c=l.length,u=o[s]=[],f,d=0;d<c;++d)(f=l[d])&&n.call(f,f.__data__,d,l)&&u.push(f);return new Be(o,this._parents,this._name,this._id)}function gc(n){if(n._id!==this._id)throw new Error;for(var e=this._groups,r=n._groups,o=e.length,s=r.length,l=Math.min(o,s),c=new Array(o),u=0;u<l;++u)for(var f=e[u],d=r[u],g=f.length,m=c[u]=new Array(g),v,b=0;b<g;++b)(v=f[b]||d[b])&&(m[b]=v);for(;u<o;++u)c[u]=e[u];return new Be(c,this._parents,this._name,this._id)}function vc(n){return(n+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function mc(n,e,r){var o,s,l=vc(e)?yo:ke;return function(){var c=l(this,n),u=c.on;u!==o&&(s=(o=u).copy()).on(e,r),c.on=s}}function pc(n,e){var r=this._id;return arguments.length<2?Se(this.node(),r).on.on(n):this.each(mc(r,n,e))}function yc(n){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==n)return;e&&e.removeChild(this)}}function xc(){return this.on("end.remove",yc(this._id))}function _c(n){var e=this._name,r=this._id;typeof n!="function"&&(n=ho(n));for(var o=this._groups,s=o.length,l=new Array(s),c=0;c<s;++c)for(var u=o[c],f=u.length,d=l[c]=new Array(f),g,m,v=0;v<f;++v)(g=u[v])&&(m=n.call(g,g.__data__,v,u))&&("__data__"in g&&(m.__data__=g.__data__),d[v]=m,_n(d[v],e,r,v,d,Se(g,r)));return new Be(l,this._parents,e,r)}function wc(n){var e=this._name,r=this._id;typeof n!="function"&&(n=Ai(n));for(var o=this._groups,s=o.length,l=[],c=[],u=0;u<s;++u)for(var f=o[u],d=f.length,g,m=0;m<d;++m)if(g=f[m]){for(var v=n.call(g,g.__data__,m,f),b,k=Se(g,r),R=0,I=v.length;R<I;++R)(b=v[R])&&_n(b,e,r,R,v,k);l.push(v),c.push(g)}return new Be(l,c,e,r)}var bc=$t.prototype.constructor;function Ec(){return new bc(this._groups,this._parents)}function Sc(n,e){var r,o,s;return function(){var l=dt(this,n),c=(this.style.removeProperty(n),dt(this,n));return l===c?null:l===r&&c===o?s:s=e(r=l,o=c)}}function vr(n){return function(){this.style.removeProperty(n)}}function Nc(n,e,r){var o,s=r+"",l;return function(){var c=dt(this,n);return c===s?null:c===o?l:l=e(o=c,r)}}function Cc(n,e,r){var o,s,l;return function(){var c=dt(this,n),u=r(this),f=u+"";return u==null&&(f=u=(this.style.removeProperty(n),dt(this,n))),c===f?null:c===o&&f===s?l:(s=f,l=e(o=c,u))}}function Mc(n,e){var r,o,s,l="style."+e,c="end."+l,u;return function(){var f=ke(this,n),d=f.on,g=f.value[l]==null?u||(u=vr(e)):void 0;(d!==r||s!==g)&&(o=(r=d).copy()).on(c,s=g),f.on=o}}function $c(n,e,r){var o=(n+="")=="transform"?$u:gr;return e==null?this.styleTween(n,Sc(n,o)).on("end.style."+n,vr(n)):typeof e=="function"?this.styleTween(n,Cc(n,o,xo(this,"style."+n,e))).each(Mc(this._id,n)):this.styleTween(n,Nc(n,o,e),r).on("end.style."+n,null)}function kc(n,e,r){return function(o){this.style.setProperty(n,e.call(this,o),r)}}function Oc(n,e,r){var o,s;function l(){var c=e.apply(this,arguments);return c!==s&&(o=(s=c)&&kc(n,c,r)),o}return l._value=e,l}function Ic(n,e,r){var o="style."+(n+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(e==null)return this.tween(o,null);if(typeof e!="function")throw new Error;return this.tween(o,Oc(n,e,r??""))}function Tc(n){return function(){this.textContent=n}}function Pc(n){return function(){var e=n(this);this.textContent=e??""}}function Dc(n){return this.tween("text",typeof n=="function"?Pc(xo(this,"text",n)):Tc(n==null?"":n+""))}function Ac(n){return function(e){this.textContent=n.call(this,e)}}function zc(n){var e,r;function o(){var s=n.apply(this,arguments);return s!==r&&(e=(r=s)&&Ac(s)),e}return o._value=n,o}function Bc(n){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(n==null)return this.tween(e,null);if(typeof n!="function")throw new Error;return this.tween(e,zc(n))}function Rc(){for(var n=this._name,e=this._id,r=mr(),o=this._groups,s=o.length,l=0;l<s;++l)for(var c=o[l],u=c.length,f,d=0;d<u;++d)if(f=c[d]){var g=Se(f,e);_n(f,n,r,d,c,{time:g.time+g.delay+g.duration,delay:0,duration:g.duration,ease:g.ease})}return new Be(o,this._parents,n,r)}function Vc(){var n,e,r=this,o=r._id,s=r.size();return new Promise(function(l,c){var u={value:c},f={value:function(){--s===0&&l()}};r.each(function(){var d=ke(this,o),g=d.on;g!==n&&(e=(n=g).copy(),e._.cancel.push(u),e._.interrupt.push(u),e._.end.push(f)),d.on=e}),s===0&&l()})}var Hc=0;function Be(n,e,r,o){this._groups=n,this._parents=e,this._name=r,this._id=o}function mr(){return++Hc}var Oe=$t.prototype;Be.prototype={constructor:Be,select:_c,selectAll:wc,selectChild:Oe.selectChild,selectChildren:Oe.selectChildren,filter:hc,merge:gc,selection:Ec,transition:Rc,call:Oe.call,nodes:Oe.nodes,node:Oe.node,size:Oe.size,empty:Oe.empty,each:Oe.each,on:pc,attr:ju,attrTween:nc,style:$c,styleTween:Ic,text:Dc,textTween:Bc,remove:xc,tween:Yu,delay:rc,duration:lc,ease:cc,easeVarying:fc,end:Vc,[Symbol.iterator]:Oe[Symbol.iterator]};function Lc(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}var Fc={time:null,delay:0,duration:250,ease:Lc};function Gc(n,e){for(var r;!(r=n.__transition)||!(r=r[e]);)if(!(n=n.parentNode))throw new Error(`transition ${e} not found`);return r}function Yc(n){var e,r;n instanceof Be?(e=n._id,n=n._name):(e=mr(),(r=Fc).time=po(),n=n==null?null:n+"");for(var o=this._groups,s=o.length,l=0;l<s;++l)for(var c=o[l],u=c.length,f,d=0;d<u;++d)(f=c[d])&&_n(f,n,e,d,c,r||Gc(f,e));return new Be(o,this._parents,n,e)}$t.prototype.interrupt=Lu;$t.prototype.transition=Yc;const zt=n=>()=>n;function Xc(n,{sourceEvent:e,target:r,transform:o,dispatch:s}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:s}})}function De(n,e,r){this.k=n,this.x=e,this.y=r}De.prototype={constructor:De,scale:function(n){return n===1?this:new De(this.k*n,this.x,this.y)},translate:function(n,e){return n===0&e===0?this:new De(this.k,this.x+this.k*n,this.y+this.k*e)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ht=new De(1,0,0);De.prototype;function $n(n){n.stopImmediatePropagation()}function vt(n){n.preventDefault(),n.stopImmediatePropagation()}function Uc(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function Zc(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function si(){return this.__zoom||ht}function Kc(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function Wc(){return navigator.maxTouchPoints||"ontouchstart"in this}function qc(n,e,r){var o=n.invertX(e[0][0])-r[0][0],s=n.invertX(e[1][0])-r[1][0],l=n.invertY(e[0][1])-r[0][1],c=n.invertY(e[1][1])-r[1][1];return n.translate(s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s),c>l?(l+c)/2:Math.min(0,l)||Math.max(0,c))}function jc(){var n=Uc,e=Zc,r=qc,o=Kc,s=Wc,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,f=Pu,d=cn("start","zoom","end"),g,m,v,b=500,k=150,R=0,I=10;function $(ee){ee.property("__zoom",si).on("wheel.zoom",qe,{passive:!1}).on("mousedown.zoom",ge).on("dblclick.zoom",Z).filter(s).on("touchstart.zoom",re).on("touchmove.zoom",He).on("touchend.zoom touchcancel.zoom",st).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}$.transform=function(ee,_e,ue,ye){var We=ee.selection?ee.selection():ee;We.property("__zoom",si),ee!==We?q(ee,_e,ue,ye):We.interrupt().each(function(){ne(this,arguments).event(ye).start().zoom(null,typeof _e=="function"?_e.apply(this,arguments):_e).end()})},$.scaleBy=function(ee,_e,ue,ye){$.scaleTo(ee,function(){var We=this.__zoom.k,Ze=typeof _e=="function"?_e.apply(this,arguments):_e;return We*Ze},ue,ye)},$.scaleTo=function(ee,_e,ue,ye){$.transform(ee,function(){var We=e.apply(this,arguments),Ze=this.__zoom,Ae=ue==null?G(We):typeof ue=="function"?ue.apply(this,arguments):ue,Bt=Ze.invert(Ae),Ge=typeof _e=="function"?_e.apply(this,arguments):_e;return r(oe(Y(Ze,Ge),Ae,Bt),We,c)},ue,ye)},$.translateBy=function(ee,_e,ue,ye){$.transform(ee,function(){return r(this.__zoom.translate(typeof _e=="function"?_e.apply(this,arguments):_e,typeof ue=="function"?ue.apply(this,arguments):ue),e.apply(this,arguments),c)},null,ye)},$.translateTo=function(ee,_e,ue,ye,We){$.transform(ee,function(){var Ze=e.apply(this,arguments),Ae=this.__zoom,Bt=ye==null?G(Ze):typeof ye=="function"?ye.apply(this,arguments):ye;return r(ht.translate(Bt[0],Bt[1]).scale(Ae.k).translate(typeof _e=="function"?-_e.apply(this,arguments):-_e,typeof ue=="function"?-ue.apply(this,arguments):-ue),Ze,c)},ye,We)};function Y(ee,_e){return _e=Math.max(l[0],Math.min(l[1],_e)),_e===ee.k?ee:new De(_e,ee.x,ee.y)}function oe(ee,_e,ue){var ye=_e[0]-ue[0]*ee.k,We=_e[1]-ue[1]*ee.k;return ye===ee.x&&We===ee.y?ee:new De(ee.k,ye,We)}function G(ee){return[(+ee[0][0]+ +ee[1][0])/2,(+ee[0][1]+ +ee[1][1])/2]}function q(ee,_e,ue,ye){ee.on("start.zoom",function(){ne(this,arguments).event(ye).start()}).on("interrupt.zoom end.zoom",function(){ne(this,arguments).event(ye).end()}).tween("zoom",function(){var We=this,Ze=arguments,Ae=ne(We,Ze).event(ye),Bt=e.apply(We,Ze),Ge=ue==null?G(Bt):typeof ue=="function"?ue.apply(We,Ze):ue,Dn=Math.max(Bt[1][0]-Bt[0][0],Bt[1][1]-Bt[0][1]),An=We.__zoom,fe=typeof _e=="function"?_e.apply(We,Ze):_e,le=f(An.invert(Ge).concat(Dn/An.k),fe.invert(Ge).concat(Dn/fe.k));return function(H){if(H===1)H=fe;else{var J=le(H),Ce=Dn/J[2];H=new De(Ce,Ge[0]-J[0]*Ce,Ge[1]-J[1]*Ce)}Ae.zoom(null,H)}})}function ne(ee,_e,ue){return!ue&&ee.__zooming||new K(ee,_e)}function K(ee,_e){this.that=ee,this.args=_e,this.active=0,this.sourceEvent=null,this.extent=e.apply(ee,_e),this.taps=0}K.prototype={event:function(ee){return ee&&(this.sourceEvent=ee),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(ee,_e){return this.mouse&&ee!=="mouse"&&(this.mouse[1]=_e.invert(this.mouse[0])),this.touch0&&ee!=="touch"&&(this.touch0[1]=_e.invert(this.touch0[0])),this.touch1&&ee!=="touch"&&(this.touch1[1]=_e.invert(this.touch1[0])),this.that.__zoom=_e,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(ee){var _e=we(this.that).datum();d.call(ee,this.that,new Xc(ee,{sourceEvent:this.sourceEvent,target:$,type:ee,transform:this.that.__zoom,dispatch:d}),_e)}};function qe(ee,..._e){if(!n.apply(this,arguments))return;var ue=ne(this,_e).event(ee),ye=this.__zoom,We=Math.max(l[0],Math.min(l[1],ye.k*Math.pow(2,o.apply(this,arguments)))),Ze=Ne(ee);if(ue.wheel)(ue.mouse[0][0]!==Ze[0]||ue.mouse[0][1]!==Ze[1])&&(ue.mouse[1]=ye.invert(ue.mouse[0]=Ze)),clearTimeout(ue.wheel);else{if(ye.k===We)return;ue.mouse=[Ze,ye.invert(Ze)],Lt(this),ue.start()}vt(ee),ue.wheel=setTimeout(Ae,k),ue.zoom("mouse",r(oe(Y(ye,We),ue.mouse[0],ue.mouse[1]),ue.extent,c));function Ae(){ue.wheel=null,ue.end()}}function ge(ee,..._e){if(v||!n.apply(this,arguments))return;var ue=ee.currentTarget,ye=ne(this,_e,!0).event(ee),We=we(ee.view).on("mousemove.zoom",Ge,!0).on("mouseup.zoom",Dn,!0),Ze=Ne(ee,ue),Ae=ee.clientX,Bt=ee.clientY;Ui(ee.view),$n(ee),ye.mouse=[Ze,this.__zoom.invert(Ze)],Lt(this),ye.start();function Ge(An){if(vt(An),!ye.moved){var fe=An.clientX-Ae,le=An.clientY-Bt;ye.moved=fe*fe+le*le>R}ye.event(An).zoom("mouse",r(oe(ye.that.__zoom,ye.mouse[0]=Ne(An,ue),ye.mouse[1]),ye.extent,c))}function Dn(An){We.on("mousemove.zoom mouseup.zoom",null),Zi(An.view,ye.moved),vt(An),ye.event(An).end()}}function Z(ee,..._e){if(n.apply(this,arguments)){var ue=this.__zoom,ye=Ne(ee.changedTouches?ee.changedTouches[0]:ee,this),We=ue.invert(ye),Ze=ue.k*(ee.shiftKey?.5:2),Ae=r(oe(Y(ue,Ze),ye,We),e.apply(this,_e),c);vt(ee),u>0?we(this).transition().duration(u).call(q,Ae,ye,ee):we(this).call($.transform,Ae,ye,ee)}}function re(ee,..._e){if(n.apply(this,arguments)){var ue=ee.touches,ye=ue.length,We=ne(this,_e,ee.changedTouches.length===ye).event(ee),Ze,Ae,Bt,Ge;for($n(ee),Ae=0;Ae<ye;++Ae)Bt=ue[Ae],Ge=Ne(Bt,this),Ge=[Ge,this.__zoom.invert(Ge),Bt.identifier],We.touch0?!We.touch1&&We.touch0[2]!==Ge[2]&&(We.touch1=Ge,We.taps=0):(We.touch0=Ge,Ze=!0,We.taps=1+!!g);g&&(g=clearTimeout(g)),Ze&&(We.taps<2&&(m=Ge[0],g=setTimeout(function(){g=null},b)),Lt(this),We.start())}}function He(ee,..._e){if(this.__zooming){var ue=ne(this,_e).event(ee),ye=ee.changedTouches,We=ye.length,Ze,Ae,Bt,Ge;for(vt(ee),Ze=0;Ze<We;++Ze)Ae=ye[Ze],Bt=Ne(Ae,this),ue.touch0&&ue.touch0[2]===Ae.identifier?ue.touch0[0]=Bt:ue.touch1&&ue.touch1[2]===Ae.identifier&&(ue.touch1[0]=Bt);if(Ae=ue.that.__zoom,ue.touch1){var Dn=ue.touch0[0],An=ue.touch0[1],fe=ue.touch1[0],le=ue.touch1[1],H=(H=fe[0]-Dn[0])*H+(H=fe[1]-Dn[1])*H,J=(J=le[0]-An[0])*J+(J=le[1]-An[1])*J;Ae=Y(Ae,Math.sqrt(H/J)),Bt=[(Dn[0]+fe[0])/2,(Dn[1]+fe[1])/2],Ge=[(An[0]+le[0])/2,(An[1]+le[1])/2]}else if(ue.touch0)Bt=ue.touch0[0],Ge=ue.touch0[1];else return;ue.zoom("touch",r(oe(Ae,Bt,Ge),ue.extent,c))}}function st(ee,..._e){if(this.__zooming){var ue=ne(this,_e).event(ee),ye=ee.changedTouches,We=ye.length,Ze,Ae;for($n(ee),v&&clearTimeout(v),v=setTimeout(function(){v=null},b),Ze=0;Ze<We;++Ze)Ae=ye[Ze],ue.touch0&&ue.touch0[2]===Ae.identifier?delete ue.touch0:ue.touch1&&ue.touch1[2]===Ae.identifier&&delete ue.touch1;if(ue.touch1&&!ue.touch0&&(ue.touch0=ue.touch1,delete ue.touch1),ue.touch0)ue.touch0[1]=this.__zoom.invert(ue.touch0[0]);else if(ue.end(),ue.taps===2&&(Ae=Ne(Ae,this),Math.hypot(m[0]-Ae[0],m[1]-Ae[1])<I)){var Bt=we(this).on("dblclick.zoom");Bt&&Bt.apply(this,arguments)}}}return $.wheelDelta=function(ee){return arguments.length?(o=typeof ee=="function"?ee:zt(+ee),$):o},$.filter=function(ee){return arguments.length?(n=typeof ee=="function"?ee:zt(!!ee),$):n},$.touchable=function(ee){return arguments.length?(s=typeof ee=="function"?ee:zt(!!ee),$):s},$.extent=function(ee){return arguments.length?(e=typeof ee=="function"?ee:zt([[+ee[0][0],+ee[0][1]],[+ee[1][0],+ee[1][1]]]),$):e},$.scaleExtent=function(ee){return arguments.length?(l[0]=+ee[0],l[1]=+ee[1],$):[l[0],l[1]]},$.translateExtent=function(ee){return arguments.length?(c[0][0]=+ee[0][0],c[1][0]=+ee[1][0],c[0][1]=+ee[0][1],c[1][1]=+ee[1][1],$):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},$.constrain=function(ee){return arguments.length?(r=ee,$):r},$.duration=function(ee){return arguments.length?(u=+ee,$):u},$.interpolate=function(ee){return arguments.length?(f=ee,$):f},$.on=function(){var ee=d.on.apply(d,arguments);return ee===d?$:ee},$.clickDistance=function(ee){return arguments.length?(R=(ee=+ee)*ee,$):Math.sqrt(R)},$.tapDistance=function(ee){return arguments.length?(I=+ee,$):I},$}const kn=.1;function Fe(){}const Qc={zoomIn:Fe,zoomOut:Fe,zoomTo:Fe,fitView:Fe,setCenter:Fe,fitBounds:Fe,project:n=>n,setTransform:Fe,getTransform:()=>({x:0,y:0,zoom:1}),initialized:!1},Jc=(n,e)=>{const r=n,o=toRef(r,"nodes"),s=toRef(r,"d3Zoom"),l=toRef(r,"d3Selection"),c=toRef(r,"dimensions"),u=toRef(r,"translateExtent"),f=toRef(r,"minZoom"),d=toRef(r,"maxZoom"),g=toRef(r,"viewport"),m=toRef(r,"snapToGrid"),v=toRef(r,"snapGrid"),b=toRef(r,"hooks"),k=e,R=toRef(k,"getNodes"),I=ref(!1);b.value.nodesInitialized.on(()=>{I.value=!0});const $=computed(()=>!!s.value&&!!l.value&&!!c.value.width&&!!c.value.height&&I.value);function Y(G,q){l.value&&s.value&&s.value.scaleBy(On(l.value,q),G)}function oe(G,q,ne,K){const{x:qe,y:ge}=ro({x:-G,y:-q},u.value),Z=ht.translate(-qe,-ge).scale(ne);l.value&&s.value&&s.value.transform(On(l.value,K),Z)}return computed(()=>$.value?{initialized:!0,zoomIn:G=>{Y(1.2,G==null?void 0:G.duration)},zoomOut:G=>{Y(1/1.2,G==null?void 0:G.duration)},zoomTo:(G,q)=>{l.value&&s.value&&s.value.scaleTo(On(l.value,q==null?void 0:q.duration),G)},setTransform:(G,q)=>{oe(G.x,G.y,G.zoom,q==null?void 0:q.duration)},getTransform:()=>({x:g.value.x,y:g.value.y,zoom:g.value.zoom}),fitView:(G={padding:kn,includeHiddenNodes:!1,duration:0})=>{if(!o.value.length)return;const q=(G.includeHiddenNodes?o.value:R.value).filter(Z=>{var re;const He=Z.initialized&&Z.dimensions.width&&Z.dimensions.height;let st=!0;return(re=G.nodes)!=null&&re.length&&(st=G.nodes.includes(Z.id)),He&&st}),ne=lo(q),{x:K,y:qe,zoom:ge}=Yt(ne,c.value.width,c.value.height,G.minZoom??f.value,G.maxZoom??d.value,G.padding??kn,G.offset);oe(K,qe,ge,G==null?void 0:G.duration)},setCenter:(G,q,ne)=>{const K=typeof(ne==null?void 0:ne.zoom)<"u"?ne.zoom:d.value,qe=c.value.width/2-G*K,ge=c.value.height/2-q*K;oe(qe,ge,K,ne==null?void 0:ne.duration)},fitBounds:(G,q={padding:kn})=>{const{x:ne,y:K,zoom:qe}=Yt(G,c.value.width,c.value.height,f.value,d.value,q.padding);oe(ne,K,qe,q==null?void 0:q.duration)},project:G=>so(G,g.value,m.value,v.value)}:Qc)};function On(n,e=0){return n.transition().duration(e)}function In(n,e){if(e){const r=n.position.x+n.dimensions.width-e.dimensions.width,o=n.position.y+n.dimensions.height-e.dimensions.height;if(r>0||o>0||n.position.x<0||n.position.y<0){let s={};if(ze(e.style)?s={...e.style(e)}:e.style&&(s={...e.style}),s.width=s.width??`${e.dimensions.width}px`,s.height=s.height??`${e.dimensions.height}px`,r>0)if(Pe(s.width)){const l=Number(s.width.replace("px",""));s.width=`${l+r}px`}else s.width+=r;if(o>0)if(Pe(s.height)){const l=Number(s.height.replace("px",""));s.height=`${l+o}px`}else s.height+=o;if(n.position.x<0){const l=Math.abs(n.position.x);if(e.position.x=e.position.x-l,Pe(s.width)){const c=Number(s.width.replace("px",""));s.width=`${c+l}px`}else s.width+=l;n.position.x=0}if(n.position.y<0){const l=Math.abs(n.position.y);if(e.position.y=e.position.y-l,Pe(s.height)){const c=Number(s.height.replace("px",""));s.height=`${c+l}px`}else s.height+=l;n.position.y=0}e.dimensions.width=Number(s.width.toString().replace("px","")),e.dimensions.height=Number(s.height.toString().replace("px","")),ze(e.style)?e.style=l=>{const c=e.style;return{...c(l),...s}}:e.style={...e.style,...s}}}}function en(n,e){n.filter(o=>o.type==="add"||o.type==="remove").forEach(o=>{if(o.type==="add")e.findIndex(s=>s.id===o.item.id)===-1&&e.push(o.item);else if(o.type==="remove"){const s=e.findIndex(l=>l.id===o.id);s!==-1&&e.splice(s,1)}});const r=e.map(o=>o.id);return e.forEach(o=>{var s,l;const c=n.filter(u=>u.id===o.id);for(const u of c)switch(u.type){case"select":o.selected=u.selected;break;case"position":if(et(o)&&(typeof u.position<"u"&&(o.position=u.position),typeof u.dragging<"u"&&(o.dragging=u.dragging),o.expandParent&&o.parentNode)){const f=e[r.indexOf(o.parentNode)];f&&et(f)&&In(o,f)}break;case"dimensions":if(et(o)){if(typeof u.dimensions<"u"&&(o.dimensions=u.dimensions),typeof u.updateStyle<"u"&&(o.style={...o.style||{},width:`${(s=u.dimensions)==null?void 0:s.width}px`,height:`${(l=u.dimensions)==null?void 0:l.height}px`}),typeof u.resizing<"u"&&(o.resizing=u.resizing),o.expandParent&&o.parentNode){const f=e[r.indexOf(o.parentNode)];f&&et(f)&&(f.initialized?In(o,f):nextTick(()=>{In(o,f)}))}o.initialized||(o.initialized=!0)}break}}),e}function Ie(n,e){return{id:n,type:"select",selected:e}}function li(n){return{item:n,type:"add"}}function Tn(n){return{id:n,type:"remove"}}function Pn(n,e){return n.reduce((r,o)=>{let s=e.includes(o.id);de(o.selectable)&&!o.selectable&&(s=!1);const l=et(o)?"changedNodes":"changedEdges";return!o.selected&&s?r[l].push(Ie(o.id,!0)):o.selected&&!s&&r[l].push(Ie(o.id,!1)),r},{changedNodes:[],changedEdges:[]})}function ed(n,e,r,o){let s=!1;const l=Jc(n,e),c=H=>{const J=H??r.value??[];n.hooks.updateNodeInternals.trigger(J)},u=H=>{if(H)return n.nodes&&!r.value.length?n.nodes.find(J=>J.id===H):n.nodes[r.value.indexOf(H)]},f=H=>{if(H)return n.edges&&!o.value.length?n.edges.find(J=>J.id===H):n.edges[o.value.indexOf(H)]},d=(H,J,Ce)=>{const Ve=[];H.forEach(Le=>{var N,_;const te={id:Le.id,type:"position",dragging:Ce,from:Le.from};if(J&&(te.position=Le.position,Le.parentNode)){const ae=u(Le.parentNode);te.position={x:te.position.x-(((N=ae==null?void 0:ae.computedPosition)==null?void 0:N.x)??0),y:te.position.y-(((_=ae==null?void 0:ae.computedPosition)==null?void 0:_.y)??0)}}Ve.push(te)}),Ve!=null&&Ve.length&&n.hooks.nodesChange.trigger(Ve)},g=H=>{var J;if(!n.vueFlowRef)return;const Ce=n.vueFlowRef.querySelector(".vue-flow__transformationpane");if(!Ce)return;let Ve;if((J=n.__experimentalFeatures)!=null&&J.nestedFlow){let N=[Ce],_=Ce,te;for(;!te&&_;)_=_.parentElement,te=_==null?void 0:_.classList.contains("vue-flow__transformationpane"),te&&(N=[_,...N]);N.forEach(ae=>{const Ee=window.getComputedStyle(ae),{m22:lt}=new window.DOMMatrixReadOnly(Ee.transform);Ve?Ve*=lt:Ve=lt})}else{const N=window.getComputedStyle(Ce),{m22:_}=new window.DOMMatrixReadOnly(N.transform);Ve=_}const Le=H.reduce((N,_)=>{const te=u(_.id);if(te){const ae=nn(_.nodeElement);ae.width&&ae.height&&(te.dimensions.width!==ae.width||te.dimensions.height!==ae.height||_.forceUpdate)&&(te.handleBounds.source=Ro(".source",_.nodeElement,Ve),te.handleBounds.target=Ro(".target",_.nodeElement,Ve),te.dimensions=ae,te.initialized=!0,N.push({id:te.id,type:"dimensions",dimensions:ae}))}return N},[]);n.fitViewOnInit&&!s&&(pe(()=>l.value.initialized).toBe(!0).then(()=>{l.value.fitView()}),s=!0),Le.length&&n.hooks.nodesChange.trigger(Le)},m=(H,J)=>{const Ce=H.map(N=>N.id);let Ve,Le=[];if(n.multiSelectionActive)Ve=Ce.map(N=>Ie(N,J));else{const N=Pn([...n.nodes,...n.edges],Ce);Ve=N.changedNodes,Le=N.changedEdges}Ve.length&&n.hooks.nodesChange.trigger(Ve),Le.length&&n.hooks.edgesChange.trigger(Le)},v=(H,J)=>{const Ce=H.map(N=>N.id);let Ve=[],Le;if(n.multiSelectionActive)Le=Ce.map(N=>Ie(N,J));else{const N=Pn([...n.nodes,...n.edges],Ce);Ve=N.changedNodes,Le=N.changedEdges}Ve.length&&n.hooks.nodesChange.trigger(Ve),Le.length&&n.hooks.edgesChange.trigger(Le)},b=(H,J)=>{const Ce=H.filter(xt).map(_=>_.id),Ve=H.filter($e).map(_=>_.id);let{changedNodes:Le,changedEdges:N}=Pn([...n.nodes,...n.edges],[...Ce,...Ve]);n.multiSelectionActive&&(Le=Ce.map(_=>Ie(_,J)),N=Ve.map(_=>Ie(_,J))),Le.length&&n.hooks.nodesChange.trigger(Le),N.length&&n.hooks.edgesChange.trigger(N)},k=H=>{m(H,!0)},R=H=>{v(H,!0)},I=H=>{b(H,!0)},$=H=>{if(!H.length)return m(H,!1);const J=H.map(Ce=>Ce.id).map(Ce=>Ie(Ce,!1));J.length&&n.hooks.nodesChange.trigger(J)},Y=H=>{if(!H.length)return v(H,!1);const J=H.map(Ce=>Ce.id).map(Ce=>Ie(Ce,!1));J.length&&n.hooks.edgesChange.trigger(J)},oe=H=>{if(!H||!H.length)return b([],!1);const{changedNodes:J,changedEdges:Ce}=H.reduce((Ve,Le)=>{const N=Ie(Le.id,!1);return xt(Le)?Ve.changedNodes.push(N):Ve.changedEdges.push(N),Ve},{changedNodes:[],changedEdges:[]});J.length&&n.hooks.nodesChange.trigger(J),Ce.length&&n.hooks.edgesChange.trigger(Ce)},G=H=>{var J;(J=n.d3Zoom)==null||J.scaleExtent([H,n.maxZoom]),n.minZoom=H},q=H=>{var J;(J=n.d3Zoom)==null||J.scaleExtent([n.minZoom,H]),n.maxZoom=H},ne=H=>{var J;(J=n.d3Zoom)==null||J.translateExtent(H),n.translateExtent=H},K=H=>{n.nodeExtent=H,c(r.value)},qe=H=>{n.nodesDraggable=H,n.nodesConnectable=H,n.elementsSelectable=H},ge=H=>{const J=H instanceof Function?H(n.nodes):H;!n.initialized&&!J.length||(n.nodes=Io(J,n.nodes,u,n.hooks.error.trigger))},Z=H=>{const J=H instanceof Function?H(n.edges):H;if(!n.initialized&&!J.length)return;const Ce=n.isValidConnection?J.filter(Ve=>n.isValidConnection(Ve,{edges:n.edges,sourceNode:u(Ve.source),targetNode:u(Ve.target)})):J;n.edges=Ce.reduce((Ve,Le)=>{const N=u(Le.source),_=u(Le.target),te=!N||typeof N>"u",ae=!_||typeof _>"u";if(te&&ae?n.hooks.error.trigger(new ve(he.EDGE_SOURCE_TARGET_MISSING,Le.id,Le.source,Le.target)):(te&&n.hooks.error.trigger(new ve(he.EDGE_SOURCE_MISSING,Le.id,Le.source)),ae&&n.hooks.error.trigger(new ve(he.EDGE_TARGET_MISSING,Le.id,Le.target))),te||ae)return Ve;const Ee=f(Le.id);return Ve.push({...ao(Le,Object.assign({},Ee,n.defaultEdgeOptions)),sourceNode:N,targetNode:_}),Ve},[])},re=H=>{const J=H instanceof Function?H([...n.nodes,...n.edges]):H;!n.initialized&&!J.length||(ge(J.filter(xt)),Z(J.filter($e)))},He=H=>{const J=H instanceof Function?H(n.nodes):H,Ce=Io(J,n.nodes,u,n.hooks.error.trigger).map(li);Ce.length&&n.hooks.nodesChange.trigger(Ce)},st=H=>{const J=H instanceof Function?H(n.edges):H,Ce=(n.isValidConnection?J.filter(Ve=>n.isValidConnection(Ve,{edges:n.edges,sourceNode:u(Ve.source),targetNode:u(Ve.target)})):J).reduce((Ve,Le)=>{const N=ga({...Le,...n.defaultEdgeOptions},n.edges,n.hooks.error.trigger);if(N){const _=u(N.source),te=u(N.target),ae=!_||typeof _>"u",Ee=!te||typeof te>"u";if(ae&&Ee?n.hooks.error.trigger(new ve(he.EDGE_SOURCE_TARGET_MISSING,N.id,N.source,N.target)):(ae&&n.hooks.error.trigger(new ve(he.EDGE_SOURCE_MISSING,N.id,N.source)),Ee&&n.hooks.error.trigger(new ve(he.EDGE_TARGET_MISSING,N.id,N.target))),ae||Ee)return Ve;Ve.push(li({...N,sourceNode:_,targetNode:te}))}return Ve},[]);Ce.length&&n.hooks.edgesChange.trigger(Ce)},ee=(H,J=!0)=>{const Ce=H instanceof Function?H(n.nodes):H,Ve=[],Le=[];Ce.forEach(N=>{const _=typeof N=="string"?u(N):N;if(!(de(_.deletable)&&!_.deletable)&&(Ve.push(Tn(_.id)),J)){const te=rn([_],n.edges).filter(ae=>de(ae.deletable)?ae.deletable:!0);Le.push(...te.map(ae=>Tn(ae.id)))}}),Le.length&&n.hooks.edgesChange.trigger(Le),Ve.length&&n.hooks.nodesChange.trigger(Ve)},_e=H=>{const J=H instanceof Function?H(n.edges):H,Ce=[];J.forEach(Ve=>{const Le=typeof Ve=="string"?f(Ve):Ve;de(Le.deletable)&&!Le.deletable||Ce.push(Tn(typeof Ve=="string"?Ve:Ve.id))}),n.hooks.edgesChange.trigger(Ce)},ue=(H,J,Ce=!0)=>va(H,J,n.edges,f,Ce,n.hooks.error.trigger),ye=H=>en(H,n.nodes),We=H=>en(H,n.edges),Ze=(H,J,Ce,Ve=!1)=>{Ve?n.connectionClickStartHandle=H:n.connectionStartHandle=H,n.connectionEndHandle=null,n.connectionStatus=null,J&&(n.connectionPosition=J)},Ae=(H,J=null,Ce=null)=>{n.connectionStartHandle&&(n.connectionPosition=H,n.connectionEndHandle=J,n.connectionStatus=Ce)},Bt=(H,J)=>{n.connectionPosition={x:NaN,y:NaN},n.connectionStatus=null,J?n.connectionClickStartHandle=null:n.connectionStartHandle=null},Ge=H=>{const J=ca(H),Ce=J?null:u(H.id);return!J&&!Ce?[null,null,J]:[J?H:ko(Ce),Ce,J]},Dn=(H,J=!0,Ce)=>{const[Ve,Le,N]=Ge(H);return Ve?(Ce||n.nodes).filter(_=>{if(!N&&(_.id===Le.id||!_.computedPosition))return!1;const te=ko(_),ae=Ln(te,Ve);return J&&ae>0||ae>=Number(H.width)*Number(H.height)}):[]},An=(H,J,Ce=!0)=>{const[Ve]=Ge(H);if(!Ve)return!1;const Le=Ln(Ve,J);return Ce&&Le>0||Le>=Number(H.width)*Number(H.height)},fe=(H,J)=>{const{viewport:Ce,dimensions:Ve,d3Zoom:Le,d3Selection:N,translateExtent:_}=n;if(!Le||!N||!H.x&&!H.y)return;const te=ht.translate(Ce.x+H.x,Ce.y+H.y).scale(Ce.zoom),ae=[[0,0],[Ve.width,Ve.height]],Ee=Le.constrain()(te,ae,_);J==null||J(Ee),Le.transform(N,Ee)},le=H=>{const J=H instanceof Function?H(n):H,Ce=["modelValue","nodes","edges","maxZoom","minZoom","translateExtent","nodeExtent","hooks"],Ve=J.modelValue||J.nodes||J.edges?[]:void 0;Ve&&(J.modelValue&&Ve.push(...J.modelValue),J.nodes&&Ve.push(...J.nodes),J.edges&&Ve.push(...J.edges),re(Ve));const Le=()=>{typeof J.maxZoom<"u"&&q(J.maxZoom),typeof J.minZoom<"u"&&G(J.minZoom),typeof J.translateExtent<"u"&&ne(J.translateExtent),typeof J.nodeExtent<"u"&&K(J.nodeExtent)};Object.keys(J).forEach(N=>{const _=J[N];!Ce.includes(N)&&de(_)&&(n[N]=_)}),n.d3Zoom?Le():pe(()=>n.d3Zoom).not.toBeUndefined().then(Le),n.initialized||(n.initialized=!0)};return{updateNodePositions:d,updateNodeDimensions:g,setElements:re,setNodes:ge,setEdges:Z,addNodes:He,addEdges:st,removeNodes:ee,removeEdges:_e,findNode:u,findEdge:f,updateEdge:ue,applyEdgeChanges:We,applyNodeChanges:ye,addSelectedElements:I,addSelectedNodes:k,addSelectedEdges:R,setMinZoom:G,setMaxZoom:q,setTranslateExtent:ne,setNodeExtent:K,removeSelectedElements:oe,removeSelectedNodes:$,removeSelectedEdges:Y,startConnection:Ze,updateConnection:Ae,endConnection:Bt,setInteractive:qe,setState:le,getIntersectingNodes:Dn,isNodeIntersecting:An,panBy:fe,fitView:async(H={padding:.1})=>{await pe(()=>l.value.initialized).toBe(!0),l.value.fitView(H)},zoomIn:async H=>{await pe(()=>l.value.initialized).toBe(!0),l.value.zoomIn(H)},zoomOut:async H=>{await pe(()=>l.value.initialized).toBe(!0),l.value.zoomOut(H)},zoomTo:async(H,J)=>{await pe(()=>l.value.initialized).toBe(!0),l.value.zoomTo(H,J)},setTransform:async(H,J)=>{await pe(()=>l.value.initialized).toBe(!0),l.value.setTransform(H,J)},getTransform:()=>l.value.getTransform(),setCenter:async(H,J,Ce)=>{await pe(()=>l.value.initialized).toBe(!0),l.value.setCenter(H,J,Ce)},fitBounds:async(H,J)=>{await pe(()=>l.value.initialized).toBe(!0),l.value.fitBounds(H,J)},project:H=>l.value.project(H),toObject:()=>JSON.parse(JSON.stringify({nodes:n.nodes.map(H=>{const{computedPosition:J,handleBounds:Ce,selected:Ve,dimensions:Le,isParent:N,resizing:_,dragging:te,initialized:ae,...Ee}=H;return Ee}),edges:n.edges.map(H=>{const{selected:J,sourceNode:Ce,targetNode:Ve,...Le}=H;return Le}),position:[n.viewport.x,n.viewport.y],zoom:n.viewport.zoom})),updateNodeInternals:c,$reset:()=>{n.edges=[],n.nodes=[],le(or())},$destroy:()=>{}}}class tt{constructor(){this.currentId=0,this.flows=new Map}static getInstance(){return tt.instance||(tt.instance=new tt),tt.instance}set(e,r){return this.flows.set(e,r)}get(e){return this.flows.get(e)}remove(e){return this.flows.delete(e)}create(e,r){const o=or(r),s=reactive(o),l=computed(()=>s.nodes.map(v=>v.id)),c=computed(()=>s.edges.map(v=>v.id)),u=su(s,l,c),f=ed(s,u,l,c),d={};Object.entries(s.hooks).forEach(([v,b])=>{const k=`on${v.charAt(0).toUpperCase()+v.slice(1)}`;d[k]=b.on});const g={};Object.entries(s.hooks).forEach(([v,b])=>{g[v]=b.trigger}),f.setState(s);const m={...d,...u,...f,...toRefs(s),emits:g,id:e,$destroy:()=>{this.remove(e)}};return this.set(e,m),m}getId(){return`vue-flow-${this.currentId++}`}}const ce=n=>{const e=tt.getInstance(),r=getCurrentScope(),o=n==null?void 0:n.id,s=(r==null?void 0:r.vueFlowId)||o;let l,c=!1;if(r){const u=inject(To,null);typeof u<"u"&&u!==null&&(l=u)}if(l||s&&(l=e.get(s)),!l||l&&o&&o!==l.id){const u=o??e.getId();l=e.create(u,n),r&&(c=!0)}else n&&l.setState(n);return r&&(provide(To,l),r.vueFlowId=l.id,c&&Mt(()=>{if(l){const u=e.get(l.id);u?u.$destroy():wt(`No store instance found for id ${l.id} in storage.`)}})),l};function td(n,e,r){const o=effectScope();return o.run(()=>{[()=>{o.run(()=>{let s,l,c=!!(r.nodes.value.length||r.edges.value.length);s=Je([n.modelValue,()=>{var u,f;return(f=(u=n.modelValue)==null?void 0:u.value)==null?void 0:f.length}],([u])=>{u&&Array.isArray(u)&&(l==null||l.pause(),r.setElements(u),!l&&!c&&u.length?c=!0:l==null||l.resume())}),l=Je([r.nodes,r.edges,()=>r.edges.value.length,()=>r.nodes.value.length],([u,f])=>{var d;(d=n.modelValue)!=null&&d.value&&Array.isArray(n.modelValue.value)&&(s==null||s.pause(),n.modelValue.value=[...u,...f],nextTick(()=>{s==null||s.resume()}))},{immediate:c}),onScopeDispose(()=>{s==null||s.stop(),l==null||l.stop()})})},()=>{o.run(()=>{let s,l,c=!!r.nodes.value.length;s=Je([n.nodes,()=>{var u,f;return(f=(u=n.nodes)==null?void 0:u.value)==null?void 0:f.length}],([u])=>{u&&Array.isArray(u)&&(l==null||l.pause(),r.setNodes(u),!l&&!c&&u.length?c=!0:l==null||l.resume())}),l=Je([r.nodes,()=>r.nodes.value.length],([u])=>{var f;(f=n.nodes)!=null&&f.value&&Array.isArray(n.nodes.value)&&(s==null||s.pause(),n.nodes.value=[...u],nextTick(()=>{s==null||s.resume()}))},{immediate:c}),onScopeDispose(()=>{s==null||s.stop(),l==null||l.stop()})})},()=>{o.run(()=>{let s,l,c=!!r.edges.value.length;s=Je([n.edges,()=>{var u,f;return(f=(u=n.edges)==null?void 0:u.value)==null?void 0:f.length}],([u])=>{u&&Array.isArray(u)&&(l==null||l.pause(),r.setEdges(u),!l&&!c&&u.length?c=!0:l==null||l.resume())}),l=Je([r.edges,()=>r.edges.value.length],([u])=>{var f;(f=n.edges)!=null&&f.value&&Array.isArray(n.edges.value)&&(s==null||s.pause(),n.edges.value=[...u],nextTick(()=>{s==null||s.resume()}))},{immediate:c}),onScopeDispose(()=>{s==null||s.stop(),l==null||l.stop()})})},()=>{o.run(()=>{watch(()=>e.minZoom,()=>{e.minZoom&&de(e.minZoom)&&r.setMinZoom(e.minZoom)})})},()=>{o.run(()=>{watch(()=>e.maxZoom,()=>{e.maxZoom&&de(e.maxZoom)&&r.setMaxZoom(e.maxZoom)})})},()=>{o.run(()=>{watch(()=>e.translateExtent,()=>{e.translateExtent&&de(e.translateExtent)&&r.setTranslateExtent(e.translateExtent)})})},()=>{o.run(()=>{watch(()=>e.nodeExtent,()=>{e.nodeExtent&&de(e.nodeExtent)&&r.setNodeExtent(e.nodeExtent)})})},()=>{o.run(()=>{watch(()=>e.applyDefault,()=>{de(e.applyDefault)&&(r.applyDefault.value=e.applyDefault)}),watch(r.applyDefault,(s,l,c)=>{r.applyDefault.value?(r.onNodesChange(r.applyNodeChanges),r.onEdgesChange(r.applyEdgeChanges)):(r.hooks.value.nodesChange.off(r.applyNodeChanges),r.hooks.value.edgesChange.off(r.applyEdgeChanges)),c(()=>{r.hooks.value.nodesChange.off(r.applyNodeChanges),r.hooks.value.edgesChange.off(r.applyEdgeChanges)})},{immediate:!0})})},()=>{o.run(()=>{const s=async l=>{let c=l;ze(e.autoConnect)&&(c=await e.autoConnect(l)),c!==!1&&r.addEdges([c])};watch(()=>e.autoConnect,()=>{de(e.autoConnect)&&(r.autoConnect.value=e.autoConnect)}),watch(r.autoConnect,(l,c,u)=>{l?r.onConnect(s):r.hooks.value.connect.off(s),u(()=>{r.hooks.value.connect.off(s)})},{immediate:!0})})},()=>{const s=["id","modelValue","translateExtent","nodeExtent","edges","nodes","maxZoom","minZoom","applyDefault","autoConnect"];Object.keys(e).forEach(l=>{if(!s.includes(l)){const c=toRef(e,l),u=r[l];o.run(()=>{watch(c,f=>{de(f)&&(u.value=f)},{flush:"pre"})})}})}].forEach(s=>s())}),()=>o.stop()}function ui(n,e){return{x:n.clientX-e.left,y:n.clientY-e.top}}const nd={name:"Pane",compatConfig:{MODE:3}},od=defineComponent({...nd,props:{isSelecting:{type:Boolean}},setup(n){const{id:e,vueFlowRef:r,getNodes:o,getEdges:s,viewport:l,emits:c,userSelectionActive:u,removeSelectedElements:f,panOnDrag:d,userSelectionRect:g,elementsSelectable:m,nodesSelectionActive:v,addSelectedElements:b,getSelectedEdges:k,getSelectedNodes:R,removeNodes:I,removeEdges:$,selectionMode:Y,deleteKeyCode:oe,multiSelectionKeyCode:G,multiSelectionActive:q}=ce(),ne=ref(null),K=ref(0),qe=ref(0),ge=ref(),Z=computed(()=>m.value&&(n.isSelecting||u.value));_t(oe,Ae=>{if(!Ae)return;const Bt=o.value.reduce((Ge,Dn)=>((!Dn.selected&&Dn.parentNode&&Ge.find(An=>An.id===Dn.parentNode)||Dn.selected)&&Ge.push(Dn),Ge),[]);(Bt||k.value)&&(k.value.length>0&&$(k.value),Bt.length>0&&I(Bt),v.value=!1,f())}),_t(G,Ae=>{q.value=Ae});function re(){u.value=!1,g.value=null,K.value=0,qe.value=0}function He(Ae){Ae.target!==ne.value||Z.value||(c.paneClick(Ae),f(),v.value=!1)}function st(Ae){var Bt;if(Ae.target===ne.value){if(Array.isArray(d.value)&&(Bt=d.value)!=null&&Bt.includes(2)){Ae.preventDefault();return}c.paneContextMenu(Ae)}}function ee(Ae){Ae.target===ne.value&&c.paneScroll(Ae)}function _e(Ae){if(ge.value=r.value.getBoundingClientRect(),!Z.value||!m||!n.isSelecting||Ae.button!==0||Ae.target!==ne.value||!ge.value)return;const{x:Bt,y:Ge}=ui(Ae,ge.value);f(),g.value={width:0,height:0,startX:Bt,startY:Ge,x:Bt,y:Ge},u.value=!0,c.selectionStart(Ae)}function ue(Ae){if(!n.isSelecting||!ge.value||!g.value)return;if(!Z.value)return c.paneMouseMove(Ae);u.value||(u.value=!0),v.value&&(v.value=!1);const Bt=ui(Ae,ge.value),Ge=g.value.startX??0,Dn=g.value.startY??0,An={...g.value,x:Bt.x<Ge?Bt.x:Ge,y:Bt.y<Dn?Bt.y:Dn,width:Math.abs(Bt.x-Ge),height:Math.abs(Bt.y-Dn)},fe=Ei(o.value,g.value,l.value,Y.value===uo.Partial),le=rn(fe,s.value);K.value=fe.length,qe.value=le.length,g.value=An,b([...fe,...le])}function ye(Ae){Z.value&&Ae.button===0&&(!u.value&&g.value&&Ae.target===ne.value&&He(Ae),v.value=K.value>0,re(),c.selectionEnd(Ae))}function We(Ae){var Bt;if(!Z.value)return c.paneMouseLeave(Ae);u.value&&(v.value=K.value>0,(Bt=c.selectionEnd)==null||Bt.call(c,Ae)),re()}function Ze(Ae){Z.value||c.paneMouseEnter(Ae)}return(Ae,Bt)=>(openBlock(),createElementBlock("div",{ref_key:"container",ref:ne,key:`pane-${unref(e)}`,class:normalizeClass(["vue-flow__pane vue-flow__container",{selection:n.isSelecting}]),onClick:He,onContextmenu:st,onWheelPassive:ee,onMouseenter:Ze,onMousedown:_e,onMousemove:ue,onMouseup:ye,onMouseleave:We},[renderSlot(Ae.$slots,"default"),unref(u)&&unref(g)?(openBlock(),createBlock(ou,{key:0})):createCommentVNode("",!0),unref(v)&&unref(R).length?(openBlock(),createBlock(tu,{key:1})):createCommentVNode("",!0)],34))}}),id={class:"vue-flow__nodes vue-flow__container"},rd={name:"Nodes",compatConfig:{MODE:3}},ad=defineComponent({...rd,setup(n){const e=inject(an),r=ce(),o=toRef(r,"nodesDraggable"),s=toRef(r,"nodesFocusable"),l=toRef(r,"elementsSelectable"),c=toRef(r,"nodesConnectable"),u=toRef(r,"getNodes"),f=toRef(r,"getNodesInitialized"),d=toRef(r,"getNodeTypes"),g=toRef(r,"updateNodeDimensions"),m=toRef(r,"emits");let v=ref();pe(()=>u.value.length>0&&f.value.length===u.value.length).toBe(!0).then(()=>{nextTick(()=>{m.value.nodesInitialized(f.value)})}),onMounted(()=>{v.value=new ResizeObserver(Y=>{const oe=Y.map(G=>({id:G.target.getAttribute("data-id"),nodeElement:G.target,forceUpdate:!0}));g.value(oe)})}),onBeforeUnmount(()=>{var Y;return(Y=v.value)==null?void 0:Y.disconnect()});function b(Y){return typeof Y>"u"?o.value:Y}function k(Y){return typeof Y>"u"?l.value:Y}function R(Y){return typeof Y>"u"?c.value:Y}function I(Y){return typeof Y>"u"?s.value:Y}function $(Y,oe){const G=Y||"default";let q=oe??d.value[G];const ne=getCurrentInstance();if(typeof q=="string"&&ne){const qe=Object.keys(ne.appContext.components);qe&&qe.includes(G)&&(q=resolveComponent(G,!1))}return typeof q!="string"?q:(e==null?void 0:e[`node-${G}`])||(m.value.error(new ve(he.NODE_TYPE_MISSING,q)),!1)}return(Y,oe)=>(openBlock(),createElementBlock("div",id,[unref(v)?(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(unref(u),G=>(openBlock(),createBlock(unref($l),{id:G.id,key:G.id,"resize-observer":unref(v),type:$(G.type,G.template),name:G.type||"default",draggable:b(G.draggable),selectable:k(G.selectable),connectable:R(G.connectable),focusable:I(G.focusable),node:G},null,8,["id","resize-observer","type","name","draggable","selectable","connectable","focusable","node"]))),128)):createCommentVNode("",!0)]))}}),sd=["id","markerWidth","markerHeight","markerUnits","orient"],ld=["stroke","stroke-width","fill"],ud=["stroke","stroke-width"],cd={name:"MarkerType",compatConfig:{MODE:3}},dd=defineComponent({...cd,props:{id:null,type:null,color:{default:"none"},width:{default:12.5},height:{default:12.5},markerUnits:{default:"strokeWidth"},orient:{default:"auto-start-reverse"},strokeWidth:{default:1}},setup(n){return(e,r)=>(openBlock(),createElementBlock("marker",{id:n.id,class:"vue-flow__arrowhead",viewBox:"-10 -10 20 20",refX:"0",refY:"0",markerWidth:`${n.width}`,markerHeight:`${n.height}`,markerUnits:n.markerUnits,orient:n.orient},[n.type===unref(Fn).ArrowClosed?(openBlock(),createElementBlock("polyline",{key:0,stroke:n.color,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":n.strokeWidth,fill:n.color,points:"-5,-4 0,0 -5,4 -5,-4"},null,8,ld)):createCommentVNode("",!0),n.type===unref(Fn).Arrow?(openBlock(),createElementBlock("polyline",{key:1,stroke:n.color,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":n.strokeWidth,fill:"none",points:"-5,-4 0,0 -5,4"},null,8,ud)):createCommentVNode("",!0)],8,sd))}}),fd={name:"MarkerDefinitions",compatConfig:{MODE:3}},hd=defineComponent({...fd,setup(n){const e=ce(),r=toRef(e,"id"),o=toRef(e,"edges"),s=toRef(e,"connectionLineOptions"),l=toRef(e,"defaultMarkerColor"),c=computed(()=>{const u=[],f=[],d=g=>{if(g){const m=Xe(g,r.value);u.includes(m)||(typeof g=="object"?f.push({...g,id:m,color:g.color||l.value}):f.push({id:m,color:l.value,type:g}),u.push(m))}};return[s.value.markerEnd,s.value.markerStart].forEach(d),o.value.reduce((g,m)=>([m.markerStart,m.markerEnd].forEach(d),g.sort((v,b)=>v.id.localeCompare(b.id))),f),f});return(u,f)=>(openBlock(),createElementBlock("defs",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(c),d=>(openBlock(),createBlock(dd,{id:d.id,key:d.id,type:d.type,color:d.color,width:d.width,height:d.height,markerUnits:d.markerUnits,"stroke-width":d.strokeWidth,orient:d.orient},null,8,["id","type","color","width","height","markerUnits","stroke-width","orient"]))),128))]))}}),gd={key:0,class:"vue-flow__edges vue-flow__connectionline vue-flow__container"},vd={name:"Edges",compatConfig:{MODE:3}},md=defineComponent({...vd,setup(n){const e=inject(an),r=ce(),o=toRef(r,"connectionStartHandle"),s=toRef(r,"nodesConnectable"),l=toRef(r,"edgesUpdatable"),c=toRef(r,"edgesFocusable"),u=toRef(r,"elementsSelectable"),f=toRef(r,"getSelectedNodes"),d=toRef(r,"findNode"),g=toRef(r,"getEdges"),m=toRef(r,"getNodesInitialized"),v=toRef(r,"getEdgeTypes"),b=toRef(r,"elevateEdgesOnSelect"),k=toRef(r,"dimensions"),R=toRef(r,"emits"),I=wn(()=>{var K;return(K=o.value)==null?void 0:K.nodeId},()=>{var K;return(K=o.value)!=null&&K.nodeId?d.value(o.value.nodeId):!1}),$=wn(()=>{var K;return(K=o.value)==null?void 0:K.nodeId},()=>{var K,qe;return!!(I.value&&(typeof I.value.connectable>"u"?s.value:I.value.connectable)&&(K=o.value)!=null&&K.nodeId&&(qe=o.value)!=null&&qe.type)}),Y=wn([()=>g.value.map(K=>K.zIndex),()=>b.value?[f.value.length]:[0],()=>b.value?m.value.map(K=>K.computedPosition.z):[]],()=>_a(g.value,d.value,b.value));function oe(K){return typeof K>"u"?u.value:K}function G(K){return typeof K>"u"?l.value:K}function q(K){return typeof K>"u"?c.value:K}function ne(K,qe){const ge=K||"default";let Z=qe??v.value[ge];const re=getCurrentInstance();if(typeof Z=="string"&&re){const st=Object.keys(re.appContext.components);st&&st.includes(ge)&&(Z=resolveComponent(ge,!1))}return Z&&typeof Z!="string"?Z:(e==null?void 0:e[`edge-${ge}`])||(R.value.error(new ve(he.EDGE_TYPE_MISSING,Z)),!1)}return(K,qe)=>unref(k).width&&unref(k).height?(openBlock(),createElementBlock(Fragment,{key:0},[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(Y),ge=>(openBlock(),createElementBlock("svg",{key:ge.level,class:"vue-flow__edges vue-flow__container",style:normalizeStyle(`z-index: ${ge.level}`)},[ge.isMaxLevel?(openBlock(),createBlock(hd,{key:0})):createCommentVNode("",!0),createBaseVNode("g",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(ge.edges,Z=>(openBlock(),createBlock(unref(Ul),{id:Z.id,key:Z.id,edge:Z,type:ne(Z.type,Z.template),name:Z.type||"default",selectable:oe(Z.selectable),updatable:G(Z.updatable),focusable:q(Z.focusable)},null,8,["id","edge","type","name","selectable","updatable","focusable"]))),128))])],4))),128)),unref($)&&unref(I)?(openBlock(),createElementBlock("svg",gd,[createVNode(Ql,{"source-node":unref(I)},null,8,["source-node"])])):createCommentVNode("",!0)],64)):createCommentVNode("",!0)}}),pd=createBaseVNode("div",{class:"vue-flow__edge-labels"},null,-1),yd={name:"Transform",compatConfig:{MODE:3}},xd=defineComponent({...yd,setup(n){const{id:e,viewport:r,emits:o,d3Zoom:s,d3Selection:l,dimensions:c,...u}=ce(),f=ref(!to);return pe(()=>s.value&&l.value&&c.value.width>0&&c.value.height>0).toBeTruthy().then(()=>{o.paneReady({id:e,viewport:r,emits:o,d3Zoom:s,d3Selection:l,dimensions:c,...u}),setTimeout(()=>{f.value=!0},0)}),(d,g)=>(openBlock(),createElementBlock("div",{key:`transform-${unref(e)}`,class:"vue-flow__transformationpane vue-flow__container",style:normalizeStyle({transform:`translate(${unref(r).x}px,${unref(r).y}px) scale(${unref(r).zoom})`,opacity:unref(f)?void 0:0})},[createVNode(md),pd,createVNode(ad),renderSlot(d.$slots,"default")],4))}}),_d={name:"Viewport",compatConfig:{MODE:3}},wd=defineComponent({..._d,setup(n){const e=ce(),r=toRef(e,"id"),o=toRef(e,"minZoom"),s=toRef(e,"maxZoom"),l=toRef(e,"defaultViewport"),c=toRef(e,"translateExtent"),u=toRef(e,"dimensions"),f=toRef(e,"zoomActivationKeyCode"),d=toRef(e,"selectionKeyCode"),g=toRef(e,"panActivationKeyCode"),m=toRef(e,"panOnScroll"),v=toRef(e,"panOnScrollMode"),b=toRef(e,"panOnScrollSpeed"),k=toRef(e,"panOnDrag"),R=toRef(e,"zoomOnDoubleClick"),I=toRef(e,"zoomOnPinch"),$=toRef(e,"zoomOnScroll"),Y=toRef(e,"preventScrolling"),oe=toRef(e,"noWheelClassName"),G=toRef(e,"noPanClassName"),q=toRef(e,"setState"),ne=toRef(e,"emits"),K=toRef(e,"connectionStartHandle"),qe=toRef(e,"userSelectionActive"),ge=toRef(e,"paneDragging"),Z=ref();let re=ref(!1),He=ref(!1),st=ref(!1),ee=ref(0);const _e=_t(g.value),ue=computed(()=>!re.value&&k.value&&_e.value),ye=computed(()=>d.value!==!0&&re.value||d.value===!0&&ue.value!==!0);let We=ref({x:0,y:0,zoom:0});onMounted(()=>{ea(Z,Ge);const An=io();oo(An,"resize",Ge)}),onMounted(()=>{const An=Z.value,fe=An.getBoundingClientRect(),le=jc().scaleExtent([o.value,s.value]).translateExtent(c.value),H=we(An).call(le),J=H.on("wheel.zoom"),Ce=ht.translate(l.value.x??0,l.value.y??0).scale(ct(l.value.zoom??1,o.value,s.value)),Ve=[[0,0],[fe.width,fe.height]],Le=le.constrain()(Ce,Ve,c.value);le.transform(H,Le),q.value({d3Zoom:le,d3Selection:H,d3ZoomHandler:J,viewport:{x:Le.x,y:Le.y,zoom:Le.k},viewportRef:An}),_t(d.value,_=>{re.value=_});const N=_t(f.value);watchEffect(()=>{re.value&&qe.value&&!He.value?le.on("zoom",null):!re.value&&!qe.value&&le.on("zoom",_=>{q.value({viewport:{x:_.transform.x,y:_.transform.y,zoom:_.transform.k}});const te=Bt(_.transform);st.value=Ze(k.value,ee.value??0),ne.value.viewportChange(te),ne.value.move({event:_,flowTransform:te})})}),le.on("start",_=>{var te;if(!_.sourceEvent)return null;ee.value=_.sourceEvent.button,He.value=!0;const ae=Bt(_.transform);((te=_.sourceEvent)==null?void 0:te.type)==="mousedown"&&q.value({paneDragging:!0}),We.value=ae,ne.value.viewportChangeStart(ae),ne.value.moveStart({event:_,flowTransform:ae})}),le.on("end",_=>{if(!_.sourceEvent)return null;if(He.value=!1,q.value({paneDragging:!1}),Ze(k.value,ee.value??0)&&!st.value&&ne.value.paneContextMenu(_.sourceEvent),st.value=!1,Ae(We.value,_.transform)){const te=Bt(_.transform);We.value=te,ne.value.viewportChangeEnd(te),ne.value.moveEnd({event:_,flowTransform:te})}}),watchEffect(()=>{m.value&&!N.value&&!qe.value?H.on("wheel.zoom",_=>{if(Dn(_,oe.value))return!1;_.preventDefault(),_.stopImmediatePropagation();const te=H.property("__zoom").k||1;if(_.ctrlKey&&I.value){const Bn=Ne(_),ut=-_.deltaY*(_.deltaMode===1?.05:_.deltaMode?1:.002)*10,tn=te*2**ut;le.scaleTo(H,tn,Bn);return}const ae=_.deltaMode===1?20:1,Ee=v.value===Xt.Vertical?0:_.deltaX*ae,lt=v.value===Xt.Horizontal?0:_.deltaY*ae;le.translateBy(H,-(Ee/te)*b.value,-(lt/te)*b.value)},{passive:!1}):typeof J<"u"&&H.on("wheel.zoom",function(_,te){if(!Y.value||Dn(_,oe.value))return null;_.preventDefault(),J.call(this,_,te)},{passive:!1})}),le.filter(_=>{var te,ae;const Ee=N.value||$.value,lt=I.value&&_.ctrlKey;if(_.button===1&&_.type==="mousedown"&&((te=_.target)!=null&&te.closest(".vue-flow__node")||(ae=_.target)!=null&&ae.closest(".vue-flow__edge")))return!0;if(!k.value&&!Ee&&!m.value&&!R.value&&!I.value||qe.value||!R.value&&_.type==="dblclick"||Dn(_,oe.value)&&_.type==="wheel"||Dn(_,G.value)&&_.type!=="wheel"||!I.value&&_.ctrlKey&&_.type==="wheel"||!Ee&&!m.value&&!lt&&_.type==="wheel"||!k.value&&(_.type==="mousedown"||_.type==="touchstart")||Array.isArray(k.value)&&!k.value.includes(_.button)&&(_.type==="mousedown"||_.type==="touchstart"))return!1;const Bn=Array.isArray(k.value)&&k.value.includes(_.button)||!_.button||_.button<=1;return(!_.ctrlKey||_.type==="wheel")&&Bn})});function Ze(An,fe){return fe===2&&Array.isArray(An)&&An.includes(2)}function Ae(An,fe){return An.x!==fe.x&&!isNaN(fe.x)||An.y!==fe.y&&!isNaN(fe.y)||An.zoom!==fe.k&&!isNaN(fe.k)}function Bt(An){return{x:An.x,y:An.y,zoom:An.k}}function Ge(){if(!Z.value)return;const{width:An,height:fe}=nn(Z.value);(An===0||fe===0)&&ne.value.error(new ve(he.MISSING_VIEWPORT_DIMENSIONS)),u.value.width=An||500,u.value.height=fe||500}function Dn(An,fe){return An.target.closest(`.${fe}`)}return(An,fe)=>(openBlock(),createElementBlock(Fragment,null,[(openBlock(),createElementBlock("div",{ref_key:"viewportEl",ref:Z,key:`viewport-${unref(r)}`,class:"vue-flow__viewport vue-flow__container"},[createVNode(od,{"is-selecting":unref(ye),class:normalizeClass({connecting:!!unref(K),dragging:unref(ge),draggable:!!unref(k)})},{default:withCtx(()=>[createVNode(xd,null,{default:withCtx(()=>[renderSlot(An.$slots,"zoom-pane")]),_:3})]),_:3},8,["is-selecting","class"])])),renderSlot(An.$slots,"default")],64))}}),bd=["id"],Ed=["id"],Sd=["id"],Nd={name:"A11yDescriptions",compatConfig:{MODE:3}},Cd=defineComponent({...Nd,setup(n){const{id:e,disableKeyboardA11y:r,ariaLiveMessage:o}=ce(),s={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"};return(l,c)=>(openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{id:`${unref(Wi)}-${unref(e)}`,style:{display:"none"}}," Press enter or space to select a node. "+toDisplayString(unref(r)?"":"You can then use the arrow keys to move the node around.")+" You can then use the arrow keys to move the node around, press delete to remove it and press escape to cancel. ",9,bd),createBaseVNode("div",{id:`${unref(qi)}-${unref(e)}`,style:{display:"none"}}," Press enter or space to select an edge. You can then press delete to remove it or press escape to cancel. ",8,Ed),unref(r)?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:0,id:`${unref(Sl)}-${unref(e)}`,"aria-live":"assertive","aria-atomic":"true",style:s},toDisplayString(unref(o)),9,Sd))],64))}}),Md={name:"VueFlow",compatConfig:{MODE:3}},Rd=defineComponent({...Md,props:{id:null,modelValue:null,nodes:null,edges:null,edgeTypes:null,nodeTypes:null,connectionMode:null,connectionLineType:null,connectionLineStyle:{default:void 0},connectionLineOptions:{default:void 0},connectionRadius:null,isValidConnection:{type:[Function,null],default:void 0},deleteKeyCode:null,selectionKeyCode:null,multiSelectionKeyCode:null,zoomActivationKeyCode:null,panActivationKeyCode:null,snapToGrid:{type:Boolean,default:void 0},snapGrid:null,onlyRenderVisibleElements:{type:Boolean,default:void 0},edgesUpdatable:{type:[Boolean,String],default:void 0},nodesDraggable:{type:Boolean,default:void 0},nodesConnectable:{type:Boolean,default:void 0},elementsSelectable:{type:Boolean,default:void 0},selectNodesOnDrag:{type:Boolean,default:void 0},panOnDrag:{type:[Boolean,Array],default:void 0},minZoom:null,maxZoom:null,defaultViewport:null,translateExtent:null,nodeExtent:null,defaultMarkerColor:null,zoomOnScroll:{type:Boolean,default:void 0},zoomOnPinch:{type:Boolean,default:void 0},panOnScroll:{type:Boolean,default:void 0},panOnScrollSpeed:null,panOnScrollMode:null,zoomOnDoubleClick:{type:Boolean,default:void 0},preventScrolling:{type:Boolean,default:void 0},selectionMode:null,edgeUpdaterRadius:null,fitViewOnInit:{type:Boolean,default:void 0},connectOnClick:{type:Boolean,default:void 0},applyDefault:{type:Boolean,default:void 0},autoConnect:{type:[Boolean,Function],default:void 0},noDragClassName:null,noWheelClassName:null,noPanClassName:null,defaultEdgeOptions:null,elevateEdgesOnSelect:{type:Boolean,default:void 0},elevateNodesOnSelect:{type:Boolean,default:void 0},disableKeyboardA11y:{type:Boolean,default:void 0},edgesFocusable:{type:Boolean,default:void 0},nodesFocusable:{type:Boolean,default:void 0},autoPanOnConnect:{type:Boolean,default:void 0},autoPanOnNodeDrag:{type:Boolean,default:void 0},__experimentalFeatures:null},emits:["nodesChange","edgesChange","nodeDoubleClick","nodeClick","nodeMouseEnter","nodeMouseMove","nodeMouseLeave","nodeContextMenu","nodeDragStart","nodeDrag","nodeDragStop","nodesInitialized","miniMapNodeClick","miniMapNodeDoubleClick","miniMapNodeMouseEnter","miniMapNodeMouseMove","miniMapNodeMouseLeave","connect","connectStart","connectEnd","clickConnectStart","clickConnectEnd","moveStart","move","moveEnd","selectionDragStart","selectionDrag","selectionDragStop","selectionContextMenu","selectionStart","selectionEnd","viewportChangeStart","viewportChange","viewportChangeEnd","paneReady","paneScroll","paneClick","paneContextMenu","paneMouseEnter","paneMouseMove","paneMouseLeave","edgeContextMenu","edgeMouseEnter","edgeMouseMove","edgeMouseLeave","edgeDoubleClick","edgeClick","edgeUpdateStart","edgeUpdate","edgeUpdateEnd","updateNodeInternals","error","update:modelValue","update:nodes","update:edges"],setup(n,{expose:e,emit:r}){const o=n,s=yt(o,"modelValue",r),l=yt(o,"nodes",r),c=yt(o,"edges",r),{vueFlowRef:u,hooks:f,getNodeTypes:d,getEdgeTypes:g,...m}=ce(o),v=td({modelValue:s,nodes:l,edges:c},o,{vueFlowRef:u,hooks:f,getNodeTypes:d,getEdgeTypes:g,...m});la(r,f);const b=ref();return provide(an,useSlots()),onUnmounted(()=>{v()}),onMounted(()=>{u.value=b.value}),e({vueFlowRef:u,hooks:f,getNodeTypes:d,getEdgeTypes:g,...m}),(k,R)=>(openBlock(),createElementBlock("div",{ref_key:"el",ref:b,class:"vue-flow"},[createVNode(wd,null,{nodes:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(Object.keys(unref(d)),I=>renderSlot(k.$slots,`node-${I}`)),256))]),edges:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(Object.keys(unref(g)),I=>renderSlot(k.$slots,`edge-${I}`)),256))]),"connection-name":withCtx(()=>[renderSlot(k.$slots,"connection-line")]),"zoom-pane":withCtx(()=>[renderSlot(k.$slots,"zoom-pane")]),default:withCtx(()=>[renderSlot(k.$slots,"default")]),_:3}),createVNode(Cd)],512))}});var a=(n=>(n.Lines="lines",n.Dots="dots",n))(a||{});const z=function({dimensions:n,size:e,color:r}){return h$1("path",{stroke:r,"stroke-width":e,d:`M${n[0]/2} 0 V${n[1]} M0 ${n[1]/2} H${n[0]}`})},C=function({radius:n,color:e}){return h$1("circle",{cx:n,cy:n,r:n,fill:e})};a.Lines+"",a.Dots+"";const L=["id","x","y","width","height","patternTransform"],B={key:2,height:"100",width:"100"},S=["fill"],E=["x","y","fill"],M={name:"Background",compatConfig:{MODE:3}},A=defineComponent({...M,props:{id:null,variant:{default:a.Dots},gap:{default:20},size:{default:1},lineWidth:{default:1},patternColor:null,bgColor:null,height:{default:100},width:{default:100},x:{default:0},y:{default:0},offset:{default:2}},setup(n){const e={[a.Dots]:"#81818a",[a.Lines]:"#eee"},{id:r,viewport:o}=ce(),s=computed(()=>{const[u,f]=Array.isArray(n.gap)?n.gap:[n.gap,n.gap],d=[u*o.value.zoom||1,f*o.value.zoom||1],g=n.size*o.value.zoom,m=n.variant===a.Dots?[g/n.offset,g/n.offset]:[d[0]/n.offset,d[1]/n.offset];return{scaledGap:d,offset:m,size:g}}),l=computed(()=>`pattern-${r}${n.id?`-${n.id}`:""}`),c=computed(()=>n.patternColor||e[n.variant||a.Dots]);return(u,f)=>(openBlock(),createElementBlock("svg",{class:"vue-flow__background vue-flow__container",style:normalizeStyle({height:`${n.height>100?100:n.height}%`,width:`${n.width>100?100:n.width}%`})},[renderSlot(u.$slots,"pattern-container",{id:unref(l)},()=>[createBaseVNode("pattern",{id:unref(l),x:unref(o).x%unref(s).scaledGap[0],y:unref(o).y%unref(s).scaledGap[1],width:unref(s).scaledGap[0],height:unref(s).scaledGap[1],patternTransform:`translate(-${unref(s).offset[0]},-${unref(s).offset[1]})`,patternUnits:"userSpaceOnUse"},[renderSlot(u.$slots,"pattern",{},()=>[n.variant===unref(a).Lines?(openBlock(),createBlock(unref(z),{key:0,size:n.lineWidth,color:unref(c),dimensions:unref(s).scaledGap},null,8,["size","color","dimensions"])):n.variant===unref(a).Dots?(openBlock(),createBlock(unref(C),{key:1,color:unref(c),radius:unref(s).size/n.offset},null,8,["color","radius"])):createCommentVNode("",!0),n.bgColor?(openBlock(),createElementBlock("svg",B,[createBaseVNode("rect",{width:"100%",height:"100%",fill:n.bgColor},null,8,S)])):createCommentVNode("",!0)])],8,L)]),createBaseVNode("rect",{x:n.x,y:n.y,width:"100%",height:"100%",fill:`url(#${unref(l)})`},null,8,E),renderSlot(u.$slots,"default",{id:unref(l)})],4))}}),Sidebar_vue_vue_type_style_index_0_scoped_e3355825_lang="",_export_sfc=(n,e)=>{const r=n.__vccOpts||n;for(const[o,s]of e)r[o]=s;return r},_withScopeId=n=>(pushScopeId("data-v-e3355825"),n=n(),popScopeId(),n),_hoisted_1$2=_withScopeId(()=>createBaseVNode("div",{class:"description"},"You can drag these nodes to the pane.",-1)),_hoisted_2$1={class:"nodes"},_sfc_main$2={__name:"Sidebar",setup(n){function e(r,o){r.dataTransfer&&(r.dataTransfer.setData("application/vueflow",o),r.dataTransfer.effectAllowed="move")}return(r,o)=>(openBlock(),createElementBlock("aside",null,[_hoisted_1$2,createBaseVNode("div",_hoisted_2$1,[createBaseVNode("div",{class:"vue-flow__node-input",draggable:!0,onDragstart:o[0]||(o[0]=s=>e(s,"input"))}," Input Node ",32),createBaseVNode("div",{class:"vue-flow__node-default",draggable:!0,onDragstart:o[1]||(o[1]=s=>e(s,"default"))}," Default Node ",32),createBaseVNode("div",{class:"vue-flow__node-output",draggable:!0,onDragstart:o[2]||(o[2]=s=>e(s,"output"))}," Output Node ",32)])]))}},Sidebar=_export_sfc(_sfc_main$2,[["__scopeId","data-v-e3355825"]]),VueFlow_vue_vue_type_style_index_0_lang="",_hoisted_1$1={class:"updatenode__controls"},_hoisted_2={key:0},_hoisted_3=createBaseVNode("label",{class:"updatenode__bglabel"},"background:",-1),_hoisted_4={key:1},_hoisted_5=createBaseVNode("label",{class:"updatenode__bglabel"},"storke:",-1),_hoisted_6={key:2},_hoisted_7=createBaseVNode("label",{class:"updatenode__bglabel"},"labelBgStyle:",-1),_hoisted_8={key:3},_hoisted_9=createBaseVNode("label",{class:"updatenode__bglabel"},"type:",-1),_hoisted_10=createBaseVNode("option",{value:"default"},"default",-1),_hoisted_11=createBaseVNode("option",{value:"smoothstep"},"smoothstep",-1),_hoisted_12=createBaseVNode("option",{value:"step"},"step",-1),_hoisted_13=[_hoisted_10,_hoisted_11,_hoisted_12],_hoisted_14={class:"updatenode__checkboxwrapper"},_hoisted_15=createBaseVNode("label",null,"hidden:",-1),_hoisted_16={key:4,class:"updatenode__checkboxwrapper"},_hoisted_17=createBaseVNode("label",null,"animated:",-1),_sfc_main$1={__name:"VueFlow",props:["modelValue"],emits:["update:modelValue"],setup(n,{emit:e}){const r=n;let o=0;function s(){return`dnd${o++}`}const l=computed({get(){return r.modelValue},set(Z){if(Z!==l.value){const re=Z.map(st=>({id:st.id,type:st.type,label:st.label,position:st.position,style:st.style,class:st.Class,hidden:st.hidden,animated:st.animated,source:st.source,target:st.target,labelBgStyle:st.labelBgStyle})),He=JSON.stringify(re,null,2).replace(/"(\w+)"\s*:/g,"$1:").replace(/["]/g,"'");e("update:modelValue",He),Z.map(st=>{var ee,_e,ue;st.id===ne&&(q.bg=(ee=st.style)==null?void 0:ee.background,q.stroke=(_e=st.style)==null?void 0:_e.stroke,q.type=st.type,q.labelBgStyle.fill=(ue=st.labelBgStyle)==null?void 0:ue.fill,q.label=st.label,q.hidden=st.hidden)})}}});watch(()=>l.value,Z=>{Z&&(l.value=Z.map(re=>(re.position===void 0&&(re.position={x:Math.random()*Y.value.width,y:Math.random()*Y.value.height}),re)))},{deep:!0});const{onPaneReady:c,findNode:u,onNodeDragStop:f,onConnect:d,onEdgeUpdate:g,updateEdge:m,addEdges:v,addNodes:b,getSelectedElements:k,getElements:R,project:I,vueFlowRef:$,dimensions:Y}=ce({});c(({fitView:Z})=>{Z(),setTimeout(()=>{Z()},100)}),f(Z=>{const re=Z.node;l.value=l.value.map(He=>(He.id===re.id&&(He.position={x:Math.round(re.position.x),y:Math.round(re.position.y)}),He))});function oe(Z){Z.preventDefault(),Z.dataTransfer&&(Z.dataTransfer.dropEffect="move")}function G(Z){var ue;const re=(ue=Z.dataTransfer)==null?void 0:ue.getData("application/vueflow"),{left:He,top:st}=$.value.getBoundingClientRect(),ee=I({x:Z.clientX-He,y:Z.clientY-st}),_e={id:s(),type:re,position:ee,label:`${re} node`};b([_e]),nextTick(()=>{const ye=u(_e.id),We=watch(()=>ye.dimensions,Ze=>{Ze.width>0&&Ze.height>0&&(ye.position={x:ye.position.x-ye.dimensions.width/2,y:ye.position.y-ye.dimensions.height/2},We())},{deep:!0,flush:"post"})})}d(Z=>v([Z])),g(({edge:Z,connection:re})=>m(Z,re));const q=reactive({bg:null,stroke:null,type:null,labelBgStyle:{fill:null},label:null,hidden:null});let ne="1",K=!1;onMounted(()=>{R.value.map(re=>{re.id===ne&&(ne.slice(0,1)==="e"||ne.slice(0,1)==="v"?K=!0:K=!1,q.label=re.label?re.label:"",q.hidden=re.hidden,re.style&&(q.bg=re.style.backgroundColor),K&&(re.labelBgStyle&&(q.labelBgStyle.fill=re.labelBgStyle.fill?re.labelBgStyle.fill:""),q.animated=re.animated?re.animated:!1,q.type=re.type?re.type:"default",re.style&&(q.stroke=re.style.stroke?re.style.stroke:"")))})});function qe(){const Z=k.value[0];Z&&(ne=Z.id,ne.slice(0,1)==="e"||ne.slice(0,1)==="v"?K=!0:K=!1,q.label=Z.label?Z.label:"",q.hidden=Z.hidden,q.bg=Z.style?Z.style.backgroundColor:"",K&&(q.labelBgStyle.fill=Z.labelBgStyle?Z.labelBgStyle.fill:"",q.animated=Z.animated?Z.animated:!1,q.type=Z.type?Z.type:"default",q.stroke=Z.style?Z.style.stroke:""))}function ge(Z){l.value=l.value.map(re=>(re.id===ne&&(Z==="label"&&(re.label=q.label!==""?q.label:""),Z==="bg"&&(re.style={backgroundColor:q.bg}),Z==="hidden"&&(re.hidden=q.hidden),K&&(Z==="stroke"&&(re.style={stroke:q.stroke}),Z==="labelBgStyle"&&(re.labelBgStyle={fill:q.labelBgStyle.fill}),Z==="animated"&&(re.animated=q.animated),Z==="type"&&(re.type=q.type))),re))}return(Z,re)=>(openBlock(),createElementBlock("div",{class:"dndflow",onDrop:G,onClick:qe},[createVNode(Sidebar),createVNode(unref(Rd),{modelValue:unref(l),"onUpdate:modelValue":re[14]||(re[14]=He=>isRef(l)?l.value=He:null),"only-render-visible-elements":!0,"fit-view-on-init":"",class:"basicflow","edges-updatable":!0,"zoom-on-double-click":!1,"default-viewport":{zoom:1.5},"min-zoom":.2,"max-zoom":4,onDragover:oe},{default:withCtx(()=>[createVNode(unref(A)),createBaseVNode("div",_hoisted_1$1,[createBaseVNode("div",null,[withDirectives(createBaseVNode("input",{"onUpdate:modelValue":re[0]||(re[0]=He=>q.label=He),onInput:re[1]||(re[1]=He=>ge("label")),placeholder:"label"},null,544),[[vModelText,q.label]])]),unref(K)?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_2,[_hoisted_3,withDirectives(createBaseVNode("input",{"onUpdate:modelValue":re[2]||(re[2]=He=>q.bg=He),type:"color",onInput:re[3]||(re[3]=He=>ge("bg"))},null,544),[[vModelText,q.bg]])])),unref(K)?(openBlock(),createElementBlock("div",_hoisted_4,[_hoisted_5,withDirectives(createBaseVNode("input",{"onUpdate:modelValue":re[4]||(re[4]=He=>q.stroke=He),type:"color",onInput:re[5]||(re[5]=He=>ge("stroke"))},null,544),[[vModelText,q.stroke]])])):createCommentVNode("",!0),unref(K)&&q.labelBgStyle?(openBlock(),createElementBlock("div",_hoisted_6,[_hoisted_7,withDirectives(createBaseVNode("input",{"onUpdate:modelValue":re[6]||(re[6]=He=>q.labelBgStyle.fill=He),type:"color",onInput:re[7]||(re[7]=He=>ge("labelBgStyle"))},null,544),[[vModelText,q.labelBgStyle.fill]])])):createCommentVNode("",!0),unref(K)?(openBlock(),createElementBlock("div",_hoisted_8,[_hoisted_9,withDirectives(createBaseVNode("select",{"onUpdate:modelValue":re[8]||(re[8]=He=>q.type=He),onChange:re[9]||(re[9]=He=>ge("type"))},_hoisted_13,544),[[vModelSelect,q.type]])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_14,[_hoisted_15,withDirectives(createBaseVNode("input",{"onUpdate:modelValue":re[10]||(re[10]=He=>q.hidden=He),type:"checkbox",onChange:re[11]||(re[11]=He=>ge("hidden"))},null,544),[[vModelCheckbox,q.hidden]])]),unref(K)?(openBlock(),createElementBlock("div",_hoisted_16,[_hoisted_17,withDirectives(createBaseVNode("input",{"onUpdate:modelValue":re[12]||(re[12]=He=>q.animated=He),type:"checkbox",onChange:re[13]||(re[13]=He=>ge("animated"))},null,544),[[vModelCheckbox,q.animated]])])):createCommentVNode("",!0)])]),_:1},8,["modelValue","default-viewport","min-zoom"])],32))}},HomeView_vue_vue_type_style_index_0_lang="",_sfc_main={name:"HomeView",components:{VueFlow:_sfc_main$1,Codemirror:T},setup(){const extensions=[json(),oneDark],view=shallowRef(),handleReady=n=>{view.value=n.view},code=ref(`[
  {
    id: '1',
    type: 'input',
    label: 'Node 1',
    position: {
      x: 250,
      y: 1
    },
    class: 'light'
  },
  {
    id: '2',
    type: 'output',
    label: 'Node 2',
    position: {
      x: 100,
      y: 100
    },
    class: 'light'
  },
  {
    id: '3',
    label: 'Node 3',
    position: {
      x: 400,
      y: 100
    },
    class: 'light'
  },
  {
    id: '4',
    label: 'Node 4',
    position: {
      x: 150,
      y: 200
    },
    class: 'light'
  },
  {
    id: '5',
    type: 'output',
    label: 'Node 5',
    position: {
      x: 300,
      y: 300
    },
    class: 'light'
  },
  {
    id: 'e1-2',
    source: '1',
    target: '2',
    animated: true
  },
  {
    id: 'e1-3',
    label: 'edge with arrowhead',
    source: '1',
    target: '3'
  },
  {
    id: 'e4-5',
    type: 'step',
    label: 'step-edge',
    source: '4',
    target: '5',
    style: {
      stroke: '#ffa500'
    },
    labelBgStyle: {
      fill: '#ffa500'
    }
  },
  {
    id: 'e3-4',
    type: 'smoothstep',
    label: 'smoothstep-edge',
    source: '3',
    target: '4'
  }
]
`),permision=ref(!0),codeObj=computed({get(){const validator=()=>{try{return eval(code.value),!0}catch(n){return!1}};if(validator()===!0){const validateId=eval(code.value).every(n=>n.id);if(validateId)return eval(code.value)}},set(n){permision.value&&n!==code.value&&(code.value=n)}});return{code,codeObj,extensions,handleReady,permision,log:console.log}}},_hoisted_1={class:"wrapper"};function _sfc_render(n,e,r,o,s,l){const c=resolveComponent("Codemirror"),u=resolveComponent("VueFlow");return openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("div",null,[createVNode(c,{modelValue:o.code,"onUpdate:modelValue":e[0]||(e[0]=f=>o.code=f),placeholder:"Code goes here...",style:{height:"100%"},autofocus:!0,"indent-with-tab":!0,"tab-size":2,extensions:o.extensions,onReady:o.handleReady,onFocus:e[1]||(e[1]=f=>o.permision=!1),onBlur:e[2]||(e[2]=f=>o.permision=!0)},null,8,["modelValue","extensions","onReady"])]),createBaseVNode("div",null,[createVNode(u,{modelValue:o.codeObj,"onUpdate:modelValue":e[3]||(e[3]=f=>o.codeObj=f)},null,8,["modelValue"])])])}const HomeView=_export_sfc(_sfc_main,[["render",_sfc_render]]),router=createRouter({history:createWebHistory("/mermaid/"),routes:[{path:"/",name:"home",component:HomeView}]}),main="",app=createApp(_sfc_main$3),pinia=createPinia();app.use(pinia);pinia.use(src_default);app.use(router);app.use(W,{autofocus:!0,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"Code goes here...",extensions:[basicSetup]});app.mount("#app");
